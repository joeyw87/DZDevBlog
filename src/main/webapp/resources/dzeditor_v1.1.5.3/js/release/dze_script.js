var ID_CUSTOM_BOLD=0,ID_CUSTOM_ITALIC=1,ID_CUSTOM_UNDERLINE=2,ID_CUSTOM_JUSTIFY_LEFT=3,ID_CUSTOM_JUSTIFY_CENTER=4,ID_CUSTOM_JUSTIFY_RIGHT=5,ID_CUSTOM_INSERT_ORDERED_LIST=6,ID_CUSTOM_INSERT_UNORDERED_LIST=7,ID_CUSTOM_STRIKE=8,ID_CUSTOM_SUBSCRIPT=9,ID_CUSTOM_SUPERSCRIPT=10,ID_CUSTOM_OUTDENT=11,ID_CUSTOM_INDENT=12,ID_CUSTOM_UNDO=13,ID_CUSTOM_REDO=14,ID_CUSTOM_CUT=15,ID_CUSTOM_COPY=16,ID_CUSTOM_PASTE=17,ID_CUSTOM_DELETE=18,ID_CUSTOM_SELECT_ALL=19,ID_CUSTOM_FONT_NAME=20,ID_CUSTOM_FONT_SIZE=21,ID_CUSTOM_FORE_COLOR=
22,ID_CUSTOM_BACK_COLOR=23,ID_CUSTOM_TABLE_CREATE=24,ID_CUSTOM_TABLE_ADD_ROW=25,ID_CUSTOM_TABLE_DELETE_ROW=26,ID_CUSTOM_TABLE_ADD_COL=27,ID_CUSTOM_TABLE_DELETE_COL=28,ID_CUSTOM_TABLE_MERGE_CELL=29,ID_CUSTOM_TABLE_SPLIT_ROW=30,ID_CUSTOM_TABLE_SPLIT_COL=31,ID_CUSTOM_HYPERLINK_INSERT=32,ID_CUSTOM_HYPERLINK_REMOVE=33,ID_CUSTOM_IMAGE_INSERT=34,ID_CUSTOM_FLASH_INSERT=35,ID_CUSTOM_MEDIA_INSERT=36,ID_CUSTOM_FULLSCREEN=37,ID_CUSTOM_HELP=38,ID_CUSTOM_HELP_INFO=39,ID_CUSTOM_TABLE_CELL_PROPERTY=40,ID_CUSTOM_TABLE_PROPERTY=
41,ID_CUSTOM_MARK_INSERT=42,ID_CUSTOM_TABLE_TEMPLETE_INSERT=43,ID_CUSTOM_ADJUST_HWP_BASIC=44,ID_CUSTOM_ADJUST_DOC_BASIC=45,ID_CUSTOM_HORIZONTAL_RULE=46,ID_CUSTOM_LETTER_SPACING=47,ID_CUSTOM_LINE_HEIGHT=48,ID_CUSTOM_BODY_BG_COLOR=49,ID_CUSTOM_BODY_BG_IMAGE=50,ID_CUSTOM_DOC_TEMPLETE=51,ID_CUSTOM_PREVIEW=52,ID_CUSTOM_HIDE_MINIBAR=53,ID_CUSTOM_WRITE_AREA_SET=54,ID_CUSTOM_SHOW_EDITABLE_AREA=55,ID_CUSTOM_EXT_FUNCTION=56,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_1=57,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_2=58,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_3=
59,ID_CUSTOM_SAVEAS=60,ID_CUSTOM_PRINT=61,ID_CUSTOM_CODE_INSPECT=62,ID_CUSTOM_Z_INDEX_SETTING=63,ID_CUSTOM_TEXT_BOX=64,ID_CUSTOM_OBJECT_POSITION=65,ID_CUSTOM_TABLE_ADD_ROW_DOWN=66,ID_CUSTOM_TABLE_ADD_COL_RIGHT=67,ID_CUSTOM_TABLE_COPY_ROW_DOWN=68,ID_CUSTOM_JUSTIFY_JUSTIFY=69,ID_CUSTOM_RESPONSIVE_WIDTH=70,ID_CUSTOM_DOC_LAYOUT=71,ID_CUSTOM_HEADING_SIZE=72,ID_CUSTOM_RESPONSIVE_SET=73,ID_CUSTOM_FORM_TABLE=74,ID_CUSTOM_FILE_NEW=75,ID_CUSTOM_FILE_OPEN=76,ID_CUSTOM_FILE_DOCFORM=77,ID_CUSTOM_FILE_LAYOUT=78,
ID_CUSTOM_EDIT_PASTESPECIAL=79,ID_CUSTOM_EDIT_SEARCH=80,ID_CUSTOM_EDIT_REPLACE=81,ID_CUSTOM_VIEW_EDIT=82,ID_CUSTOM_VIEW_HTML=83,ID_CUSTOM_INSERT_IMAGE=84,ID_CUSTOM_INSERT_OBJECT=85,ID_CUSTOM_INSERT_SPECIALCHARS=86,ID_CUSTOM_INSERT_BOOKMARK=87,ID_CUSTOM_STYLE_FONT=88,ID_CUSTOM_STYLE_PARAGRAPH=89,ID_CUSTOM_STYLE_STYLE=90,ID_CUSTOM_STYLE_UNORDEREDLIST=91,ID_CUSTOM_STYLE_ORDEREDLIST=92,ID_CUSTOM_STYLE_INCREASEORDER=93,ID_CUSTOM_STYLE_DECREASEORDER=94,ID_CUSTOM_TABLE_CELL_STYLE=95,ID_CUSTOM_TABLE_ADD_ROW_COL=
96,ID_CUSTOM_TABLE_DELETE_ROW_COL=97,ID_CUSTOM_TABLE_SPLIT_CELL=98,ID_CUSTOM_TABLE_CELL_SAME_HEIGHT=99,ID_CUSTOM_TABLE_CELL_SAME_WIDTH=100,ID_CUSTOM_TABLE_CELL_ALIGN=101,ID_CUSTOM_TABLE_MADANG=102,ID_CUSTOM_TABLE_FORMULA=103,ID_CUSTOM_TABLE_NUMBER_FORMAT=104,ID_CUSTOM_TABLE_SELECT=105,ID_CUSTOM_TABLE_CELL_HORIZONTALALIGN=106,ID_CUSTOM_TABLE_CELL_VERTICALALIGN=107,ID_CUSTOM_TABLE_BLOCK_FORMULA=108,ID_CUSTOM_TABLE_EASY_FORMULA=109,ID_CUSTOM_TABLE_SELECT_FORMULA=110,ID_CUSTOM_HELP_SHORTCUTS=111,ID_CUSTOM_INSERT_OBJECT_MOVIE=
112,ID_CUSTOM_INSERT_OBJECT_FILE=113,ID_CUSTOM_INSERT_OBJECT_HR=114,ID_CUSTOM_TABLE_CELL_HORIZONTAL_LEFT=115,ID_CUSTOM_TABLE_CELL_HORIZONTAL_CENTER=116,ID_CUSTOM_TABLE_CELL_HORIZONTAL_RIGHT=117,ID_CUSTOM_TABLE_CELL_VERTICAL_TOP=118,ID_CUSTOM_TABLE_CELL_VERTICAL_MIDDLE=119,ID_CUSTOM_TABLE_CELL_VERTICAL_BOTTOM=120,ID_CUSTOM_STYLE_STYLE_BASIC=121,ID_CUSTOM_STYLE_STYLE_SUBJECT1=122,ID_CUSTOM_STYLE_STYLE_SUBJECT2=123,ID_CUSTOM_STYLE_STYLE_SUBJECT3=124,ID_CUSTOM_STYLE_STYLE_SUBJECT4=125,ID_CUSTOM_STYLE_STYLE_SUBJECT5=
126,ID_CUSTOM_STYLE_INCREASE_FONTSIZE=127,ID_CUSTOM_STYLE_DECREASE_FONTSIZE=128,ID_CUSTOM_TABLE_BLOCK_SUM=129,ID_CUSTOM_TABLE_BLOCK_AVG=130,ID_CUSTOM_TABLE_BLOCK_MUL=131,ID_CUSTOM_TABLE_HORIZONTAL_SUM=132,ID_CUSTOM_TABLE_VERTICAL_SUM=133,ID_CUSTOM_TABLE_HORIZONTAL_AVERAGE=134,ID_CUSTOM_TABLE_VERTICAL_AVERAGE=135,ID_CUSTOM_TABLE_HORIZONTAL_MULTIPLY=136,ID_CUSTOM_TABLE_VERTICAL_MULTIPLY=137,ID_CUSTOM_TABLE_TABLE_ADD_NUMBER_FORMAT=138,ID_CUSTOM_TABLE_TABLE_REMOTE_NUMBER_FORMAT=139,ID_CUSTOM_FORM_TAG_SWITCH=
140,ID_CUSTOM_FORM_TAG_CHECKBOX=141,ID_CUSTOM_FORM_TAG_SELECT=142,ID_CUSTOM_MAPPING_CODE=143,ID_CUSTOM_MAPPING_CSS=144,ID_CUSTOM_TEMPLETE_FORM=145,ID_CUSTOM_INSERT_PARAGRAPH_STARTPOINT=146,ID_CUSTOM_INSERT_PARAGRAPH_ENDPOINT=147,ID_CUSTOM_TABLE_DELETE_TABLE=148,ID_CUSTOM_INSERT_PARAGRAPH=149,ID_CUSTOM_TABLE_CONVERT_TEXT=150,ID_CUSTOM_IMAGE_PROPERTY=151,ID_CUSTOM_FILE_PROPERTY=152,ID_CUSTOM_EDIT_REPLACE_CASE=153,ID_CUSTOM_TABLE_CELL_BACKCOLOR=154,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_TOP=155,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_TOP=
156,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_TOP=157,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_MIDDLE=158,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_MIDDLE=159,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_MIDDLE=160,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_BOTTOM=161,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_BOTTOM=162,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_BOTTOM=163,ID_CUSTOM_DRAW_TABLE=164,ID_CUSTOM_INSERT_EMOTICONS=165,ID_CUSTOM_EDIT_PRIINT_PAGE_BREAK=166,ID_CUSTOM_VIEW_RULERBAR=167,ID_CUSTOM_STYLE_CASCADE_ORDERLIST=168,ID_CUSTOM_COPY_EXT=169,ID_CUSTOM_COPY_EXT_STYLE=
170,ID_CUSTOM_SELECT_PARAGRAPH=171,ID_CUSTOM_PASTE_EXT=172,ID_CUSTOM_TABLE_DELETE_EXT=173,ID_CUSTOM_TABLE_FORMULA_EXT=174,ID_CUSTOM_IMAGE_BORDER_TYPE=175,ID_CUSTOM_IMAGE_BORDER_THICKNESS=176,ID_CUSTOM_IMAGE_BORDER_COLOR=177,ID_CUSTOM_IMAGE_RESET_PICTURE=178,ID_CUSTOM_IMAGE_BORDER_NONE=179,ID_CUSTOM_IMAGE_BORDER_SOLID=180,ID_CUSTOM_IMAGE_BORDER_DASHED=181,ID_CUSTOM_IMAGE_BORDER_DOTTED=182,ID_CUSTOM_IMAGE_BORDER_DOUBLE=183,ID_CUSTOM_IMAGE_BORDER_1PX=184,ID_CUSTOM_IMAGE_BORDER_2PX=185,ID_CUSTOM_IMAGE_BORDER_3PX=
186,ID_CUSTOM_IMAGE_BORDER_4PX=187,ID_CUSTOM_IMAGE_BORDER_5PX=188,ID_CUSTOM_IMAGE_BORDER_6PX=189,ID_CUSTOM_IMAGE_BORDER_7PX=190,ID_CUSTOM_IMAGE_BORDER_8PX=191,ID_CUSTOM_IMAGE_BORDER_9PX=192,ID_CUSTOM_IMAGE_BORDER_10PX=193,ID_CUSTOM_TABLE_SELECT_CELL=194,ID_CUSTOM_TABLE_SELECT_ROW=195,ID_CUSTOM_TABLE_SELECT_COL=196,ID_CUSTOM_TABLE_SELECT_TABLE=197,ID_CUSTOM_IMAGE_TO_TABLE=198,ID_CUSTOM_TABLE_BORDER_THICKNESS=199,ID_CUSTOM_TABLE_BORDER_TYPE=200,ID_CUSTOM_TABLE_BORDER_COLOR=201,ID_CUSTOM_TABLE_STYLE=
202,ID_CUSTOM_IMAGE_HEIGHT=203,ID_CUSTOM_IMAGE_WIDTH=204,ID_CUSTOM_HELP_IMAGE_TO_TABLE=205,ID_CUSTOM_LOCK_EDIT_CELL=206,ID_CUSTOM_EXTERNAL_DATA_AREA=207,ID_CUSTOM_TOOLBAR_HANDLE=1111,ID_CUSTOM_TOOLBAR_SEPARATOR=1112,ID_CUSTOM_TOOLBAR_SPACE=1113,ID_CUSTOM_MENU_SEPARATOR=1114,ID_CUSTOM_TOOLBAR_CAPTION=1115;function fnGetEditorPreviewHTML(){return getEditorPreviewHTML(g_nActiveEditNumber)}function fnAddHTMLCode(a){return addHTMLCode(a,g_nActiveEditNumber)}
function fnGetEditorHTMLCode(a,b){return getEditorHTMLCode(a,b)}function fnSetEditorHTMLCode(a,b,c){return setEditorHTMLCode(a,b,c)}function fnInsertHTMLContent(a,b){insertHTMLContent(a,b)}function fnGetEditorText(a){return getEditorText(a)}function fnGetEditorSelectionText(a){return getEditorSelectionText(a)}function fnAddHTMLContent(a,b,c,d){return addHTMLContent(a,b,c,d)}function fnReplaceHTMLContent(a,b){return replaceHTMLContent(a,b)}
function fnGetEditorDocument(a){try{return g_objEditorDocument[a]}catch(b){}return null}function fnGetEditorWindow(a){try{return g_objEditWindow[a]}catch(b){}return null}function fnFindCountEditorText(a,b){try{return findCountEditorText(a,b)}catch(c){}return 0}function fnFindEditorText(a,b){try{return findEditorText(a,b)}catch(c){}return-1}function fnFindEditorTextDetail(a,b,c,d,e,f){try{return findEditorTextDetail(a,b,c,d,e,f)}catch(g){}return-1}
function fnReplaceEditorText(a,b,c){try{return replaceEditorText(a,b,c)}catch(d){}return-1}function fnReplaceEditorTextDetail(a,b,c,d,e,f,g){try{return replaceEditorTextDetail(a,b,c,d,e,f,g)}catch(h){}return-1}function fnReplaceAllEditorText(a,b,c){try{return replaceAllEditorText(a,b,c)}catch(d){}return-1}function fnResizeEditor(a,b,c){try{resizeEditor(a,b,c)}catch(d){}}function fnGetEditorMode(a){try{return g_bEditMode[a]}catch(b){}}
function fnIsActiveEditorMode(a){try{return g_bEditMode[a]?g_bActivate[a]:!1}catch(b){}return!1}function fnInitWebEditor(){try{initWebEditor()}catch(a){}}function fnGetImageList(a){try{return getImageList(a)}catch(b){}return null}function fnSetContentXHTMLFormat(a,b){try{return setContentXHTMLFormat(a,b)}catch(c){}}function fnBindExternalData(a,b){try{doBindExternalData(b,a)}catch(c){}}function fnSetPreviewPageURL(a){try{dzeEnvConfig.strPreviewPageURL=a}catch(b){}}
function fnGetEditorTagCount_script(a){try{return getEditorTagCount_script(a)}catch(b){}}function fnGetEditorTagCount_iframe(a){try{return getEditorTagCount_iframe(a)}catch(b){}}function fnShowEditor(a){try{var b=getnEditNumberFromEditId(a);duzon_menubar.rebuildHiddenToolbar();duzon_dialog.nEditNumber=b;duzon_dialog.setEditorSelection();duzon_dialog.setEditorFocus();editor_onselectionchange(b)}catch(c){}};

var DZE_IFRAME_TMP_NO=9999,DZE_TAG_NONE=0,DZE_TAG_IMG=1,DZE_TAG_TABLE=2,DZE_TAG_TR=3,DZE_TAG_TD=4,DZE_TAG_TEXT=5,DZE_TAG_FILE=6,DZE_TAG_MEDIA=7,DZE_TAG_TEXTBOX=8,DZE_TAG_SHAPE=9,DZE_TAG_OBJECT=10,DZE_TAG_EMBEDE=11,DZE_TAG_DIV=11,DZE_HTMLOBJ_TABLE="table",DZE_HTMLOBJ_IMG="img",DZE_HTMLOBJ_TR="tr",DZE_HTMLOBJ_TD="td",DZE_HTMLOBJ_TEXT="text",DZE_HTMLOBJ_BODY="body",DZE_HTMLOBJ_DIV="div",DZE_HTMLOBJ_P="p",DZE_HTMLOBJ_SPAN="span",DZE_HTMLOBJ_OL="ol",DZE_HTMLOBJ_UL="ul",DZE_HTMLOBJ_LI="li",DZE_EXTENDS_COLOR_PICKER=
0,DZE_EXTENDS_EMOTICON=1,DZE_EXTENDS_CASCADE_ORDERLIST=2,DZE_EXTENDS_COPY_EXT=3,DZE_EXTENDS_PASTE_EXT=4,DZE_EXTENDS_INSERT_PARAGRAPH=5,DZE_EXTENDS_TABLE_DELETE_EXT=6,DZE_EXTENDS_TABLE_SELECT=7,DZE_EXTENDS_TABLE_FORMULA_EXT=8,DZE_EXTENDS_TABLE_NUMBER_FORMAT=9,DZE_EXTENDS_IMAGE_BORDER_TYPE=10,DZE_EXTENDS_IMAGE_BORDER_THICKNESS=11,DZE_EXTENDS_IMAGE_BORDER_COLOR=12,DZE_EXTENDS_TABLE_BORDER_THICKNESS=13,DZE_EXTENDS_TABLE_BORDER_TYPE=14,DZE_EXTENDS_TABLE_BORDER_COLOR=15,DZE_EXTENDS_STYLE_UNORDERLIST=16,
DZE_EXTENDS_STYLE_ORDERLIST=17,DZE_EXTENDS_TABLE_CELL_ALIGN=18,DZE_EXTENDS_TABLE_STYLE=19,DZE_DISPLAY_EXTENDS_NONE=0,DZE_DISPLAY_EXTENDS_COLOR_PICKER=1,DZE_DISPLAY_EXTENDS_EMOTICON=2,DZE_DISPLAY_EXTENDS_CASCADE_ORDERLIST=3,DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST=4,DZE_DISPLAY_EXTENDS_COMMON_POPUP=5,DZE_CTRL_PT_NONE=-1,DZE_CTRL_PT_LEFT_TOP=0,DZE_CTRL_PT_RIGHT_TOP=1,DZE_CTRL_PT_RIGHT_BOTTOM=2,DZE_CTRL_PT_LEFT_BOTTOM=3,DZE_CTRL_PT_TOP=4,DZE_CTRL_PT_RIGHT=5,DZE_CTRL_PT_BOTTOM=6,DZE_CTRL_PT_LEFT=7,DZE_CTRL_PT_ROTATE=
8,COMBOBOX_TYPE_BORDER_STYLE=0,COMBOBOX_TYPE_BORDER_WIDTH=1,CONTRACTOR_TYPE=[{code:"N",name:"\uc77c\ubc18"},{code:"A",name:"\uac11"},{code:"B",name:"\uc744"},{code:"C",name:"\ubcd1"},{code:"D",name:"\uc815"},{code:"E",name:"\ubb34"},{code:"F",name:"\uae30"},{code:"G",name:"\uacbd"},{code:"H",name:"\uc2e0"},{code:"I",name:"\uc784"},{code:"J",name:"\uacc4"}],FONT_WEIGHT_TYPE=[{value:"normal",name:"\ubcf4\ud1b5"},{value:"bold",name:"\uad75\uac8c"}],CUSTOM_INPUT_DIALOG={NAME:0,TAG_NAME:1,TAG_FORMAT:2,
CONTRACTOR_TYPE:3,TEXT_LENGTH:4,FONT_FAMILY:5,FONT_SIZE:6,FONT_WEIGHT:7,READONLY_YES:8,READONLY_NO:9,DIALOG_MENU_COUNTS:10},DZE_DIR={NONE:0,LEFT:1,TOP:2,RIGHT:3,BOTTOM:4,HORIZONTAL:5,VERTICAL:6,reverse:function(a){switch(a){case this.LEFT:return this.RIGHT;case this.TOP:return this.BOTTOM;case this.RIGHT:return this.LEFT;case this.BOTTOM:return this.TOP}},doAllDir:function(a){for(var c=[this.LEFT,this.TOP,this.RIGHT,this.BOTTOM],b=0;b<c.length;b++)a(c[b],this.getString(c[b]))},getString:function(a){switch(a){case this.LEFT:return"left";
case this.TOP:return"top";case this.RIGHT:return"right";case this.BOTTOM:return"bottom"}}};

var ID_COMMAND_BOLD=0,ID_COMMAND_ITALIC=1,ID_COMMAND_UNDERLINE=2,ID_COMMAND_JUSTIFY_LEFT=3,ID_COMMAND_JUSTIFY_CENTER=4,ID_COMMAND_JUSTIFY_RIGHT=5,ID_COMMAND_INSERT_ORDERED_LIST=6,ID_COMMAND_INSERT_UNORDERED_LIST=7,ID_COMMAND_STRIKE=8,ID_COMMAND_SUBSCRIPT=9,ID_COMMAND_SUPERSCRIPT=10,ID_COMMAND_OUTDENT=11,ID_COMMAND_INDENT=12,ID_COMMAND_UNDO=13,ID_COMMAND_REDO=14,ID_COMMAND_CUT=15,ID_COMMAND_COPY=16,ID_COMMAND_PASTE=17,ID_COMMAND_DELETE=18,ID_COMMAND_SELECT_ALL=19,ID_COMMAND_FONT_NAME=20,ID_COMMAND_FONT_SIZE=
21,ID_COMMAND_FORE_COLOR=22,ID_COMMAND_BACK_COLOR=23,ID_COMMAND_TABLE_CREATE=24,ID_COMMAND_TABLE_ADD_ROW=25,ID_COMMAND_TABLE_DELETE_ROW=26,ID_COMMAND_TABLE_ADD_COL=27,ID_COMMAND_TABLE_DELETE_COL=28,ID_COMMAND_TABLE_MERGE_CELL=29,ID_COMMAND_TABLE_SPLIT_ROW=30,ID_COMMAND_TABLE_SPLIT_COL=31,ID_COMMAND_HYPERLINK_INSERT=32,ID_COMMAND_HYPERLINK_REMOVE=33,ID_COMMAND_IMAGE_INSERT=34,ID_COMMAND_FLASH_INSERT=35,ID_COMMAND_MEDIA_INSERT=36,ID_COMMAND_FULLSCREEN=37,ID_COMMAND_HELP=38,ID_COMMAND_HELP_INFO=39,ID_COMMAND_TABLE_CELL_PROPERTY=
40,ID_COMMAND_TABLE_PROPERTY=41,ID_COMMAND_MARK_INSERT=42,ID_COMMAND_TABLE_TEMPLETE_INSERT=43,ID_COMMAND_ADJUST_HWP_BASIC=44,ID_COMMAND_ADJUST_DOC_BASIC=45,ID_COMMAND_HORIZONTAL_RULE=46,ID_COMMAND_LETTER_SPACING=47,ID_COMMAND_LINE_HEIGHT=48,ID_COMMAND_BODY_BG_COLOR=49,ID_COMMAND_BODY_BG_IMAGE=50,ID_COMMAND_DOC_TEMPLETE=51,ID_COMMAND_PREVIEW=52,ID_COMMAND_HIDE_MINIBAR=53,ID_COMMAND_WRITE_AREA_SET=54,ID_COMMAND_SHOW_EDITABLE_AREA=55,ID_COMMAND_EXT_FUNCTION=56,ID_COMMAND_CUSTOMER_TOOL_BUTTON_1=57,ID_COMMAND_CUSTOMER_TOOL_BUTTON_2=
58,ID_COMMAND_CUSTOMER_TOOL_BUTTON_3=59,ID_COMMAND_SAVEAS=60,ID_COMMAND_PRINT=61,ID_COMMAND_CODE_INSPECT=62,ID_COMMAND_Z_INDEX_SETTING=63,ID_COMMAND_TEXT_BOX=64,ID_COMMAND_OBJECT_POSITION=65,ID_COMMAND_TABLE_ADD_ROW_DOWN=66,ID_COMMAND_TABLE_ADD_COL_RIGHT=67,ID_COMMAND_TABLE_COPY_ROW_DOWN=68,ID_COMMAND_JUSTIFY_JUSTIFY=69,ID_COMMAND_RESPONSIVE_WIDTH=70,ID_COMMAND_DOC_LAYOUT=71,ID_COMMAND_HEADING_SIZE=72,ID_COMMAND_RESPONSIVE_SET=73,ID_COMMAND_FORM_TABLE=74,ID_COMMAND_FILE_NEW=75,ID_COMMAND_FILE_OPEN=
76,ID_COMMAND_FILE_DOCFORM=77,ID_COMMAND_FILE_LAYOUT=78,ID_COMMAND_EDIT_PASTESPECIAL=79,ID_COMMAND_EDIT_SEARCH=80,ID_COMMAND_EDIT_REPLACE=81,ID_COMMAND_VIEW_EDIT=82,ID_COMMAND_VIEW_HTML=83,ID_COMMAND_INSERT_IMAGE=84,ID_COMMAND_INSERT_OBJECT=85,ID_COMMAND_INSERT_SPECIALCHARS=86,ID_COMMAND_INSERT_BOOKMARK=87,ID_COMMAND_STYLE_FONT=88,ID_COMMAND_STYLE_PARAGRAPH=89,ID_COMMAND_STYLE_STYLE=90,ID_COMMAND_STYLE_UNORDEREDLIST=91,ID_COMMAND_STYLE_ORDEREDLIST=92,ID_COMMAND_STYLE_INCREASEORDER=93,ID_COMMAND_STYLE_DECREASEORDER=
94,ID_COMMAND_TABLE_CELL_STYLE=95,ID_COMMAND_TABLE_ADD_ROW_COL=96,ID_COMMAND_TABLE_DELETE_ROW_COL=97,ID_COMMAND_TABLE_SPLIT_CELL=98,ID_COMMAND_TABLE_CELL_SAME_HEIGHT=99,ID_COMMAND_TABLE_CELL_SAME_WIDTH=100,ID_COMMAND_TABLE_CELL_ALIGN=101,ID_COMMAND_TABLE_MADANG=102,ID_COMMAND_TABLE_FORMULA=103,ID_COMMAND_TABLE_NUMBER_FORMAT=104,ID_COMMAND_TABLE_SELECT=105,ID_COMMAND_TABLE_CELL_HORIZONTALALIGN=106,ID_COMMAND_TABLE_CELL_VERTICALALIGN=107,ID_COMMAND_TABLE_BLOCK_FORMULA=108,ID_COMMAND_TABLE_EASY_FORMULA=
109,ID_COMMAND_TABLE_SELECT_FORMULA=110,ID_COMMAND_HELP_SHORTCUTS=111,ID_COMMAND_INSERT_OBJECT_MOVIE=112,ID_COMMAND_INSERT_OBJECT_FILE=113,ID_COMMAND_INSERT_OBJECT_HR=114,ID_COMMAND_TABLE_CELL_HORIZONTAL_LEFT=115,ID_COMMAND_TABLE_CELL_HORIZONTAL_CENTER=116,ID_COMMAND_TABLE_CELL_HORIZONTAL_RIGHT=117,ID_COMMAND_TABLE_CELL_VERTICAL_TOP=118,ID_COMMAND_TABLE_CELL_VERTICAL_MIDDLE=119,ID_COMMAND_TABLE_CELL_VERTICAL_BOTTOM=120,ID_COMMAND_STYLE_STYLE_BASIC=121,ID_COMMAND_STYLE_STYLE_SUBJECT1=122,ID_COMMAND_STYLE_STYLE_SUBJECT2=
123,ID_COMMAND_STYLE_STYLE_SUBJECT3=124,ID_COMMAND_STYLE_STYLE_SUBJECT4=125,ID_COMMAND_STYLE_STYLE_SUBJECT5=126,ID_COMMAND_STYLE_INCREASE_FONTSIZE=127,ID_COMMAND_STYLE_DECREASE_FONTSIZE=128,ID_COMMAND_TABLE_BLOCK_SUM=129,ID_COMMAND_TABLE_BLOCK_AVG=130,ID_COMMAND_TABLE_BLOCK_MUL=131,ID_COMMAND_TABLE_HORIZONTAL_SUM=132,ID_COMMAND_TABLE_VERTICAL_SUM=133,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE=134,ID_COMMAND_TABLE_VERTICAL_AVERAGE=135,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY=136,ID_COMMAND_TABLE_VERTICAL_MULTIPLY=
137,ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT=138,ID_COMMAND_TABLE_TABLE_REMOTE_NUMBER_FORMAT=139,ID_COMMAND_FORM_TAG_SWITCH=140,ID_COMMAND_FORM_TAG_CHECKBOX=141,ID_COMMAND_FORM_TAG_SELECT=142,ID_COMMAND_MAPPING_CODE=143,ID_COMMAND_MAPPING_CSS=144,ID_COMMAND_TEMPLETE_FORM=145,ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT=146,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT=147,ID_COMMAND_TABLE_DELETE_TABLE=148,ID_COMMAND_INSERT_PARAGRAPH=149,ID_COMMAND_TABLE_CONVERT_TEXT=150,ID_COMMAND_IMAGE_PROPERTY=151,ID_COMMAND_FILE_PROPERTY=
152,ID_COMMAND_EDIT_REPLACE_CASE=153,ID_COMMAND_TABLE_CELL_BACKCOLOR=154,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP=155,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP=156,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP=157,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE=158,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE=159,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE=160,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM=161,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM=162,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM=163,ID_COMMAND_DRAW_TABLE=164,ID_COMMAND_INSERT_EMOTICONS=
165,ID_COMMAND_EDIT_PRIINT_PAGE_BREAK=166,ID_COMMAND_VIEW_RULERBAR=167,ID_COMMAND_STYLE_CASCADE_ORDERLIST=168,ID_COMMAND_COPY_EXT=169,ID_COMMAND_COPY_EXT_STYLE=170,ID_COMMAND_SELECT_PARAGRAPH=171,ID_COMMAND_PASTE_EXT=172,ID_COMMAND_TABLE_DELETE_EXT=173,ID_COMMAND_TABLE_FORMULA_EXT=174,ID_COMMAND_IMAGE_BORDER_TYPE=175,ID_COMMAND_IMAGE_BORDER_THICKNESS=176,ID_COMMAND_IMAGE_BORDER_COLOR=177,ID_COMMAND_IMAGE_RESET_PICTURE=178,ID_COMMAND_IMAGE_BORDER_NONE=179,ID_COMMAND_IMAGE_BORDER_SOLID=180,ID_COMMAND_IMAGE_BORDER_DASHED=
181,ID_COMMAND_IMAGE_BORDER_DOTTED=182,ID_COMMAND_IMAGE_BORDER_DOUBLE=183,ID_COMMAND_IMAGE_BORDER_1PX=184,ID_COMMAND_IMAGE_BORDER_2PX=185,ID_COMMAND_IMAGE_BORDER_3PX=186,ID_COMMAND_IMAGE_BORDER_4PX=187,ID_COMMAND_IMAGE_BORDER_5PX=188,ID_COMMAND_IMAGE_BORDER_6PX=189,ID_COMMAND_IMAGE_BORDER_7PX=190,ID_COMMAND_IMAGE_BORDER_8PX=191,ID_COMMAND_IMAGE_BORDER_9PX=192,ID_COMMAND_IMAGE_BORDER_10PX=193,ID_COMMAND_TABLE_SELECT_CELL=194,ID_COMMAND_TABLE_SELECT_COL=195,ID_COMMAND_TABLE_SELECT_ROW=196,ID_COMMAND_TABLE_SELECT_TABLE=
197,ID_COMMAND_IMAGE_TO_TABLE=198,ID_COMMAND_TABLE_BORDER_THICKNESS=199,ID_COMMAND_TABLE_BORDER_TYPE=200,ID_COMMAND_TABLE_BORDER_COLOR=201,ID_COMMAND_TABLE_STYLE=202,ID_COMMAND_IMAGE_HEIGHT=203,ID_COMMAND_IMAGE_WIDTH=204,ID_COMMAND_HELP_IMAGE_TO_TABLE=205,ID_COMMAND_LOCK_EDIT_CELL=206,ID_COMMAND_EXTERNAL_DATA_AREA=207,ID_SUPPORT_TYPE_GENERAL=0,ID_SUPPORT_TYPE_MULTI_CELL=1,ID_SUPPORT_TYPE_TABLE_OPERATION=2,ID_SUPPORT_TYPE_PERSISTENCE=4,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT=0,ID_SUPPORT_CONTROL_TYPE_NO=
1,ID_SUPPORT_CONTROL_TYPE_YES=2,ID_TYPE_TOOLBAR_BUTTON=1,ID_TYPE_TOOLBAR_COMBOBOX=2,ID_TYPE_TOOLBAR_DROPDOWN=3,ID_TYPE_TOOLBAR_NOTHING=4,ID_TYPE_TOOLBAR_SPINNER=5,ID_TYPE_TOOLBAR_HANDLE=1111,ID_TYPE_TOOLBAR_SEPARATOR=1112,ID_TYPE_TOOLBAR_SPACE=1113,ID_TYPE_MENU_SEPARATOR=1114,ID_TYPE_TOOLBAR_CAPTION=1115,ID_DISPLAY_TABBAR_PREVIEW=0,ID_DISPLAY_TABBAR_EDIT=1,ID_DISPLAY_TABBAR_SOURCE=2,g_bMenuBar_Display=!0,g_bTabBar_Display=!0,g_bToolBar1_Display=!0,g_bToolBar2_Display=!0,g_bToolBar3_Display=!1,g_bRulerbar_Display=
!1,g_strBackColorCommand=g_browserCHK.ie?"BackColor":"hilitecolor",g_arrIcon=null,g_arrConst=[],g_arrConst_TabMode=[];
function setInitConst(){try{g_arrIcon=["toolbar_btn_style_bold.png","toolbar_btn_style_italic.png","toolbar_btn_style_underline.png","toolbar_btn_style_p_left.png","toolbar_btn_style_p_center.png","toolbar_btn_style_p_right.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_strike.png","toolbar_btn_style_subscript.png","toolbar_btn_style_superscript.png","toolbar_btn_style_p_outdent.png","toolbar_btn_style_p_indent.png","toolbar_btn_edit_undo.png","toolbar_btn_edit_redo.png",
"toolbar_btn_edit_cut.png","toolbar_btn_edit_copy.png","toolbar_btn_edit_paste.png","toolbar_btn_edit_delete.png","toolbar_btn_edit_select_all.png","","","toolbar_btn_style_forecolor.png","toolbar_btn_style_backcolor.png","toolbar_btn_table_create.png","toolbar_btn_table_add_row_up.png","toolbar_btn_table_delete_row.png","toolbar_btn_table_add_col_left.png","toolbar_btn_table_delete_col.png","toolbar_btn_table_merge_cell.png","toolbar_btn_table_split_row.gif","toolbar_btn_table_split_col.gif","toolbar_btn_insert_hyperlink.png",
"toolbar_btn_link_disconnect.gif","toolbar_btn_image.gif","toolbar_btn_flash.gif","toolbar_btn_media.gif","toolbar_btn_view_full_view.png","toolbar_btn_help.png","toolbar_btn_help_info.png","toolbar_btn_table_cell_property.png","toolbar_btn_table_property.png","toolbar_btn_mark.gif","toolbar_btn_table_templete_insert.gif","toolbar_btn_adjust_hwp_basic.gif","toolbar_btn_adjust_doc_basic.gif","toolbar_btn_horizontal_rule.gif",g_strBrowserLanguage+"/toolbar_btn_letter_space.gif",g_strBrowserLanguage+
"/toolbar_btn_line_height.gif","toolbar_btn_body_bg_color.gif","toolbar_btn_body_bg_image.gif","toolbar_btn_doc_templete.gif","","toolbar_btn_hide_minibar.gif","toolbar_btn_write_area_set.gif","toolbar_btn_show_editable_area.gif","","","","","toolbar_btn_file_save.png","toolbar_btn_file_print.png","toolbar_btn_code_inspect.gif","toolbar_btn_z_index.gif","toolbar_btn_text_box.gif","toolbar_btn_object_position.gif","toolbar_btn_table_add_row_down.png","toolbar_btn_table_add_col_right.png","toolbar_btn_table_copy_row_down.gif",
"toolbar_btn_style_p_justify.png","toolbar_btn_responsive_width.gif","toolbar_btn_doc_layout.gif","","toolbar_btn_responsive_set.gif","ico_form_layout.png","toolbar_btn_file_new.png","toolbar_btn_file_open.png","toolbar_btn_docform.png","toolbar_btn_file_layout.png","toolbar_btn_edit_paste_special.png","toolbar_btn_edit_find.png","toolbar_btn_edit_replace.png","","","toolbar_btn_insert_picture.png","","toolbar_btn_insert_specialchars.png","toolbar_btn_insert_bookmark.png","toolbar_btn_style_font.png",
"toolbar_btn_style_paragraph.png","toolbar_btn_style_style.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_increaseorder.png","toolbar_btn_style_decreaseorder.png","toolbar_btn_table_cell_style.png","toolbar_btn_table_add_cell.png","toolbar_btn_table_delete_cell.png","toolbar_btn_table_split_cell.png","toolbar_btn_table_same_height.png","toolbar_btn_table_same_width.png","toolbar_btn_table_cell_align_center_middle.png","toolbar_btn_table_madang.png","toolbar_btn_table_formula.png",
"toolbar_btn_table_number_format.png","ico_arrow_select.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_align.png","toolbar_btn_table_block_formula.png","toolbar_btn_table_easy_formula.png","toolbar_btn_table_select_formula.png","toolbar_btn_help_shortcut.png","toolbar_btn_insert_video.png","toolbar_btn_insert_file.png","toolbar_btn_insert_hr.png","toolbar_btn_table_cell_horizontal_left.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_horizontal_right.png",
"toolbar_btn_table_cell_vertical_top.png","toolbar_btn_table_cell_vertical_middle.png","toolbar_btn_table_cell_vertical_bottom.png","","","","","","","toolbar_btn_style_increase_font.png","toolbar_btn_style_decrease_font.png","toolbar_btn_table_block_sum.png","toolbar_btn_table_block_avg.png","toolbar_btn_table_block_mul.png","toolbar_btn_table_easy_h_sum.png","toolbar_btn_table_easy_v_sum.png","toolbar_btn_table_easy_h_avg.png","toolbar_btn_table_easy_v_avg.png","toolbar_btn_table_easy_h_mul.png",
"toolbar_btn_table_easy_v_mul.png","","","ico_tag_mode.png","ico_checkbox.png","ico_selectbox.png","ico_form_code.png","ico_form_css.png","toolbar_btn_form_template.png","toolbar_tbn_insert_paragraph_startpoint.png","toolbar_tbn_insert_paragraph_endpoint.png","toolbar_btn_table_delete.png","","toolbar_btn_table_convert_text.png","context_btn_prop_picture.png","context_btn_prop_file.png","toolbar_btn_replace_case.png","toolbar_btn_table_backcolor.png","toolbar_btn_table_cell_align_left_top.png","toolbar_btn_table_cell_align_center_top.png",
"toolbar_btn_table_cell_align_right_top.png","toolbar_btn_table_cell_align_left_middle.png","toolbar_btn_table_cell_align_center_middle.png","toolbar_btn_table_cell_align_right_middle.png","toolbar_btn_table_cell_align_left_bottom.png","toolbar_btn_table_cell_align_center_bottom.png","toolbar_btn_table_cell_align_right_bottom.png","toolbar_btn_draw_table.png","toolbar_btn_emoticon.png","toolbar_btn_edit_page_divide.png","toolbar_btn_view_ruler.png","toolbar_btn_style_cascade_orderlist.png","toolbar_btn_edit_copy.png",
"toolbar_btn_edit_copy_ext_style.png","ico_paragraph.png","toolbar_btn_edit_paste.png","toolbar_btn_edit_delete.png","toolbar_btn_table_formula.png","ico_sort_line.png","ico_thin_line.png","ico_line_color.png","ico_picture_back.png","","","","","","","","","","","","","","","","ico_cell_select.png","ico_v_select.png","ico_h_select.png","ico_table_select.png","ico_export_form.png","ico_thin_line.png","ico_sort_line.png","ico_line_color.png","ico_table_style.png","","","ico_export_form.png","ico_cell_lock.png",
"ico_outdata.png"],g_arrConst[0]=["Bold",ID_RES_CONST_STRING_BOLD,"TB_BOLD","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[1]=["Italic",ID_RES_CONST_STRING_ITALIC,"TB_ITALIC","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[2]=["Underline",ID_RES_CONST_STRING_UNDERLINE,"TB_UNDERLINE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[3]=["JustifyLeft",ID_RES_CONST_STRING_JUSTIFYLEFT,"TB_JUSTIFYLEFT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[4]=["JustifyCenter",ID_RES_CONST_STRING_JUSTIFYCENTER,"TB_JUSTIFYCENTER","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[5]=["JustifyRight",ID_RES_CONST_STRING_JUSTIFYRIGHT,"TB_JUSTIFYRIGHT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[6]=["InsertOrderedList",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_ORDERLIST","fnHandler_Tb_OrderedList",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[7]=["InsertUnorderedList",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_UNORDERLIST","fnHandler_Tb_UnorderedList",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[8]=["StrikeThrough",ID_RES_CONST_STRING_STRIKE,
"TB_STRIKE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[9]=["Subscript",ID_RES_CONST_STRING_SUBSCRIPT,"TB_SUBSCRIPT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[10]=["Superscript",ID_RES_CONST_STRING_SUPERSCRIPT,"TB_SUPERSCRIPT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[11]=["Outdent",
ID_RES_CONST_STRING_OUTDENT,"TB_OUTDENT","fnHandler_Outdent_Indent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[12]=["Indent",ID_RES_CONST_STRING_INDENT,"TB_INDENT","fnHandler_Outdent_Indent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[13]=["Undo",ID_RES_CONST_STRING_UNDO,"TB_UNDO","fnHandler_Undo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[14]=["Redo",ID_RES_CONST_STRING_REDO,
"TB_REDO","fnHandler_Redo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[15]=["Cut",ID_RES_CONST_STRING_CUT,"TB_CUT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[16]=["Copy",ID_RES_CONST_STRING_COPY,"TB_COPY","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[17]=["Paste",ID_RES_CONST_STRING_PASTE,
"TB_PASTE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[18]=["Delete",ID_RES_CONST_STRING_DELETE,"TB_DELETE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[19]=["SelectAll",ID_RES_CONST_STRING_SELECT_ALL,"TB_SELECT_ALL","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[20]=["FontName",ID_RES_CONST_STRING_FONT_NAME,
"TB_COMBOBOX_FONT_NAME","fnHandler_FontName",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[21]=["FontSize",ID_RES_CONST_STRING_FONT_SIZE,"TB_COMBOBOX_FONT_SIZE","fnHandler_FontSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[22]=["ForeColor",ID_RES_CONST_STRING_FORE_COLOR,"TB_SETFORECOLOR","fnHandler_ForeColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[23]=
[g_strBackColorCommand,ID_RES_CONST_STRING_BACK_COLOR,"TB_SETBACKCOLOR","fnHandler_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[24]=["",ID_RES_CONST_STRING_TABLE_CREATE,"TB_TABLE_CREATE","fnHandler_TableCreate",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[25]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW,"TB_TABLE_ADD_ROW","fnHandler_TableAddRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[26]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW,"TB_TABLE_DELETE_ROW","fnHandler_TableDeleteRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[27]=["",ID_RES_CONST_STRING_TABLE_ADD_COL,"TB_TABLE_ADD_COL","fnHandler_TableAddCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[28]=["",ID_RES_CONST_STRING_TABLE_DELETE_COL,"TB_TABLE_DELETE_COL","fnHandler_TableDeleteCol",ID_SUPPORT_TYPE_TABLE_OPERATION,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[29]=["",ID_RES_CONST_STRING_TABLE_MERGE_CELL,"TB_TABLE_MERGE_CELL","fnHandler_TableMergeCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[30]=["",ID_RES_CONST_STRING_TABLE_SPLIT_ROW,"TB_TABLE_SPLIT_ROW","fnHandler_TableSplitRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[31]=["",ID_RES_CONST_STRING_TABLE_SPLIT_COL,"TB_TABLE_SPLIT_COL","fnHandler_TableSplitCol",
ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[32]=["CreateLink",ID_RES_CONST_STRING_HYPERLINK_INSERT,"TB_HYPERLINK_INSERT","fnHandler_HyperLinkInsert",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[33]=["Unlink",ID_RES_CONST_STRING_HYPERLINK_REMOVE,"TB_HYPERLINK_REMOVE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[34]=["InsertImage",ID_RES_CONST_STRING_IMAGE_INSERT,
"TB_IMAGE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[35]=["InsertImage",ID_RES_CONST_STRING_FLASH_INSERT,"TB_FLASH_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[36]=["InsertImage",ID_RES_CONST_STRING_MEDIA_INSERT,"TB_MEDIA_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[37]=["",ID_RES_CONST_STRING_FULLSCREEN,
"TB_FULLSCREEN","fnHandler_FullScreen",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[38]=["",ID_RES_CONST_STRING_HELP,"","fnHandler_Help",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[39]=["",ID_RES_CONST_STRING_PRODUCT_INFO,"","fnHandler_ProductInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[40]=["",ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,
"TB_TABLE_CELL_PROPERTY","fnHandler_TableCellProperty",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[41]=["",ID_RES_CONST_STRING_TABLE_PROPERTY,"TB_TABLE_PROPERTY","fnHandler_TableProperty",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[42]=["",ID_RES_CONST_STRING_MARK_INSERT,"TB_MARK_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[43]=["",
ID_RES_CONST_STRING_TABLE_TEMPLETE_INSERT,"TB_TABLE_TEMPLETE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[44]=["",ID_RES_CONST_STRING_ADJUST_HWP_BASIC,"TB_ADJUST_HWP_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[45]=["",ID_RES_CONST_STRING_ADJUST_DOC_BASIC,"TB_ADJUST_DOC_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[46]=["InsertHorizontalRule",ID_RES_CONST_STRING_HORIZONTAL_RULE,"TB_HORIZONTAL_RULE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[47]=["",ID_RES_CONST_STRING_LETTER_SPACING,"TB_LETTER_SPACING","fnHandler_LetterSpacing",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[48]=["",ID_RES_CONST_STRING_LINE_HEIGHT,"TB_LINE_HEIGHT","fnHandler_LineHeight",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[49]=["",ID_RES_CONST_STRING_BODY_BG_COLOR,"TB_BODY_BG_COLOR","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[50]=["",ID_RES_CONST_STRING_BODY_BG_IMAGE,"TB_BODY_BG_IMAGE","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[51]=["",ID_RES_CONST_STRING_DOC_TEMPLETE,"TB_DOC_TEMPLETE","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[52]=["",ID_RES_CONST_STRING_PREVIEW,"TB_PREVIEW","fnHandler_Preview",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[53]=["",ID_RES_CONST_STRING_HIDE_MINIBAR,"TB_HIDE_MINIBAR","fnHandler_HideMiniBar",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[54]=["",ID_RES_CONST_STRING_WRITE_AREA_SET,"TB_WRITE_AREA_SET","fnHandler_WriteAreaSet",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[55]=["",ID_RES_CONST_STRING_SHOW_EDITABLE_AREA,"TB_SHOW_EDITABLE_AREA","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[56]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[57]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[58]=["","",
"","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[59]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[60]=["",ID_RES_CONST_STRING_SAVEAS,"TB_SAVEAS","fnHandler_SaveAs",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[61]=["",ID_RES_CONST_STRING_PRINT,"TB_PRINT","fnHandler_Print",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[62]=["","","TB_CODE_INSPECT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[63]=["",ID_RES_CONST_STRING_Z_INDEX_SETTING,"TB_ZINDEXSETTING","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[64]=["",ID_RES_CONST_STRING_TEXT_BOX,"TB_TEXT_BOX","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[65]=["",ID_RES_CONST_STRING_OBJECT_POSITION,
"TB_OBJECT_POSITION","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[66]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_DOWN,"TB_TABLE_ADD_ROW_DOWN","fnHandler_TableAddRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[67]=["",ID_RES_CONST_STRING_TABLE_ADD_COL_RIGHT,"TB_TABLE_ADD_COL_RIGHT","fnHandler_TableAddCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[68]=
["",ID_RES_CONST_STRING_TABLE_COPY_ROW_DOWN,"TB_TABLE_COPY_ROW_DOWN","fnHandler_TableCopyRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[69]=["JustifyLeft",ID_RES_CONST_STRING_JUSTIFYJUSTIFY,"TB_JUSTIFYJUSTIFY","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[70]=["",ID_RES_CONST_STRING_RESPONSIVE_WIDTH,"TB_RESPONSIVE_WIDTH","fnHandler_ResponsiveWidth",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[71]=["",ID_RES_CONST_STRING_DOC_LAYOUT,"TB_DOC_LAYOUT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[72]=["formatBlock",ID_RES_CONST_STRING_HEADING_SIZE,"TB_COMBOBOX_HEADING_SIZE","fnHandler_HeadingSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[73]=["",ID_RES_CONST_STRING_RESPONSIVE_SET,"TB_RESPONSIVE_SET","fnHandler_ResponsiveSet",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[74]=["",ID_RES_CONST_STRING_FORM_TABLE,"TB_FORM_TABLE","fnHandler_FormTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[75]=["",ID_RES_CONST_STRING_FILE_NEW,"TB_FILE_NEW","fnHandler_NewFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[76]=["",ID_RES_CONST_STRING_FILE_OPEN,"TB_FILE_OPEN","fnHandler_OpenFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[77]=["",ID_RES_CONST_STRING_FILE_DOCFORM,"TB_FILE_DOCFORM","fnHandler_DocForm",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[78]=["",ID_RES_CONST_STRING_FILE_LAYOUT,"TB_FILE_LAYOUT","fnHandler_Layout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[79]=["",ID_RES_CONST_STRING_EDIT_PASTESPECIAL,"TB_EDIT_PASTESPECIAL","fnHandler_Pastespecial",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[80]=["",ID_RES_CONST_STRING_EDIT_SEARCH,"TB_EDIT_SEARCH","fnHandler_FindReplaceText",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[81]=["",ID_RES_CONST_STRING_EDIT_REPLACE,"TB_EDIT_REPLACE","fnHandler_FindReplaceText",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[82]=["",ID_RES_CONST_STRING_VIEW_EDIT,"TB_VIEW_EDIT","fnHandler_viewEdit",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[83]=["",ID_RES_CONST_STRING_VIEW_HTML,"TB_VIEW_HTML","fnHandler_viewHtml",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[84]=["InsertImage",ID_RES_CONST_STRING_INSERT_IMAGE,"TB_INSERT_IMAGE","fnHandler_InsertImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[85]=["",ID_RES_CONST_STRING_INSERT_OBJECT,"TB_INSERT_OBJECT","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[86]=["",ID_RES_CONST_STRING_INSERT_SPECIALCHARS,"TB_INSERT_SPECIALCHARS","fnHandler_SpecialChars",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[87]=["",ID_RES_CONST_STRING_INSERT_BOOKMARK,"TB_INSERT_BOOKMARK","fnHandler_InsertBookmark",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[88]=["",ID_RES_CONST_STRING_STYLE_FONT,"TB_STYLE_FONT","fnHandler_StyleFont",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[89]=["",ID_RES_CONST_STRING_STYLE_PARAGRAPH,"TB_STYLE_PARAGRAPH","fnHandler_StyleParagraph",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[90]=["",ID_RES_CONST_STRING_STYLE_STYLE,"TB_STYLE_STYLE","dummyFunc",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[91]=["",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_STYLE_UNORDEREDLIST","fnHandler_StyleUnorderedList",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[92]=["",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_STYLE_ORDEREDLIST","fnHandler_StyleOrderedList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[93]=["",ID_RES_CONST_STRING_STYLE_INCREASEORDER,"TB_STYLE_INCREASEORDER","fnHandler_IncreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[94]=["",ID_RES_CONST_STRING_STYLE_DECREASEORDER,
"TB_STYLE_DECREASEORDER","fnHandler_DecreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[95]=["",ID_RES_CONST_STRING_TABLE_CELL_STYLE,"TB_TABLE_CELL_STYLE","fnHandler_TableCellStyle",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[96]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,"TB_TABLE_ADD_ROW_COL","fnHandler_TableAddRowCol",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[97]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW_COL,"TB_TABLE_DELETE_ROW_COL","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[98]=["",ID_RES_CONST_STRING_TABLE_SPLIT_CELL,"TB_TABLE_SPLIT_CELL","fnHandler_TableSplitCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[99]=["",ID_RES_CONST_STRING_TABLE_CELL_SAME_HEIGHT,"TB_TABLE_CELL_SAME_HEIGHT","fnHandler_TableCellSameHeight",
ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[100]=["",ID_RES_CONST_STRING_TABLE_CELL_SAME_WIDTH,"TB_TABLE_CELL_SAME_WIDTH","fnHandler_TableCellSameWidth",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[101]=["",ID_RES_CONST_STRING_TABLE_CELL_ALIGN,"TB_TABLE_CELL_ALIGN","fnHandler_TableCellAlign",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[102]=["",ID_RES_CONST_STRING_TABLE_MADANG,
"TB_TABLE_MADANG","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[103]=["",ID_RES_CONST_STRING_TABLE_FORMULA,"TB_TABLE_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[104]=["",ID_RES_CONST_STRING_TABLE_NUMBER_FORMAT,"TB_TABLE_NUMBER_FORMAT","fnHandler_TableNumberFormat",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[105]=["",ID_RES_CONST_STRING_TABLE_SELECT,
"TB_TABLE_SELECT","fnHandler_TableSelect",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[106]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTALALIGN,"TB_TABLE_CELL_HORIZONTALALIGN","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[107]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICALALIGN,"TB_TABLE_CELL_VERTICALALIGN","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],
g_arrConst[108]=["",ID_RES_CONST_STRING_TABLE_BLOCK_FORMULA,"TB_TABLE_BLOCK_FORMULA","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[109]=["",ID_RES_CONST_STRING_TABLE_EASY_FORMULA,"TB_TABLE_EASY_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[110]=["",ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,"TB_TABLE_SELECT_FORMULA","fnHandler_TableSelectFormula",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[111]=["",ID_RES_CONST_STRING_HELP_SHORTCUTS,"","fnHandler_ShortCutsInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[112]=["",ID_RES_CONST_STRING_INSERT_OBJECT_MOVIE,"TB_INSERT_OBJECT_MOVIE","fnHandler_InsertExtMovie",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[113]=["",ID_RES_CONST_STRING_INSERT_OBJECT_FILE,"TB_INSERT_OBJECT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[114]=["",ID_RES_CONST_STRING_INSERT_OBJECT_HR,"TB_INSERT_OBJECT_HR","fnHandler_InsertHr",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[115]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_LEFT,"TB_TABLE_CELL_HORIZONTAL_LEFT","fnHandler_TableCellHorizontalLeft",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[116]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_CENTER,
"TB_TABLE_CELL_HORIZONTAL_CENTER","fnHandler_TableCellHorizontalCenter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[117]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_RIGHT,"TB_TABLE_CELL_HORIZONTAL_RIGHT","fnHandler_TableCellHorizontalRight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[118]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_TOP,"","fnHandler_TableCellVerticalTop",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[119]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_MIDDLE,"","fnHandler_TableCellVerticalMiddle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[120]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_BOTTOM,"","fnHandler_TableCellVerticalBottom",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[121]=["",ID_RES_CONST_STRING_STYLE_STYLE_BASIC,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[122]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[123]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[124]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3,"","fnHandler_StyleHeadingSize",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[125]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[126]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[127]=["",ID_RES_CONST_STRING_STYLE_INCREASE_FONTSIZE,
"TB_STYLE_INCREASE_FONTSIZE","fnHandler_StyleIncreaseFontSize",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[128]=["",ID_RES_CONST_STRING_STYLE_DECREASE_FONTSIZE,"TB_STYLE_DECREASE_FONTSIZE","fnHandler_StyleDecreaseFontSize",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[129]=["",ID_RES_CONST_STRING_TABLE_BLOCK_SUM,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[130]=
["",ID_RES_CONST_STRING_TABLE_BLOCK_AVG,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[131]=["",ID_RES_CONST_STRING_TABLE_BLOCK_MUL,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[132]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_SUM,"","fnHandler_TableHorizontalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[133]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_SUM,
"","fnHandler_TableVerticalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[134]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_AVERAGE,"","fnHandler_TableHorizontalAverage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[135]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_AVERAGE,"","fnHandler_TableVerticalAverage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[136]=
["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_MULTIPLY,"","fnHandler_TableHorizontalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[137]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_MULTIPLY,"","fnHandler_TableVerticalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[138]=["",ID_RES_CONST_STRING_TABLE_ADD_NUMBER_FORMAT,"","fnHandler_TableAddNumberFormat",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[139]=["",ID_RES_CONST_STRING_TABLE_REMOVE_NUMBER_FORMAT,"","fnHandler_TableRemoveNumberFormat",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[140]=["",ID_RES_CONST_STRING_FORM_TAG_SWITCH,"TB_FORM_TAG_SWITCH","fnHandler_FormTagSwitch",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[141]=["",ID_RES_CONST_STRING_FORM_TAG_CHECKBOX,"TB_FORM_TAG_CHECKBOX","fnHandler_CheckBox",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[142]=["",ID_RES_CONST_STRING_FORM_TAG_SELECT,"TB_FORM_TAG_SELECT","fnHandler_SelectBox",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[143]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[144]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[145]=["","","","",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[146]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_STARTPOINT,"TB_INSERT_PARAGRAPH_STARTPOINT","fnHandler_InsertParagraphStartPoint",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[147]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_ENDPOINT,"TB_INSERT_PARAGRAPH_ENDPOINT","fnHandler_InsertParagraphEndPoint",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[148]=["",ID_RES_CONST_STRING_TABLE_DELETE_TABLE,
"TB_TABLE_DELETE_TABLE","fnHandler_TableDelete",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[149]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,"TB_INSERT_PARAGRAPH","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[150]=["",ID_RES_CONST_STRING_TABLE_CONVERT_TEXT,"TB_TABLE_CONVERT_TEXT","fnHandler_TableConvertText",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[151]=
["",ID_RES_PROP_INSERT_IMAGE,"TB_PROP_INSERT_IMAGE","fnHandler_InsertImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[152]=["",ID_RES_PROP_INSERT_FILE,"TB_PROP_INSERT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[153]=["",ID_RES_CONST_STRING_REPLACE_CASE,"TB_EDIT_REPLACE_CASE","fnHandler_ReplaceCase",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[154]=["",ID_RED_CONST_STRING_TABLE_CELL_BACKCOLOR,"TB_SETCELLBACKCOLOR","fnHandler_Table_Cell_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[155]=["",ID_RED_CONST_STRING_ALIGN_LEFT_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[156]=["",ID_RED_CONST_STRING_ALIGN_CENTER_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[157]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[158]=["",ID_RED_CONST_STRING_ALIGN_LEFT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[159]=["",ID_RED_CONST_STRING_ALIGN_CENTER_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[160]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[161]=["",ID_RED_CONST_STRING_ALIGN_LEFT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[162]=["",ID_RED_CONST_STRING_ALIGN_CENTER_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[163]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[164]=["",ID_RES_CONST_STRING_DRAW_TABLE,"TB_DRAW_TABLE","fnHandler_drawTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[165]=["",ID_RES_CONST_STRING_INSERT_EMOTICONS,"TB_INSERT_EMOTICONS","fnHandler_InsertEmoticons",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[166]=["",ID_RES_CONST_STRING_PRINT_PAGE_BREAK,"TB_EDIT_PRINT_PAGE_BREAK","fnHandler_InsertPrintPageBreak",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[167]=["",ID_RES_CONST_STRING_VIEW_RULERBAR,"TB_VIEW_RULERBAR","fnHandler_viewRulerbar",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[168]=["",ID_RES_DIALOG_STRING_CASCADE_ORDERLIST,"TB_STYLE_CASCADE_ORDERLIST","fnHandler_cascadeOrderList",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[169]=["Copy",ID_RES_CONST_STRING_COPY,"TB_COPY_EXT","fnHandler_CopyExt",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[170]=["Copy",ID_RES_CONST_STRING_COPY_EXT_STYLE,"TB_COPY_EXT_STYLE","fnHandler_CopyExtStyle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[171]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,"TB_INSERT_SELECT_PARAGRAPH",
"fnHandler_SelectParagraphDropDown",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[172]=["Paste",ID_RES_CONST_STRING_PASTE,"TB_PASTE_EXT","fnHandler_PasteExt",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[173]=["",ID_RES_CONST_BTN_DELETE,"TB_TABLE_DELETE_EXT","fnHandler_TalbeDeleteExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[174]=["",ID_RES_CONST_STRING_TABLE_FORMULA,
"TB_TABLE_FORMULA_EXT","fnHandler_TableFomulaExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[175]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_IMAGE_BORDER_TYPE","fnHandler_ImageBorderType",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[176]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_IMAGE_BORDER_THICKNESS","fnHandler_ImageBorderThickness",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[177]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETIMAGEBORDERCOLOR","fnHandler_ImageBorderColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[178]=["",ID_RES_CONST_STRING_RESET_PICTURE,"TB_IMAGE_RESET_PICTURE","fnHandler_ImageResetPicture",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[179]=["",ID_RES_CONST_STRING_NO_LINE,"","fnHandler_ObjectBorderNoLine",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[180]=["",ID_RES_CONST_STRING_SOLID_LINE,"","fnHandler_ObjectBorderSolidLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[181]=["",ID_RES_CONST_STRING_DASHED_LINE,"","fnHandler_ObjectBorderDashedLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[182]=["",ID_RES_CONST_STRING_DOTTED_LINE,"","fnHandler_ObjectBorderDottedLine",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[183]=["",ID_RES_CONST_STRING_DOUBLE_LINE,"","fnHandler_ObjectBorderDoubleLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[184]=["","1px","","fnHandler_ObjectBorder1pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[185]=["","2px","","fnHandler_ObjectBorder2pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[186]=["","3px","","fnHandler_ObjectBorder3pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[187]=["","4px","","fnHandler_ObjectBorder4pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[188]=["","5px","","fnHandler_ObjectBorder5pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[189]=["","6px","","fnHandler_ObjectBorder6pxLine",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[190]=["","7px","","fnHandler_ObjectBorder7pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[191]=["","8px","","fnHandler_ObjectBorder8pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[192]=["","9px","","fnHandler_ObjectBorder9pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[193]=
["","10px","","fnHandler_ObjectBorder10pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[194]=["",ID_RES_CONST_STRING_TABLE_SELECT_CELL,"TB_TABLE_SELECT_CELL","fnHandler_TableSelectCell",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[195]=["",ID_RES_CONST_STRING_TABLE_SELECT_COL,"TB_TABLE_SELECT_COL","fnHandler_TableSelectCol",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[196]=["",ID_RES_CONST_STRING_TABLE_SELECT_ROW,"TB_TABLE_SELECT_ROW","fnHandler_TableSelectRow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[197]=["",ID_RES_CONST_STRING_TABLE_SELECT_TABLE,"TB_TABLE_SELECT_TABLE","fnHandler_TableSelectTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[198]=["",ID_RES_CONST_STRING_IMAGE_TO_TABLE,"TB_IMAGE_TO_TABLE","fnHandler_imageToTable",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[199]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_TABLE_BORDER_THICKNESS","fnHandler_TableBorderThickness",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[200]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_TABLE_BORDER_TYPE","fnHandler_TableBorderType",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[201]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETTABLEBORDERCOLOR",
"fnHandler_TableBorderColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[202]=["",ID_RES_CONST_STRING_STYLE_STYLE,"TB_TABLE_STYLE","fnHandler_TableStyle",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[203]=["",ID_RES_DIALOG_STRING_HEIGHT,"TB_IMAGE_HEIGHT","fnHandler_TBSetImageHeight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"],g_arrConst[204]=["",ID_RES_DIALOG_STRING_WIDTH,
"TB_IMAGE_WIDTH","fnHandler_TBSetImageWidth",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"],g_arrConst[205]=["",ID_RES_CONST_STRING_HELP_IMAGE_TO_TABLE,"","fnHandler_Help_ImageToTable",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[206]=["",ID_RES_CONST_STRING_TABLE_LOCK_EDIT_CELL,"TB_TABLE_CELL_STYLE","fnHandler_table_lock_edit_cell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[207]=["",ID_RES_CONST_EXTERNAL_DATA_AREA,"TB_EXTERNAL_DATA_AREA","fnHandler_insertExternalDataBox",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst_TabMode[0]=[ID_TB_TABMODE_PREVIEW,"fnTool_TabMode_Preview"],g_arrConst_TabMode[1]=[ID_TB_TABMODE_EDIT,"fnTool_TabMode"],g_arrConst_TabMode[2]=[ID_TB_TABMODE_SOURCE,"fnTool_TabMode"]}catch(a){}}var ID_COMMAND_MENU_TABLE_INDEX=5;
function setInitUpdateVariable(a){try{g_TBButton[a]=[],g_TBComboBox[a]=[],g_TBComboBoxLabel[a]=[],g_TBDropDown[a]=[],g_objMenuWin.arrTBMenu[a]=[],g_TBTabMode[a]=[],g_bEditMode[a]=!0,g_objEditMode.arrWriteAreaSet[a]=!1,g_objEditMode.arrShowEditableAreaOrder[a]=null}catch(b){}};

var g_arrEditorAreaContainer=[],g_arrEditorWidth=[],g_arrEditorHeight=[],g_objEditAreaContainer=[],g_objMainEditAreaContainer=[],g_nToolbarSetHeight=0,g_nTabBarSetHeight=0,g_nBottomResizeHeight=0,g_nEditAreaSetHeight=0,g_objEditContainer=[],g_objEditSourceContainer=[],g_objEditObjectSource=[],g_bMarkWinAssigned=!1;
function initEditAreaContainer(b,a){b.innerHTML='<div id="INIT_LOAD_AREA_'+a+'" class="editor_set_container"></div><div id="INIT_INFO_AREA_'+a+'"></div>';b=document.getElementById("INIT_LOAD_AREA_"+a);g_objEditAreaContainer[a]=b;var f=buildEditAreaContainer(a);b.innerHTML=f;g_objMainEditAreaContainer[a]=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a);g_objEditContainer[a]=document.getElementById(g_strEditContainerName+"_"+a);g_objEditSourceContainer[a]=document.getElementById(g_strEditSourceContainerName+
"_"+a);g_objEditObjectSource[a]=document.getElementById(g_strEditObjectSourceName+"_"+a)}
function buildEditAreaContainer(b){var a="",f=!0;if(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)f=!1;g_nToolbarSetHeight=113;g_bMenuBar_Display||(g_nToolbarSetHeight-=24);g_bToolBar1_Display||(g_nToolbarSetHeight-=30);g_bToolBar2_Display||(g_nToolbarSetHeight-=30);g_bToolBar3_Display||(g_nToolbarSetHeight-=30);0>=g_nToolbarSetHeight&&(g_nToolbarSetHeight=1);g_nTabBarSetHeight=30;g_bTabBar_Display||(g_nTabBarSetHeight=0);g_nBottomResizeHeight=12;g_bBottomResizeYN||
(g_nBottomResizeHeight=0);if(g_bEditorHeightIFrameYN){var e=g_objPositionUtil.getDocumentClientSize(self).nClientHeight;if(g_bBrowserType_WK&&0==e){var c=g_objPositionUtil.getDocumentElementObject(!1);c&&(e=c.scrollHeight)}g_bBrowserType_WK||g_bBrowserType_FF?e+=1:window.attachEvent&&--e;g_arrEditorHeight[b]=e}g_nEditAreaSetHeight=g_arrEditorHeight[b]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight;window.attachEvent&&(g_nEditAreaSetHeight+=3);a=g_bEditorWidthPercentageYN?a+('<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+
b+'" height="'+g_arrEditorHeight[b]+'">'):a+('<table style="width:'+g_arrEditorWidth[b]+'px;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+b+'" height="'+g_arrEditorHeight[b]+'">');a=(f?a+'<tr valign="top" style="display:none">':a+'<tr valign="top">')+('<td height="'+g_nToolbarSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+g_nToolbarSetHeight+'px;">');a=f?a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+
b+'">'):a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+b+'" class="duzon_controller_container">');g_bMenuBar_Display&&(a=a+"<tr>"+('<td id="TB_CONTAINER_MENU_'+b+'" class="duzon_menubar_line">')+'<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0">',a+='<tr valign="center">',calculateStringLength(ID_RES_TOOL_STRING_MENU_FILE),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_FILE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_FILE+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_EDIT),
a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_EDIT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_EDIT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_VIEW),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_VIEW_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_VIEW+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_INSERT),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_INSERT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_INSERT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_BASIC),
a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_BASIC_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_BASIC+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_TABLE),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_TABLE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_TABLE+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_HELP),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_HELP_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_HELP+"</td>",a+='<td><img src="'+dzeEnvConfig.strPath_Image+
g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>',a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");if(g_bToolBar1_Display){e="";g_bMenuBar_Display||(e='style="border-width:0;"');a+="<tr>";a+='<td id="TB_CONTAINER_TOOL_1_'+b+'" class="'+g_strSkin_ToolBarLine+'" '+e+">";a+='<table cellSpacing="0" border="0" cellPadding="0" height="28" width="100%">';a+='<tr valign="center" height="28">';for(e=0;e<g_arrToolbar1.length;e++){c=g_arrToolbar1[e][0];var d=
g_arrToolbar1[e][1];ID_TYPE_TOOLBAR_HANDLE==c?a+=buildEditAreaContainer_Handle(1,7,1):ID_TYPE_TOOLBAR_SEPARATOR==c?a+=buildEditAreaContainer_Separator(1):ID_TYPE_TOOLBAR_SPACE==c?a+=buildEditAreaContainer_Space(d):ID_TYPE_TOOLBAR_CAPTION==c?a+=buildEditAreaContainer_Caption(d):ID_TYPE_TOOLBAR_BUTTON==g_arrConst[c][6]?a+=buildEditAreaContainer_Button(c,b):ID_TYPE_TOOLBAR_COMBOBOX==g_arrConst[c][6]?ID_COMMAND_FONT_NAME==c?a+=buildEditAreaContainer_ComboBox(c,102,2,d,b):ID_COMMAND_FONT_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,
72,1,d,b):ID_COMMAND_HEADING_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,72,1,d,b):ID_COMMAND_LETTER_SPACING==c?a+=buildEditAreaContainer_ComboBox(c,52,1,d,b):ID_COMMAND_LINE_HEIGHT==c&&(a+=buildEditAreaContainer_ComboBox(c,52,1,d,b)):ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[c][6]&&(a+=buildEditAreaContainer_DropDown(c,b))}a+="<td></td>";a+="<td>";a=a+('\t<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_1_HIDDEN_'+b+'" toolbarNo="1">')+('\t\t<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_1_HIDDEN_TBL_'+
b+'"><tr>')+buildEditAreaContainer_Space(8);a+=buildEditAreaContainer_Space(8);a+="\t\t</tr></table>";a+="\t</div>";a+="</td>";a+='\t\t<td align="right" style="vertical-align:middle">';a=a+('\t\t\t<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_1_HIDDEN_'+b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(1,'+b+')"></div>')+"\t\t</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>"}if(g_bToolBar2_Display){e="";g_bMenuBar_Display||g_bToolBar1_Display||(e=
'style="border-width:0;"');a+='<tr style="height:24px;">';a+='<td id="TB_CONTAINER_TOOL_2_'+b+'" class="'+g_strSkin_ToolBarLine+'" '+e+">";a+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0">';a+='<tr height="24" valign="center">';for(e=0;e<g_arrToolbar2.length;e++)c=g_arrToolbar2[e][0],d=parseInt(g_arrToolbar2[e][1]),ID_TYPE_TOOLBAR_HANDLE==c?a+=buildEditAreaContainer_Handle(1,7,1):ID_TYPE_TOOLBAR_SEPARATOR==c?a+=buildEditAreaContainer_Separator(1):ID_TYPE_TOOLBAR_SPACE==
c?a+=buildEditAreaContainer_Space(d):ID_TYPE_TOOLBAR_CAPTION==c?a+=buildEditAreaContainer_Caption(d):ID_TYPE_TOOLBAR_BUTTON==g_arrConst[c][6]?a+=buildEditAreaContainer_Button(c,b):ID_TYPE_TOOLBAR_COMBOBOX==g_arrConst[c][6]?ID_COMMAND_FONT_NAME==c?a+=buildEditAreaContainer_ComboBox(c,102,2,d,b):ID_COMMAND_FONT_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,72,1,d,b):ID_COMMAND_HEADING_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,72,1,d,b):ID_COMMAND_LETTER_SPACING==c?a+=buildEditAreaContainer_ComboBox(c,
52,1,d,b):ID_COMMAND_LINE_HEIGHT==c&&(a+=buildEditAreaContainer_ComboBox(c,52,1,d,b)):ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[c][6]&&(a+=buildEditAreaContainer_DropDown(c,b));a+="<td></td>";a+="<td>";a=a+('\t<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_2_HIDDEN_'+b+'" toolbarNo="2">')+('\t\t<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_2_HIDDEN_TBL_'+b+'"><tr>')+buildEditAreaContainer_Space(8);a+=buildEditAreaContainer_Space(8);a+="\t\t</tr></table>";
a+="\t</div>";a+="</td>";a+='\t\t<td align="right" style="vertical-align:middle">';a=a+('\t\t\t<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_2_HIDDEN_'+b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(2,'+b+')"></div>')+"\t\t</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>"}if(g_bToolBar3_Display){e="";g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||(e='style="border-width:0;"');a+='<tr style="height:24px;">';a+='<td id="TB_CONTAINER_TOOL_3_'+
b+'" class="'+g_strSkin_ToolBarLine+'" '+e+">";a+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0">';a+='<tr height="24" valign="center">';for(e=0;e<g_arrToolbar3.length;e++)c=g_arrToolbar3[e][0],d=g_arrToolbar3[e][1],ID_TYPE_TOOLBAR_HANDLE==c?a+=buildEditAreaContainer_Handle(1,7,1):ID_TYPE_TOOLBAR_SEPARATOR==c?a+=buildEditAreaContainer_Separator(1):ID_TYPE_TOOLBAR_SPACE==c?a+=buildEditAreaContainer_Space(d):ID_TYPE_TOOLBAR_CAPTION==c?a+=buildEditAreaContainer_Caption(d):
ID_TYPE_TOOLBAR_BUTTON==g_arrConst[c][6]?a+=buildEditAreaContainer_Button(c,b):ID_TYPE_TOOLBAR_COMBOBOX==g_arrConst[c][6]?ID_COMMAND_FONT_NAME==c?a+=buildEditAreaContainer_ComboBox(c,102,2,d,b):ID_COMMAND_FONT_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,72,1,d,b):ID_COMMAND_HEADING_SIZE==c?a+=buildEditAreaContainer_ComboBox(c,72,1,d,b):ID_COMMAND_LETTER_SPACING==c?a+=buildEditAreaContainer_ComboBox(c,52,1,d,b):ID_COMMAND_LINE_HEIGHT==c&&(a+=buildEditAreaContainer_ComboBox(c,52,1,d,b)):ID_TYPE_TOOLBAR_DROPDOWN==
g_arrConst[c][6]&&(a+=buildEditAreaContainer_DropDown(c,b));a+="<td></td>";a+="<td>";a=a+('\t<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_3_HIDDEN_'+b+'" toolbarNo="3">')+('\t\t<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_3_HIDDEN_TBL_'+b+'"><tr>')+buildEditAreaContainer_Space(8);a+=buildEditAreaContainer_Space(8);a+="\t\t</tr></table>";a+="\t</div>";a+="</td>";a+='\t\t<td align="right" style="vertical-align:middle">';a=a+('\t\t\t<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_3_HIDDEN_'+
b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(3,'+b+')"></div>')+"\t\t</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>"}a+="</table>";a+="</td>";a+="</tr>";a+='<tr valign="top">';a+='<td id="MAIN_EDIT_AREA_CONTAINER_'+b+'" height="'+g_nEditAreaSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+g_nEditAreaSetHeight+'px;background-color:#FFFFFF;">';a+='<table id="'+g_strEditContainerName+"_"+b+'" style="width:100%;border:0px;" class="editorContainer" cellSpacing="0" cellPadding="0">';
a+="<tr>";f?g_bBrowserType_IE&&""!=g_strDomainPageName?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',
a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>'):g_bBrowserType_IE&&""!=g_strDomainPageName?g_bEditorHeightReSettingYN?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-
2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):g_bEditorHeightReSettingYN?
(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',
a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>');a+="</td>";a+="</tr>";a+="</table>";a+='<table id="'+g_strEditSourceContainerName+"_"+b+'" style="width:100%;border:0px;display:none;" class="editorContainer" cellSpacing="0" cellPadding="0">';a+="<tr>";f?(g_bBrowserType_WK||(a+='<td class="editor_source_frame_padding_nothing" style="line-height:normal;padding:0px;"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+
'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'),a+='<td class="editor_source_frame_main_nothing" style="line-height:normal;padding:0px;"><label for="'+g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>'):a+='<td class="editor_source_frame_main" id="dze_editor_source_frame_main_'+b+'" style="line-height:normal;padding:0px;"><label for="'+
g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";if(g_bTabBar_Display)a=a+('<tr valign="top" id="TB_TABMODE_TR_CONTAINER_'+b+'">')+'<td style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;">',a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="TB_TABMODE_CONTAINER_'+
b+'" class="tbToolbarSetTabMode">')+"<tr>",a=a+('<td id="TB_CONTAINER_TABMODE_'+b+'" style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;text-align:right;vertical-align:top;">')+'<table align="left" width="100%" cellSpacing="0" cellPadding="0">',a+="<tr>",g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&(a+='<td style="width:90px;height:24px;">',a+='\t<div id="TB_TABMODE_EDIT_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_EDIT+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_EDIT+"</div>",a+="</td>"),
g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&(a+='<td style="width:90px;height:24px;">',a+='\t<div id="TB_TABMODE_SOURCE_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_SOURCE+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_SOURCE+"</div>",a+="</td>"),g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&(a+='<td style="width:90px;height:24px;">',a+='\t<div id="TB_TABMODE_PREVIEW_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_PREVIEW+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_PREVIEW+"</div>",a+="</td>"),a+='<td style="height:24px;">',
a+='\t<div class="duzon_btn_tabmod_area_blank"></div>',a+="</td>",dzeUiConfig.bCustomBottomResizeBtnYN&&(a+='<td style="width:15px;height:24px;">',a+='<div class="duzon_btn_tabmod_area_resizer">',a=a+("<div id='TB_CONTAINER_BOTTOM_RESIZE_BTN_"+b+"'>")+("<img class='duzon_spinner_btn_arrow_up' src='"+dzeEnvConfig.strPath_Image+"dialog/btn_arrow_up.png' alt='' width='5' height='3' />"),a+="<img class='duzon_spinner_btn_arrow_up' src='"+dzeEnvConfig.strPath_Image+"dialog/btn_arrow_down.png' alt='' width='5' height='3' border='0' />",
a+="</div>",a+="</div>",a+="</td>"),a+="</tr>",a+="</table>",a+="</td>",a+="</tr>",a+="</table>",g_bBottomResizeYN&&(a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" class="tbToolbarSetTabMode" id="TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_'+b+'">')+'<tr valign="top">',a=a+('<td id="TB_CONTAINER_BOTTOM_RESIZE_'+b+'" class="duzon_handle_resize_height">')+'<div style="display:inline-block;"></div>',a+="</td>",a+="</tr>",a+="</table>"),a+="</td>",a+="</tr>";
else if(!f||g_bTabBar_Display)a+='<tr valign="top"><td style="width:100%;line-height:normal;padding:0px;"><div class="tbToolbarSetTabMode_No_Bottom" id="ToolbarSetTabMode_No_Bottom_'+b+'"></div></td</tr>';a+="</table>";b=parseInt(b,10)+DZE_IFRAME_TMP_NO;a+='<div id="'+g_strEditObjectName+"_Parent_"+b+'" style="display:none;">';a+='\t<iframe id="'+g_strEditObjectName+"_"+b+'">';return a+="</div>"}
function buildEditAreaContainer_Handle(b,a,f){var e="";0!=b&&(e+='<td width="'+b+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');0!=a&&(e+='<td width="'+a+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_HandleDiv+'"></div></td>');0!=f&&(e+='<td width="'+f+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');return e}
function buildEditAreaContainer_ComboBox(b,a,f,e,c){var d=0;e&&(d=calculateStringLength(g_arrConst[b][1])-6);d=a+(e?d:0)+2;d='<td width="'+d+'" height="28" style="width:'+d+'px;height:16px;line-height:0;border:0px;padding:0px;vertical-align:middle;"><table style="border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0"><tr>';e&&(d+='<td style="height:16px;line-height:0;border:0px;padding-left:5px;padding-top:3px;padding-right:3px;padding-bottom:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+
'">'+g_arrConst[b][1]+"</td>");d+='<td style="width:'+a+'px;height:16px;line-height:0;border:0px;padding:0px;">';d+='<div id="'+g_arrConst[b][2]+"_"+c+'" TBTYPE="toggle" style="line-height:0;width:'+a+'px;overflow:hidden;" title="'+g_arrConst[b][1]+'">';d+='<table style="width:'+a+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';d+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(d+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
f+'"><span id="'+g_arrConst[b][2]+"_"+c+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',d+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(d+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
f+'"><span id="'+g_arrConst[b][2]+"_"+c+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',d+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(d+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
f+'"><span id="'+g_arrConst[b][2]+"_"+c+'_LABEL" style="line-height:0;"></span></td>',d+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(d+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
f+'"><span id="'+g_arrConst[b][2]+"_"+c+'_LABEL" style="line-height:0;"></span></td>',d+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');d+="</tr>";d+="</table>";d+="</div>";d+="</td>";d+="</tr>";d+="</table>";return d+="</td>"}
function buildEditAreaContainer_Separator(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_Separator+'"></div></td>');return a}function buildEditAreaContainer_Space(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"></td>');return a}
function buildEditAreaContainer_Button(b,a){return'<td width="24" height="28" style="padding:0;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+g_arrConst[b][1]+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[b][1]+'"></div></div>')+"</td>"}
function buildEditAreaContainer_DropDown(b,a){b==ID_COMMAND_MARK_INSERT&&(g_bMarkWinAssigned=!0);var f='<td width="35" height="28" style="line-height:0;height:24px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+g_arrConst[b][1]+'" TBTYPE="toggle" style="overflow:hidden;">');f=f+'<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="30"><tr><td width="18" style="line-height:0;height:20px;border:0px;padding:0px;">'+
('<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" alt="'+g_arrConst[b][1]+'" style="vertical-align:baseline;border:none;"></div></div>');b==ID_COMMAND_FORE_COLOR&&(f+='<div id="TB_SETFORECOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b==ID_COMMAND_BACK_COLOR&&(f+='<div id="TB_SETBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');
b==ID_COMMAND_TABLE_CELL_BACKCOLOR&&(f+='<div id="TB_SETCELLBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');b==ID_COMMAND_IMAGE_BORDER_COLOR&&(f+='<div id="TB_SETIMAGEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b==ID_COMMAND_TABLE_BORDER_COLOR&&(f+='<div id="TB_SETTABLEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');
f=f+'</td><td width="13" style="line-height:0;height:20px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'_SUB" class="'+g_strSkin_DropDown_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>');return f+"</td></tr></table></div></td>"}
function buildEditAreaContainer_Caption(b){return'<td style="width:'+(12*b.length+1)+'px;height:16px;line-height:normal;border:0px;padding:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+'">'+b+"</td>"}
function calculateStringLength(b){try{if(null==g_strBrowserLanguage)return 0;var a=0,f=b.length;if(ID_LANGUAGE_TYPE_KO==g_strBrowserLanguage)a=12*f+16;else if(ID_LANGUAGE_TYPE_EN==g_strBrowserLanguage)a=9*f+2;else if(ID_LANGUAGE_TYPE_JA==g_strBrowserLanguage)a=12*f+16;else if(ID_LANGUAGE_TYPE_ZH==g_strBrowserLanguage||ID_LANGUAGE_TYPE_ZH_CN==g_strBrowserLanguage)a=12*f+16;return a}catch(e){}return 0};

var duzon_http={createRequest:function(){var a=null;try{try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}}null==a&&alert("Request Error! Please Retry!");return a}catch(b){return a}},loading_screen:!0,loading_image_url:g_dzEditorBasePath+"image/loading-image.gif",loading_image_size:[48,48],ajax:function(a){try{var b=this.createRequest();if("undefined"!=typeof b&&null!=b){var c="undefined"!=typeof a.type?a.type.toLowerCase():
"post",d=a.url,f="undefined"!=typeof a.async?a.async:!0,g="undefined"!=typeof a.dataType?a.dataType:"html",e="undefined"!=typeof a.data?a.data:{},l="undefined"!=typeof a.success?a.success:function(){},m="undefined"!=typeof a.error?a.error:function(){},p="undefined"!=typeof a.timeout&&0<a.timeout?a.timeout:3E4;"undefined"!=typeof a.loading_screen&&(this.loading_screen=a.loading_screen);"undefined"!=typeof a.loading_image_size&&(this.loading_image_size=a.loading_image_size);var h="undefined"!=typeof a.bShowLoading?
a.bShowLoading:!0;if("object"===typeof e){a=[];for(var n in e)a.push(n+"="+encodeURIComponent(e[n]));var k=a.join("&");"get"==c&&""!=k&&(d+="?"+encodeURI(k))}duzon_http.log("url : "+d);b.open(c,d,f);"post"==c&&b.setRequestHeader("Content-type","application/x-www-form-urlencoded");var q=setTimeout(function(){duzon_http.log("HttpReqeust Timeout!");duzon_http.hideLoading();b.abort()},p);!0===h&&this.showLoading();b.onreadystatechange=function(){if(4==b.readyState)if(!0===h&&duzon_http.hideLoading(),
duzon_http.log("HttpReqeust Complete"),clearTimeout(q),200==b.status){duzon_http.log("HttpReqeust Result : Success");var a="xml"==g?b.responseXML:b.responseText;duzon_http.log("response dataType:"+typeof a);"json"==g&&(a=duzon_http.parseJSON(a));l(a)}else duzon_http.log("HttpReqeust Result : Fail"),m({status:b.status,msg:"response error"})};duzon_http.log("HttpReqeust Start");"post"==c?b.send(k):b.send()}}catch(r){!0===h&&duzon_http.hideLoading(),m({status:"",msg:"exception error"})}},parseJSON:function(a){if("undefined"!=
typeof JSON)try{return JSON.parse(a)}catch(b){try{return eval("("+a+")")}catch(c){return{}}}else try{return eval("("+a+")")}catch(b){return{}}},loadingScreenObj:null,loadingImageObj:null,loadingImageTimer:null,showLoading:function(){try{!0===this.loading_screen&&(this.loadingScreenObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_screen_obj"),null==this.loadingScreenObj&&(this.loadingScreenObj=g_objLayerKit.getLayerDocument().createElement("div"),this.loadingScreenObj.id="dze_idx_loading_screen_obj",
this.loadingScreenObj.style.position="absolute",this.loadingScreenObj.style.left="0",this.loadingScreenObj.style.top="0",this.loadingScreenObj.style.width="100%",this.loadingScreenObj.style.height="100%",this.loadingScreenObj.style.backgroundColor="gray",this.loadingScreenObj.style.opacity="0.3",this.loadingScreenObj.style.zIndex="30001",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingScreenObj)),this.loadingScreenObj.style.display="block",this.resizeLoadingScreen(),""!=this.loading_image_url&&
(this.loadingImageObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_image_obj"),null==this.loadingImageObj&&(this.loadingImageObj=g_objLayerKit.getLayerDocument().createElement("div"),this.loadingImageObj.id="dze_idx_loading_image_obj",this.loadingImageObj.style.backgroundImage="url("+this.loading_image_url+")",this.loadingImageObj.style.position="absolute",this.loadingImageObj.style.left="0",this.loadingImageObj.style.top="0",this.loadingImageObj.style.width=this.loading_image_size[0]+
"px",this.loadingImageObj.style.height=this.loading_image_size[1]+"px",this.loadingImageObj.style.zIndex="30002",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingImageObj)),this.loadingImageObj.style.display="block",this.setPositionLoadingImage(),this.addLoadingImageEvent()),this.loadingImageTimer=setTimeout(function(){duzon_http.hideLoading()},3E4))}catch(a){}},addLoadingImageEvent:function(){try{g_objLayerKit.getLayerWindow().attachEvent?(g_objLayerKit.getLayerWindow().attachEvent("onscroll",
duzon_http.setPositionLoadingImage),g_objLayerKit.getLayerWindow().attachEvent("onscroll",duzon_http.resizeLoadingScreen),g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_http.setPositionLoadingImage),g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_http.resizeLoadingScreen)):(g_objLayerKit.getLayerWindow().addEventListener("scroll",duzon_http.setPositionLoadingImage,!1),g_objLayerKit.getLayerWindow().addEventListener("scroll",duzon_http.resizeLoadingScreen,!1),g_objLayerKit.getLayerWindow().addEventListener("resize",
duzon_http.setPositionLoadingImage,!1),g_objLayerKit.getLayerWindow().addEventListener("resize",duzon_http.resizeLoadingScreen,!1))}catch(a){}},resizeLoadingScreen:function(){try{if(duzon_http.loadingScreenObj=g_objLayerKit.getElementById("dze_idx_loading_screen_obj"),null!=duzon_http.loadingScreenObj&&"none"!=duzon_http.loadingScreenObj.style.display){var a=0,b=0;duzon_http.loadingScreenObj.style.width=a+"px";duzon_http.loadingScreenObj.style.height=b+"px";g_objLayerKit.getLayerDocument().documentElement.scrollWidth&&
(a=g_objLayerKit.getLayerDocument().documentElement.scrollWidth);g_objLayerKit.getLayerDocument().documentElement.scrollHeight&&(b=g_objLayerKit.getLayerDocument().documentElement.scrollHeight);g_objLayerKit.getLayerWindow().innerHeight&&g_objLayerKit.getLayerWindow().innerHeight>b&&(b=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&g_objLayerKit.getLayerDocument().documentElement.clientHeight>b&&(b=g_objLayerKit.getLayerDocument().documentElement.clientHeight);
g_objLayerKit.getLayerDocument().body.scrollWidth&&g_objLayerKit.getLayerDocument().body.scrollWidth>a&&(a=g_objLayerKit.getLayerDocument().body.scrollWidth);g_objLayerKit.getLayerDocument().body.scrollHeight&&g_objLayerKit.getLayerDocument().body.scrollHeight>b&&(b=g_objLayerKit.getLayerDocument().body.scrollHeight);duzon_http.loadingScreenObj.style.width=a+"px";duzon_http.loadingScreenObj.style.height=b+"px"}}catch(c){}},setPositionLoadingImage:function(){try{if(duzon_http.loadingImageObj=g_objLayerKit.getElementById("dze_idx_loading_image_obj"),
null!=duzon_http.loadingImageObj&&"block"==duzon_http.loadingImageObj.style.display){duzon_http.loadingImageObj.style.position="absolute";if(g_objLayerKit.getLayerWindow().innerWidth)var a=g_objLayerKit.getLayerWindow().innerWidth,b=g_objLayerKit.getLayerWindow().innerHeight;else a=g_objLayerKit.getLayerDocument().documentElement.clientWidth,b=g_objLayerKit.getLayerDocument().documentElement.clientHeight;var c=a/2-duzon_http.loadingImageObj.offsetWidth/2,d=b/2-duzon_http.loadingImageObj.offsetHeight/
2;g_objLayerKit.getLayerDocument().documentElement.scrollTop?(d+=g_objLayerKit.getLayerDocument().documentElement.scrollTop,c+=g_objLayerKit.getLayerDocument().documentElement.scrollLeft):(d+=g_objLayerKit.getLayerDocument().body.scrollTop,c+=g_objLayerKit.getLayerDocument().body.scrollLeft);duzon_http.loadingImageObj.style.left=c+"px";duzon_http.loadingImageObj.style.top=d+"px"}}catch(f){}},hideLoading:function(){try{!0===this.loading_screen&&(this.loadingImageTimer&&clearTimeout(this.loadingImageTimer),
null!=this.loadingImageObj&&(this.loadingImageObj.style.display="none"),null!=this.loadingScreenObj&&(this.loadingScreenObj.style.display="none"),this.loadingImageTimer=null)}catch(a){}},debug:!0,checkDebuggingStatus:function(){return!0===duzon_http.debug&&!0===dzeEnvConfig.bDebugging?!0:!1},error:function(a,b){if(!0===this.checkDebuggingStatus()&&"undefined"!=typeof console)try{console.error(a,b)}catch(c){}},log:function(a){if(!0===this.checkDebuggingStatus()&&"undefined"!==typeof console)try{console.log("[DZE_HTTP:"+
duzon_http.getCurrTime()+"] "+a)}catch(b){duzon_http.error("Error",b)}},getCurrTime:function(){try{var a=new Date,b=a.getFullYear(),c=a.getMonth()+1;10>c&&(c="0"+c);var d=a.getDate();10>d&&(d="0"+d);var f=a.getHours();10>f&&(f="0"+f);var g=a.getMinutes();10>g&&(g="0"+g);var e=a.getSeconds();10>e&&(e="0"+e);return""+b+"-"+c+"-"+d+" "+f+":"+g+":"+e}catch(l){return""}}};

var duzon_menubar={nEditNumber:0,objLayerDoc:document,setEditNumber:function(c){this.nEditNumber=c},menuBarContainerObj:{},setMenuBarContainerObj:function(){this.menuBarContainerObj=g_objLayerKit.getElementById("TB_CONTAINER_MENU_"+this.nEditNumber)},calcElementPosition:function(c){var a={};a.scrollX=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;a.scrollY=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;
a.top=c.offsetTop;a.left=c.offsetLeft;a.width=c.offsetWidth;a.height=c.offsetHeight;window.innerWidth?(a.view_window_width=window.innerWidth,a.view_window_height=window.innerHeight):(a.view_window_width=document.documentElement.clientWidth,a.view_window_height=document.documentElement.clientHeight);return a},idx_twodepth_menu_container:"idx_twodepth_menu_container",twodepth_menu_container:{},prev_command_id:"0",viewTwoDepthMenu:function(c,a,e){g_objCommonUtil.log("viewTwoDepthMenu:"+a);duzon_menubar.twodepth_menu_container=
g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(null!=duzon_menubar.twodepth_menu_container){g_objCommonUtil.log("duzon_menubar.twodepth_menu_container is not null");if(this.prev_command_id==a){g_objCommonUtil.log("viewTwoDepthMenu:1:this.prev_command_id->"+this.prev_command_id+",command_id=>"+a);duzon_menubar.twodepth_menu_container.style.display="block";return}g_objCommonUtil.log("viewTwoDepthMenu:2:this.prev_command_id->"+this.prev_command_id+",command_id=>"+a);duzon_menubar.hideTwoDepthMenu(a)}this.prev_command_id=
a;this.twodepth_menu_container=g_objLayerKit.getLayerDocument().createElement("div");this.twodepth_menu_container.id=this.idx_twodepth_menu_container;this.twodepth_menu_container.className="twodepth_menu_container";g_objLayerKit.getLayerDocument().body.appendChild(this.twodepth_menu_container);var d=0,b=0;a:for(;b<g_objMenuWin.arrMenuMember.length;b++){var f=0;for(;f<g_objMenuWin.arrMenuMember[b].length;f++)if(a==g_objMenuWin.arrMenuMember[b][f]){d=b;break a}}g_objCommonUtil.log("divMenuSelectNo:"+
d);b=g_objLayerKit.getElementById("divMenuSelect_"+d);if(null==b||"none"==b.style.display){d=-1;for(b=0;b<dzeUiConfig.arrContextMenu_General.length;b++)if(a==dzeUiConfig.arrContextMenu_General[b]){d=0;"none"==g_objLayerKit.getElementById("divContextMenu_"+d).style.display&&(d=-1);break}if(0>d)for(b=0;b<dzeUiConfig.arrContextMenu_OneCell.length;b++)if(a==dzeUiConfig.arrContextMenu_OneCell[b]){d=1;"none"==g_objLayerKit.getElementById("divContextMenu_"+d).style.display&&(d=-1);break}if(0>d)for(b=0;b<
dzeUiConfig.arrContextMenu_MultiCell.length;b++)if(a==dzeUiConfig.arrContextMenu_MultiCell[b]){d=2;"none"==g_objLayerKit.getElementById("divContextMenu_"+d).style.display&&(d=-1);break}if(0>d)for(b=0;b<dzeUiConfig.arrContextMenu_Control.length;b++)if(a==dzeUiConfig.arrContextMenu_Control[b]){d=3;"none"==g_objLayerKit.getElementById("divContextMenu_"+d).style.display&&(d=-1);break}g_objCommonUtil.log("-------------- divContextMenuSelectNo:"+d+"------------------------");if(0<=d)b=g_objLayerKit.getElementById("divContextMenu_"+
d);else return}a=this.setTwoDetphMenuList(e);this.twodepth_menu_container.appendChild(a);this.twodepth_menu_container.style.display="block";this.setTwoDepthMenuPosition(b,c,this.twodepth_menu_container)},setTwoDetphMenuList:function(c){var a=document.createElement("div"),e=document.createElement("div");e.className="twodepth_menu_list_blank";a.appendChild(e);var d={},b=0;e="";for(var f=0;f<c.length;f++)if(e="",b=c[f],b!==ID_COMMAND_INSERT_OBJECT_FILE||!1!==dzeUiConfig.bUseServerUpload){d=document.createElement("div");
d.className="twodepth_menu_list";(function(){var a=g_arrConst[b][3];d.onmousedown=function(a){if("undefined"==typeof a||null==a)if("undefined"==typeof window.event||null==window.event)a=g_objLayerKit.getLayerWindow().event;TBCancelBubbleEvent(a)};d.onclick=function(b){g_objCommonUtil.log("func:"+a);currFunc=eval(a);currFunc(b,this,-1)};d.onmouseover=function(b){this.className="twodepth_menu_list_over";g_objCommonUtil.log("func:"+a)};d.onmouseout=function(a){this.className="twodepth_menu_list"};d.command=
g_arrConst[b][0];d.commandtype=ID_COMMAND_TYPE_MENU;d.TBSTATE=ID_STRING_NAME_UNCHECKED;d.command_id=b;d.support_type=g_arrConst[b][4];d.support_control_type=g_arrConst[b][5]})();var m="",l;for(l in shortcutsMenuList)if(l==b){m="<span class='shortcuts_text'>("+shortcutsMenuList[l]+")</span>";break}var g=g_arrConst[b][1];inArray(b,g_objMenuWin.openMenuList)&&(g+="...");e+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";e+="<tr height='22'>";e+="<td class='twodepth_menu_list_blank_8'></td>";
e+="<td class='twodepth_menu_list_icon'>";"undefined"!=typeof g_arrIcon[b]&&""!=g_arrIcon[b]&&(g_objCommonUtil.log("g_arrIcon[commandID]:"+b+":"+g_arrIcon[b]),e+='<div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" alt="'+g+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div>');e+="</td>";e+="<td class='twodepth_menu_list_blank_6'></td>";e+="<td class='twodepth_menu_list_text'>"+g+m+"</td>";e+="</td>";e+="</tr>";
e+="</table>";d.innerHTML=e;a.appendChild(d)}c=document.createElement("div");c.className="twodepth_menu_list_blank";a.appendChild(c);return a},setTwoDepthMenuPosition:function(c,a,e){c=this.calcElementPosition(c);var d=this.calcElementPosition(a);a=this.calcElementPosition(e);var b=c.top+d.top+2;d=c.left+d.width;var f=duzon_dialog.getActiveDialogWindowSize();d+a.width>f.view_window_width+f.scrollX&&(d=d-c.width-a.width+4);b+a.height>f.view_window_height+f.scrollY&&(b=b-a.height+20);0>b&&(b=0);0>d&&
(d=0);e.style.top=b+"px";e.style.left=d+"px"},hideTwoDepthMenu:function(c){g_objCommonUtil.log("hideTwoDepthMenu");duzon_menubar.twodepth_menu_container=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);null!=duzon_menubar.twodepth_menu_container&&(duzon_menubar.twodepth_menu_container.style.display="none",g_objLayerKit.getLayerDocument().body.removeChild(duzon_menubar.twodepth_menu_container))},toolbar_line:3,viewHiddenTbContainerTool:function(c,a){g_objCommonUtil.log("===viewHiddenTbContainerTool==== toolbarNo:"+
c+", nEditNumber:"+a);duzon_menubar.nEditNumber=a;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);for(a=1;a<=duzon_menubar.toolbar_line;a++){var e=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber);null!=e&&(e.style.display=c==a?"none"==e.style.display?"block":"none":"none")}duzon_menubar.setHiddenTbContainerToolPostion();duzon_menubar.addLayerEvent()},closeHiddenTbContainerTool:function(){for(var c,a=1;a<=duzon_menubar.toolbar_line;a++)c=document.getElementById("TB_CONTAINER_TOOL_"+
a+"_HIDDEN_"+duzon_menubar.nEditNumber),null!=c&&(c.style.display="none");duzon_menubar.removeLayerEvent()},setHiddenTbContainerToolPostion:function(){g_objCommonUtil.log("setHiddenTbContainerToolPostion CAll");for(var c=null,a=1;a<=duzon_menubar.toolbar_line&&(c=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber),null==c||"none"==c.style.display);a++);if(null!=c&&"none"!=c.style.display){c.style.left="0px";c.style.top="0px";a=c.getAttribute("toolbarNo");var e=document.getElementById("EDIT_SET_CONTAINER_"+
duzon_menubar.nEditNumber);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(e);var d=duzon_menubar.calcElementPosition(c);e=document.getElementById("TB_CONTAINER_"+duzon_menubar.nEditNumber);tbContainerObj_pos=duzon_menubar.calcElementPosition(e);g_objCommonUtil.log(d);g_objCommonUtil.log("------------------------------------------ toolbarNo:"+a);e=parentToolbarObj_pos.top;if(dzeUiConfig.bCustomize_MenuBar_Display){var b=document.getElementById("TB_CONTAINER_MENU_"+duzon_menubar.nEditNumber);menubarObj_pos=
duzon_menubar.calcElementPosition(b);e+=menubarObj_pos.height}b=0;1<=a&&dzeUiConfig.bCustomize_ToolBar1_Display&&(e+=d.height,b++);2<=a&&dzeUiConfig.bCustomize_ToolBar2_Display&&(e+=d.height,b++);3<=a&&dzeUiConfig.bCustomize_ToolBar3_Display&&(e+=d.height,b++);g_objCommonUtil.log("============================ viewToolbarNum : "+b);a=parentToolbarObj_pos.left+tbContainerObj_pos.width-d.width;1<b&&(e-=b-1);d=duzon_dialog.getParentAbsoluteNodePos(c);e-=d.top;a-=d.left;c.style.top=e+"px";c.style.left=
a+"px";g_objCommonUtil.log("toolbarObj.style.top:"+c.style.top);g_objCommonUtil.log("toolbarObj.style.left:"+c.style.left);g_objCommonUtil.log("toolbarObj.id:"+c.id)}},resizeHiddenTbContainerToolPostion:function(){g_objCommonUtil.log("resizeHiddenTbContainerToolPostion call");for(var c=null,a=1;a<=duzon_menubar.toolbar_line&&(c=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber),null==c||"none"==c.style.display);a++);null!=c&&duzon_menubar.setHiddenTbContainerToolPostion(c)},
addLayerEvent:function(){try{window.attachEvent?(window.attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.attachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.addEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.addEventListener("resize",duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var c in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[c].attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool):
g_objEditorDocument[c].addEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_menubar.addLayerEvent error")}},removeLayerEvent:function(){try{window.detachEvent?(window.detachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.detachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.removeEventListener("resize",
duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var c in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[c].detachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool):g_objEditorDocument[c].removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_menubar.addLayerEvent error")}},availToolbarWidth:0,rebuildHiddenToolbar:function(){for(var c in g_arrEditorAreaContainer){var a=c;duzon_menubar.availToolbarWidth=
!0===g_bEditorWidthPercentageYN?duzon_menubar.calcElementPosition(document.getElementById("INIT_LOAD_AREA_"+a)).width-2:parseInt(g_arrEditorWidth[a],10)-7;if(!(0>=duzon_menubar.availToolbarWidth))for(var e,d=1;3>=d;d++){e=0;var b=d;if(eval("dzeUiConfig.bCustomize_ToolBar"+b+"_Display")){for(var f=document.getElementById("TB_CONTAINER_TOOL_"+b+"_"+a).childNodes[0],m=g_objTableUtil.getTableRowElement(f,0),l=g_objTableUtil.getTableCellsLength(f,0),g=0;g<l;g++){var k=g_objTableUtil.getTableCellElement(f,
0,g).getAttribute("width");null!=k&&(e+=parseInt(k,10))}k=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_TBL_"+a);var q=g_objTableUtil.getTableRowElement(k,0),p=g_objTableUtil.getTableCellsLength(k,0);g=duzon_menubar.availToolbarWidth;"block"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+a).style.display&&(g-=13);if(e>g){if(f=g_objTableUtil.getTableCellElement(f,0,l-4),null!=f&&f.getAttribute("width")){var h=q.insertCell(1);f.getAttribute("width")&&h.setAttribute("width",
f.getAttribute("width"));f.getAttribute("height")&&h.setAttribute("height",f.getAttribute("height"));f.getAttribute("style")&&h.setAttribute("style",f.getAttribute("style"));for(var n=0;n<f.childNodes.length;n++)h.appendChild(f.childNodes[n]);m.deleteCell(l-4);document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+a).style.display="block";e-=parseInt(h.getAttribute("width"));e>g&&duzon_menubar.rebuildHiddenToolbar()}}else{if("none"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+
a).style.display)continue;if(2==p){document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+a).style.display="none";continue}f=g_objTableUtil.getTableCellElement(k,0,1);e+=parseInt(f.getAttribute("width"),10);3==p&&(g+=13);if(g>e){h=m.insertCell(l-3);f.getAttribute("width")&&h.setAttribute("width",f.getAttribute("width"));f.getAttribute("height")&&h.setAttribute("height",f.getAttribute("height"));f.getAttribute("style")&&h.setAttribute("style",f.getAttribute("style"));for(n=0;n<f.childNodes.length;n++)h.appendChild(f.childNodes[n]);
q.deleteCell(1);2==p?document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+a).style.display="none":(m=g_objTableUtil.getTableCellElement(k,0,1),e+=parseInt(m.getAttribute("width"),10),g>e&&duzon_menubar.rebuildHiddenToolbar())}}k=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_TBL_"+a);p=g_objTableUtil.getTableCellsLength(k,0);2==p&&(document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_"+a).style.display="none",document.getElementById("TB_CONTAINER_BTN_TOOL_"+b+"_HIDDEN_"+a).style.display=
"none")}}}},evtKeyCode:function(c){this.keyCode=(c?c:window.event).keyCode;g_objCommonUtil.log("keycode :"+this.keyCode);27==this.keyCode&&duzon_menubar.closeHiddenTbContainerTool()}};

var duzon_dialog={use_backscreen:!0,nEditNumber:0,objLayerDoc:document,objLayerWin:window,setObjLayer:function(){this.objLayerDoc=g_objLayerKit.getLayerDocument();this.objLayerWin=g_objLayerKit.getLayerWindow()},checkObject:function(a){return"undefined"==typeof a||null==a?!1:!0},dialog_obj:null,tabType:!1,setTabType:function(a){"undefined"==typeof a&&(a=!1);this.tabType=a},getTabType:function(){return this.tabType},title:"",setTitle:function(a){this.title=a},getTitle:function(){return this.title},
dialogStatus:!1,unloadCB:function(){},income_path:"child",resetSelection:!1,viewDialog:function(a,b,c,d,e,f,g,h,k,l,m,n){try{g_objCommonUtil.log("viewDialog nEditNumber : "+b);this.dialogStatus=!0;this.setObjLayer();this.income_path="undefined"==typeof this.objLayerWin.event||null==this.objLayerWin.event?"child":"parent";this.resetSelection=!1;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_nActiveEditNumber=this.nEditNumber=b;"none"!=this.color_picker_mode&&!0!==dzeUiConfig.bTBPreviewLetterOperation||
g_objInsertUtil.saveSelectionRange_IE(0,this.nEditNumber);this.viewBackScreen();this.setTitle(c);this.createDialog(a,c,d,e,f,g);this.fade("in",this.dialog_obj);this.back_screen_obj.className=null==this.dialog_buttonbox_obj?"duzon_backscreen_transparent":"duzon_backscreen";this.setButtonStyle();this.setButtonFocus(l);this.addDialogEvent();"undefined"!=typeof h&&h();this.unloadCB="undefined"!=typeof k?k:function(){};if("undefined"!=typeof m&&"toolbar"==m&&"undefined"!=typeof n){var q=document.getElementById(n.id.replace(/_SUB/,
"")),p=g_objPositionUtil.getOuterRect(q),r=g_objPositionUtil.getOuterRect(window.frameElement);this.dialog_obj.style.left=r.left+p.left+"px";this.dialog_obj.style.top=r.top+p.top+p.height+"px"}else this.setObjectPosition(a,this.dialog_obj,m);this.resizeBackScreen()}catch(u){g_objCommonUtil.displayErrorAlert(u,"viewDialog")}},addDialogEvent:function(){try{window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousedown",duzon_dialog.evtDialogBoxDragDown),g_objLayerKit.getLayerDocument().attachEvent("onmousemove",
duzon_dialog.evtDialogBoxDragMove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",duzon_dialog.evtDialogBoxDragUp),g_objLayerKit.getLayerDocument().attachEvent("onkeydown",duzon_dialog.evtKeyCode)):window.addEventListener&&(g_objLayerKit.getLayerDocument().addEventListener("mousedown",duzon_dialog.evtDialogBoxDragDown,!1),g_objLayerKit.getLayerDocument().addEventListener("mousemove",duzon_dialog.evtDialogBoxDragMove,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",duzon_dialog.evtDialogBoxDragUp,
!1),g_objLayerKit.getLayerDocument().addEventListener("keydown",duzon_dialog.evtKeyCode,!1));for(var a in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[a].attachEvent("onkeydown",duzon_dialog.evtKeyCode):g_objEditorDocument[a].addEventListener("keydown",duzon_dialog.evtKeyCode,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"addDialogEvent")}},removeDialogEvent:function(){try{window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousedown",duzon_dialog.evtDialogBoxDragDown),
g_objLayerKit.getLayerDocument().detachEvent("onmousemove",duzon_dialog.evtDialogBoxDragMove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",duzon_dialog.evtDialogBoxDragUp),g_objLayerKit.getLayerDocument().detachEvent("onkeydown",duzon_dialog.evtKeyCode)):window.removeEventListener&&(g_objLayerKit.getLayerDocument().removeEventListener("mousedown",duzon_dialog.evtDialogBoxDragDown,!1),g_objLayerKit.getLayerDocument().removeEventListener("mousemove",duzon_dialog.evtDialogBoxDragMove,!1),
g_objLayerKit.getLayerDocument().removeEventListener("mouseup",duzon_dialog.evtDialogBoxDragUp,!1),g_objLayerKit.getLayerDocument().removeEventListener("keydown",duzon_dialog.evtKeyCode,!1));for(var a in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[a].detachEvent("onkeydown",duzon_dialog.evtKeyCode):g_objEditorDocument[a].removeEventListener("keydown",duzon_dialog.evtKeyCode,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"removeDialogEvent")}},resetTableObjInfo:function(){try{if(g_objTableFlag.initTableInfo(),
g_nEndClick_Col=g_nEndClick_Row=g_nStartClick_Col=g_nStartClick_Row=-1,g_objWrapperOutlineResize.resetExtOutlineInfo(),!fnObjectCheckNull(g_objTable)){for(var a=0;a<g_objTable.rows.length;a++)for(var b=g_objTableUtil.getTableCellsLength(g_objTable,a),c=0;c<b;c++){var d=g_objTableUtil.getTableCellElement(g_objTable,a,c);g_objTableFlag.RemoveCellAfterCheckExist(d)}g_objTableFlag.bOneCell=!0;g_objTable=null;g_objTableFlag.arrDecreaseRowCol=null}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.resetTableObjInfo error")}},
setButtonFocus:function(a){try{"undefined"==typeof a&&(a=!0),setTimeout(function(){for(var b=duzon_dialog.dialog_obj.getElementsByTagName("*"),c=[],d=1,e=!1,f=0;f<b.length;f++)if("input"==b[f].nodeName.toLowerCase()||"select"==b[f].nodeName.toLowerCase()||"textarea"==b[f].nodeName.toLowerCase())b[f].tabIndex=d,c.push(b[f]),1==a&&0==e&&0==b[f].disabled&&(b[f].focus(),e=!0),d++},100)}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.setButtonFocus")}},setButtonStyle:function(){try{for(var a=
duzon_dialog.dialog_obj.getElementsByTagName("*"),b="",c="",d=0;d<a.length;d++)if(b=a[d].nodeName.toLowerCase(),c=a[d].getAttribute("type"),("input"==b||"select"==b)&&""==a[d].className){if("submit"==c||"button"==c)a[d].className="duzon_dialog_btn_normal",a[d].onmouseover=function(){this.className="duzon_dialog_btn_up"},a[d].onmouseout=function(){this.className="duzon_dialog_btn_normal"},a[d].onmousedown=function(){this.className="duzon_dialog_btn_down"},a[d].onmouseup=function(){this.className="duzon_dialog_btn_up"};
"file"==c&&(a[d].className="duzon_dialog_body_fileform");"select"==b&&(a[d].className="duzon_dialog_body_selectform")}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.setButtonStyle")}},setObjectPosition:function(a,b,c){try{"undefined"==typeof c&&(c="relative");"center"!=c&&(a?0>=a.offsetX&&0>=a.offsetY&&(c="center"):c="center");this.setScrollPosition(a,b,c);g_objCommonUtil.log("this.mousedownX+:"+this.mousedownX);g_objCommonUtil.log("this.mousedownY+:"+this.mousedownY);g_objCommonUtil.log("this.scrollX+:"+
this.scrollX);g_objCommonUtil.log("this.scrollY+:"+this.scrollY);if("relative"==c){var d=c=0;g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(c=g_objLayerKit.getLayerWindow().innerWidth,d=g_objLayerKit.getLayerWindow().innerHeight):(c=g_objLayerKit.getLayerDocument().documentElement.clientWidth,d=g_objLayerKit.getLayerDocument().documentElement.clientHeight):(c=g_objLayerKit.getLayerDocument().body.scrollWidth,d=g_objLayerKit.getLayerDocument().body.scrollHeight);
var e=b.offsetWidth,f=b.offsetHeight;g_objCommonUtil.log("windowHeight:"+d);this.mousedownX+e>c+this.scrollX&&(this.mousedownX=this.mousedownX-(this.mousedownX+e-(c+this.scrollX))-20);this.mousedownY+f>d+this.scrollY&&(this.mousedownY=this.mousedownY-(this.mousedownY+f-(d+this.scrollY))-10);(0>=this.mousedownX||0>=this.mousedownY)&&this.setScrollPosition(a,b,"center")}0>this.mousedownX&&(this.mousedownX=0);0>this.mousedownY&&(this.mousedownY=0);b.style.left=this.mousedownX+"px";b.style.top=this.mousedownY+
"px"}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.setObjectPosition")}},back_screen_obj:null,viewBackScreen:function(){try{!0===this.use_backscreen&&(this.back_screen_obj=g_objLayerKit.getElementById(this.idx_duzon_backscreen),!0!==this.checkObject(this.back_screen_obj)&&this.createBackScreen(),this.addBackScreenEvent(),this.back_screen_obj.onclick=function(){null==duzon_dialog.dialog_buttonbox_obj&&duzon_dialog.closeDialog()},this.back_screen_obj.style.display="block",setTimeout(function(){duzon_dialog.dialog_obj=
g_objLayerKit.getElementById(duzon_dialog.idx_duzon_dialog);!0===duzon_dialog.checkObject(duzon_dialog.dialog_obj)&&"none"!=duzon_dialog.dialog_obj.style.display||duzon_dialog.closeBackScreen()},1E3),this.resizeBackScreen())}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.viewBackScreen")}},addBackScreenEvent:function(){try{window.attachEvent?g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_dialog.resizeBackScreen):window.addEventListener&&g_objLayerKit.getLayerWindow().addEventListener("resize",
duzon_dialog.resizeBackScreen,!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.addBackScreenEvent")}},removeBackScreenEvent:function(){try{window.detachEvent?g_objLayerKit.getLayerWindow().detachEvent("onresize",duzon_dialog.resizeBackScreen):window.removeEventListener&&g_objLayerKit.getLayerWindow().removeEventListener("resize",duzon_dialog.resizeBackScreen,!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.removeBackScreenEvent")}},idx_duzon_backscreen:"idx_duzon_backscreen",
createBackScreen:function(){try{this.back_screen_obj=g_objLayerKit.getLayerDocument().createElement("div"),this.back_screen_obj.id=this.idx_duzon_backscreen,this.back_screen_obj.className="duzon_backscreen_transparent",g_objLayerKit.getLayerDocument().body.appendChild(this.back_screen_obj)}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.createBackScreen")}},resizeBackScreen:function(){try{if(!0===duzon_dialog.use_backscreen&&(duzon_dialog.back_screen_obj=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_backscreen),
!0===duzon_dialog.checkObject(duzon_dialog.back_screen_obj)&&"none"!=duzon_dialog.back_screen_obj.style.display)){var a=0,b=0;duzon_dialog.back_screen_obj.style.width=a+"px";duzon_dialog.back_screen_obj.style.height=b+"px";g_objLayerKit.getLayerDocument().documentElement.scrollWidth&&(a=g_objLayerKit.getLayerDocument().documentElement.scrollWidth);g_objLayerKit.getLayerDocument().documentElement.scrollHeight&&(b=g_objLayerKit.getLayerDocument().documentElement.scrollHeight);g_objLayerKit.getLayerWindow().innerHeight&&
g_objLayerKit.getLayerWindow().innerHeight>b&&(b=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&g_objLayerKit.getLayerDocument().documentElement.clientHeight>b&&(b=g_objLayerKit.getLayerDocument().documentElement.clientHeight);g_objLayerKit.getLayerDocument().body.scrollWidth&&g_objLayerKit.getLayerDocument().body.scrollWidth>a&&(a=g_objLayerKit.getLayerDocument().body.scrollWidth);g_objLayerKit.getLayerDocument().body.scrollHeight&&g_objLayerKit.getLayerDocument().body.scrollHeight>
b&&(b=g_objLayerKit.getLayerDocument().body.scrollHeight);duzon_dialog.back_screen_obj.style.width=a+"px";duzon_dialog.back_screen_obj.style.height=b+"px"}}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.resizeBackScreen")}},closeBackScreen:function(){try{!0===duzon_dialog.use_backscreen&&(duzon_dialog.back_screen_obj=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_backscreen),!0===duzon_dialog.checkObject(duzon_dialog.back_screen_obj)&&(duzon_dialog.back_screen_obj.style.width="0px",
duzon_dialog.back_screen_obj.style.height="0px",duzon_dialog.back_screen_obj.style.display="none",this.removeBackScreenEvent()))}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.closeBackScreen")}},idx_duzon_dialog:"idx_duzon_dialog",createDialog:function(a,b,c,d,e,f){try{null!=this.dialog_obj&&(g_objLayerKit.getLayerDocument().body.removeChild(this.dialog_obj),this.dialog_obj=null,null!=this.closeDialogTimer&&(clearTimeout(this.closeDialogTimer),this.closeDialogTimer=null)),null==this.dialog_obj&&
(this.dialog_obj=g_objLayerKit.getLayerDocument().createElement("div"),this.dialog_obj.className="duzon_dialog",this.dialog_obj.id=this.idx_duzon_dialog,this.dialog_obj.style.top="0",this.dialog_obj.style.left="0",""!=b&&(this.dialog_title_obj=this.createDialogTitle(b),this.dialog_obj.appendChild(this.dialog_title_obj)),this.dialog_body_obj=this.createDialogBody(c),this.dialog_obj.appendChild(this.dialog_body_obj),0<d&&(this.dialog_buttonbox_obj=this.createDialogButtonBox(d,e,f),this.dialog_obj.appendChild(this.dialog_buttonbox_obj)),
g_objLayerKit.getLayerDocument().body.appendChild(this.dialog_obj))}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.createDialog")}},dialog_title_obj:{},createDialogTitle:function(a){try{var b=g_objLayerKit.getLayerDocument().createElement("div");b.className="duzon_dialog_title";b.innerHTML=a;b.ondragstart=function(){return!1};b.onselectstart=function(){return!1};return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.createDialogTitle")}},dialog_body_obj:{},createDialogBody:function(a){try{var b=
g_objLayerKit.getLayerDocument().createElement("div");b.className="duzon_dialog_body";var c=g_objLayerKit.getLayerDocument().createElement("div");"object"==typeof a?c.appendChild(a):"string"==typeof a&&(c.innerHTML=a);1!=this.getTabType()&&(c.className="duzon_dialog_body_content");this.setTabType(!1);b.appendChild(c);return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.createDialogBody")}},dialog_buttonbox_obj:null,createDialogButtonBox:function(a,b,c){try{var d=g_objLayerKit.getLayerDocument().createElement("div");
d.className="duzon_dialog_buttonbox";for(var e={},f=0;f<a;f++)e={},e=g_objLayerKit.getLayerDocument().createElement("input"),e.type="button",e.value=b[f],function(){var a=c[f],b=f;e.onclick=function(c){a(c?c:window.event)};var d="duzon_dialog_btn_normal",l="duzon_dialog_btn_up",m="duzon_dialog_btn_down";0==b&&(d="duzon_dialog_btn_ok_normal",l="duzon_dialog_btn_ok_up",m="duzon_dialog_btn_ok_down");e.className=d;e.onmouseover=function(){this.className=l};e.onmouseout=function(){this.className=d};e.onmousedown=
function(){this.className=m};e.onmouseup=function(){this.className=l}}(),d.appendChild(e);return d}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.createDialogButtonBox")}},closeDialogTimer:null,closeDialog:function(){try{if(0!=this.dialogStatus&&(this.dialogStatus=!1,null!=this.dialog_obj))if(this.fade("out",this.dialog_obj),this.clearSpinnerBtnMDownTimer(),this.closeDialogTimer=setTimeout(function(){null!=duzon_dialog.dialog_obj&&(g_objLayerKit.getLayerDocument().body.removeChild(duzon_dialog.dialog_obj),
duzon_dialog.dialog_obj=null,duzon_dialog.closeDialogTimer=null,duzon_dialog.dialog_buttonbox_obj=null)},500),this.closeBackScreen(),this.removeDialogEvent(),this.unloadCB(),this.unloadCB=function(){},this.resetSelection&&g_bBrowserType_IE)1==duzon_dialog.isFindDialog&&this.setEditorFocus();else if(null==g_objTable)this.setEditorSelection(),this.setEditorFocus(),editor_onselectionchange(this.nEditNumber);else{GetMultiCellSelection()?(this.setEditorFocus(),g_bBrowserType_IE&&(window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.empty():
g_objEditWindow[this.nEditNumber].getSelection().removeAllRanges())):(this.setEditorFocus(),this.setEditorSelection());g_bMenuEnabled||(g_objMenuWin.TBMenuSetStateAllEnable(!0,this.nEditNumber),g_bMenuEnabled=!0);updateTableHandlerUI.updateTableUICommand(this.nEditNumber);var a=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[this.nEditNumber],this.nEditNumber);null!=a&&updateTableHandlerUI.updateTableUIHandler(a[0],a[1],a[2],a[3],this.nEditNumber)}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.closeDialog")}},setEditorFocus:function(){try{window.attachEvent?g_objEditWindow[this.nEditNumber].focus():g_objEditorDocument[this.nEditNumber].body.focus()}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.setEditorFocus")}},setEditorSelection:function(){if(g_bBrowserType_IE)try{if(null!=g_objLastRange[this.nEditNumber])if(window.attachEvent)g_objLastRange[this.nEditNumber].select();else{var a=g_objEditWindow[this.nEditNumber].getSelection();a.removeAllRanges();a.addRange(g_objLastRange[this.nEditNumber])}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.setEditorSelection")}},setSelection:function(){this.setEditorSelection()},setEditorFirstFocus:function(a){try{window.attachEvent||(objSelection=g_objEditWindow[a].getSelection(),fnObjectCheckNull(objSelection)||(objSelection.removeAllRanges(),duzon_dialog.setEditorFocus()))}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.setEditorFirstFocus")}},setOpacity:function(a,b){try{"undefined"!=typeof a&&"undefined"!=typeof a.id&&(a.style.opacity=b,a.style.filter="alpha(opacity="+
100*b+")",a.style.MozOpacity=b,a.style.KhtmlOpacity=b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.setOpacity")}},fade_effect:!0,fade:function(a,b){try{if(!0!==duzon_dialog.fade_effect)b.style.display="out"==a?"none":"block";else{var c="out"==a?1:.1;duzon_dialog.setOpacity(b,c);b.style.display="block";var d=0,e=setInterval(function(){"out"==a?.1>=c&&(c=0,clearInterval(e),b.style.display="none"):.9<=c&&(c=1,clearInterval(e));duzon_dialog.setOpacity(b,c);c="out"==a?c-.3*c:c+.3*c;d++},
10)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.fade")}},drag_status:!1,drag_startX:0,drag_startY:0,org_windowSizeInfo:{},evtDialogBoxDragDown:function(a){try{var b=a?a:window.event;if("duzon_dialog_title"==(b.srcElement?b.srcElement:b.target).className){var c=duzon_dialog.getDialogLayerPosition(b);duzon_dialog.drag_startX=c.mousedownX;duzon_dialog.drag_startY=c.mousedownY;duzon_dialog.drag_status=!0;duzon_dialog.dialog_obj.className="duzon_dialog_move";duzon_dialog.setOpacity(duzon_dialog.dialog_obj,
.5);duzon_dialog.org_windowSizeInfo=duzon_dialog.getActiveDialogWindowSize()}}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.evtDialogBoxDragDown")}},evtDialogBoxDragMove:function(a){try{var b=a?a:window.event;if(!0===duzon_dialog.drag_status){var c=duzon_dialog.getDialogLayerPosition(b),d=c.mousedownX-duzon_dialog.drag_startX,e=c.mousedownY-duzon_dialog.drag_startY,f=parseInt(duzon_dialog.dialog_obj.style.left.replace(/px/,""),10)+d,g=parseInt(duzon_dialog.dialog_obj.style.top.replace(/px/,
""),10)+e;0<=f&&(duzon_dialog.drag_startX=c.mousedownX);0>f&&(f=0);0<=g&&(duzon_dialog.drag_startY=c.mousedownY);0>g&&(g=0);duzon_dialog.dialog_obj.style.left=f+"px";duzon_dialog.dialog_obj.style.top=g+"px"}}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.evtDialogBoxDragMove")}},evtDialogBoxDragUp:function(a){try{duzon_dialog.drag_status=!1,duzon_dialog.dialog_obj.className="duzon_dialog",duzon_dialog.setOpacity(duzon_dialog.dialog_obj,1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.evtDialogBoxDragUp")}},
getDialogLayerPosition:function(a){var b={scrollX:0,scrollY:0,mousedownX:0,mousedownY:0,top:0,right:0,bottom:0,left:0,width:0,height:0};try{return"undefined"!=typeof a&&null!=a&&(document.documentElement.scrollLeft?(b.scrollX=document.documentElement.scrollLeft,b.mousedownX=document.documentElement.scrollLeft+a.clientX):(b.scrollX=document.body.scrollLeft,b.mousedownX=document.body.scrollLeft+a.clientX),document.documentElement.scrollTop?(b.scrollY=document.documentElement.scrollTop,b.mousedownY=
document.documentElement.scrollTop+a.clientY):(b.scrollY=document.body.scrollTop,b.mousedownY=document.body.scrollTop+a.clientY)),"none"!=duzon_dialog.dialog_obj.style.display&&(b.top=parseInt(duzon_dialog.dialog_obj.style.top.replace(/px/,""),10),b.left=parseInt(duzon_dialog.dialog_obj.style.left.replace(/px/,""),10),b.width=duzon_dialog.dialog_obj.offsetWidth,b.height=duzon_dialog.dialog_obj.offsetHeight,b.right=b.left+b.width,b.bottom=b.top+b.height),b}catch(c){return g_objCommonUtil.displayErrorAlert(c,
"error:"),b}},keyCode:"",evtKeyCode:function(a){try{this.keyCode=(a?a:window.event).keyCode,g_objCommonUtil.log("keycode :"+this.keyCode),27==this.keyCode&&(g_objPropForm.bShowPropForm||duzon_dialog.closeDialog())}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.evtKeyCode")}},scrollX:0,scrollY:0,mousedownX:0,mousedownY:0,setScrollPosition:function(a,b,c){try{if("undefined"==typeof c&&(c="relative"),"center"!=c&&(a?0>=a.offsetX&&0>=a.offsetY&&(c="center"):c="center"),"relative"==c){if(g_objLayerKit.getLayerDocument().documentElement.scrollLeft?
(this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft,this.mousedownX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft+a.clientX):(this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft,this.mousedownX=g_objLayerKit.getLayerDocument().body.scrollLeft+a.clientX),g_objLayerKit.getLayerDocument().documentElement.scrollTop?(this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop,this.mousedownY=g_objLayerKit.getLayerDocument().documentElement.scrollTop+
a.clientY):(this.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop,this.mousedownY=g_objLayerKit.getLayerDocument().body.scrollTop+a.clientY),"child"==this.income_path){var d=g_objPositionUtil.getOuterRect(window.frameElement);this.mousedownX=a.clientX+d.left;this.mousedownY=a.clientY+d.top}}else if("center"==c){g_objLayerKit.getLayerDocument().documentElement.scrollLeft?this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft;
g_objLayerKit.getLayerDocument().documentElement.scrollTop?this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:this.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop;var e=b.offsetWidth,f=g_objPositionUtil.getOuterRect(g_objEditObject[this.nEditNumber]);d=g_objPositionUtil.getOuterRect(window.frameElement);this.mousedownY=d.top+f.top+10;this.mousedownX=d.left+f.left+(f.width-e)/2;this.scrollY=this.scrollX=0}else if("screen_center"==c){g_objLayerKit.getLayerDocument().documentElement.scrollLeft?
this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft;g_objLayerKit.getLayerDocument().documentElement.scrollTop?this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:this.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop;c=a=0;g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(a=g_objLayerKit.getLayerWindow().innerWidth,c=g_objLayerKit.getLayerWindow().innerHeight):
(a=g_objLayerKit.getLayerDocument().documentElement.clientWidth,c=g_objLayerKit.getLayerDocument().documentElement.clientHeight):(a=g_objLayerKit.getLayerDocument().body.scrollWidth,c=g_objLayerKit.getLayerDocument().body.scrollHeight);e=b.offsetWidth;var g=b.offsetHeight;this.mousedownX=a/2+this.scrollX-e/2;this.mousedownY=c/2+this.scrollY-g/2}}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.setScrollPosition")}},idx_toast_msg:"idx_toast_msg",toastObj:null,showToastMessage:function(a,
b,c){try{null==duzon_dialog.toastObj&&(duzon_dialog.toastObj=document.createElement("div"),duzon_dialog.toastObj.className="duzon_toastmsg_box",duzon_dialog.toastObj.innerHTML=b,document.body.appendChild(duzon_dialog.toastObj),duzon_dialog.fade("in",duzon_dialog.toastObj),duzon_dialog.setObjectPosition(a,duzon_dialog.toastObj),setTimeout(function(){duzon_dialog.hideToastMessage()},1E3*c))}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.showToastMessage")}},hideToastMessage:function(){try{null!=
duzon_dialog.toastObj&&(duzon_dialog.fade("out",duzon_dialog.toastObj),setTimeout(function(){document.body.removeChild(duzon_dialog.toastObj);duzon_dialog.toastObj=null},500))}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.hideToastMessage")}},idx_openfile_form:"idx_duzon_openfile_form",idx_openfile_input:"idx_duzon_openfile_input",idx_openfile_iframe:"idx_duzon_openfile_iframe",nm_openfile_iframe:"nm_duzon_openfile_iframe",avail_openfile_ext:["html","htm","txt"],getOpenFileFormContent:function(){var a=
"<form method='post' id='"+this.idx_openfile_form+"' enctype='multipart/form-data' action=''>";a+="<input type='file' name='openfile' id='"+this.idx_openfile_input+"' accept='.html,.htm,.txt' />";return a=a+"</form>"+("<iframe name='"+this.nm_openfile_iframe+"' id='"+this.idx_openfile_iframe+"' src='' style='display:none'></iframe>")},docFormLeftContent:null,docFormRightContent:null,selectedDocCategoryNo:-1,selectedDocNo:-1,getDocFormContent:function(){try{var a=document.createElement("div");a.className=
"duzon_dialog_docform_container";var b=document.createElement("div");b.className="duzon_dialog_docform_left";var c=document.createElement("div");c.className="duzon_dialog_docform_left_title";c.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_AREA;this.docFormLeftContent=document.createElement("div");this.docFormLeftContent.className="duzon_dialog_docform_left_content";b.appendChild(c);b.appendChild(this.docFormLeftContent);var d=document.createElement("div");d.className="duzon_dialog_docform_right";var e=
document.createElement("div");e.className="duzon_dialog_docform_right_title";e.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_SELECT;this.docFormRightContent=document.createElement("div");this.docFormRightContent.className="duzon_dialog_docform_right_content";d.appendChild(e);d.appendChild(this.docFormRightContent);a.appendChild(b);a.appendChild(d);var f=null;this.dynamicScriptCall("const/file_docform_const.js",function(){for(var a=0;a<docformTemplateCategory.length;a++)f=document.createElement("div"),f.className=
"duzon_dialog_docform_category_list",f.innerHTML=docformTemplateCategory[a].category,function(){var c=a;f.onclick=function(){duzon_dialog.selectDocFormCategory(c)}}(),duzon_dialog.docFormLeftContent.appendChild(f);duzon_dialog.selectDocFormCategory(0)});return a}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.getDocFormContent")}},selectDocFormCategory:function(a){try{this.selectedDocCategoryNo=a;this.selectedDocNo=0;for(var b=this.docFormLeftContent.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=
c==a?"duzon_dialog_docform_category_list_select":"duzon_dialog_docform_category_list";this.docFormRightContent.innerHTML="";var d=null;for(c=0;c<docformTemplateCategory[a].data.length;c++)d=document.createElement("div"),d.className="duzon_dialog_docform_category_data",d.innerHTML=docformTemplateCategory[a].data[c].name,function(){var a=c;d.onclick=function(){duzon_dialog.selectDocFormData(a)};d.ondblclick=function(){duzon_dialog.selectDocFormData(a);duzon_dialog.inputSelectDocFormData()}}(),this.docFormRightContent.appendChild(d);
0<=this.selectedDocNo&&this.selectDocFormData(this.selectedDocNo)}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.selectDocFormCategory")}},selectDocFormData:function(a){try{this.selectedDocNo=a;for(var b=this.docFormRightContent.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_dialog_docform_category_data_select":"duzon_dialog_docform_category_data"}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectDocFormData")}},inputSelectDocFormData:function(){try{if(0>
this.selectedDocCategoryNo||0>this.selectedDocNo)alert(ID_RES_DIALOG_ALERT_SELECT_DOCFORM);else{var a=fnGetEditorHTMLCode(!1,this.nEditNumber);a=a.trim();if(""==a||"<p><br /></p>"==a||"<p><br></p>"==a||"<p>&nbsp;</p>"==a||"<p></p>"==a||"<br>"==a||"<br />"==a||confirm(ID_RES_DIALOG_CONFIRM_DOCFORM_DELETE_CONTENT))this.resetTableObjInfo(),replaceHTMLContent(docformTemplateCategory[this.selectedDocCategoryNo].data[this.selectedDocNo].html,this.nEditNumber),this.selectedDocNo=-1,this.layoutMode=!1;this.closeDialog()}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.inputSelectDocFormData")}},selectedLayoutNo:-1,layoutContainer:null,idx_dze_file_layout_container:"idx_dze_file_layout_container",getLayoutContent:function(){try{this.dynamicScriptCall("const/file_layout_const.js",function(){g_objCommonUtil.log("file_layout_const load ok")});this.layoutContainer=document.createElement("div");this.layoutContainer.className="duzon_dialog_content_medium";this.layoutContainer.id=this.idx_dze_file_layout_container;var a="";a+="<table cellspacing=0 cellpadding=0 border=0>";
for(var b=0,c=0,d="",e="",f=0;4>f;f++){a+="<tr>";for(var g=0;4>g;g++)c++,d=c,10>c&&(d="0"+c),e=dzeEnvConfig.strPath_Image+"dialog/popup_btn_layout_"+d+".png",a+="<td width='100'>",a+="\t<div class='duzon_file_layout_unit'><img src='"+e+"' width='98' height='98'/></div>",a+="</td>",3>g&&(a+="<td width='4'></td>"),b++;a+="</tr>";3>f&&(a+="<tr><td colspan='7' height='4'></td></tr>")}a+="</table>";this.selectedLayoutNo=-1;this.layoutContainer.innerHTML=a;return this.layoutContainer}catch(h){g_objCommonUtil.displayErrorAlert(h,
"duzon_dialog.getLayoutContent")}},addLayoutContentEvent:function(){try{for(var a=this.layoutContainer.getElementsByTagName("div"),b=0;b<a.length;b++)(function(){var c=b;a[b].onclick=function(){duzon_dialog.selectLayoutData(c)};a[b].onmouseover=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit_over")};a[b].onmouseout=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit")}})()}catch(c){g_objCommonUtil.displayErrorAlert(c,
"duzon_dialog.addLayoutContentEvent")}},selectLayoutData:function(a){try{this.selectedLayoutNo=a;g_objCommonUtil.log("this.selectedLayoutNo:"+this.selectedLayoutNo);for(var b=this.layoutContainer.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_file_layout_unit_select":"duzon_file_layout_unit"}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectLayoutData")}},layoutMode:!1,inputSelectLayoutData:function(){try{if(0>this.selectedLayoutNo)alert(ID_RES_DIALOG_ALERT_SELECT_LAYOUT_DESIGN);
else{g_objCommonUtil.log("inputSelectLayoutData this.selectedLayoutNo : "+this.selectedLayoutNo);var a=fnGetEditorHTMLCode(!1,this.nEditNumber);a=a.trim();if(""==a||"<p><br /></p>"==a||"<p><br></p>"==a||"<br>"==a||"<br />"==a||confirm(ID_RES_DIALOG_CONFIRM_LAYOUT_DELETE_CONTENT)){this.resetTableObjInfo();replaceHTMLContent(layoutTemplate[this.selectedLayoutNo],this.nEditNumber);this.layoutMode=!0;this.closeDialog();this.setLayoutStyleToTable(this.nEditNumber);var b=g_objEditorDocument[this.nEditNumber].body,
c=b.getElementsByTagName("H1");if(null!=c&&0<c.length){var d=c[0];duzon_dialog.setFocusElement(d,duzon_dialog.nEditNumber,"start")}else{var e=b.getElementsByTagName("P");null!=e&&0<e.length&&(d=e[0],duzon_dialog.setFocusElement(d,duzon_dialog.nEditNumber,"start"))}g_objEditWindow[duzon_dialog.nEditNumber].scrollTo(0,0)}else this.closeDialog()}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.inputSelectLayoutData")}},setLayoutStyleToTable:function(a){try{if(1==this.layoutMode){var b=g_objEditorDocument[a].body.getElementsByTagName("table");
for(a=0;a<b.length;a++){b[a].className="dze_tb_layout";for(var c=b[a].getElementsByTagName("*"),d=0;d<c.length;d++)if("th"==c[d].nodeName.toLowerCase()||"td"==c[d].nodeName.toLowerCase())c[d].className="dze_tb_layout_td"}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.setLayoutStyleToTable")}},setFocusElement:function(a,b,c){try{var d=!0;"undefined"!=typeof c&&"end"==c&&(d=!1);if(g_objEditorDocument[b].createRange){var e=g_objEditorDocument[b].createRange();e.selectNodeContents(a);e.collapse(d);
var f=g_objEditorDocument[b].getSelection();f.removeAllRanges();f.addRange(e)}else g_objEditorDocument[b].selection&&(e=g_objEditorDocument[b].body.createTextRange(),e.moveToElementText(a),e.collapse(d),e.select())}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.setFocusElement")}},selectElement:function(a,b){try{if(g_objEditorDocument[b].createRange){var c=g_objEditorDocument[b].createRange();c.selectNodeContents(a);var d=g_objEditorDocument[b].getSelection();d.removeAllRanges();d.addRange(c)}else g_objEditorDocument[b].selection&&
(c=g_objEditorDocument[b].body.createTextRange(),c.moveToElementText(a),c.select())}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.selectElement")}},idx_insertimage_radio_type1:"idx_insertimage_radio_type1",idx_insertimage_radio_type2:"idx_insertimage_radio_type2",idx_insertimage_upimage_txt:"idx_insertimage_upimage_txt",idx_insertimage_upurl_txt:"idx_insertimage_upurl_txt",idx_insertimage_checkbox_orgratio:"idx_insertimage_checkbox_orgratio",idx_insertimage_size_title:"idx_insertimage_size_title",
idx_insertimage_size_table:"idx_insertimage_size_table",idx_dze_upload_iframe:"idx_dze_upload_iframe",idx_dze_insertimage_width:"idx_dze_insertimage_width",idx_dze_insertimage_height:"idx_dze_insertimage_height",idx_dze_insertimage_align:"idx_dze_insertimage_align",idx_dze_org_imagesize:"idx_dze_org_imagesize",getInsertImageContent:function(a){try{var b=a==ID_RES_CONST_STRING_INSERT_IMAGE&&dzeUiConfig.bUseMultiImageInsert,c=document.createElement("div");c.className="duzon_dialog_insertimage_container";
a="";a+="<form name='dze_insert_image_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadImageURL+"' >";a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";a+="<tr>";!0===dzeUiConfig.bUseServerUpload&&(a+="<td width='80'><input type='radio' name='dze_insert_type' value='1' id='"+this.idx_insertimage_radio_type1+"' checked='true' /><label for='"+this.idx_insertimage_radio_type1+"' style='background: none;'>"+ID_RES_DIALOG_STRING_FILE_PATH+
"</label></td>",a+="<td>",a+=this.makeExtFileForm("dze_upimage_file",this.idx_insertimage_upimage_txt,"265px",[".png",".jpg",".gif",".jpeg"],b),a+="</td>",a+="</tr>",a+="<tr>",a+="<td colspan='2' height='5'></td>",a+="</tr>",a+="<tr>");a+="<td width='80'>";a=!0===dzeUiConfig.bUseServerUpload?a+("<input type='radio' name='dze_insert_type' value='2' id='"+this.idx_insertimage_radio_type2+"' /><label for='"+this.idx_insertimage_radio_type2+"' style='background: none;'>"+ID_RES_DIALOG_STRING_URL_INPUT+
"</label>"):a+ID_RES_DIALOG_STRING_URL_INPUT;a+="</td>";a+="<td><input type='text' name='dze_upimage_url' value='http://' id='"+this.idx_insertimage_upurl_txt+"' class='duzon_dialog_body_urlform' style='width: 263px' /></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title' id='"+this.idx_insertimage_size_title+"'>"+ID_RES_DIALOG_STRING_SIZE+"</div>";a+="<table id='"+this.idx_insertimage_size_table+"' width='100%' border='0' cellpadding='0' cellspacing='0'>";
a+="<tr>";a+="<td width='65'>"+ID_RES_DIALOG_STRING_WIDTH+"</td>";a+="<td width='90'><input type='text' name='dze_image_width' id='"+this.idx_dze_insertimage_width+"' class='duzon_dialog_body_textform' value='' size='5' /> px</td>";a+="<td></td>";a+="<td width='65'>"+ID_RES_DIALOG_STRING_HEIGHT+"</td>";a+="<td width='90'><input type='text' name='dze_image_height' id='"+this.idx_dze_insertimage_height+"' class='duzon_dialog_body_textform' value='' size='5' /> px</td>";a+="</tr>";a+="<tr>";a+="<td colspan='5' height='5'></td>";
a+="</tr>";a+="<tr>";a+="<td colspan='2'><input type='checkbox' name='dze_image_orgratio' value='1' id='"+this.idx_insertimage_checkbox_orgratio+"' checked='checked' /> "+ID_RES_DIALOG_STRING_KEEP_RATIO+"</td>";a+="<td></td>";a+="<td></td>";a+="<td><input type='button' value='"+ID_RES_DIALOG_STRING_SET_ORG+"' id='"+this.idx_dze_org_imagesize+"' style='margin: 0px !important;'/></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+
ID_RES_DIALOG_STRING_MARGIN+"</div>";a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";a+="<tr>";a+="<td width='65'>"+ID_RES_DIALOG_STRING_MARGIN_LEFT+"</td>";a+="<td width='90'>"+this.makeSpinnerInputForm("dze_image_marginleft","px",100,0)+"</td>";a+="<td></td>";a+="<td width='65'>"+ID_RES_DIALOG_STRING_MARGIN_TOP+"</td>";a+="<td width='90'>"+this.makeSpinnerInputForm("dze_image_margintop","px",100,0)+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='5' height='5'></td>";a+="</tr>";
a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_RIGHT+"</td>";a+="<td>"+this.makeSpinnerInputForm("dze_image_marginright","px",100,0)+"</td>";a+="<td></td>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_BOTTOM+"</td>";a+="<td>"+this.makeSpinnerInputForm("dze_image_marginbottom","px",100,0)+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='5' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_CONST_INSERT_IMAGE_PARAGRAPH_ALIGN+"</td>";a+="<td colspan='4'><select name='dze_image_align' id='"+this.idx_dze_insertimage_align+
"'><option value='default'>"+ID_RES_DIALOG_STRING_ALIGN_BASIC+"</option><option value='left'>"+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</option><option value='middle'>"+ID_RES_DIALOG_STRING_ALIGN_CENTER+"</option><option value='right'>"+ID_RES_DIALOG_STRING_ALIGN_RIGHT+"</option></select></td>";a+="</tr>";a+="</table>";a+="</form>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+"' style='width:100%;height:100px;display:none'></iframe>";c.innerHTML=a;duzon_dialog.initImageArray();
return c}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.getInsertImageContent")}},makeExtFileForm:function(a,b,c,d,e){d="undefined"==typeof d?"":d.join(",");"undefined"==typeof c&&(c="auto");c="<div style='width:"+c+"'><table width='100%' border='0' cellpadding='0' cellspacing='0' style='table-layout:fixed'><tr>";c+="<td><div class='duzon_dialog_upload_fileview_container' id='"+b+"_view'></div></td>";c+="<td width='4'></td>";c+="<td width='80' class='duzon_dialog_body_fileform_hide_td'>";
c+="<input type='button' value='"+ID_RES_CONST_STRING_EDIT_SEARCH+"' style='' class='duzon_dialog_btn_upload'>";c+="<input type='file' name='"+a+"' id='"+b+"'"+(!0===e?"multiple ":" ")+"class='duzon_dialog_body_fileform_hide' accept='"+d+"' />";c+="</td>";c+="</tr>";c+="</table>";return c+="</div>"},addEventExtFileForm:function(a,b){var c=g_objLayerKit.getElementById(a),d=g_objLayerKit.getElementById(a+"_view");c.onchange=function(){for(var a="",c=0,g=this.files.length;c<g;c++){var h=this.files[c].name;
-1<h.indexOf("\\")&&(h=h.split("\\").pop());-1<h.indexOf("/")&&(h=h.split("/").pop());0!=c&&(a+=" ");a+='"'+h+'"'}d.innerHTML="<div style='width:1000px;overflow:hidden'>"+a+"</div>";"undefined"!=typeof b&&b()};c.onmouseover=function(){this.previousSibling.style.backgroundColor="#f2f2f2"};c.onmousedown=function(){this.previousSibling.style.backgroundColor="#d9d9d9"};c.onmouseup=function(){this.previousSibling.style.backgroundColor="#f2f2f2"};c.onmouseout=function(){this.previousSibling.style.backgroundColor=
""};d.onmouseover=function(){this.title=this.innerText}},disableExtFileForm:function(a){g_objLayerKit.getElementById(a).disabled=!0;g_objLayerKit.getElementById(a).style.cursor="default";g_objNodeUtil.getLoopParentElement(g_objLayerKit.getElementById(a),"table").style.opacity="0.3"},enableExtFileForm:function(a){g_objLayerKit.getElementById(a).disabled=!1;g_objLayerKit.getElementById(a).style.cursor="pointer";g_objNodeUtil.getLoopParentElement(g_objLayerKit.getElementById(a),"table").style.opacity=
"1"},addEventImageUrlForm:function(a,b){"undefined"!=typeof b&&null!=b&&""!=b&&(a=g_objLayerKit.getElementById(a),a.onpaste=function(){setTimeout(function(){b()},100)},a.onkeydown=function(a){(a?a:g_objLayerKit.getLayerWindow().event).keyCode==ID_KEYCODE_ENTER&&b()},a.onblur=function(){b()})},disableImageUrlForm:function(a){g_objLayerKit.getElementById(a).disabled=!0;g_objLayerKit.getElementById(a).style.opacity="0.3"},enableImageUrlForm:function(a){g_objLayerKit.getElementById(a).disabled=!1;g_objLayerKit.getElementById(a).style.opacity=
"1"},defaultSpinnerInputMaxValue:500,defaultSpinnerInputMinValue:0,makeSpinnerInputForm:function(a,b,c,d,e,f){try{"undefined"==typeof b&&(b="");"undefined"==typeof c&&(c=this.defaultSpinnerInputMaxValue);"undefined"==typeof d&&(d=this.defaultSpinnerInputMinValue);"undefined"==typeof e&&(e="");"undefined"==typeof f&&(f="");var g="";g+="<table align='' border='0' cellpadding='0' cellspacing='0'>";g+="<tr>";g+="<td>";g+="<table align='' border='1' cellpadding='0' cellspacing='0' class='duzon_spinner_input_form_container'>";
g+="<tr>";g+="<td style='line-height:0;' height='18'><input type='text' name='"+a+"' id='"+a+"' value='"+e+"' class='duzon_spinner_input_form' size='5' onfocus='this.select()' onblur=\"duzon_dialog.spinnValCheck(this,'"+c+"','"+d+"')\" /></td>";g+="<td style='line-height:0;'>";g+="<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\" onclick=\"duzon_dialog.spinnUp('"+
a+"','"+c+"','"+d+"','"+f+"')\"><img src='"+dzeEnvConfig.strPath_Image+"dialog/btn_arrow_up.png' alt='' width='5' height='3'></div>";g+="<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\" onclick=\"duzon_dialog.spinnDown('"+a+"','"+c+"','"+d+"','"+f+"')\"><img src='"+dzeEnvConfig.strPath_Image+
"dialog/btn_arrow_down.png' alt='' width='5' height='3' border='0'></div>";g+="</td>";g+="</tr>";g+="</table>";""!=b&&(g+="<td>",g+="<table align='left' border='0' cellpadding='0' cellspacing='0'>",g+="<tr height='20'>",g+="<td width='6'></td>",g+="<td>"+b+"</td>",g+="</tr>",g+="</table>",g+="</td>");g+="</td>";return g+"</tr></table>"}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.makeSpinnerInputForm")}},spinnUp:function(a,b,c,d){try{var e=g_objLayerKit.getElementById(a);null==e&&duzon_dialog.clearSpinnerBtnMDownTimer();
if(1!=e.disabled){""==e.value&&(e.value=c-1);b=parseInt(b,10);if(parseInt(e.value,10)+1<=parseInt(b,10))return e.value=parseInt(e.value,10)+1,""!=d&&eval(d)(e.value),e.focus(),!0;duzon_dialog.clearSpinnerBtnMDownTimer();alert(ID_RES_DIALOG_ALERT_MAX_VALUE+b);return!1}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.spinnUp")}},spinnDown:function(a,b,c,d){try{var e=g_objLayerKit.getElementById(a);null==e&&duzon_dialog.clearSpinnerBtnMDownTimer();if(1!=e.disabled){""==e.value&&(e.value=c);
c=parseInt(c,10);if(parseInt(e.value,10)-1>=c)return e.value=parseInt(e.value,10)-1,""!=d&&eval(d)(e.value),e.focus(),!0;duzon_dialog.clearSpinnerBtnMDownTimer();alert(ID_RES_DIALOG_ALERT_MIN_VALUE+c);return!1}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.spinnDown")}},spinnValCheck:function(a,b,c){try{1!=checkNumber(a.value)?(alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),a.value="",a.focus()):(b=parseInt(b,10),c=parseInt(c,10),val=parseInt(a.value,10),val>b?(alert(ID_RES_DIALOG_ALERT_MAX_VALUE+
b),a.value=b,a.select()):val<c&&(alert(ID_RES_DIALOG_ALERT_MIN_VALUE+c),a.value=c,a.select()))}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.spinnValCheck")}},setEnableSpinner:function(a,b){try{var c=$_(a).parentNode.nextSibling.childNodes;1==b?($_(a).className="duzon_spinner_input_form",$_(a).disabled=!1,c[0].className="duzon_spinner_btn_arrow_up",c[1].className="duzon_spinner_btn_arrow_up"):($_(a).className="duzon_spinner_input_form_disabled",$_(a).disabled=!0,c[0].className="duzon_spinner_btn_arrow_disabled",
c[1].className="duzon_spinner_btn_arrow_disabled")}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.setEnableSpinner")}},spinnerBtnMDownTimer1:null,spinnerBtnMDownTimer2:null,modifySpinnerValue:function(a,b,c,d,e){try{var f=g_objLayerKit.getElementById(a).parentNode.nextSibling.childNodes,g=g_objLayerKit.getElementById(a);"undefined"!=typeof d&&null!=d&&(g.value=d);"undefined"==typeof e&&(e="");f[0].getAttribute("onclick")&&f[0].removeAttribute("onclick");f[0].onclick=null;f[1].getAttribute("onclick")&&
f[1].removeAttribute("onclick");f[1].onclick=null;g.getAttribute("onblur")&&g.removeAttribute("onblur");g.onblur=null;f[0].onmousedown=function(d){(d?d:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(d=duzon_dialog.spinnUp(a,b,c,e),this.className="duzon_spinner_btn_arrow_down",d&&(duzon_dialog.spinnerBtnMDownTimer1=setTimeout(function(){duzon_dialog.spinnerBtnMDownTimer2=setInterval(function(){duzon_dialog.spinnUp(a,b,c,e)},70)},500)))};f[0].onmouseup=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();
this.className="duzon_spinner_btn_arrow_over"};f[0].onmouseout=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_up"};f[0].onmouseover=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};f[1].onmousedown=function(d){(d?d:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(d=duzon_dialog.spinnDown(a,b,c,e),this.className="duzon_spinner_btn_arrow_down",d&&(duzon_dialog.spinnerBtnMDownTimer1=setTimeout(function(){duzon_dialog.spinnerBtnMDownTimer2=
setInterval(function(){duzon_dialog.spinnDown(a,b,c,e)},70)},500)))};f[1].onmouseup=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};f[1].onmouseout=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_up"};f[1].onmouseover=function(a){duzon_dialog.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};g.onblur=function(){duzon_dialog.spinnValCheck(this,b,c)};g.onkeydown=function(d){try{var f=
d?d:window.event;"undefined"==typeof f||null==f?g_objCommonUtil.log("IE8 -> Not Support"):(f.keyCode==ID_KEYCODE_ARROW_TOP&&duzon_dialog.spinnUp(this.id,b,c,e),f.keyCode==ID_KEYCODE_ARROW_BOTTOM&&duzon_dialog.spinnDown(a,b,c,e))}catch(l){}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.modifySpinnerValue")}},clearSpinnerBtnMDownTimer:function(){try{duzon_dialog.spinnerBtnMDownTimer1&&clearInterval(duzon_dialog.spinnerBtnMDownTimer1),duzon_dialog.spinnerBtnMDownTimer2&&clearInterval(duzon_dialog.spinnerBtnMDownTimer2),
duzon_dialog.spinnerBtnMDownTimer1=null,duzon_dialog.spinnerBtnMDownTimer2=null}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:clearSpinnerBtnMDownTimer")}},insertImageForm:function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;if(!0===dzeUiConfig.bUseServerUpload&&1==a.dze_insert_type[0].checked)if(!0===dzeUiConfig.bUseImageExtUpload)g_objExtUploader.initWithUploadItem(a,!1);else{duzon_http.showLoading();var b=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe);
b.attachEvent?b.attachEvent("onload",duzon_dialog.onloadActionIframeInsertImage):b.addEventListener("load",duzon_dialog.onloadActionIframeInsertImage,!1);a.submit()}else if(!1===dzeUiConfig.bUseServerUpload||1==a.dze_insert_type[1].checked)""==g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).value||"http://"==g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).value?(a.dze_image_width.value="",a.dze_image_height.value="",duzon_dialog.arrEditingImg=[]):(duzon_http.showLoading(),
duzon_dialog.urlImgObj=null,duzon_dialog.getImageObj(a.dze_upimage_url.value,function(a){duzon_http.hideLoading();duzon_dialog.urlImgObj=a;duzon_dialog.arrEditingImg=[a];duzon_dialog.insertOrgImageSize()},function(){duzon_http.hideLoading();a.dze_image_width.value="";a.dze_image_height.value=""}))}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.insertImageForm")}},onloadActionIframeInsertImage:function(){try{duzon_http.hideLoading();var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe).contentWindow.document.body.innerHTML,
b=duzon_http.parseJSON(a);if("success"!=b.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),duzon_dialog.clearFileNameInImageForm();else{DZE_UPLOAD_EVENT.setComplete(duzon_dialog.nEditNumber,b);duzon_dialog.arrUpImgObj=[];var c=Array.isArray(b.url)?b.url:[b.url],d=Array.isArray(b.filename)?b.filename:[b.filename];duzon_dialog.getImageObjArray(c,function(a){a=duzon_dialog.filterNullImage(a,d,!0);duzon_dialog.arrUpImgObj=a;duzon_dialog.arrEditingImg=a;duzon_dialog.insertOrgImageSize()},function(a){!0===
dzeUiConfig.bUseServerUpload&&(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upimage_txt).value="");alert(ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE)})}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.onloadActionIframeInsertImage"),duzon_http.hideLoading()}},onradiochange_insertType:function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;1==a.dze_insert_type[0].checked&&0<duzon_dialog.arrUpImgObj.length?(duzon_dialog.arrEditingImg=duzon_dialog.arrUpImgObj,duzon_dialog.insertOrgImageSize()):
1==a.dze_insert_type[1].checked&&duzon_dialog.urlImgObj&&(duzon_dialog.arrEditingImg=[duzon_dialog.urlImgObj],duzon_dialog.insertOrgImageSize())}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:onradiochange_insertType")}},checkDzeInsertType:function(a){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form;1==b.dze_insert_type[0].checked&&(!0===dzeUiConfig.bUseServerUpload&&duzon_dialog.enableExtFileForm(duzon_dialog.idx_insertimage_upimage_txt),duzon_dialog.disableImageUrlForm(duzon_dialog.idx_insertimage_upurl_txt));
1==b.dze_insert_type[1].checked&&(!0===dzeUiConfig.bUseServerUpload&&duzon_dialog.disableExtFileForm(duzon_dialog.idx_insertimage_upimage_txt),duzon_dialog.enableImageUrlForm(duzon_dialog.idx_insertimage_upurl_txt),g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).select())}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.checkDzeInsertType")}},modInsertImageResize:function(a,b){try{var c=g_objLayerKit.getLayerDocument().dze_insert_image_form;null==duzon_dialog.arrEditingImg[0]?
(alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE),c.dze_image_width.value="",c.dze_image_height.value=""):0==checkNumber(a.value)?(alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),this.insertOrgImageSize(),a.focus()):""!=a.value&&1==c.dze_image_orgratio.checked&&("width"==b&&(c.dze_image_height.value=Math.floor(parseInt(a.value,10)*duzon_dialog.imgRatio)),"height"==b&&(c.dze_image_width.value=Math.floor(parseInt(a.value,10)/duzon_dialog.imgRatio)))}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.modInsertImageResize")}},
setImageOrgRatio:function(a){try{if(1==a.checked){var b=g_objLayerKit.getElementById(this.idx_dze_insertimage_width);this.modInsertImageResize(b,"width")}}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.setImageOrgRatio")}},insertOrgImageSize:function(a){try{for(var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,c=0,d=duzon_dialog.arrEditingImg.length;c<d;c++){var e=duzon_dialog.arrEditingImg[c];if(null==e){!1!==a&&alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE);b.dze_image_width.value=
"";b.dze_image_height.value="";return}var f=document.getElementById("dzeditor_"+duzon_dialog.nEditNumber),g=g_objEditorDocument[duzon_dialog.nEditNumber].body,h=g_objPropertyUtil.getElementStyleAttributeValue(g,"margin-left",duzon_dialog.nEditNumber),k=g_objPropertyUtil.getElementStyleAttributeValue(g,"margin-right",duzon_dialog.nEditNumber),l=f.offsetWidth-(parseInt(h)+parseInt(k)),m=e.width,n=e.height;if(m>l){var q=m/l;e.style.width=m/q;e.style.height=n/q}}var p=duzon_dialog.arrEditingImg[0];p&&
(b.dze_image_width.value=p.width,b.dze_image_height.value=p.height,duzon_dialog.imgRatio=parseInt(p.height,10)/parseInt(p.width,10));duzon_dialog.enableImageSizeForm(1>=duzon_dialog.arrEditingImg.length)}catch(r){g_objCommonUtil.displayErrorAlert(r,"duzon_dialog.insertOrgImageSize")}},enableImageSizeForm:function(a){try{var b=duzon_dialog;a?(g_objLayerKit.getElementById(b.idx_dze_insertimage_width).disabled=!1,g_objLayerKit.getElementById(b.idx_dze_insertimage_height).disabled=!1,g_objLayerKit.getElementById(b.idx_insertimage_checkbox_orgratio).disabled=
!1,g_objLayerKit.getElementById(b.idx_dze_org_imagesize).disabled=!1,g_objLayerKit.getElementById(b.idx_insertimage_size_title).style.opacity="",g_objLayerKit.getElementById(b.idx_insertimage_size_table).style.opacity=""):(g_objLayerKit.getElementById(b.idx_dze_insertimage_width).disabled=!0,g_objLayerKit.getElementById(b.idx_dze_insertimage_height).disabled=!0,g_objLayerKit.getElementById(b.idx_insertimage_checkbox_orgratio).disabled=!0,g_objLayerKit.getElementById(b.idx_dze_org_imagesize).disabled=
!0,g_objLayerKit.getElementById(b.idx_insertimage_size_title).style.opacity=.3,g_objLayerKit.getElementById(b.idx_insertimage_size_table).style.opacity=.3)}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.enableImageSizeForm")}},removeFileNameInImageForm:function(a){try{if(!1!==dzeUiConfig.bUseServerUpload){var b=g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upimage_txt+"_view"),c=b?b.firstChild:null;if(c){var d=c.innerHTML;d=d.replace(/"/g,"|");d=d.replace(/'/g,"|");var e=d.split("|");
b="";d=0;for(var f=e.length;d<f;d++){var g=e[d].trim();g&&g!=a&&(b+='"'+e[d]+'" ')}b=b.trim();c.innerHTML=b}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.removeImageFileNameForm")}},clearFileNameInImageForm:function(){try{if(!1!==dzeUiConfig.bUseServerUpload){var a=g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upimage_txt+"_view"),b=a?a.firstChild:null;b&&(b.innerHTML="")}}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.clearFileNameInImageForm")}},arrEditingImg:[],
arrUpImgObj:[],urlImgObj:null,imgRatio:1,initImageArray:function(){try{duzon_dialog.arrEditingImg=[],duzon_dialog.arrUpImgObj=[],duzon_dialog.urlImgObj=null,duzon_dialog.imgRatio=1}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.initUploadImageArray")}},getImageObj:function(a,b,c){try{var d=new Image;d.src=a;d.onload=function(){b(d)};d.onerror=function(){c(a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.getImageObj"),c&&c()}},getImageObjArray:function(a,b,c){try{if(!a.length||
0==a.length)return!1;for(var d=[],e=0,f=a.length;e<f;e++)d[e]=void 0;var g=function(){var e;if(e=b&&c)a:{e=0;for(var f=d.length;e<f;e++)if(void 0===d[e]){e=!1;break a}e=!0}if(e){a:{e=0;for(f=d.length;e<f;e++)if(d[e]){e=!1;break a}e=!0}e?c(a):b(d);return!0}return!1};a.forEach(function(a,c){duzon_dialog.getImageObj(getFullUrlFromPath(a),function(a){d[c]=a;g()},function(a){d[c]=null;g()})});return!0}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.getImageObjArray"),c&&c()}},filterNullImage:function(a,
b,c){try{if(!a)return!1;var d="";a=a.filter(function(a,c){return null==a?(b&&b[c]&&(duzon_dialog.removeFileNameInImageForm(b[c]),d+=d?", "+b[c]:b[c]),!1):!0});c&&d&&alert(ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE+" ("+d+")");return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.filterNullImage")}},idx_paste_special_type_text:"idx_duzon_paste_special_type_text",idx_paste_special_type_html:"idx_duzon_paste_special_type_html",getPastespecial:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";
a+="\t<div style='margin-bottom:5px;'><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_text+"' value='text' /> "+ID_RES_DIALOG_STRING_NO_STYLE_TEXT+"</div>";a+="\t<div><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_html+"' value='html' checked> "+ID_RES_DIALOG_STRING_HTML_STYLE_TEXT+"</div>";return a+"</div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getPastespecial")}},idxTabContainer:"idxDuzonTabContainer",tabTitleContainer:null,
tabBodyContainer:null,tabDefaultContainer:null,tabBottomContainer:null,defaultTabSize:60,tabOnloadCallbacks:[],getTabContents:function(a,b,c,d,e,f){try{g_objCommonUtil.log("typeof(tabSizeArray):"+typeof d);if("undefined"==typeof d){d=[];for(var g=0;g<a;g++)d[g]=this.defaultTabSize}var h=0;for(g=0;g<a;g++)"undefined"==typeof d[g]&&(d[g]=this.defaultTabSize),h+=d[g];this.tabOnloadCallbacks=[];if("undefined"==typeof f)for(g=0;g<a;g++)this.tabOnloadCallbacks.push(function(){});else for(g=0;g<a;g++)"undefined"==
typeof f[g]?this.tabOnloadCallbacks.push(function(){}):this.tabOnloadCallbacks.push(f[g]);this.tabTitleContainer=document.createElement("div");this.tabTitleContainer.className="duzon_dialog_tab_container";this.tabTitleContainer.id=this.idxTabContainer;var k=document.createElement("div");k.className="duzon_dialog_tab_title_blank_left";this.tabTitleContainer.appendChild(k);var l=null;for(g=0;g<a;g++)l=document.createElement("div"),l.className="duzon_dialog_tab_titles_off",l.style.width=d[g]+"px",l.innerHTML=
b[g],function(){var a=g;l.onclick=function(){duzon_dialog.viewTabContents(a)}}(),this.tabTitleContainer.appendChild(l);var m=document.createElement("div");m.className="duzon_dialog_tab_title_blank_right";m.style.marginLeft=h+2+14+"px";this.tabTitleContainer.appendChild(m);this.tabBodyContainer=document.createElement("div");this.tabBodyContainer.className="duzon_dialog_tab_body_container";b=null;for(g=0;g<a;g++)b=document.createElement("div"),b.className="duzon_dialog_tab_body_container_off","object"==
typeof c[g]?b.appendChild(c[g]):"string"==typeof c[g]&&(b.innerHTML=c[g]),this.tabBodyContainer.appendChild(b);this.tabDefaultContainer=document.createElement("div");this.tabDefaultContainer.className="duzon_dialog_tab_default_container";"undefined"!=typeof e&&("object"==typeof e?this.tabDefaultContainer.appendChild(e):"string"==typeof e&&(this.tabDefaultContainer.innerHTML=e));this.tabBottomContainer=document.createElement("div");this.tabBottomContainer.className="duzon_dialog_tab_bottom_container";
var n=document.createElement("div");n.appendChild(this.tabTitleContainer);n.appendChild(this.tabBodyContainer);n.appendChild(this.tabDefaultContainer);n.appendChild(this.tabBottomContainer);this.tabType=!0;return n}catch(q){g_objCommonUtil.displayErrorAlert(q,"duzon_dialog.getTabContents")}},viewTabContents:function(a){try{g_objCommonUtil.log("viewTabContents tabIdx:"+a);for(var b=this.tabTitleContainer.getElementsByTagName("div"),c=1;c<b.length-1;c++)b[c].className=a+1==c?"duzon_dialog_tab_titles_on":
"duzon_dialog_tab_titles_off";var d=this.tabBodyContainer.getElementsByTagName("div");b=[];for(c=0;c<d.length;c++)"duzon_dialog_tab_body_container_on"!=d[c].className&&"duzon_dialog_tab_body_container_off"!=d[c].className||b.push(d[c]);for(c=0;c<b.length;c++)b[c].className=a==c?"duzon_dialog_tab_body_container_on":"duzon_dialog_tab_body_container_off";this.tabOnloadCallbacks[a]()}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.viewTabContents")}},getSampleTabContent1:function(){return this.getTabContents(1,
["\uc77c\ubc18"],["<div style='width:300px;height:60px;background-color:green'>\uc77c\ubc18\ud0ed \ub0b4\uc6a9</div>"],[80],"<div style='width:300px;height:30px;background-color:yellow'>\uc774\uacf3\uc740 \uae30\ubcf8 \ucd9c\ub825 \uc601\uc5ed\uc785\ub2c8\ub2e4.</div>",[function(){g_objCommonUtil.log("\uc77c\ubc18\ud0ed \uc120\ud0dd\ub428")}])},getSampleTabContent3:function(){return this.getTabContents(3,["\uc77c\ubc18","\ud14c\ub450\ub9ac","\ubc30\uacbd"],["<div style='width:300px;height:60px;background-color:green'>\uc77c\ubc18\ud0ed \ub0b4\uc6a9</div>",
"<div style='width:300px;height:60px;background-color:orange'>\ud14c\ub450\ub9ac\ud0ed \ub0b4\uc6a9</div>","<div style='width:300px;height:60px;background-color:skyblue'>\ubc30\uacbd\ud0ed \ub0b4\uc6a9</div>"],[80,80,60],"<div style='width:300px;height:30px;background-color:yellow'>\uc774\uacf3\uc740 \uae30\ubcf8 \ucd9c\ub825 \uc601\uc5ed\uc785\ub2c8\ub2e4.</div>",[function(){g_objCommonUtil.log("\uc77c\ubc18\ud0ed \uc120\ud0dd\ub428")},function(){g_objCommonUtil.log("\ud14c\ub450\ub9ac\ud0ed \uc120\ud0dd\ub428")},
function(){g_objCommonUtil.log("\ubc30\uacbd\ud0ed \uc120\ud0dd\ub428")}])},idx_duzon_find_text:"idx_duzon_find_text",idx_duzon_replace_text:"idx_duzon_replace_text",idx_find_text_box:"idx_duzon_find_text_box",idx_replace_text_box:"idx_duzon_replace_text_box",getReplaceFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="\t<div id='"+this.idx_find_text_box+"' class='duzon_dialog_find_form_container'>"+ID_RES_DIALOG_STRING_FIND_TEXT+": <input type='text' name='dze_find_text' id='"+
this.idx_duzon_find_text+"' value='' size='30' class='duzon_findtext_frm' /></div>";a+="\t<div id='"+this.idx_replace_text_box+"' class='duzon_dialog_find_form_container'>"+ID_RES_DIALOG_STRING_REPLACE_TEXT+": <input type='text' name='dze_replace_text' id='"+this.idx_duzon_replace_text+"' value='' size='30' class='duzon_replacetext_frm' /></div>";return a+"</div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getReplaceFormText")}},idx_casesensitive:"idx_casesensitive",idx_ignorespace:"idx_ignorespace",
idx_findforward:"idx_findforward",idx_findbackward:"idx_findbackward",isFindDialog:!1,getFindOptionFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIND_OPTION+"</div>";a+="\t<div class='duzon_dialog_string_divline'>";a+="\t\t<input type='checkbox' name='dze_casesensitive' id='"+this.idx_casesensitive+"' value='1' /> "+ID_RES_DIALOG_STRING_CASESENSITIVE;
a+="\t\t<input type='checkbox' name='dze_completeword' id='"+this.idx_completeword+"' value='1' /> "+ID_RES_DIALOG_STRING_COMPLETEWORD;a+="\t</div>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIND_DERECTION+"</div>";a+="\t<div>";a+="\t\t<input type='radio' name='dze_direction' id='"+this.idx_findforward+"' value='0' checked /> "+ID_RES_DIALOG_STRING_FIND_DOWN;a+="\t\t<input type='radio' name='dze_direction' id='"+this.idx_findbackward+
"' value='1'/> "+ID_RES_DIALOG_STRING_FIND_UP;return a+"\t</div></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getFindOptionFormText")}},strFindText:"",getFindReplaceContent:function(){try{return this.getTabContents(2,[ID_RES_CONST_STRING_EDIT_SEARCH,ID_RES_CONST_STRING_EDIT_REPLACE],["",""],[60,60],this.getReplaceFormText()+this.getFindOptionFormText(),[function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.display="none";g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus();
var a=duzon_dialog.dialog_buttonbox_obj.getElementsByTagName("input");g_objCommonUtil.log("btnObj[0]:"+a[0].value);a[0].style.display="none";a[1].style.display="none"},function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.display="inline";var a=duzon_dialog.dialog_buttonbox_obj.getElementsByTagName("input");a[0].style.display="inline";a[1].style.display="inline";""==g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value?g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus():
g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).focus()}])}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.getFindReplaceContent")}},idx_dze_ext_movie_source:"idx_dze_ext_movie_source",idx_dze_movie_align_form:"idx_dze_movie_align_form",getInsertExtMovieContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_INPUT_SOURCE+"</div>";a+="<div class=''><textarea name='dze_ext_movie_source' id='"+
this.idx_dze_ext_movie_source+"' class='dze_ext_movie_source_form' placeholder='"+ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE+"'></textarea></div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_LEFT+" :</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_marginleft","px","500",
"0","0")+"</td>";a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_TOP+" :</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_margintop","px","500","0","0")+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_RIGHT+" :</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginright","px","500","0","0")+"</td>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_BOTTOM+" :</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginbottom",
"px","500","0","0")+"</td>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="</tr>";a+="<tr>";a+="<td colspan='2'>"+ID_RES_CONST_STRING_ALIGN+" : <select name='dze_movie_align' id='"+this.idx_dze_movie_align_form+"'><option value='default'>"+ID_RES_DIALOG_STRING_ALIGN_BASIC+"</option><option value='left'>"+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</option><option value='center'>"+ID_RES_DIALOG_STRING_ALIGN_CENTER+"</option><option value='right'>"+ID_RES_DIALOG_STRING_ALIGN_RIGHT+"</option></select></td>";
a+="<td colspan='2' align='right'></td>";a+="</tr>";return a+"</table></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getInsertExtMovieContent")}},insertExtMovieContent:function(){try{var a=g_objLayerKit.getElementById(this.idx_dze_ext_movie_source);source=a.value.trim();if(""==source)return alert(ID_RES_DIALOG_STRING_INPUT_MOVIE_SOURCE),a.focus(),!1;a=g_objLayerKit.getLayerDocument().createElement("div");a.innerHTML=source;var b=a.getElementsByTagName("iframe");if(0>b.length&&
(b=a.getElementsByTagName("object"),0>b.length)){alert(ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE);return}"default"!=g_objLayerKit.getElementById(this.idx_dze_movie_align_form).value&&(a.style.textAlign=g_objLayerKit.getElementById(this.idx_dze_movie_align_form).value);""!=g_objLayerKit.getElementById("dze_movie_marginleft").value&&(a.style.marginLeft=g_objLayerKit.getElementById("dze_movie_marginleft").value+"px");""!=g_objLayerKit.getElementById("dze_movie_margintop").value&&(a.style.marginTop=g_objLayerKit.getElementById("dze_movie_margintop").value+
"px");""!=g_objLayerKit.getElementById("dze_movie_marginright").value&&(a.style.marginRight=g_objLayerKit.getElementById("dze_movie_marginright").value+"px");""!=g_objLayerKit.getElementById("dze_movie_marginbottom").value&&(a.style.marginBottom=g_objLayerKit.getElementById("dze_movie_marginbottom").value+"px");a.style.width="auto";a.style.height="auto";a.style.overflow="auto";var c=g_objLayerKit.getLayerDocument().createElement("div");c.appendChild(a);this.closeDialog();addHTMLContent(c.innerHTML,
null,0,this.nEditNumber);return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.insertExtMovieContent")}},idx_dze_insert_extfile_link_box:"idx_dze_insert_extfile_link_box",idx_dze_insert_extfile_text:"idx_dze_insert_extfile_text",idx_dze_up_extfile:"idx_dze_up_extfile",allow_file_ext_array:"doc docx xls xlsx ppt pptx hwp txt pdf".split(" "),getInsertExtFileContent:function(){try{for(var a=[],b=0;b<this.allow_file_ext_array.length;b++)a.push("."+this.allow_file_ext_array[b]);var c=a.join(",");
a="";a+="<div class='duzon_dialog_content_medium'>";a+="<form name='dze_insert_extfile_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadExtFileURL+"' >";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='100'>"+ID_RES_DIALOG_STRING_FILE_PATH+" : </td><td></label> <input type='file' name='dze_up_extfile' value='' id='"+this.idx_dze_up_extfile+"' onchange='duzon_dialog.uploadExtFile()' accept='"+c+
"' class='duzon_dialog_body_fileform' /></td>";a+="</tr>";a+="<tr>";a+="<td height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_VIEW_TEXT+" : </td><td></label> <input type='text' name='dze_up_extfile_title' value='' size='256' id='"+this.idx_dze_insert_extfile_text+"' class='duzon_dialog_body_urlform' /></td>";a+="</tr>";a+="</table>";a+="</form>";a+="<div id='"+this.idx_dze_insert_extfile_link_box+"' style='display:none'></div>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+
"' style='width:100%;height:100px;display:none'></iframe>";return a+"</div>"}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.getInsertExtFileContent")}},uploadExtFile:function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_extfile_form,b=a.dze_up_extfile.value.split(".").pop().toLowerCase();if(!0!==this.checkInsertFileExt(b))alert(this.allow_file_ext_array.join(",")+" "+ID_RES_DIALOG_ALERT_ALLOW_FORMAT),a.dze_up_extfile.value="";else{var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe);
c.attachEvent?c.attachEvent("onload",duzon_dialog.onloadActionIframeInsertExtFile):c.addEventListener("load",duzon_dialog.onloadActionIframeInsertExtFile,!1);a.submit()}}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.uploadExtFile")}},onloadActionIframeInsertExtFile:function(){try{var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe).contentWindow.document.body.innerHTML,b=duzon_http.parseJSON(a);if("success"!=b.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);else{DZE_UPLOAD_EVENT.setComplete(duzon_dialog.nEditNumber,
b);var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).value.split(".").pop().toLowerCase(),d=duzon_dialog.setFileExtIconPath(c),e=1==dzeUiConfig.attachFileExtIconView?"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+"' style=\"background-image: url("+d+');background-repeat: no-repeat;background-position: left top;padding:2px 0 2px 18px;margin:0 8px 0 8px;color:#000000;text-decoration:none;font-weight:bold;"  >'+b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+
" ":"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+'\' style="color:#000000;text-decoration:none;font-weight:bold;"  >'+b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+" ";g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box).innerHTML=e;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=b.filename}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.onloadActionIframeInsertExtFile")}},insertExtFileContent:function(){try{var a=
g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box);if(""==a.innerHTML.trim())alert(ID_RES_DIALOG_ALERT_SELECTFILE),g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).focus();else{var b=a.getElementsByTagName("a")[0];b.title=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;b.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;var c=a.innerHTML;this.closeDialog();addHTMLContent(c,null,0,this.nEditNumber)}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"duzon_dialog.insertExtFileContent")}},checkInsertFileExt:function(a){try{a=a.toLowerCase();for(var b=!1,c=0;c<this.allow_file_ext_array.length;c++)if(this.allow_file_ext_array[c]==a){b=!0;break}return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.checkInsertFileExt")}},setFileExtIconPath:function(a){try{a=a.toLowerCase();var b="toolbar_btn_insert_file.png";!0===this.checkInsertFileExt(a)&&("docx"==a&&(a="doc"),"xlsx"==a&&(a="xls"),"pptx"==a&&(a="ppt"),b="ico_"+a+".png");return dzeEnvConfig.strPath_Image+
"toolbar/"+b}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.setFileExtIconPath")}},modifyExtFileContent:function(){try{this.setEditorSelection();var a=getSelectionParentElement(duzon_dialog.nEditNumber,"A");null!=a&&(a.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value,a.title=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value);this.closeDialog()}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.modifyExtFileContent")}},
nInsTypeIdx:0,insTypeInfo:[{},{}],leftInsTypeContent:null,rightInsTypeContent:null,curCategoryIdx:[0,0],curCategoryItem:[{},{}],recentItemList:[{},{}],recentItemListMaxViewCnt:[9,5],recentItemListCurViewIdx:[0,0],recentItemListMaxCnt:[30,30],dze_idx_recent_data_area:"dze_idx_recent_data_area",dze_idx_instype_recent_btn_pre:"",dze_idx_instype_recent_btn_next:"",makeInsTypeInfo:function(){try{this.insTypeInfo[0]={strInsType:"specialchars",strLTitle:ID_RES_DIALOG_STRING_CHARACTER_AREA,strRTitle:ID_RES_DIALOG_STRING_CHARACTER_SELECT,
strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_CHARACTER,jsSrc:"const/insert_specialchars_const.js",refInfoDB:"dzeSpecialchars"},this.insTypeInfo[1]={strInsType:"emoticons",strLTitle:ID_RES_DIALOG_STRING_CATEGORY_AREA,strRTitle:ID_RES_DIALOG_STRING_EMOTICON_SELECT,strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_EMOTICONS,jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons"}}catch(a){}},getInsertTypeContent:function(){try{var a=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;
this.dze_idx_instype_recent_btn_pre="dze_idx_"+a+"_recent_btn_pre";this.dze_idx_instype_recent_btn_next="dze_idx_"+a+"_recent_btn_next";var b=document.createElement("div");b.className="duzon_dialog_content_medium";var c=document.createElement("div");c.className="dze_"+a+"_left_container";var d=document.createElement("div");d.className="dze_dlg_left_title";d.innerHTML=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strLTitle+":";this.leftInsTypeContent=document.createElement("div");this.leftInsTypeContent.className=
"dze_"+a+"_left_content";c.appendChild(d);c.appendChild(this.leftInsTypeContent);var e=document.createElement("div");e.className="dze_"+a+"_right_container";var f=document.createElement("div");f.className="dze_dlg_right_title";f.innerHTML=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strRTitle+":";this.rightInsTypeContent=document.createElement("div");this.rightInsTypeContent.className="dze_"+a+"_right_content";var g=document.createElement("div");g.className="dze_dlg_recent_title";g.innerHTML=
duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strRecentTitle+":";var h=document.createElement("div");h.className="dze_"+a+"_recent_content";d="<table width='100%' height='36' cellspacing='0' cellpadding='0' border='0'>";d+="<tr>";d+="<td width='12'><div class='dze_"+a+"_recent_btn_pre' id='"+this.dze_idx_instype_recent_btn_pre+"'></div></td>";d+="<td><div class='dze_"+a+"_recent_data_container'><div class='dze_"+a+"_recent_data_area' id='"+this.dze_idx_recent_data_area+"'></div></div></td>";
d+="<td width='12'><div class='dze_"+a+"_recent_btn_next' id='"+this.dze_idx_instype_recent_btn_next+"'></div></td>";h.innerHTML=d+"</tr><table>";e.appendChild(f);e.appendChild(this.rightInsTypeContent);0==duzon_dialog.nInsTypeIdx&&(e.appendChild(g),e.appendChild(h));b.appendChild(c);b.appendChild(e);1==duzon_dialog.nInsTypeIdx&&(b.appendChild(g),b.appendChild(h));return b}catch(k){g_objCommonUtil.displayErrorAlert(k,"duzon_dialog.getInsertTypeContent")}},loadInsertTypeContent:function(){try{duzon_dialog.dynamicScriptCall(duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].jsSrc,
function(){try{for(var a=null,b=eval(duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].refInfoDB),c=b.length,d=0;d<c;d++)a=null,a=g_objLayerKit.getLayerDocument().createElement("div"),a.className="dze_dlg_left_content_unit",a.innerHTML=b[d].name,function(){var c=d;a.onclick=function(){duzon_dialog.selectCategoryItemList(c,b)}}(),duzon_dialog.leftInsTypeContent.appendChild(a),duzon_dialog.selectCategoryItemList(duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx],b);duzon_dialog.getRecentItemList();
var e=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length-1,f=e-duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]+1;0>f&&(f=0);duzon_dialog.printRecentItem(f,e);g_objCommonUtil.log("duzon_dialog.curCategoryItem:"+duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]);var g=duzon_dialog.selectCategoryItem(duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]);g_objLayerKit.getElementById(duzon_dialog.dze_idx_instype_recent_btn_pre).onclick=function(){duzon_dialog.prevRecentItem()};
g_objLayerKit.getElementById(duzon_dialog.dze_idx_instype_recent_btn_next).onclick=function(){duzon_dialog.nextRecentItem()};var h=23*duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx];3<duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx]&&(duzon_dialog.leftInsTypeContent.scrollTop=h-57);if("undefined"!=typeof g&&null!=g&&8<g){var k=Math.floor(g/9);2<k&&(duzon_dialog.rightInsTypeContent.scrollTop=3+32*k-40)}}catch(l){}})}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.loadInsertTypeContent")}},
prevRecentItem:function(){try{if(duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1>duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]){var a=duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1-duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1;this.printRecentItem(a,a+duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1);this.setRecentItemBtns();$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft=""}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.prevRecentItem")}},nextRecentItem:function(){try{if(duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length>duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1){var a=duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1-duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]+1;this.printRecentItem(a,a+duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1);this.setRecentItemBtns();$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft=
"-5px"}}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.nextRecentItem")}},emptyRecentListBox:function(){try{for(var a=0;$_(duzon_dialog.dze_idx_recent_data_area).childNodes.length;)$_(duzon_dialog.dze_idx_recent_data_area).removeChild($_(duzon_dialog.dze_idx_recent_data_area).childNodes[0]),a++,g_objCommonUtil.log("emptyRecentListBox cnt:"+a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.emptyRecentListBox")}},printRecentItem:function(a,b){try{var c=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;
g_objCommonUtil.log("printRecentItem firstCharNo : "+a+", lastCharNo:"+b+", strInsType : "+c);this.emptyRecentListBox();for(var d=null,e=a;e<=b;e++){g_objCommonUtil.log("i:"+duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]);if("undefined"==typeof duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]||null==duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]||""==duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e])break;g_objCommonUtil.log("i2:"+duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]);
d=document.createElement("div");d.className="dze_"+c+"_right_content_unit";d.innerHTML=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e];(function(){var a=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e];d.onclick=function(){duzon_dialog.selectCategoryItem(a)};d.ondblclick=function(){duzon_dialog.selectCategoryItem(a);duzon_dialog.insertTypeContent(null)}})();$_(duzon_dialog.dze_idx_recent_data_area).appendChild(d);duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]=e}this.setRecentItemBtns();
0<a?$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="-5px":duzon_dialog.nInsTypeIdx||duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1!=duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]?$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="":$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="-5px"}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.printRecentItem")}},setRecentItemBtns:function(){try{g_objCommonUtil.log(":::setRecentItemBtns::: duzon_dialog.recentItemListCurViewIdx: "+
duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]),g_objCommonUtil.log(":::setRecentItemBtns::: duzon_dialog.recentItemListMaxViewCnt: "+duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]),duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1>duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]?($_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.opacity="",$_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.cursor="pointer"):($_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.opacity=
"0.3",$_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.cursor="default"),duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length>duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1?($_(duzon_dialog.dze_idx_instype_recent_btn_next).style.opacity="",$_(duzon_dialog.dze_idx_instype_recent_btn_next).style.cursor="pointer"):($_(duzon_dialog.dze_idx_instype_recent_btn_next).style.opacity="0.3",$_(duzon_dialog.dze_idx_instype_recent_btn_next).style.cursor="default")}catch(a){g_objCommonUtil.displayErrorAlert(a,
"duzon_dialog.setRecentItemBtns")}},makeEmoticonItemHTML:function(a,b,c,d){d=d?32:68;return"<img src='"+dzeEnvConfig.strPath_Image+"emoticons/"+c[a].content[b]+"'  width='"+d+"px' height='"+d+"px'>"},selectCategoryItemList:function(a,b){try{duzon_dialog.rightInsTypeContent.innerHTML="";for(var c=null,d=b[a].content.length,e=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType,f=0;f<d;f++){c=null;c=document.createElement("div");c.className="dze_"+e+"_right_content_unit";switch(duzon_dialog.nInsTypeIdx){case 0:c.innerHTML=
b[a].content[f];break;case 1:c.innerHTML=duzon_dialog.makeEmoticonItemHTML(a,f,b,!1)}(function(){var a=c.innerHTML;c.onclick=function(){duzon_dialog.selectCategoryItem(a)};c.ondblclick=function(){duzon_dialog.selectCategoryItem(a);duzon_dialog.insertTypeContent(null)}})();duzon_dialog.rightInsTypeContent.appendChild(c);duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]==c.innerHTML&&this.selectCategoryItem(duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx])}leftContentList=this.leftInsTypeContent.getElementsByTagName("div");
for(f=0;f<leftContentList.length;f++)leftContentList[f].className=f==a?"dze_dlg_left_content_unit_select":"dze_dlg_left_content_unit";this.curCategoryIdx[duzon_dialog.nInsTypeIdx]=a;duzon_dialog.rightInsTypeContent.scrollTop=0}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.selectCategoryItemList")}},selectCategoryItem:function(a){try{if(""!=a){g_objCommonUtil.log("selectCategoryItem strInnerHTML:"+a);var b=0,c=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]=
a;rightContentList=this.rightInsTypeContent.getElementsByTagName("div");for(var d=0;d<rightContentList.length;d++)rightContentList[d].innerHTML==a?(rightContentList[d].className="dze_"+c+"_right_content_unit_down",b=d):rightContentList[d].className="dze_"+c+"_right_content_unit";rightRecentContentList=g_objLayerKit.getElementById(this.dze_idx_recent_data_area).getElementsByTagName("div");for(d=0;d<rightRecentContentList.length;d++)"dze_dlg_right_content_unit_separator"!=rightRecentContentList[d].className&&
(rightRecentContentList[d].className=rightRecentContentList[d].innerHTML==a?"dze_"+c+"_right_content_unit_down":"dze_"+c+"_right_content_unit");return b}}catch(e){return g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.selectCategoryItem"),0}},insertTypeContent:function(a){try{a?(g_objCommonUtil.log("insertTypeContent innerHTML : "+a),this.closeExtendsDlg(),fnAddHTMLContent(a,null,0,this.nEditNumber)):(g_objCommonUtil.log("insertTypeContent this.curCategoryItem : "+this.curCategoryItem[duzon_dialog.nInsTypeIdx]),
""==this.curCategoryItem[duzon_dialog.nInsTypeIdx]?alert(ID_RES_DIALOG_ALERT_SELECT_CHARACTER):(duzon_dialog.closeDialog(),fnAddHTMLContent(this.curCategoryItem[duzon_dialog.nInsTypeIdx],null,0,this.nEditNumber),this.setRecentItemList(this.curCategoryItem[duzon_dialog.nInsTypeIdx])))}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.insertSpecialCharsContent")}},setRecentItemList:function(a){try{for(var b=[],c=0;c<this.recentItemList[this.nInsTypeIdx].length;c++)this.recentItemList[this.nInsTypeIdx][c]!=
a&&b.push(this.recentItemList[this.nInsTypeIdx][c]);b.push(a);b=this.getMaxArrayList(b,this.recentItemListMaxCnt[this.nInsTypeIdx]);this.recentItemList[this.nInsTypeIdx]=b;if("undefined"!=typeof localStorage)try{0==this.nInsTypeIdx?localStorage.setItem("dzeSpecialCharsRecentList",b.join(",")):1==this.nInsTypeIdx&&localStorage.setItem("dzeEmoticonsRecentList",b.join(","))}catch(d){g_objCommonUtil.displayErrorAlert(d,"setRecentItemList localStorage error")}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"duzon_dialog.setRecentItemList")}},getMaxArrayList:function(a,b){try{if(a.length>b){var c=a.length-b;for(b=0;b<c;b++)a.shift()}return a}catch(d){return g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.getMaxArrayList"),[]}},getRecentItemList:function(){if("undefined"!=typeof localStorage)try{0==this.nInsTypeIdx&&localStorage.getItem("dzeSpecialCharsRecentList")?this.recentItemList[this.nInsTypeIdx]=localStorage.getItem("dzeSpecialCharsRecentList").split(","):1==this.nInsTypeIdx&&localStorage.getItem("dzeEmoticonsRecentList")&&
(this.recentItemList[this.nInsTypeIdx]=localStorage.getItem("dzeEmoticonsRecentList").split(","))}catch(a){g_objCommonUtil.displayErrorAlert(a,"getRecentItemList localStorage error"),this.recentItemList[this.nInsTypeIdx]=[]}return this.recentItemList[this.nInsTypeIdx]},idx_dze_bookmark_list_select:"idx_dze_bookmark_list_select",idx_dze_bookmark_sort_name:"idx_dze_bookmark_sort_name",idx_dze_bookmark_sort_position:"idx_dze_bookmark_sort_position",idx_dze_bookmark_name_form:"idx_dze_bookmark_name_form",
bookmark_select_text:"",idx_dze_bookmark_insert_btn:"idx_dze_bookmark_insert_btn",idx_dze_bookmark_delete_btn:"idx_dze_bookmark_delete_btn",idx_dze_bookmark_move_btn:"idx_dze_bookmark_move_btn",getInsertBookmarkContent:function(){try{this.bookmark_select_text="";this.bookmark_select_text=getSelectionTextValue(this.nEditNumber);var a="";a+="<div class='duzon_dialog_content_small'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_NAME+"</div>";a+="<div class=''>";a+="\t<table width='260' height='20' cellspacing='0' cellpadding='0'>";
a+="\t\t<tr>";a+="\t\t<td width='196' valign='top'>";a+="\t\t\t<input type='text' name='bookmark_name' id='"+this.idx_dze_bookmark_name_form+"' value='"+this.bookmark_select_text+"' class='dze_bookmark_name_formbox' />";a+="\t\t</td>";a+="\t\t<td width='4'></td>";a+="\t\t<td width='60' valign='top'>";a+="\t\t\t<div><input type='button' value='"+ID_RES_DIALOG_BTN_INSERT+"' id='"+this.idx_dze_bookmark_insert_btn+"' class='dze_bookmark_button' /></div>";a+="\t\t</td>";a+="\t\t</tr>";a+="\t</table>";
a+="</div>";a+="<div style='height:8px'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_LIST+"</div>";a+="<div class=''>";a+="\t<table width='260' height='132' cellspacing='0' cellpadding='0'>";a+="\t\t<tr>";a+="\t\t<td width='196' valign='top'>";a+="\t\t\t<div class='dze_bookmark_list_container' id='"+this.idx_dze_bookmark_list_select+"'></div>";a+="\t\t</td>";a+="\t\t<td width='4'></td>";a+="\t\t<td width='60' valign='top'>";a+="\t\t\t<div style='margin-bottom:4px'><input type='button' value='"+
ID_RES_CONST_BTN_DELETE+"' id='"+this.idx_dze_bookmark_delete_btn+"' class='dze_bookmark_button' /></div>";a+="\t\t\t<div><input type='button' value='"+ID_RES_DIALOG_STRING_MOVE+"' id='"+this.idx_dze_bookmark_move_btn+"'  class='dze_bookmark_button' /></div>";a+="\t\t</td>";a+="\t\t</tr>";a+="\t</table>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_SORT_STANDARD+"</div>";a+="<div class=''>";a+="<input type='radio' name='bk_sort' value='name' id='"+
this.idx_dze_bookmark_sort_name+"'> "+ID_RES_DIALOG_STRING_NAME;a+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='bk_sort' value='position' id='"+this.idx_dze_bookmark_sort_position+"' checked> "+ID_RES_DIALOG_STRING_POSITION;return a+"</div></div>"}catch(b){return g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getInsertBookmarkContent"),""}},bookmark_list:[],makeBookmarkList:function(a){try{var b=g_objEditorDocument[this.nEditNumber].body.getElementsByTagName("a");this.bookmark_list=
[];for(var c=0;c<b.length;c++)null!=b[c].getAttribute("name")&&""!=b[c].getAttribute("name")&&(g_objCommonUtil.log("aObj[i].getAttribute(name):"+b[c].getAttribute("name")),this.bookmark_list.push(b[c]));"undefined"==typeof a&&(a="position");this.bookmark_list=this.sortBookmarkList(this.bookmark_list,a);this.select_bookmark_no=-1}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.makeBookmarkList")}},sortBookmarkList:function(a,b){try{return"name"==b&&a.sort(function(a,b){a=a.getAttribute("name").toString().toLowerCase();
b=b.getAttribute("name").toString().toLowerCase();return a<b?-1:a>b?1:0}),a}catch(c){return g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.sortBookmarkList"),a}},printBookmarkList:function(){try{var a="position";1==$_(this.idx_dze_bookmark_sort_name).checked&&(a="name");this.makeBookmarkList(a);var b=$_(duzon_dialog.idx_dze_bookmark_list_select);b.innerHTML="";for(var c=null,d=0;d<this.bookmark_list.length;d++)c=document.createElement("div"),c.className="dze_bookmark_list_item",c.innerHTML=this.bookmark_list[d].getAttribute("name"),
function(){var a=d;c.onclick=function(){duzon_dialog.selectBookmark(a)};c.ondblclick=function(){duzon_dialog.selectBookmark(a);duzon_dialog.moveBookmarkPosition()}}(),b.appendChild(c);this.select_bookmark_no=-1}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.printBookmarkList")}},dze_bookmark_last_tag:"&#8203;",inputBookmark:function(){try{var a=$_(duzon_dialog.idx_dze_bookmark_name_form).value;if(""==a)alert(ID_RES_DIALOG_ALERT_INPUT_BOOKMARK_NAME),$_(duzon_dialog.idx_dze_bookmark_name_form).focus();
else{if(!0===dzeUiConfig.bUseLockEditCellFunction){var b=g_objEditorDocument[this.nEditNumber].getSelection();if(!1===fnObjectCheckNull(b)&&0<b.rangeCount){var c=b.getRangeAt(0).commonAncestorContainer;c=g_objNodeUtil.getLoopParentElement(c,"td");if(!1===fnObjectCheckNull(c)&&"td"===c.nodeName.toLowerCase()&&!0===g_objTableFunction.isCellLocked(c)){alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA);return}}}fnAddHTMLContent("<a name='"+a+"' class='dze_bookmark_flag' style='text-decoration:none'>"+this.bookmark_select_text+
"</a>"+this.dze_bookmark_last_tag,null,0,this.nEditNumber);g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber);this.closeDialog()}}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.inputBookmark")}},select_bookmark_no:-1,selectBookmark:function(a){try{this.select_bookmark_no=a;for(var b=$_(duzon_dialog.idx_dze_bookmark_list_select).getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"dze_bookmark_list_item_select":"dze_bookmark_list_item"}catch(d){g_objCommonUtil.displayErrorAlert(d,
"duzon_dialog.selectBookmark")}},removeBookmarkItem:function(){try{if(0>this.select_bookmark_no)alert(ID_RES_DIALOG_ALERT_INPUT_SELECT_DELTE_BOOKMARK_ITEM);else{if(!0===dzeUiConfig.bUseLockEditCellFunction){var a=this.bookmark_list[this.select_bookmark_no];a=g_objNodeUtil.getLoopParentElement(a,"td");if(!1===fnObjectCheckNull(a)&&"td"===a.nodeName.toLowerCase()&&!0===g_objTableFunction.isCellLocked(a)){alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA);return}}null!=this.bookmark_list[this.select_bookmark_no].getAttribute("name")&&
""!=this.bookmark_list[this.select_bookmark_no].getAttribute("name")&&(this.bookmark_list[this.select_bookmark_no].removeAttribute("name"),null==this.bookmark_list[this.select_bookmark_no].getAttribute("href")||""==this.bookmark_list[this.select_bookmark_no].getAttribute("href"))&&("dze_bookmark_flag"==this.bookmark_list[this.select_bookmark_no].getAttribute("class")&&this.bookmark_list[this.select_bookmark_no].removeAttribute("class"),""==this.bookmark_list[this.select_bookmark_no].innerHTML?this.bookmark_list[this.select_bookmark_no].parentNode.removeChild(this.bookmark_list[this.select_bookmark_no]):
(duzon_dialog.selectElement(duzon_dialog.bookmark_list[duzon_dialog.select_bookmark_no],duzon_dialog.nEditNumber),this.unLink()),this.printBookmarkList(),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber))}}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.removeBookmarkItem")}},moveBookmarkPosition:function(){try{if(0>this.select_bookmark_no)alert(ID_RES_DIALOG_ALERT_INPUT_SELECT_MOVE_BOOKMARK_ITEM);else{g_objCommonUtil.log("moveBookmarkPosition select_bookmark_no:"+this.select_bookmark_no);
var a=this.bookmark_list[this.select_bookmark_no];this.setEditorFocus();this.setFocusElement(a,this.nEditNumber,"start")}}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.moveBookmarkPosition")}},idx_dze_hyperlink_text_form:"idx_dze_hyperlink_text_form",idx_dze_hyperlink_type_url:"idx_dze_hyperlink_type_url",idx_dze_hyperlink_type_bookmark:"idx_dze_hyperlink_type_bookmark",idx_dze_hyperlink_url_form_box:"idx_dze_hyperlink_url_form_box",idx_dze_hyperlink_bookmark_form_box:"idx_dze_hyperlink_bookmark_form_box",
idx_dze_hyperlink_form_url:"idx_dze_hyperlink_form_url",idx_dze_hyperlink_open_type_self:"idx_dze_hyperlink_open_type_self",idx_dze_hyperlink_open_type_blank:"idx_dze_hyperlink_open_type_blank",idx_dze_hyperlink_unlink_button:"idx_dze_hyperlink_unlink_button",idx_dze_hyperlink_bookmark_form_list:"idx_dze_hyperlink_bookmark_form_list",idx_dze_hyperlink_target_menu_box:"idx_dze_hyperlink_target_menu_box",getInsertHyperLinkContent:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";
a+="\t<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_VIEW_TEXT+"</div>";a+="\t<div class=''><input type='text' name='hyperlink_text' id='"+this.idx_dze_hyperlink_text_form+"' value='' class='dze_hyperlink_name_formbox' /></div>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LINK_TYPE+"</div>";a+="\t<div class=''>";a+="\t\t<input type='radio' name='link_type' value='url' id='"+this.idx_dze_hyperlink_type_url+
"' checked> "+ID_RES_DIALOG_STRING_WEB_ADDR;a+="\t\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_type' value='bookmark' id='"+this.idx_dze_hyperlink_type_bookmark+"'> "+ID_RES_CONST_STRING_INSERT_BOOKMARK;a+="\t</div>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t<div id='"+this.idx_dze_hyperlink_url_form_box+"'>";a+="\t\t<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_WEB_ADDR+"</div>";a+="\t\t<div class=''><input type='text' name='hyperlink_form_url' id='"+
this.idx_dze_hyperlink_form_url+"' value='' class='dze_hyperlink_name_formbox' /></div>";a+="\t</div>";a+="\t<div id='"+this.idx_dze_hyperlink_bookmark_form_box+"' style='display:none'>";a+="\t\t<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_INSERT_BOOKMARK+"</div>";a+="\t\t<div id='"+this.idx_dze_hyperlink_bookmark_form_list+"'>";a+="\t\t</div>";a+="\t</div>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t<div id='"+this.idx_dze_hyperlink_target_menu_box+"'>";a+="\t<div class='duzon_dialog_label_title'>"+
ID_RES_DIALOG_STRING_LINK_TARGET+"</div>";a+="\t<div class=''>";a+="\t\t<input type='radio' name='link_open_type' value='_blank' id='"+this.idx_dze_hyperlink_open_type_blank+"' checked><label for='"+this.idx_dze_hyperlink_open_type_blank+"' style='background: none;'>"+ID_RES_DIALOG_STRING_LINK_NEW_WINDOW+"</label>";a+="\t\t<div style='display: none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_open_type' value='_self' id='"+this.idx_dze_hyperlink_open_type_self+"'> "+ID_RES_DIALOG_STRING_LINK_CURRENT_WINDOW+
"</div>";a+="\t</div>";a+="\t<div class='duzon_dialog_label_separator'></div>";a+="\t</div>";a+="\t<div style='width:auto;text-align:right'><input type='button' id='"+this.idx_dze_hyperlink_unlink_button+"' value='"+ID_RES_DIALOG_STRING_LINK_NO_CONNECT+"'></div>";return a+"</div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getInsertHyperLinkContent")}},setHyperLinkType:function(){try{1==$_(this.idx_dze_hyperlink_type_url).checked?($_(this.idx_dze_hyperlink_url_form_box).style.display=
"block",$_(this.idx_dze_hyperlink_bookmark_form_box).style.display="none",$_(this.idx_dze_hyperlink_open_type_blank).disabled=!1,$_(this.idx_dze_hyperlink_target_menu_box).style.display=""):($_(this.idx_dze_hyperlink_url_form_box).style.display="none",$_(this.idx_dze_hyperlink_bookmark_form_box).style.display="block",$_(this.idx_dze_hyperlink_open_type_self).disabled=!0,$_(this.idx_dze_hyperlink_open_type_blank).checked=!0,$_(this.idx_dze_hyperlink_target_menu_box).style.display="none")}catch(a){g_objCommonUtil.displayErrorAlert(a,
"duzon_dialog.setHyperLinkType")}},unLink:function(){this.setEditorSelection();fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,ID_STRING_COMMAND_UNLINK);g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber)},selectedObject:null,idx_dze_hyperlink_bookmark_list_form:"idx_dze_hyperlink_bookmark_list_form",setHyperLinkContentData:function(){try{var a=g_objPropContentLink.getPropContentParam(this.nEditNumber),b=a.arrValue[0],c=a.arrValue[1],d=a.arrValue[2],e=a.arrValue[4];this.selectedObject=
null;var f=getSelectionControl(this.nEditNumber);null!=f.controlObject&&"undefined"!=typeof f.controlObject&&"img"==f.controlObject.nodeName.toLowerCase()?(this.selectedObject=f.controlObject,e=""==d?f.controlObject.title:d):(e=getSelectionTextValue(this.nEditNumber),""==e&&(e=d));$_(this.idx_dze_hyperlink_text_form).value=e;0==b.indexOf("#")?($_(this.idx_dze_hyperlink_type_bookmark).checked=!0,$_(this.idx_dze_hyperlink_form_url).value="http://"):($_(this.idx_dze_hyperlink_type_url).checked=!0,$_(this.idx_dze_hyperlink_form_url).value=
b);this.setHyperLinkType();"_self"==c?$_(this.idx_dze_hyperlink_open_type_self).checked=!0:$_(this.idx_dze_hyperlink_open_type_blank).checked=!0;""==b||"http://"==b?($_(this.idx_dze_hyperlink_unlink_button).disabled=!0,$_(this.idx_dze_hyperlink_unlink_button).className="duzon_dialog_btn_disabled",$_(this.idx_dze_hyperlink_unlink_button).style.color="#d9d9d9"):($_(this.idx_dze_hyperlink_unlink_button).disabled=!1,$_(this.idx_dze_hyperlink_unlink_button).className="duzon_dialog_btn_normal");this.makeBookmarkList();
var g=document.createElement("select");g.className="dze_hyperlink_bookmark_form";g.id=this.idx_dze_hyperlink_bookmark_list_form;a=null;a=document.createElement("option");a.value="";a.innerHTML="----- "+ID_RES_DIALOG_STRING_LIST_SELECT+" -----";g.appendChild(a);for(c=0;c<this.bookmark_list.length;c++)a=document.createElement("option"),a.value=this.bookmark_list[c].getAttribute("name"),a.innerHTML=this.bookmark_list[c].getAttribute("name"),b=="#"+this.bookmark_list[c].getAttribute("name")&&a.setAttribute("selected",
"selected"),g.appendChild(a);$_(this.idx_dze_hyperlink_bookmark_form_list).appendChild(g)}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.setHyperLinkContentData")}},inputHyperLink:function(){try{if(1!=$_(this.idx_dze_hyperlink_type_url).checked||"http://"!=$_(this.idx_dze_hyperlink_form_url).value&&""!=$_(this.idx_dze_hyperlink_form_url).value)if(1==$_(this.idx_dze_hyperlink_type_bookmark).checked&&""==$_(this.idx_dze_hyperlink_bookmark_list_form).value)alert(ID_RES_DIALOG_ALERT_SELECT_BOOKMARK),
$_(this.idx_dze_hyperlink_bookmark_list_form).focus();else{var a="",b="",c="",d="";a=1==$_(this.idx_dze_hyperlink_type_url).checked?$_(this.idx_dze_hyperlink_form_url).value:"#"+$_(this.idx_dze_hyperlink_bookmark_list_form).value;b=1==$_(this.idx_dze_hyperlink_type_url).checked?1==$_(this.idx_dze_hyperlink_open_type_blank).checked?"_blank":"_self":"_self";c=$_(this.idx_dze_hyperlink_text_form).value;d=$_(this.idx_dze_hyperlink_text_form).value;null!=this.selectedObject&&(d=this.selectedObject.outerHTML,
this.selectedObject=null);a=[a,b,c,d];g_objCommonUtil.log(a);this.closeDialog();g_objPropContentLink.setLinkHTML(a,this.nEditNumber)}else alert(ID_RES_DIALOG_ALERT_INPUT_WEB_ADDR),$_(this.idx_dze_hyperlink_form_url).focus()}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.inputHyperLink")}},makeComboInputForm:function(a,b,c){try{var d="<select name='"+a+"' id='"+a+"'";!1===fnObjectCheckNull(c)&&"number"===typeof c&&(d+=" style='width:"+c+"px !important;'");d+=">";c=function(a){return"<option value='"+
b[a].value+"'>"+b[a].text+"</option>"};"dze_style_font_family"==a&&(c=function(a){return"<option value='"+b[a].value+"' style='font-family:"+b[a].value+";'>"+b[a].text.replace(/["']/g,"")+"</option>"});for(a=0;a<b.length;a++)d+=c(a);return d+"</select>"}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.makeComboInputForm")}},idx_dze_style_font_preview:"idx_dze_style_font_preview",dze_font_propertys:"bold italic underline strike superscript subscript normal".split(" "),max_letterspacing:10,
min_letterspacing:0,getStyleFontContent:function(){try{for(var a=[],b=1;b<g_arrFontName.length;b++)a.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/["']/g,"")});this.checkFontPropertyList=[];var c="";c+="<div class='duzon_dialog_content_medium'>";c+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BASIC+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";c+="<tr>";c+="<td width='60'>"+ID_RES_CONST_STRING_FONT_NAME+" </td>";c+="<td width='180'>"+this.makeComboInputForm("dze_style_font_family",
a)+"</td>";c+="<td width='' align='right'>"+ID_RES_DIALOG_STRING_LETTERSPACING+" </td>";c+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_font_spacing","pt",this.max_letterspacing,this.min_letterspacing,this.min_letterspacing,"duzon_dialog.preveiwDzeLetterSpacing")+"</div></td>";c+="</tr>";c+="<tr>";c+="<td colspan='4' height='5'></td>";c+="</tr>";c+="<tr>";c+="<td>"+ID_RES_CONST_STRING_FONT_SIZE+" </td>";c+="<td colspan='3'>"+this.makeSpinnerInputForm("dze_style_font_size",
"pt","36","8","9","duzon_dialog.preveiwDzeFontSize")+"</td>";c+="</tr>";c+="</table>";c+="<div class='duzon_dialog_label_separator'></div>";c+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_PROPERTY+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";c+="<tr>";c+="<td colspan='4'>";var d=a="",e="";for(b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],d=dzeEnvConfig.strPath_Image+"dialog/btn_style_font_"+this.dze_font_propertys[b]+
".png",e=eval("ID_RES_CONST_STRING_"+this.dze_font_propertys[b].toUpperCase()),c+="<div class='dze_style_font_propery_set' id='"+a+"'><img src='"+d+"' alt='' title='"+e+"' width='28' height='28'></div>";c+="</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="<tr>";c+="<td width='60'>"+ID_RES_CONST_STRING_FORE_COLOR+" </td>";c+="<td width='180'>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_forecolor",70)+"</td>";c+="<td>"+ID_RES_CONST_STRING_BACK_COLOR+" </td>";c+="<td width='90'>"+
g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_backcolor",70)+"</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="</table>";c+="<div class='dze_style_font_preview_container'><div class='dze_style_font_preview'><span id='"+this.idx_dze_style_font_preview+"'>"+ID_RES_DIALOG_STRING_FONT_STYLE_PREVIEW+"</span></div></div>";return c+"</div>"}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.getStyleFontContent")}},preveiwDzeFontSize:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=
a+"pt"},preveiwDzeLetterSpacing:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=a+"pt"},checkFontPropertyList:[],addFontPropertyList:function(a){try{inArray(a,this.checkFontPropertyList)?this.removeFontPropertyList(a):duzon_dialog.checkFontPropertyList.push(a),"normal"!=a&&inArray("normal",this.checkFontPropertyList)&&this.removeFontPropertyList("normal"),inArray("normal",this.checkFontPropertyList)&&(this.checkFontPropertyList=["normal"]),"superscript"==a&&inArray("subscript",
this.checkFontPropertyList)&&this.removeFontPropertyList("subscript"),"subscript"==a&&inArray("superscript",this.checkFontPropertyList)&&this.removeFontPropertyList("superscript")}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.addFontPropertyList")}},removeFontPropertyList:function(a){try{for(var b=[],c=0;c<this.checkFontPropertyList.length;c++)a!=this.checkFontPropertyList[c]&&b.push(this.checkFontPropertyList[c]);this.checkFontPropertyList=b}catch(d){g_objCommonUtil.displayErrorAlert(d,
"duzon_dialog.removeFontPropertyList")}},selectFontProperty:function(a){try{g_objCommonUtil.log("selectFontProperty"),g_objCommonUtil.log("execName:"+a),this.addFontPropertyList(a),g_objCommonUtil.log(this.checkFontPropertyList),this.setFontPropertyButtons(),this.setFontProperysPreview()}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.selectFontProperty")}},removeGabageSelectionFontPropertyList:function(){try{for(var a=[],b=0;b<this.selectionFontStyleList.fontPropertyList.length;b++)"normal"!=
this.selectionFontStyleList.fontPropertyList[b]&&a.push(this.selectionFontStyleList.fontPropertyList[b]);this.selectionFontStyleList.fontPropertyList=a}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.removeGabageSelectionFontPropertyList")}},setFontPropertyButtons:function(){try{for(var a="",b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],inArray(this.dze_font_propertys[b],this.checkFontPropertyList)?(g_objCommonUtil.log("___ok___:"+this.dze_font_propertys[b]),
$_(a).className="dze_style_font_propery_set_down"):$_(a).className="dze_style_font_propery_set"}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.setFontPropertyButtons")}},setFontProperysPreview:function(){try{this.unsetFontProperysPreview();for(var a="",b=0;b<this.checkFontPropertyList.length;b++){a=this.checkFontPropertyList[b];if("normal"==a){this.unsetFontProperysPreview();break}"bold"==a&&($_(this.idx_dze_style_font_preview).style.fontWeight="bold");"italic"==a&&($_(this.idx_dze_style_font_preview).style.fontStyle=
"italic");"underline"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="underline");"strike"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="line-through");inArray("underline",this.checkFontPropertyList)&&inArray("strike",this.checkFontPropertyList)&&($_(this.idx_dze_style_font_preview).style.textDecoration="underline line-through");"superscript"==a&&($_(this.idx_dze_style_font_preview).innerHTML="<sup>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sup>");"subscript"==
a&&($_(this.idx_dze_style_font_preview).innerHTML="<sub>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sub>")}}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.setFontProperysPreview")}},unsetFontProperysPreview:function(){try{$_(this.idx_dze_style_font_preview).style.fontWeight="",$_(this.idx_dze_style_font_preview).style.fontStyle="",$_(this.idx_dze_style_font_preview).style.textDecoration="",$_(this.idx_dze_style_font_preview).style.textDecoration="",$_(this.idx_dze_style_font_preview).innerHTML=
$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sup>/gi,""),$_(this.idx_dze_style_font_preview).innerHTML=$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sub>/gi,"")}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.unsetFontProperysPreview")}},dze_editor_default_font_size:"9",selectionFontStyleList:{fontPropertyList:[],fontFamily:"",fontSize:"",color:"",backgroundColor:"",letterSpacing:""},initSelectionFontStyleList:function(a){try{"undefined"==typeof a||null==a?(this.selectionFontStyleList.fontPropertyList=
[],this.selectionFontStyleList.fontFamily="",this.selectionFontStyleList.fontSize="",this.selectionFontStyleList.color="",this.selectionFontStyleList.backgroundColor="",this.selectionFontStyleList.letterSpacing=""):(null==a[0]&&(a[0]=""),null==a[1]&&(a[1]=""),null==a[2]&&(a[2]=""),null==a[3]&&(a[3]=""),null==a[4]&&(a[4]=""),this.selectionFontStyleList.fontFamily=a[0],this.selectionFontStyleList.fontSize=a[1].toLowerCase(),this.selectionFontStyleList.color=a[2],this.selectionFontStyleList.backgroundColor=
a[3],this.selectionFontStyleList.letterSpacing=a[4].toLowerCase(),0<=this.selectionFontStyleList.fontSize.indexOf("px")?(this.selectionFontStyleList.fontSize=g_objCommonUtil.convPxToPt(this.selectionFontStyleList.fontSize),this.selectionFontStyleList.fontSize=0>this.selectionFontStyleList.fontSize?"":this.selectionFontStyleList.fontSize+"pt"):0>this.selectionFontStyleList.fontSize.indexOf("pt")&&(this.selectionFontStyleList.fontSize=""),0<=this.selectionFontStyleList.letterSpacing.indexOf("px")?(this.selectionFontStyleList.letterSpacing=
g_objCommonUtil.convPxToPt(this.selectionFontStyleList.letterSpacing),this.selectionFontStyleList.letterSpacing=0>this.selectionFontStyleList.letterSpacing?"":this.selectionFontStyleList.letterSpacing+"pt"):0>this.selectionFontStyleList.letterSpacing.indexOf("pt")&&(this.selectionFontStyleList.letterSpacing=""))}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.initSelectionFontStyleList")}},checkSelectionFontStyle:function(){try{if(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:
getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){this.initSelectionFontStyleList();for(var a="",b=0,c=0;c<this.dze_font_propertys.length-1;c++)if("normal"!=this.dze_font_propertys[c]){a=this.dze_font_propertys[c].toUpperCase();b=eval("ID_COMMAND_"+a);"STRIKE"==a&&(a="StrikeThrough");var d=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],b,a,this.nEditNumber,-1,strSelectionType);
ID_STRING_NAME_CHECKED==d&&(this.selectFontProperty(this.dze_font_propertys[c]),this.selectionFontStyleList.fontPropertyList.push(this.dze_font_propertys[c]))}var e=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);"undefined"!=typeof e&&null!=e&&this.initSelectionFontStyleList(e);$_("dze_style_font_family").value=this.selectionFontStyleList.fontFamily;""!=$_("dze_style_font_family").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=$_("dze_style_font_family").value);
$_("dze_style_font_size").value=this.selectionFontStyleList.fontSize.replace(/(pt|px)/gi,"");""!=$_("dze_style_font_size").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=$_("dze_style_font_size").value+"pt");g_objColorComboBoxUtil.setColorValue("dze_font_forecolor",this.selectionFontStyleList.color);""!=this.selectionFontStyleList.color&&($_(duzon_dialog.idx_dze_style_font_preview).style.color=this.selectionFontStyleList.color);g_objColorComboBoxUtil.setColorValue("dze_font_backcolor",
this.selectionFontStyleList.backgroundColor);""!=this.selectionFontStyleList.backgroundColor&&($_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=this.selectionFontStyleList.backgroundColor);$_("dze_style_font_spacing").value=this.selectionFontStyleList.letterSpacing.replace(/(pt|px)/gi,"");""!=$_("dze_style_font_spacing").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=$_("dze_style_font_spacing").value+"pt")}}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.checkSelectionFontStyle")}},
setStyleFont:function(){try{this.setEditorSelection();var a=$_("dze_style_font_family").value;this.selectionFontStyleList.fontFamily!=a&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(a,!1));var b=$_("dze_style_font_size").value;""!=b&&(b+="pt");this.selectionFontStyleList.fontSize!=b&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],
g_objComboBoxWin.setComboBox(b,!1));var c=g_objColorComboBoxUtil.getColorValue("dze_font_forecolor");if(this.selectionFontStyleList.color!=c){var d=document.getElementById("TB_SETFORECOLOR_"+duzon_dialog.nEditNumber+"_SUB");duzon_dialog.selectColorCode(c,d);g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply(c,!1)}var e=g_objColorComboBoxUtil.getColorValue("dze_font_backcolor");if(this.selectionFontStyleList.backgroundColor!=e){var f=document.getElementById("TB_SETBACKCOLOR_"+duzon_dialog.nEditNumber+
"_SUB");duzon_dialog.selectColorCode(e,f);g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber);fnColorCellApply(e,!1)}var g=$_("dze_style_font_spacing").value;""!=g&&(g+="pt");this.selectionFontStyleList.letterSpacing!=g&&(-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),g_objLetterSpacingWin.fnLetterSpacingCellClick(g,!1));a=c=b="";for(d=0;d<this.dze_font_propertys.length;d++)if(c=b=this.dze_font_propertys[d],
"strike"==b.toLowerCase()&&(c="StrikeThrough"),inArray("normal",this.checkFontPropertyList)){for(b=0;b<this.selectionFontStyleList.fontPropertyList.length;b++)a=this.selectionFontStyleList.fontPropertyList[b],"strike"==this.selectionFontStyleList.fontPropertyList[b].toLowerCase()&&(a="StrikeThrough"),fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);break}else(inArray(b,this.selectionFontStyleList.fontPropertyList)&&!inArray(b,this.checkFontPropertyList)||!inArray(b,this.selectionFontStyleList.fontPropertyList)&&
inArray(b,this.checkFontPropertyList))&&fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,c);duzon_dialog.resetSelection=!0}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.setStyleFont")}},idx_dze_style_paragraph_justify:"idx_dze_style_paragraph_justify",idx_dze_style_paragraph_left:"idx_dze_style_paragraph_left",idx_dze_style_paragraph_center:"idx_dze_style_paragraph_center",idx_dze_style_paragraph_right:"idx_dze_style_paragraph_right",dze_style_paragraph_align_propertys:["justify",
"left","center","right"],idx_dze_firstline_indent_normal:"idx_dze_firstline_indent_normal",idx_dze_firstline_indent_in:"idx_dze_firstline_indent_in",idx_dze_firstline_indent_out:"idx_dze_firstline_indent_out",marginLeftMax:533,marginLeftMin:0,marginRightMax:533,marginRightMin:0,lineHeightMax:500,lineHeightMin:0,lineHeightDefault:160,getStyleParagraphContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BASIC+
"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td colspan='4'>";a+="<div class='dze_style_paragraph_align_title'>"+ID_RES_DIALOG_STRING_ALIGN_TYPE+" </div>";for(var b="",c="",d="",e="",f=0;f<this.dze_style_paragraph_align_propertys.length;f++)b=this.dze_style_paragraph_align_propertys[f],c="idx_dze_style_paragraph_"+b,d=eval("ID_RES_CONST_STRING_JUSTIFY"+b.toUpperCase()),e=dzeEnvConfig.strPath_Image+"dialog/btn_style_paragraph_"+b+".png",a+="<div class='dze_style_font_propery_set' id='"+
c+"'><img src='"+e+"' alt='"+b+"' title='"+d+"' width='28' height='28'></div>";a+="</td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='30'>"+ID_RES_DIALOG_STRING_ALIGN_LEFT+" </td>";a+="<td width='90'>"+this.makeSpinnerInputForm("dze_style_p_margin_left","px",this.marginLeftMax,this.marginLeftMin,
"0")+"</td>";a+="<td></td>";a+="<td width='40'>"+ID_RES_DIALOG_STRING_ALIGN_RIGHT+" </td>";a+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_p_margin_right","px",this.marginRightMax,this.marginRightMin,"0")+"</div></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIRST_PARAGRAPH+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";
a+="<tr>";a+="<td>";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_normal+"' value='normal' /> "+ID_RES_DIALOG_STRING_NORMAL+" &nbsp;";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_in+"' value='in' /> "+ID_RES_CONST_STRING_INDENT+" &nbsp;";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_out+"' value='out' /> "+ID_RES_CONST_STRING_OUTDENT+" &nbsp;";a+="</td>";a+=
"<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_p_firstline_indent","px","553","0","0")+"</div></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_SPACING+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='38'>"+ID_RES_DIALOG_STRING_LINEHEIGHT+" </td>";a+="<td width='90'>"+this.makeSpinnerInputForm("dze_style_p_line_height",
"%",this.lineHeightMax,this.lineHeightMin,this.lineHeightDefault)+"</td>";a+="<td width='38'>"+ID_RES_DIALOG_STRING_PARAGRAPH_TOP+" </td>";a+="<td width=''>"+this.makeSpinnerInputForm("dze_style_p_margin_top","px","876","0","0")+"</td>";a+="<td width='48'>"+ID_RES_DIALOG_STRING_PARAGRAPH_BOTTOM+" </td>";a+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_p_margin_bottom","px","876","0","0")+"</div></td>";a+="</tr>";return a+"</table></div>"}catch(g){g_objCommonUtil.displayErrorAlert(g,
"duzon_dialog.getStyleParagraphContent")}},checkFirstlineIndentSelect:function(){try{1==$_(this.idx_dze_firstline_indent_normal).checked?($_("dze_style_p_firstline_indent").value="0",this.setEnableSpinner("dze_style_p_firstline_indent",!1)):1==$_(this.idx_dze_firstline_indent_in).checked?(0<=parseInt(this.SelectionParagraphStyle.textIndent.replace(/px/,""),10)?$_("dze_style_p_firstline_indent").value=parseInt(this.SelectionParagraphStyle.textIndent.replace(/px/,""),10):$_("dze_style_p_firstline_indent").value=
0,this.setEnableSpinner("dze_style_p_firstline_indent",!0),$_("dze_style_p_firstline_indent").select()):1==$_(this.idx_dze_firstline_indent_out).checked?(0>parseInt(this.SelectionParagraphStyle.textIndent.replace(/px/,""),10)?$_("dze_style_p_firstline_indent").value=Math.abs(parseInt(this.SelectionParagraphStyle.textIndent.replace(/px/,""),10)):$_("dze_style_p_firstline_indent").value=0,this.setEnableSpinner("dze_style_p_firstline_indent",!0),$_("dze_style_p_firstline_indent").select()):($_(this.idx_dze_firstline_indent_normal).checked=
!0,$_("dze_style_p_firstline_indent").value="0",this.setEnableSpinner("dze_style_p_firstline_indent",!1))}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.checkFirstlineIndentSelect")}},selectParagraphStyle:{align:"",marginLeft:"",marginRight:"",marginTop:"",marginBottom:"",lineHeight:"",textIndent:""},selectParagraphAlign:function(a){try{var b="idx_dze_style_paragraph_"+a;if("dze_style_font_propery_set_down"==$_(b).className)$_(b).className="dze_style_font_propery_set",this.selectParagraphStyle.align=
"";else for(var c="",d=0;d<this.dze_style_paragraph_align_propertys.length;d++)c=this.dze_style_paragraph_align_propertys[d],b="idx_dze_style_paragraph_"+c,a==c?$_(b).className="dze_style_font_propery_set_down":$_(b).className="dze_style_font_propery_set",this.selectParagraphStyle.align=a}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.selectParagraphAlign")}},SelectionParagraphStyle:{align:"",marginLeft:"",marginRight:"",marginTop:"",marginBottom:"",lineHeight:"",textIndent:""},checkSelectionParagraphStyle:function(){try{if(g_objCommonUtil.log("checkSelectionParagraphStyle START"),
strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)g_objCommonUtil.log("select type is not support -> strSelectionType : "+strSelectionType);else{for(var a=getAlignValueForSelectionArea(this.nEditNumber),b="",c="",d=!1,e="",f=0;f<this.dze_style_paragraph_align_propertys.length;f++)if(b=this.dze_style_paragraph_align_propertys[f],
c=eval("ID_COMMAND_JUSTIFY_"+b.toUpperCase()),curr_exeName=b,e="Justify"+curr_exeName,d=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],c,e,this.nEditNumber,a,strSelectionType),null!=d&&d==ID_STRING_NAME_CHECKED){this.SelectionParagraphStyle.align=b;break}else this.SelectionParagraphStyle.align="";var g=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);"undefined"==typeof g||null==g?this.checkFirstlineIndentSelect():(g_objCommonUtil.log("=========selection fontStyleInfo========="),
g_objCommonUtil.log(g),this.SelectionParagraphStyle.lineHeight=g[5],this.SelectionParagraphStyle.marginLeft=g[6],this.SelectionParagraphStyle.marginTop=g[7],this.SelectionParagraphStyle.marginRight=g[8],this.SelectionParagraphStyle.marginBottom=g[9],this.SelectionParagraphStyle.textIndent=g[10],g_objCommonUtil.log("========SelectionParagraphStyle======="),g_objCommonUtil.log(this.SelectionParagraphStyle),""!=this.SelectionParagraphStyle.align&&this.selectParagraphAlign(this.SelectionParagraphStyle.align),
""==this.SelectionParagraphStyle.lineHeight?$_("dze_style_p_line_height").value="":$_("dze_style_p_line_height").value=parseInt(100*this.SelectionParagraphStyle.lineHeight,10),$_("dze_style_p_margin_top").value=this.SelectionParagraphStyle.marginTop.replace(/px/gi,""),$_("dze_style_p_margin_right").value=this.SelectionParagraphStyle.marginRight.replace(/px/gi,""),$_("dze_style_p_margin_bottom").value=this.SelectionParagraphStyle.marginBottom.replace(/px/gi,""),$_("dze_style_p_margin_left").value=
this.SelectionParagraphStyle.marginLeft.replace(/px/gi,""),a=0,""!=this.SelectionParagraphStyle.textIndent?(this.SelectionParagraphStyle.textIndent=this.SelectionParagraphStyle.textIndent.toLowerCase(),0<=this.SelectionParagraphStyle.textIndent.indexOf("px")?a=parseInt(this.SelectionParagraphStyle.textIndent.replace(/px/gi,""),10):0<=this.SelectionParagraphStyle.textIndent.indexOf("pt")&&(a=g_objCommonUtil.convPtToPx(this.SelectionParagraphStyle.textIndent)),0<a?$_(this.idx_dze_firstline_indent_in).checked=
!0:0>a?$_(this.idx_dze_firstline_indent_out).checked=!0:$_(this.idx_dze_firstline_indent_normal).checked=!0,$_("dze_style_p_firstline_indent").value=Math.abs(a),this.SelectionParagraphStyle.textIndent=a+"px"):($_(this.idx_dze_firstline_indent_normal).checked=!0,$_("dze_style_p_firstline_indent").value=0,this.SelectionParagraphStyle.textIndent="0px"),this.checkFirstlineIndentSelect(),g_objCommonUtil.log("================= SelectionParagraphStyle ================="),g_objCommonUtil.log(this.SelectionParagraphStyle))}}catch(h){g_objCommonUtil.displayErrorAlert(h,
"duzon_dialog.checkSelectionParagraphStyle")}},setStyleParagraph:function(){try{g_objCommonUtil.log("================= setStyleParagraph START =================");this.setEditorSelection();if(this.SelectionParagraphStyle.align!=this.selectParagraphStyle.align){var a=!1;""==this.selectParagraphStyle.align&&(a=!0);var b="justify"==this.selectParagraphStyle.align?"JustifyLeft":"Justify"+this.selectParagraphStyle.align.capitalizeFirstLetter(),c=eval("ID_COMMAND_JUSTIFY_"+this.selectParagraphStyle.align.toUpperCase());
fnHandler_Align_Main(this.nEditNumber,b,a,c)}this.selectParagraphStyle.marginLeft=$_("dze_style_p_margin_left").value;this.SelectionParagraphStyle.marginLeft!=this.selectParagraphStyle.marginLeft&&do_handler_Outdent_Indent({name:"marginLeft",value:this.selectParagraphStyle.marginLeft},this.nEditNumber);this.selectParagraphStyle.marginRight=$_("dze_style_p_margin_right").value;this.SelectionParagraphStyle.marginRight!=this.selectParagraphStyle.marginRight&&do_handler_Outdent_Indent({name:"marginRight",
value:this.selectParagraphStyle.marginRight},this.nEditNumber);this.selectParagraphStyle.marginTop=$_("dze_style_p_margin_top").value;this.SelectionParagraphStyle.marginTop!=this.selectParagraphStyle.marginTop&&do_handler_Outdent_Indent({name:"marginTop",value:this.selectParagraphStyle.marginTop},this.nEditNumber);this.selectParagraphStyle.marginBottom=$_("dze_style_p_margin_bottom").value;this.SelectionParagraphStyle.marginBottom!=this.selectParagraphStyle.marginBottom&&do_handler_Outdent_Indent({name:"marginBottom",
value:this.selectParagraphStyle.marginBottom},this.nEditNumber);this.selectParagraphStyle.lineHeight=parseInt($_("dze_style_p_line_height").value,10)/100;this.SelectionParagraphStyle.lineHeight!=this.selectParagraphStyle.lineHeight&&(strValue=this.selectParagraphStyle.lineHeight,g_objLineHeightWin.fnLineHeightCellClick(strValue,!1));var d=parseInt($_("dze_style_p_firstline_indent").value,10);0<d&&(1==$_(this.idx_dze_firstline_indent_out).checked?d=-d:1==$_(this.idx_dze_firstline_indent_normal).checked&&
(d=0));this.SelectionParagraphStyle.textIndent=d+"px";do_handler_Outdent_Indent({name:"firstlineIndent",value:d},this.nEditNumber);duzon_dialog.resetSelection=!0;g_objCommonUtil.log("================= setStyleParagraph END =================")}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.setStyleParagraph")}},unorderlist_styles:["none","disc","circle","square"],unorderlist_ext_styles:["fillcircle","innercircle","diamond","triangle"],idx_dze_unorderedlist_container:"idx_dze_unorderedlist_container",
idx_dze_unorderedlist_container2:"idx_dze_unorderedlist_container2",getStyleUnorderedListContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium' id='idx_dze_unorderedlist_content_medium'>";a+="<div class='dze_unorderedlist_container' id='"+this.idx_dze_unorderedlist_container+"'>";for(var b="",c="",d=0;d<this.unorderlist_styles.length;d++)b=this.unorderlist_styles[d],c="idx_dze_unorderlist_style_"+b,a="none"==b?a+("\t\t<span class='dze_orderedlist_unit_img' id='"+c+"'>"+ID_RES_DIALOG_STRING_NONE+
"</span>"):a+("\t\t<span class='dze_orderedlist_unit_img' id='"+c+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+b+".png)'></span>");a+="</div>";if(!0===dzeUiConfig.useExtUnorderedListStyleType){a+="<div class='dze_unorderedlist_container' id='"+this.idx_dze_unorderedlist_container2+"'>";c=b="";for(d=0;d<this.unorderlist_ext_styles.length;d++)b=this.unorderlist_ext_styles[d],c="idx_dze_unorderlist_style_"+b,a="none"==b?a+("\t\t<span class='dze_orderedlist_unit_img' id='"+
c+"'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):a+("\t\t<span class='dze_orderedlist_unit_img' id='"+c+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+b+".png)'></span>");a+="</div>"}return a+"</div>"}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.getStyleUnorderedListContent")}},addEventUnorderedListContent:function(a){var b=dzeUiConfig.bTBPreviewLetterOperation;try{for(var c=$_(this.idx_dze_unorderedlist_container).parentNode.getElementsByTagName("span"),
d=0;d<c.length;d++)c[d].onmouseover=function(){"dze_orderedlist_unit_img"==this.className&&(this.className="dze_orderedlist_unit_over");!0===b&&"dze_orderedlist_unit_selection"!=this.className&&"undefined"!=typeof a&&"toolbar"==a&&(duzon_dialog.selectUnorderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleUnorderedListItem(!1))},c[d].onmouseout=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_img")},c[d].onmousedown=function(){"dze_orderedlist_unit_over"==
this.className&&(this.className="dze_orderedlist_unit_down")},c[d].onmouseup=function(){"dze_orderedlist_unit_down"==this.className&&(this.className="dze_orderedlist_unit_over")},c[d].onclick="undefined"!=typeof a&&"toolbar"==a?function(){!0===b?(g_objLayerKit.getElementById("idx_dze_unorderedlist_content_medium").onmouseleave=function(){},g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)):(duzon_dialog.selectUnorderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleUnorderedListItem());
duzon_dialog.closeDialog()}:function(){duzon_dialog.selectUnorderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,""))};"undefined"!=typeof a&&"toolbar"==a&&!0===b&&(g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber),g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),g_objLayerKit.getElementById("idx_dze_unorderedlist_content_medium").onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):
(g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber))})}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.addEventUnorderedListContent")}},selectedUnorderedListItem:"",selectUnorderedListItem:function(a){try{for(var b=$_(this.idx_dze_unorderedlist_container).parentNode.getElementsByTagName("span"),c=0;c<b.length;c++)b[c].id.replace(/idx_dze_unorderlist_style_/,"")==a?"dze_orderedlist_unit_selection"!=b[c].className?
(b[c].className="dze_orderedlist_unit_selection",this.selectedUnorderedListItem=a):(b[c].className="dze_orderedlist_unit_img",this.selectedUnorderedListItem=""):b[c].className="dze_orderedlist_unit_img"}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectUnorderedListItem")}},selectUnorderedListItem2:function(a){try{for(var b=$_(this.idx_dze_unorderedlist_container).getElementsByTagName("span"),c=0;c<b.length;c++)if(b[c].id.replace(/idx_dze_unorderlist_style_/,"")==a){this.selectedUnorderedListItem=
a;break}}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectUnorderedListItem2")}},setStyleUnorderedListItem:function(a){try{var b=!0;"undefined"!=typeof a&&(b=a);1==b&&this.setEditorSelection();if(1==GetMultiCellSelection())for(var c=0;c<g_objTable.rows.length;c++)for(var d=0;d<g_objTableUtil.getTableCellsLength(g_objTable,c);d++){var e=g_objTableFlag.GetCellAttribute_Flag(g_objTable,c,d);if(2==e||3==e||4==e){var f=g_objTableUtil.getTableCellElement(g_objTable,c,d),g=f.innerHTML;g=
g.replace(/<(ul[^>.]*|\/ul|ol[^>.]*|\/ol)>/gi,"");g=g.replace(/<(\/*)li[^>.]*>/gi,"<$1p>");f.innerHTML=g}}else{var h=null,k=g_objNodeUtil.getAncestorNodeOnCaret(this.nEditNumber);k&&(3==k.nodeType&&(k=k.parentNode),k&&("ul"==k.nodeName.toLowerCase()&&(h=k),"li"==k.nodeName.toLowerCase()&&(h=k.parentNode)));if("none"==this.selectedUnorderedListItem&&null==h)return;if(null!=h){if("none"==this.selectedUnorderedListItem){h.getAttribute("style")&&h.removeAttribute("style");h.getAttribute("class")&&h.removeAttribute("class");
if(h.childNodes.length)for(c=0;c<h.childNodes.length;c++)h.childNodes[c].getAttribute("style")&&h.childNodes[c].removeAttribute("style"),h.childNodes[c].getAttribute("class")&&h.childNodes[c].removeAttribute("class");fnHandler_SupportCommand_Main(this.nEditNumber,"InsertUnorderedList")}else if(h.getAttribute("style")&&h.removeAttribute("style"),h.getAttribute("class")&&h.removeAttribute("class"),inArray(this.selectedUnorderedListItem,this.unorderlist_ext_styles))for("innercircle"==this.selectedUnorderedListItem&&
(h.className="dzeExtListStyleInnerCircle"),"triangle"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleTriangle"),"fillcircle"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleFillCircle"),"diamond"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleDiamond"),c=0;c<h.childNodes.length;c++)"li"==h.childNodes[c].nodeName.toLowerCase()&&(h.childNodes[c].className=h.className+"Li");else for(h.style.listStyleType=this.selectedUnorderedListItem,c=0;c<h.childNodes.length;c++)"LI"==
h.childNodes[c].nodeName.toUpperCase()&&null!=h.childNodes[c].getAttribute("class")&&0<=h.childNodes[c].getAttribute("class").indexOf("dzeExtListStyle")&&h.childNodes[c].removeAttribute("class");return}}if("none"!=this.selectedUnorderedListItem&&""!=this.selectedUnorderedListItem){GetMultiCellSelection()||this.insertZeroWidthCharSpanFocus();this.resetSelection&&g_bBrowserType_IE||1==b&&this.setEditorSelection();fnHandler_SupportCommand_Main(this.nEditNumber,"InsertUnorderedList");cleanPtagForOrderedList(this.nEditNumber);
if(""!=this.selectedUnorderedListItem)if(this.resetSelection&&g_bBrowserType_IE||1==b&&this.setEditorSelection(),1==GetMultiCellSelection())for(c=0;c<g_objTable.rows.length;c++)for(d=0;d<g_objTableUtil.getTableCellsLength(g_objTable,c);d++){if(e=g_objTableFlag.GetCellAttribute_Flag(g_objTable,c,d),2==e||3==e||4==e){f=g_objTableUtil.getTableCellElement(g_objTable,c,d);var l=f.getElementsByTagName("UL");for(h=0;h<l.length;h++)if(inArray(this.selectedUnorderedListItem,this.unorderlist_ext_styles)){l[h].getAttribute("style")&&
l[h].removeAttribute("style");"innercircle"==this.selectedUnorderedListItem&&(l[h].className="dzeExtListStyleInnerCircle");"triangle"==this.selectedUnorderedListItem&&(l[h].className="dzeExtListStyleTriangle");"fillcircle"==this.selectedUnorderedListItem&&(l[h].className="dzeExtListStyleFillCircle");"diamond"==this.selectedUnorderedListItem&&(l[h].className="dzeExtListStyleDiamond");for(var m=0;m<l[h].childNodes.length;m++)"li"==l[h].childNodes[m].nodeName.toLowerCase()&&(l[h].childNodes[m].getAttribute("style")&&
l[h].childNodes[m].removeAttribute("style"),l[h].childNodes[m].className=l[h].className+"Li")}else{l[h].style.listStyleType=this.selectedUnorderedListItem;for(m=0;m<l[h].childNodes.length;m++)"li"==l[h].childNodes[m].nodeName.toLowerCase()&&l[h].childNodes[m].getAttribute("class")&&0<=l[h].childNodes[m].getAttribute("class").indexOf("dzeExtListStyle")&&l[h].childNodes[m].removeAttribute("class");l[h].getAttribute("class")&&0<=l[h].getAttribute("class").indexOf("dzeExtListStyle")&&l[h].removeAttribute("class")}}}else{h=
null;if(k=g_objNodeUtil.getAncestorNodeOnCaret(this.nEditNumber))3==k.nodeType&&(k=k.parentNode),k&&("ul"==k.nodeName.toLowerCase()&&(h=k),"li"==k.nodeName.toLowerCase()&&(h=k.parentNode));null==h&&(h=g_objNodeUtil.getLoopParentElement(k,"ul"));if(null==h)return;if(inArray(this.selectedUnorderedListItem,this.unorderlist_ext_styles))for(h.getAttribute("style")&&h.removeAttribute("style"),"innercircle"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleInnerCircle"),"triangle"==this.selectedUnorderedListItem&&
(h.className="dzeExtListStyleTriangle"),"fillcircle"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleFillCircle"),"diamond"==this.selectedUnorderedListItem&&(h.className="dzeExtListStyleDiamond"),c=0;c<h.childNodes.length;c++)"li"==h.childNodes[c].nodeName.toLowerCase()&&(h.childNodes[c].className=h.className+"Li");else for(h.style.listStyleType=this.selectedUnorderedListItem,c=0;c<h.childNodes.length;c++)"LI"==h.childNodes[c].nodeName.toUpperCase()&&null!=h.childNodes[c].getAttribute("class")&&
0<=h.childNodes[c].getAttribute("class").indexOf("dzeExtListStyle")&&h.childNodes[c].removeAttribute("class");if(window.addEventListener&&g_objEditWindow[this.nEditNumber].getSelection().getRangeAt(0).collapsed)for(c=0;c<h.childNodes.length;c++)"LI"==h.childNodes[c].nodeName.toUpperCase()&&(h.childNodes[c].innerHTML=h.childNodes[c].innerHTML.replace(/\u200B/g,""),h.childNodes[c].innerHTML=h.childNodes[c].innerHTML.replace(/<(span|br)><\/(span|br)>/gi,""),"<br>"==h.childNodes[c].innerHTML&&(h.childNodes[c].innerHTML=
""));if(h)for(e=null,c=0;c<h.childNodes.length;c++)for(e=h.childNodes[c],d=e.childNodes.length-1;0<=d;d--){var n=e.childNodes[d].nodeName.toLowerCase(),q=e.childNodes[d].nodeValue;"span"!=n&&"br"!=n||q||e.removeChild(e.childNodes[d])}}1==b&&g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber)}}catch(p){g_objCommonUtil.displayErrorAlert(p,"duzon_dialog.setStyleUnorderedListItem")}},checkSelectionStyleUnorderedListItem:function(){try{var a=getSelectionParentElement(this.nEditNumber,"UL");if(!GetMultiCellSelection()&&
window.addEventListener&&null==a){var b=g_objEditWindow[this.nEditNumber].getSelection().getRangeAt(0).endContainer;a=g_objNodeUtil.getLoopParentElement(b,"ul")}if(null!=a){var c=a.style.listStyleType;""==c&&(c="disc");"none"==c&&"LI"==a.childNodes[0].nodeName.toUpperCase()&&null!=a.childNodes[0].className&&(c=a.childNodes[0].className.replace(/dzeExtListStyle/,"").toLowerCase());c=c.toLowerCase();duzon_dialog.selectUnorderedListItem(c);g_objCommonUtil.log("selectionListStyleType:"+c)}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"duzon_dialog.checkSelectionStyleUnorderedListItem")}},removeGabageListStyleClass:function(a){try{var b=g_objEditorDocument[a].getElementsByTagName("*");for(a=0;a<b.length;a++)"li"!=b[a].nodeName.toLowerCase()&&b[a].getAttribute("class")&&0<=b[a].getAttribute("class").indexOf("dzeExtListStyle")&&b[a].removeAttribute("class")}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.removeGabageListStyleClass")}},orderlist_styles:"none decimal decimal-leading-zero upper-alpha lower-alpha upper-roman lower-roman lower-greek".split(" "),
idx_dze_orderedlist_container:"idx_dze_orderedlist_container",getStyleOrderedListContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='dze_orderedlist_container' id='"+this.idx_dze_orderedlist_container+"'>";for(var b="",c="",d=0;d<this.orderlist_styles.length;d++)b=this.orderlist_styles[d],c="idx_dze_unorderlist_style_"+b,a="none"==b?a+("\t\t<span class='dze_orderedlist_unit_img' id='"+c+"'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):a+("\t\t<span class='dze_orderedlist_unit_img' id='"+
c+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+b+".png)'></span>");return a+"</div></div>"}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.getStyleOrderedListContent")}},addEventOrderedListContent:function(a){try{for(var b=dzeUiConfig.bTBPreviewLetterOperation,c=$_(this.idx_dze_orderedlist_container).getElementsByTagName("span"),d=0;d<c.length;d++)c[d].onmouseover=function(){"dze_orderedlist_unit_img"==this.className&&(this.className="dze_orderedlist_unit_over");
"dze_orderedlist_unit_selection"!=this.className&&"undefined"!=typeof a&&"toolbar"==a&&!0===b&&(duzon_dialog.selectOrderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleOrderedListItem(!1))},c[d].onmouseout=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_img")},c[d].onmousedown=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_down")},c[d].onmouseup=function(){"dze_orderedlist_unit_down"==
this.className&&(this.className="dze_orderedlist_unit_over")},c[d].onclick="undefined"!=typeof a&&"toolbar"==a?function(){!0===b?($_(duzon_dialog.idx_dze_orderedlist_container).onmouseleave=function(){},g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)):(duzon_dialog.selectOrderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleOrderedListItem());duzon_dialog.closeDialog()}:function(){duzon_dialog.selectOrderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,
""))};"undefined"!=typeof a&&"toolbar"==a&&!0===b&&(g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber),g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),$_(this.idx_dze_orderedlist_container).onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):(g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),g_objUndoRedo.operateUndoRedoStack(!0,
!0,duzon_dialog.nEditNumber))})}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.addEventOrderedListContent")}},selectedOrderedListItem:"",selectOrderedListItem:function(a){try{for(var b=$_(this.idx_dze_orderedlist_container).getElementsByTagName("span"),c=0;c<b.length;c++)b[c].id.replace(/idx_dze_unorderlist_style_/,"")==a?"dze_orderedlist_unit_selection"!=b[c].className?(b[c].className="dze_orderedlist_unit_selection",this.selectedOrderedListItem=a):(b[c].className="dze_orderedlist_unit_img",
this.selectedOrderedListItem=""):b[c].className="dze_orderedlist_unit_img"}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectOrderedListItem")}},selectOrderedListItem2:function(a){try{for(var b=$_(this.idx_dze_orderedlist_container).getElementsByTagName("span"),c=0;c<b.length;c++)b[c].id.replace(/idx_dze_unorderlist_style_/,"")==a&&(this.selectedOrderedListItem=a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectOrderedListItem2")}},setStyleOrderedListItem:function(a){try{"undefined"==
typeof a&&(a=!0);this.setEditorSelection();if(1==GetMultiCellSelection())for(var b=0;b<g_objTable.rows.length;b++)for(var c=0;c<g_objTableUtil.getTableCellsLength(g_objTable,b);c++){var d=g_objTableFlag.GetCellAttribute_Flag(g_objTable,b,c);if(2==d||3==d||4==d){var e=g_objTableUtil.getTableCellElement(g_objTable,b,c),f=e.innerHTML;f=f.replace(/<(ul[^>.]*|\/ul|ol[^>.]*|\/ol)>/gi,"");f=f.replace(/<(\/*)li[^>.]*>/gi,"<$1p>");e.innerHTML=f}}else{var g=null,h=g_objNodeUtil.getAncestorNodeOnCaret(this.nEditNumber);
h&&(3==h.nodeType&&(h=h.parentNode),h&&("ol"==h.nodeName.toLowerCase()&&(g=h),"li"==h.nodeName.toLowerCase()&&(g=h.parentNode)));if("none"==this.selectedOrderedListItem&&null==g)return;if(null!=g){if("none"==this.selectedOrderedListItem){g.getAttribute("style")&&g.removeAttribute("style");g.getAttribute("class")&&g.removeAttribute("class");if(g.childNodes.length)for(b=0;b<g.childNodes.length;b++)g.childNodes[b].getAttribute("style")&&g.childNodes[b].removeAttribute("style"),g.childNodes[b].getAttribute("class")&&
g.childNodes[b].removeAttribute("class");fnHandler_SupportCommand_Main(this.nEditNumber,"InsertOrderedList")}else for(g.getAttribute("style")&&g.removeAttribute("style"),g.getAttribute("class")&&g.removeAttribute("class"),g.style.listStyleType=this.selectedOrderedListItem,b=0;b<g.childNodes.length;b++)"LI"==g.childNodes[b].nodeName.toUpperCase()&&null!=g.childNodes[b].getAttribute("class")&&0<=g.childNodes[b].getAttribute("class").indexOf("dzeExtListStyle")&&g.childNodes[b].removeAttribute("class");
return}}if("none"!=this.selectedOrderedListItem&&""!=this.selectedOrderedListItem){GetMultiCellSelection()||this.insertZeroWidthCharSpanFocus();this.resetSelection&&g_bBrowserType_IE||this.setEditorSelection();fnHandler_SupportCommand_Main(this.nEditNumber,"InsertOrderedList");cleanPtagForOrderedList(this.nEditNumber);if(""!=this.selectedOrderedListItem)if(this.resetSelection&&g_bBrowserType_IE||this.setEditorSelection(),1==GetMultiCellSelection())for(b=0;b<g_objTable.rows.length;b++)for(c=0;c<g_objTableUtil.getTableCellsLength(g_objTable,
b);c++){if(d=g_objTableFlag.GetCellAttribute_Flag(g_objTable,b,c),2==d||3==d||4==d){e=g_objTableUtil.getTableCellElement(g_objTable,b,c);var k=e.getElementsByTagName("OL");for(g=0;g<k.length;g++)k[g].style.listStyleType=this.selectedOrderedListItem}}else{g=null;if(h=g_objNodeUtil.getAncestorNodeOnCaret(this.nEditNumber))3==h.nodeType&&(h=h.parentNode),h&&("ol"==h.nodeName.toLowerCase()&&(g=h),"li"==h.nodeName.toLowerCase()&&(g=h.parentNode));null==g&&(g=g_objNodeUtil.getLoopParentElement(h,"ol"));
if(null==g)return;null!=g&&(g.style.listStyleType=this.selectedOrderedListItem);if(window.addEventListener&&g_objEditWindow[this.nEditNumber].getSelection().getRangeAt(0).collapsed)for(b=0;b<g.childNodes.length;b++)"LI"==g.childNodes[b].nodeName.toUpperCase()&&(g.childNodes[b].innerHTML=g.childNodes[b].innerHTML.replace(/\u200B/g,""),g.childNodes[b].innerHTML=g.childNodes[b].innerHTML.replace(/<(span|br)><\/(span|br)>/gi,""),"<br>"==g.childNodes[b].innerHTML&&(g.childNodes[b].innerHTML=""));if(g)for(d=
null,b=0;b<g.childNodes.length;b++)for(d=g.childNodes[b],c=d.childNodes.length-1;0<=c;c--){var l=d.childNodes[c].nodeName.toLowerCase(),m=d.childNodes[c].nodeValue;"span"!=l&&"br"!=l||m||d.removeChild(d.childNodes[c])}}1==a&&g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber)}}catch(n){g_objCommonUtil.displayErrorAlert(n,"duzon_dialog.setStyleOrderedListItem")}},checkSelectionStyleOrderedListItem:function(){try{var a=getSelectionParentElement(this.nEditNumber,"OL");if(!GetMultiCellSelection()&&
window.addEventListener&&null==a){var b=g_objEditWindow[this.nEditNumber].getSelection().getRangeAt(0).endContainer;a=g_objNodeUtil.getLoopParentElement(b,"ol")}if(null!=a){var c=a.style.listStyleType;""==c&&(c="decimal");c=c.toLowerCase();duzon_dialog.selectOrderedListItem(c);g_objCommonUtil.log("selectionListStyleType:"+c)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.checkSelectionStyleOrderedListItem")}},getWebEditorInfoContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";
a+="<div class='dze_logo_container'></div>";a+="<div class='dze_editor_url_info'><a href='http://www.douzone.com' target='_blank'>http://www.douzone.com</a></div>";a+="<div class='dze_editor_url_info'>"+ID_RES_DIALOG_STRING_VERSION+" : "+dzeVersion.version+"</div>";return a+"<div class='dze_editor_copyright_info'>Copyright Douzone Bizon, All right reserved.</div></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getWebEditorInfoContent")}},dze_idx_shortcuts_content:"dze_idx_shortcuts_content",
getShortCutsInfoContent:function(){try{return"<div class='dze_shortcuts_content' id='"+this.dze_idx_shortcuts_content+"'></div>"}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.getShortCutsInfoContent")}},setShortCutsInfo:function(){try{this.dynamicScriptCall("const/shortcuts_info_const.js",function(){$_(duzon_dialog.dze_idx_shortcuts_content).innerHTML=shortcutsInfo;for(var a=$_(duzon_dialog.dze_idx_shortcuts_content).getElementsByTagName("tr"),b=0;b<a.length;b++)a[b].onmouseover=function(){for(var a=
this.getElementsByTagName("td"),b=0;b<a.length;b++)"dze_shortcuts_table_body"==a[b].className&&(a[b].className="dze_shortcuts_table_body_over")},a[b].onmouseout=function(){for(var a=this.getElementsByTagName("td"),b=0;b<a.length;b++)"dze_shortcuts_table_body_over"==a[b].className&&(a[b].className="dze_shortcuts_table_body")};duzon_dialog.setObjectPosition(null,duzon_dialog.dialog_obj,"center")})}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.setShortCutsInfo")}},curr_forecolor:[],curr_backcolor:[],
curr_cell_backcolor:[],curr_image_border_backcolor:[],curr_table_border_backcolor:[],ext_contents_container:null,ext_contents_sub_container:null,idx_dze_ext_item_overlayer:"idx_dze_ext_item_overlayer",affectedColorPreviewSet:!1,color_picker_mode:"none",nExtendsDlgType:0,extendsDlgTypeInfo:[{},{}],makeExtendsDlgInfo:function(){try{this.extendsDlgTypeInfo[0].length||(this.extendsDlgTypeInfo[DZE_EXTENDS_COLOR_PICKER]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},
this.extendsDlgTypeInfo[DZE_EXTENDS_EMOTICON]={strExtendsDlgType:"emoticons",jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons"},this.extendsDlgTypeInfo[DZE_EXTENDS_CASCADE_ORDERLIST]={strExtendsDlgType:"cascade_orderlist",jsSrc:"const/cascade_orderlist_const.js",refInfoDB:"dzeCasCadeOrderList"},this.extendsDlgTypeInfo[DZE_EXTENDS_COPY_EXT]={strExtendsDlgType:"copy_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeCopyExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_PASTE_EXT]=
{strExtendsDlgType:"paste_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzePasteExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_INSERT_PARAGRAPH]={strExtendsDlgType:"insert_paragraph",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeInsertParagraphList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_DELETE_EXT]={strExtendsDlgType:"table_delete_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableDeleteExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_SELECT]={strExtendsDlgType:"table_select",
jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableSelectList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_FORMULA_EXT]={strExtendsDlgType:"table_formula_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableFomulaExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_NUMBER_FORMAT]={strExtendsDlgType:"table_number_format",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableNumberFormatList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_TYPE]={strExtendsDlgType:"image_border_type",
jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderTypeList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_THICKNESS]={strExtendsDlgType:"image_border_thickness",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderThicknessList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_COLOR]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_THICKNESS]={strExtendsDlgType:"table_border_thickness",
jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderThicknessList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_TYPE]={strExtendsDlgType:"table_border_type",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderTypeList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_COLOR]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},this.extendsDlgTypeInfo[DZE_EXTENDS_STYLE_UNORDERLIST]={strExtendsDlgType:"style_unorderlist",
jsSrc:"const/cascade_orderlist_const.js",refInfoDB:"dzeStyleUnOrderList"},this.extendsDlgTypeInfo[DZE_EXTENDS_STYLE_ORDERLIST]={strExtendsDlgType:"style_orderlist",jsSrc:"const/cascade_orderlist_const.js",refInfoDB:"dzeStyleOrderList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_CELL_ALIGN]={strExtendsDlgType:"table_cell_align",jsSrc:"const/common_popup_const.js",refInfoDB:"dzeTableCellAlignList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_STYLE]={strExtendsDlgType:"table_style",jsSrc:"const/common_popup_const.js",
refInfoDB:"dzeTableStyleList"})}catch(a){g_objCommonUtil.displayErrorAlert(a,"duzon_dialog.makeExtendsDlgInfo")}},getDisplayExtendsDlgType:function(){switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_COLOR_PICKER:case DZE_EXTENDS_IMAGE_BORDER_COLOR:case DZE_EXTENDS_TABLE_BORDER_COLOR:var a=DZE_DISPLAY_EXTENDS_COLOR_PICKER;break;case DZE_EXTENDS_EMOTICON:a=DZE_DISPLAY_EXTENDS_EMOTICON;break;case DZE_EXTENDS_CASCADE_ORDERLIST:case DZE_EXTENDS_STYLE_UNORDERLIST:case DZE_EXTENDS_STYLE_ORDERLIST:a=
DZE_DISPLAY_EXTENDS_CASCADE_ORDERLIST;break;case DZE_EXTENDS_COPY_EXT:case DZE_EXTENDS_PASTE_EXT:case DZE_EXTENDS_INSERT_PARAGRAPH:case DZE_EXTENDS_TABLE_DELETE_EXT:case DZE_EXTENDS_TABLE_SELECT:case DZE_EXTENDS_TABLE_FORMULA_EXT:case DZE_EXTENDS_TABLE_NUMBER_FORMAT:case DZE_EXTENDS_IMAGE_BORDER_TYPE:case DZE_EXTENDS_IMAGE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_TYPE:a=DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST;break;case DZE_EXTENDS_TABLE_CELL_ALIGN:case DZE_EXTENDS_TABLE_STYLE:a=
DZE_DISPLAY_EXTENDS_COMMON_POPUP;break;default:a=DZE_DISPLAY_EXTENDS_NONE}return a},createEmoticonsTable:function(a){try{var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("border","0");var c=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);for(a=0;a<c.length;a++){duzon_dialog.createTitleRowCell(b,7,c[a].name,0==a?!0:!1);duzon_dialog.createEmptyRowCell(b,2,7);var d=b.insertRow();d.setAttribute("height",
"12");var e=d.insertCell();e.setAttribute("width","3");for(var f=0;8>f;f++){var g=duzon_dialog.createObjUnitDiv(a,f,c,null,null,null,null);e=d.insertCell();e.appendChild(g);3==f&&(e=d.insertCell(),e.setAttribute("width","3"),d=b.insertRow(),d.setAttribute("height","12"),e=d.insertCell(),e.setAttribute("width","3"))}}return b}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.createEmoticonsTable")}return null},viewExtendsDlg:function(a,b,c,d,e,f,g){try{if(g_nActiveEditNumber=this.nEditNumber=
b,null!=this.ext_contents_container)this.closeExtendsDlg();else{this.color_picker_mode="basic";g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);1!=this.dialogStatus&&g_objInsertUtil.saveSelectionRange_IE(0,b);"undefined"==typeof f&&(f="toolbar");"undefined"==typeof g&&(g=!0);duzon_dialog.makeExtendsDlgInfo();var h=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType;this.ext_contents_container=document.createElement("div");this.ext_contents_container.className="dze_ext_dialog_container";
this.ext_contents_container.id=h+"_"+a.id;this.ext_contents_container.onclick=function(a){TBCancelBubbleEvent(a?a:window.event)};this.ext_contents_container.onmousedown=function(a){TBCancelBubbleEvent(a?a:window.event)};this.ext_contents_container.onmouseover=function(a){a=a?a:window.event;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);TBCancelBubbleEvent(a)};0<=a.id.indexOf("_SUB")?document.getElementById(a.id.replace(/_SUB/,"")).parentNode.appendChild(this.ext_contents_container):a.parentNode.appendChild(this.ext_contents_container);
"toolbar"!=f||!0!==dzeUiConfig.bTBPreviewLetterOperation||duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_COLOR_PICKER&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR||(g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable));this.dynamicScriptCall(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].jsSrc,function(){var k=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);
switch(duzon_dialog.getDisplayExtendsDlgType()){case DZE_DISPLAY_EXTENDS_COLOR_PICKER:!0===dzeUiConfig.showTBRecentColor&&duzon_dialog.updateTBRecentColorCtrl(k);k=duzon_dialog.createColorPickerTable(k,c,a,g,f);break;case DZE_DISPLAY_EXTENDS_EMOTICON:k=duzon_dialog.createEmoticonsTable(h);break;case DZE_DISPLAY_EXTENDS_CASCADE_ORDERLIST:k=duzon_dialog.createCascadeOrderListTable(k,b);break;case DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST:k=duzon_dialog.createGeneralCommandListTable(k,b);break;case DZE_DISPLAY_EXTENDS_COMMON_POPUP:k=
duzon_dialog.createCommonPopupTable(k,b);break;default:return}duzon_dialog.ext_contents_container.appendChild(k);"undefined"!=typeof d&&null!=d&&0<d.length&&(k=DZE_EXTENDS_TABLE_STYLE==duzon_dialog.nExtendsDlgType?duzon_dialog.createDialogButtonBox(2,d,e):duzon_dialog.makeBottomBtnProcess(d,e,f),duzon_dialog.ext_contents_container.appendChild(k));duzon_dialog.setOpacity(this.ext_contents_container,0);duzon_dialog.ext_contents_container.style.display="block";"toolbar"==f&&(duzon_dialog.addExtContentsEvent(),
duzon_dialog.resizeExtContentsContainerPos(a,!0),duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_COLOR_PICKER&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR||!0!==dzeUiConfig.bTBPreviewLetterOperation||duzon_dialog.addColorPreviewEventForTB(a));duzon_dialog.animateDlg(duzon_dialog.ext_contents_container,"down")})}}catch(k){duzon_dialog.setOpacity(duzon_dialog.ext_contents_container,1),g_objCommonUtil.displayErrorAlert(k,"duzon_dialog.viewExtendsDlg")}},
addColorPreviewEventForTB:function(a){try{duzon_dialog.ext_contents_container.onmouseenter=function(){g_objTable&&!GetMultiCellSelection()&&a.id=="TB_SETCELLBACKCOLOR_"+duzon_dialog.nEditNumber+"_SUB"&&g_objTableSelection.table_SelectionCaretCell(duzon_dialog.nEditNumber);GetMultiCellSelection()?(g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),duzon_dialog.removeMultiCellSelectionBG(!0)):0<=a.id.indexOf("IMAGEBORDERCOLOR")||0<=a.id.indexOf("TABLEBORDERCOLOR")||g_objUndoRedo.registerUndoRedoStack(0,
duzon_dialog.nEditNumber)},duzon_dialog.ext_contents_container.onmouseleave=function(){GetMultiCellSelection()?(g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable),duzon_dialog.recoverMultiCellSelectionBG()):0<=a.id.indexOf("IMAGEBORDERCOLOR")||0<=a.id.indexOf("TABLEBORDERCOLOR")||(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.strTimeCodeID_Start=null,duzon_dialog.strTimeCodeID_End=null);duzon_dialog.affectedColorPreviewSet=!1}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.addColorPreviewEventForTB")}},makeBottomBtnProcess:function(a,b,c){try{var d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");d.setAttribute("border","0");d.setAttribute("width","100%");var e=null,f=null;duzon_dialog.createEmptyRowCell(d,8,6);duzon_dialog.createSeperateLineRowCell(d,0,6);duzon_dialog.createEmptyRowCell(d,2,6);for(var g=0;g<a.length;g++)e=d.insertRow(),f=e.insertCell(),f.setAttribute("width","8"),f=e.insertCell(),f.setAttribute("width",
"16"),f.className="duzon_menubar_select_item",f.style.textAlign="center",f.innerHTML=duzon_dialog.makeColorPickerItemHTML(a[g]),f.onmouseover=function(){for(var a=0;a<this.parentNode.childNodes.length;a++)this.parentNode.childNodes[a].className="duzon_menubar_select_item_icon_over"},f.onmouseout=function(){for(var a=0;a<this.parentNode.childNodes.length;a++)this.parentNode.childNodes[a].className="duzon_menubar_select_item"},function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==
c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&(duzon_dialog.ext_contents_container.onmouseleave=function(){},duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?(g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable),duzon_dialog.recoverMultiCellSelectionBG()):g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber));a(b)}}(),f=e.insertCell(),f.setAttribute("width","6"),f=e.insertCell(),f.innerHTML=a[g],f.className="duzon_menubar_select_item",f.onmouseover=
function(){for(var a=0;a<this.parentNode.childNodes.length;a++)this.parentNode.childNodes[a].className="duzon_menubar_select_item_caption_over"},f.onmouseout=function(){for(var a=0;a<this.parentNode.childNodes.length;a++)this.parentNode.childNodes[a].className="duzon_menubar_select_item"},function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=
DZE_EXTENDS_TABLE_BORDER_COLOR&&(duzon_dialog.ext_contents_container.onmouseleave=function(){},duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?(g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable),duzon_dialog.recoverMultiCellSelectionBG()):g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber));a(b)}}(),f=e.insertCell(),f.setAttribute("width","3"),f=e.insertCell(),f.setAttribute("width","6");duzon_dialog.createEmptyRowCell(d,6,6);return d}catch(h){g_objCommonUtil.displayErrorAlert(h,
"duzon_dialog.makeBottomBtnProcess")}},makeColorPickerItemHTML:function(a){try{if(a==ID_RES_DIALOG_STRING_BASIC)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_default.png'>";if(a==ID_RES_CONST_STRING_OTHER_COLOR)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_other.png'>";if(a==ID_RES_DIALOG_BTN_NOCOLOR)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_null.png'>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.makeColorPickerItemHTML")}},createEmptyRowCell:function(a,
b,c){try{var d=a.insertRow();b&&d.setAttribute("height",b);var e=d.insertCell();c&&e.setAttribute("colspan",c)}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.createEmptyRowCell")}},createTitleRowCell:function(a,b,c,d){try{var e=a.insertRow().insertCell();e.setAttribute("align","left");b&&e.setAttribute("colspan",b);d&&(e.style.borderTopWidth="0px");e.className="dze_extdlg_title_container";e.innerHTML=c}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.createTitleRowCell")}return a},
createSeperateLineRowCell:function(a,b,c){try{var d=a.insertRow();d.setAttribute("height","1");var e=null;b&&(e=d.insertCell(),e.setAttribute("width",b));e=d.insertCell();e.className="dze_color_picker_separator_line";c&&e.setAttribute("colspan",c);b&&(e=d.insertCell(),e.setAttribute("width",b))}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.createSeperateLineRowCell")}return a},createColorPickerTable:function(a,b,c,d,e){try{var f=document.createElement("table");f.setAttribute("cellspacing",
"0");f.setAttribute("cellpadding","0");f.setAttribute("border","0");for(var g=0;g<a.length;g++){switch(g){case 0:duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_THEME,!0);duzon_dialog.createEmptyRowCell(f,8,21);break;case 1:duzon_dialog.createEmptyRowCell(f,6,21);break;case 6:duzon_dialog.createEmptyRowCell(f,8,21);duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_STANDARD,!1);duzon_dialog.createEmptyRowCell(f,8,21);break;case 8:!0===dzeUiConfig.showTBRecentColor&&(duzon_dialog.createEmptyRowCell(f,
8,21),duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_RECENT_COLOR,!1),duzon_dialog.createEmptyRowCell(f,4,21))}7<=g&&duzon_dialog.createEmptyRowCell(f,4,21);var h=f.insertRow();h.setAttribute("height","12");duzon_dialog.createColorPickerTableCol(a,g,h,b,c,d,e)}duzon_dialog.ext_contents_sub_container=document.createElement("div");duzon_dialog.ext_contents_sub_container.className="dze_color_picker_palettes_container";duzon_dialog.ext_contents_sub_container.appendChild(f);return duzon_dialog.ext_contents_sub_container}catch(k){g_objCommonUtil.displayErrorAlert(k,
"duzon_dialog.createColorPickerTable")}return null},createObjUnitDiv:function(a,b,c,d,e,f,g){try{var h=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,k=document.createElement("div");k.className="dze_"+h+"_unit_item";if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_COLOR||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR){var l=c[a][b];k.style.backgroundColor=""!=l?"#"+l:""}else k.innerHTML=
duzon_dialog.makeEmoticonItemHTML(a,b,c,!0);(function(){var a=l;k.innerHTML&&(a="<img src='"+k.childNodes[0].src+"'  width='64' height='64'>");k.onmousedown=function(a){TBCancelBubbleEvent(a?a:window.event)};k.onmouseout=function(a){};k.onmouseover=function(b){g_objCommonUtil.log("onmouseover event call");b=duzon_dialog.ext_contents_container.getElementsByTagName("table")[0];b=duzon_menubar.calcElementPosition(b);var c=duzon_menubar.calcElementPosition(this.parentNode);duzon_dialog.overLayerObjProcess(a,
d,e,f,g,b.left+c.left-1,b.top+c.top-1)}})();return k}catch(m){}return null},createColorPickerTableCol:function(a,b,c,d,e,f,g){try{for(var h=0;h<a[b].length;h++){objNewCell=c.insertCell();objNewCell.setAttribute("width","4");var k=duzon_dialog.createObjUnitDiv(b,h,a,d,e,f,g);objNewCell=c.insertCell();objNewCell.setAttribute("width","12");objNewCell.appendChild(k)}objNewCell=c.insertCell();objNewCell.setAttribute("width","4")}catch(l){g_objCommonUtil.displayErrorAlert(l,"duzon_dialog.createColorPickerTableCol")}},
overLayerObjProcess:function(a,b,c,d,e,f,g){try{var h=1!=duzon_dialog.dialogStatus?document.getElementById(duzon_dialog.idx_dze_ext_item_overlayer):g_objLayerKit.getElementById(duzon_dialog.idx_dze_ext_item_overlayer);if(null==h){h=document.createElement("div");h.className="dze_ext_item_over_layer";h.id=duzon_dialog.idx_dze_ext_item_overlayer;var k=document.createElement("div");k.className="dze_ext_item_over_layer_innerbox";duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==
DZE_EXTENDS_IMAGE_BORDER_COLOR||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR?(h.style.width="12px",h.style.height="12px",k.style.width="10px",k.style.height="10px"):(h.style.width="30px",h.style.height="30px",k.style.width="28px",k.style.height="28px");h.appendChild(k);duzon_dialog.ext_contents_container.appendChild(h)}(function(){g_objCommonUtil.log("cur_pos_value:"+a);h.onmousedown=function(a){};h.onclick=function(f){duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_COLOR_PICKER&&duzon_dialog.nExtendsDlgType!=
DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR?(duzon_dialog.insertTypeContent(a),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)):("toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation?(duzon_dialog.ext_contents_container.onmouseleave=function(){},duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?duzon_dialog.recoverMultiCellSelectionBG():0<=c.id.indexOf("IMAGEBORDERCOLOR")||0<=c.id.indexOf("TABLEBORDERCOLOR")||
g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.affectedColorPreviewSet=!1,""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+a,c),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),b("#"+a))):""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+a,c),b("#"+a)),dzeColorPallet.addRecentColorSet(a))};h.onmouseover=function(c){TBCancelBubbleEvent(c?c:window.event);if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_COLOR||
duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR)this.title=""!=a?"#"+a:"","toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation&&(GetMultiCellSelection()||duzon_dialog.setSelectionFromSelectionFlag(),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),b("#"+a,!1),GetMultiCellSelection()?duzon_dialog.removeMultiCellSelectionBG():(duzon_dialog.insertCurrSelectionFlag(),window.attachEvent?g_objEditorDocument[duzon_dialog.nEditNumber].selection.empty():g_objEditorDocument[duzon_dialog.nEditNumber].getSelection().removeAllRanges()),
duzon_dialog.affectedColorPreviewSet=!0)};h.onkeydown=function(a){TBCancelBubbleEvent(a?a:window.event)};h.onkeyup=function(a){TBCancelBubbleEvent(a?a:window.event)}})();h.style.left=f+"px";h.style.top=g+"px";h.style.display="block"}catch(l){g_objCommonUtil.displayErrorAlert(l,"duzon_dialog.overLayerObjProcess")}},updateTBRecentColorCtrl:function(a){try{8<a.length&&(a.pop(),a.pop());for(var b=dzeColorPallet.getRecentColorSet(),c=[],d=[],e=0;10>e;e++){var f="";f="undefined"==typeof b[e]?"":b[e];c.push(f)}for(e=
10;20>e;e++)f="",f="undefined"==typeof b[e]?"":b[e],d.push(f);a.push(c);a.push(d)}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.updateTBRecentColorCtrl")}},createGeneralCommandListTable:function(a,b){try{if(!a||!a.length)return null;var c=document.createElement("table");c.setAttribute("width","100%");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");c.setAttribute("title","");var d=c.insertRow(),e=d.insertCell();e.setAttribute("colspan",
6);e.setAttribute("height",5);for(var f="",g="",h="",k=null,l=null,m=0;m<a.length;m++){0<m&&(d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("height",1),d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("class","dze_extdlg_general_btn_underline"),d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("height",1));f=a[m];g=g_arrConst[f][1];h=g_arrIcon[f];""!=h&&(k=document.createElement("img"),k.alt=h,k.src=dzeEnvConfig.strPath_Image+
"toolbar/"+h);l=eval(g_arrConst[f][3]);d=c.insertRow();d.setAttribute("class","dze_extdlg_general_btn_unit");d.MBCODE=f;d.TBSTATE=ID_STRING_NAME_UNCHECKED;d.command=g_arrConst[f][0];d.command_id=f;d.support_type=g_arrConst[f][4];d.support_control_type=g_arrConst[f][5];if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_DELETE_EXT&&ID_COMMAND_TABLE_DELETE_TABLE!=f&&g_objTable){var n=g_objTableSelection.CheckTableSelection(g_objEditorDocument[b],g_objTable,b),q=!0;if(n)if(ID_COMMAND_TABLE_DELETE_ROW==
f)switch(n[0]){case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:case UI_TABLE_SELECT_TYPE_ONE_CELL:case UI_TABLE_SELECT_TYPE_ENTIRE_COL:case UI_TABLE_SELECT_TYPE_GENERAL:q=!1}else if(ID_COMMAND_TABLE_DELETE_COL==f)switch(n[0]){case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:case UI_TABLE_SELECT_TYPE_ONE_CELL:case UI_TABLE_SELECT_TYPE_ENTIRE_ROW:case UI_TABLE_SELECT_TYPE_GENERAL:q=!1}0==q&&(d.TBSTATE=ID_STRING_NAME_GRAY,d.style.opacity=.3)}(function(){var a=l;d.onclick=function(c){this.TBSTATE!=ID_STRING_NAME_GRAY&&
(c=c?c:window.event,a(c,this,b),duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(c))}})();d.onmouseover=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_over")};d.onmousedown=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_down",TBCancelBubbleEvent(a))};d.onmouseup=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_over",TBCancelBubbleEvent(a))};
d.onmouseout=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_unit")};""==h?duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE?e=duzon_dialog.makeBorderTypeCell(d,f,g):duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS?e=duzon_dialog.makeBorderThicknessCell(d,f,g):(e=d.insertCell(),e.setAttribute("align","middle"),
e.innerHTML=g):(e=d.insertCell(),e.setAttribute("width",8),e=d.insertCell(),e.setAttribute("width",16),e.appendChild(k),e=d.insertCell(),e.setAttribute("width",6),e=d.insertCell(),e.setAttribute("align","left"),e.innerHTML=g,e=d.insertCell(),e.setAttribute("width",10),e=d.insertCell(),e.setAttribute("width",3))}d=c.insertRow();e=d.insertCell();e.setAttribute("colspan",6);e.setAttribute("height",5);var p=document.createElement("div");p.className="dze_extdlg_general_command_container";a[0]===ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT&&
(p.style.width="100px");p.appendChild(c);return p}catch(r){g_objCommonUtil.displayErrorAlert(r,"error:createGeneralCommandListTable")}},makeBorderTypeCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",5);d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");e.style.border="none";switch(b){case ID_COMMAND_IMAGE_BORDER_SOLID:e.style.borderBottom="solid";break;case ID_COMMAND_IMAGE_BORDER_DASHED:e.style.borderBottom="dashed";break;case ID_COMMAND_IMAGE_BORDER_DOTTED:e.style.borderBottom=
"dotted";break;case ID_COMMAND_IMAGE_BORDER_DOUBLE:e.style.borderBottom="double";break;case ID_COMMAND_IMAGE_BORDER_NONE:d.setAttribute("align","left"),d.innerHTML=c}d.appendChild(e);d=a.insertCell();d.setAttribute("width",5);return d},makeBorderThicknessCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",5);if(ID_COMMAND_IMAGE_BORDER_NONE==b)return d=a.insertCell(),d.setAttribute("align","left"),d.innerHTML=c,a.insertCell(),a.insertCell(),d=a.insertCell(),d.setAttribute("width",5),d;
d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");e.style.border="none";e.style.borderBottom="solid";b=b-ID_COMMAND_IMAGE_BORDER_1PX+1;0>b&&(b=0);e.style.borderWidth=b+"px";d.appendChild(e);d=a.insertCell();d.setAttribute("width",5);d=a.insertCell();d.setAttribute("width",10);d.setAttribute("align","left");d.innerHTML=c;d=a.insertCell();d.setAttribute("width",5);return d},strTimeCodeID_Start:null,strTimeCodeID_End:null,setTimeCodeID:function(){try{this.strTimeCodeID_End=
this.strTimeCodeID_Start=null;var a=(new Date).getTime();this.strTimeCodeID_Start="S_"+a;this.strTimeCodeID_End="E_"+a}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.setTimeCodeID")}},insertCurrSelectionFlag:function(){try{var a=this.nEditNumber;if(GetMultiCellSelection())g_objCommonUtil.log("Not Support MultiCellSelection!");else if(this.setTimeCodeID(),window.attachEvent){var b=g_objEditorDocument[a].selection;if(!fnObjectCheckNull(b)){var c=b.createRange();if(!fnObjectCheckNull(c))if(""==
c.htmlText){var d='<span id="'+this.strTimeCodeID_Start+'"></span><span id="'+this.strTimeCodeID_End+'"></span>';c.pasteHTML(d)}else{var e='<span id="'+this.strTimeCodeID_Start+'"></span>',f='<span id="'+this.strTimeCodeID_End+'"></span>',g=c.duplicate();g.collapse(!0);g.pasteHTML(e);var h=c.duplicate();h.collapse(!1);h.pasteHTML(f)}}}else if(b=g_objEditWindow[a].getSelection(),1==b.rangeCount){var k=b.getRangeAt(0);if(k.collapsed)d='<span id="'+this.strTimeCodeID_Start+'"></span><span id="'+this.strTimeCodeID_End+
'"></span>',insertHTMLCodeAtSelection(d,null,a);else if(c=!1,ID_SELECTION_TEXT_NODE==k.commonAncestorContainer.nodeType&&(c=!0),c){var l=g_objEditorDocument[a].createElement("span"),m=g_objEditorDocument[a].createElement("span");l.id=this.strTimeCodeID_Start;m.id=this.strTimeCodeID_End;l.innerHTML="&nbsp;";m.innerHTML="&nbsp;";var n=g_objEditorDocument[a].createElement("span");n.appendChild(k.cloneContents());var q=g_objEditorDocument[a].createTextNode(n.textContent);insertHTMLCodeAtSelection(null,
m,a);var p=m.parentNode;p.insertBefore(l,m);p.insertBefore(q,m)}else{var r=k.startContainer,u=k.startOffset,v=k.endContainer,t=k.endOffset;l=g_objEditorDocument[a].createElement("span");m=g_objEditorDocument[a].createElement("span");l.id=this.strTimeCodeID_Start;m.id=this.strTimeCodeID_End;b.removeAllRanges();h=g_objEditorDocument[a].createRange();h.setStartBefore(v);h.setEnd(v,t);h.collapse(!1);b.addRange(h);insertHTMLCodeAtSelection(null,m,a);b.removeAllRanges();g=g_objEditorDocument[a].createRange();
g.setStart(r,u);g.setEndAfter(r);g.collapse(!0);b.addRange(g);insertHTMLCodeAtSelection(null,l,a)}}}catch(w){g_objCommonUtil.displayErrorAlert(w,"insertCurrSelectionFlag error")}},setSelectionFromSelectionFlag:function(){try{var a=this.nEditNumber;if(null!=this.strTimeCodeID_Start&&null!=this.strTimeCodeID_End){if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(fnObjectCheckNull(b)){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}for(var c=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start),
d=!0,e=!0,f="";e=d=!0,f=c.innerHTML,-1==f.indexOf(this.strTimeCodeID_Start)&&(d=!1,c=c.parentElement),f=c.innerHTML,-1==f.indexOf(this.strTimeCodeID_End)&&(e=!1,c=c.parentElement),!d||!e;);var g=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start),h=g_objEditorDocument[a].getElementById(this.strTimeCodeID_End),k=b.createRange();k.moveToElementText(g);var l=b.createRange();l.moveToElementText(h);var m=b.createRange();m.moveToElementText(c);m.setEndPoint("StartToStart",k);m.setEndPoint("EndToStart",
l);m.select();var n=g_objNodeUtil.getParentElement(g);if(null==n){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}var q=g_objNodeUtil.getParentElement(h)}else{b=g_objEditWindow[a].getSelection();g=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start);h=g_objEditorDocument[a].getElementById(this.strTimeCodeID_End);if(null==g||null==h){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}b.removeAllRanges();m=g_objEditorDocument[a].createRange();m.setStartAfter(g);m.setEndBefore(h);
b.addRange(m);n=g_objNodeUtil.getParentElement(g);if(null==n){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}q=g_objNodeUtil.getParentElement(h)}null!=q&&(n.removeChild(g),q.removeChild(h));this.strTimeCodeID_End=this.strTimeCodeID_Start=null}}catch(p){try{g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)}catch(r){g_objCommonUtil.displayErrorAlert(r,"setSelectionFromSelectionFlag error")}}},resizeExtContentsContainerPos:function(a,
b){try{if(g_objCommonUtil.log("resizeExtContentsContainerPos Call"),"undefined"!=typeof a&&null!=a&&b){var c=duzon_dialog.getExtContentsPos(a,duzon_dialog.ext_contents_container,"relative");duzon_dialog.ext_contents_container.style.top=c.top+"px";duzon_dialog.ext_contents_container.style.left=c.left+"px"}else if(null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.ext_contents_container.style.display){var d=duzon_dialog.ext_contents_container.id.replace(new RegExp("^"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType+
"_"),""),e=document.getElementById(d);if(null!=e){var f=duzon_dialog.getExtContentsPos(e,duzon_dialog.ext_contents_container,"relative");duzon_dialog.ext_contents_container.style.top=f.top+"px";duzon_dialog.ext_contents_container.style.left=f.left+"px"}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.resizeExtContentsContainerPos")}},animateDlg:function(a,b){try{if(!0!==dzeUiConfig.bToolbarLayerAnimate||!0!==dzeUiConfig.bUseUiMode||"ribbon"!=dze_menu_control.ui_mode)duzon_dialog.setOpacity(a,
1);else if(null!=a&&"none"!=a.style.display){var c=-10,d=-10;if("down"==b){var e=0;a.style.marginTop=c+"px";duzon_dialog.setOpacity(a,e);var f=setInterval(function(){c+=2;e+=.2;0<=c&&(clearInterval(f),c=0);a.style.marginTop=c+"px";duzon_dialog.setOpacity(a,e)},30)}"right"==b&&(e=0,a.style.marginLeft=d+"px",duzon_dialog.setOpacity(a,e),f=setInterval(function(){d+=2;e+=.2;0<=d&&(clearInterval(f),d=0);a.style.marginLeft=d+"px";duzon_dialog.setOpacity(a,e)},30))}}catch(g){duzon_dialog.setOpacity(a,1),
g_objCommonUtil.displayErrorAlert(g,"error:animateDlg")}},getDialogElementPositionFromToolbarElement:function(a,b){try{g_objCommonUtil.log("=============getDialogElementPositionFromToolbarElement START==============");for(var c=a.id.replace(/_SUB$/,""),d=document.getElementById(c).command_id,e=0,f=0;f<g_arrToolbar1.length;f++)if(g_arrToolbar1[f][0]==d){e=1;break}if(0==e)for(f=0;f<g_arrToolbar2.length;f++)if(g_arrToolbar2[f][0]==d){e=2;break}if(0==e)for(f=0;f<g_arrToolbar3.length;f++)if(g_arrToolbar3[f][0]==
d){e=3;break}g_objCommonUtil.log("tb_tr_no:"+e);g_objCommonUtil.log("main_command_id:"+d);d=!1;var g=document.getElementById("TB_CONTAINER_TOOL_"+e+"_HIDDEN_"+duzon_dialog.nEditNumber);if(null!=g){var h=g.getElementsByTagName("div");for(f=0;f<h.length;f++)if(h[f].id==c){d=!0;break}}g_objCommonUtil.log("is_hidden_toolbar:"+d);g_objCommonUtil.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>tb_tr_no:"+e);var k=duzon_menubar.calcElementPosition(document.getElementById(c).parentNode);c={top:0,
left:0,trNo:e,isHidden:d};if(1==d){var l=duzon_menubar.calcElementPosition(g);c.left=c.left+parentToolbarObj_pos.width-l.width;c.top=c.top+l.height-2}var m=g_objPositionUtil.getNodeElementPosition(a);c.left=m.left;c.top=m.top;c.top=c.top+k.height-8;if("undefined"!=typeof b){var n=duzon_menubar.calcElementPosition(b),q=this.getActiveDialogWindowSize();c.left+n.width>q.view_window_width+q.scrollX&&(c.left=c.left-n.width+k.width-4)}0>c.top&&(c.top=0);0>c.left&&(c.left=0);return c}catch(p){g_objCommonUtil.displayErrorAlert(p,
"duzon_dialog.getDialogElementPositionFromToolbarElement")}},getExtContentsPos:function(a,b,c,d){try{"undefined"==typeof c&&(c="relative");"undefined"==typeof d&&(d=this.nEditNumber);var e=a.id.replace(/_SUB$/,"");document.getElementById(e);var f=document.getElementById("EDIT_SET_CONTAINER_"+d);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(f);duzon_menubar.calcElementPosition(document.getElementById(e).parentNode);var g=duzon_menubar.calcElementPosition(document.getElementById(e));a={top:0,
left:0};var h=g_objPositionUtil.getLayerElementPosition(document.getElementById(e),!1),k=duzon_dialog.getParentAbsoluteNodePos(document.getElementById(e),d);a.top=h.top-k.top;a.left=h.left-k.left;a.top+=document.getElementById(e).offsetHeight;if("relative"==c){var l=duzon_menubar.calcElementPosition(b);a.left+l.width+k.left>parentToolbarObj_pos.width+parentToolbarObj_pos.left+l.scrollX&&(a.left=a.left-l.width+g.width)}0>a.left&&(a.left=0);g_objCommonUtil.log("getExtContentsPos result : "+a);return a}catch(m){g_objCommonUtil.displayErrorAlert(m,
"duzon_dialog.getExtContentsPos")}},getParentAbsoluteNodePos:function(a,b){try{"undefined"==typeof b&&(b=duzon_dialog.nEditNumber);for(var c={left:0,top:0},d=0;!(1E3<d)&&a.parentNode;){a=a.parentNode;if("body"==a.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var e=a.currentStyle.getAttribute("position");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)e=g_objEditWindow[b].getComputedStyle(a,null).getPropertyValue("position");if("absolute"==e.toLowerCase()||"relative"==e.toLowerCase()){c=
g_objPositionUtil.getLayerElementPosition(a,!1);"duzon_hidden_toolbar_container"==a.className&&(c.left+=1,c.top+=1);break}d++}return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.getParentAbsoluteNodePos")}},selectColorCode:function(a,b,c){try{if("undefined"!=typeof b&&null!=b&&(g_objCommonUtil.log("selectColorCode:"+a),g_objCommonUtil.log("toolbar_element.id:"+b.id),g_objCommonUtil.log("selectColorCode"),g_objCommonUtil.dir(b),"undefined"==typeof c&&(c=this.nEditNumber),!(null==b||
0>b.id.indexOf("FORECOLOR")&&0>b.id.indexOf("BACKCOLOR")&&0>b.id.indexOf("CELLBACKCOLOR")&&0>b.id.indexOf("IMAGEBORDERCOLOR")&&0>b.id.indexOf("TABLEBORDERCOLOR")))){0<=b.id.indexOf("FORECOLOR")&&(this.curr_forecolor[c]=a);0<=b.id.indexOf("BACKCOLOR")&&(this.curr_backcolor[c]=a);0<=b.id.indexOf("CELLBACKCOLOR")&&(this.curr_cell_backcolor[c]=a);0<=b.id.indexOf("IMAGEBORDERCOLOR")&&(this.curr_image_border_backcolor[c]=a);0<=b.id.indexOf("TABLEBORDERCOLOR")&&(this.curr_table_border_backcolor[c]=a);var d=
document.getElementById(b.id+"_color_selector");a||0<=b.id.indexOf("FORECOLOR")&&(a=g_strBodyFontColor);d.style.backgroundColor=a}}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.selectColorCode")}},closeExtendsDlg:function(){try{if(1==duzon_dialog.isTableStylePreviewApply&&(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.isTableStylePreviewApply=!1),null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.color_picker_mode){this.color_picker_mode=
"none";var a=!1;if(0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETFORECOLOR_")||0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETBACKCOLOR_"))a=!0;duzon_dialog.ext_contents_container.style.display="none";duzon_dialog.ext_contents_container.parentNode.removeChild(duzon_dialog.ext_contents_container);duzon_dialog.ext_contents_container=null;duzon_dialog.nExtendsDlgType=0;duzon_dialog.removeExtContentsEvent();if(1==a&&1!=duzon_dialog.dialogStatus)if(null==g_objTable)editor_onselectionchange(duzon_dialog.nEditNumber);
else if(GetMultiCellSelection()?(duzon_dialog.setEditorFocus(),g_bBrowserType_IE&&(window.attachEvent?g_objEditorDocument[duzon_dialog.nEditNumber].selection.empty():g_objEditWindow[duzon_dialog.nEditNumber].getSelection().removeAllRanges())):duzon_dialog.setEditorFocus(),g_bMenuEnabled||(g_objMenuWin.TBMenuSetStateAllEnable(!0,duzon_dialog.nEditNumber),g_bMenuEnabled=!0),updateTableHandlerUI.updateTableUICommand(duzon_dialog.nEditNumber),g_objTable&&g_objTable.rows.length){var b=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[duzon_dialog.nEditNumber],
duzon_dialog.nEditNumber);null!=b&&updateTableHandlerUI.updateTableUIHandler(b[0],b[1],b[2],b[3],duzon_dialog.nEditNumber)}}}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.closeExtendsDlg")}},addExtContentsEvent:function(){try{window.attachEvent?(window.attachEvent("onmousedown",duzon_dialog.closeExtendsDlg),window.attachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents),window.attachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos)):(window.addEventListener("mousedown",
duzon_dialog.closeExtendsDlg,!1),window.addEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,!1),window.addEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1));for(var a in g_arrEditorAreaContainer)window.attachEvent?(g_objEditorDocument[a].attachEvent("onmousedown",duzon_dialog.closeExtendsDlg),g_objEditorDocument[a].attachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents)):(g_objEditorDocument[a].addEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),g_objEditorDocument[a].addEventListener("keydown",
duzon_dialog.evtKeyCodeExtContents,!1))}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.closeExtendsDlg error")}},removeExtContentsEvent:function(){try{window.detachEvent?(window.detachEvent("onmousedown",duzon_dialog.closeExtendsDlg),window.detachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents),window.detachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos)):(window.removeEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),window.removeEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,
!1),window.removeEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1));for(var a in g_arrEditorAreaContainer)window.detachEvent?(g_objEditorDocument[a].detachEvent("onmousedown",duzon_dialog.closeExtendsDlg),g_objEditorDocument[a].detachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents)):(g_objEditorDocument[a].removeEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),g_objEditorDocument[a].removeEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,!1))}catch(b){g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.closeExtendsDlg error")}},evtKeyCodeExtContents:function(a){try{var b=a?a:window.event;this.keyCode=b.keyCode;g_objCommonUtil.log("keycode :"+this.keyCode);1==duzon_dialog.affectedColorPreviewSet&&(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.affectedColorPreviewSet=!1);27==this.keyCode&&(duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(b))}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.evtKeyCodeExtContents")}},viewToolbarOrderedList:function(){try{html=
this.getStyleOrderedListContent();var a=document.createElement("div");a.innerHTML=html;document.body.appendChild(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.viewToolbarOrderedList")}},table_cell_align_list:"left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" "),idx_dze_table_cell_align_container:"idx_dze_table_cell_align_container",getTableCellAlignContent:function(){try{var a=document.createElement("div");a.className=
"dze_table_cell_align_container";a.id=this.idx_dze_table_cell_horizontalalign_container;for(var b=null,c="",d=0;d<this.table_cell_align_list.length;d++)b=document.createElement("div"),b.className="dze_table_cell_align_unit",c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[d].toUpperCase()),c="<table border=0 cellpadding=0 cellspacing=0><tr><td width='16'><img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_table_cell_align_"+this.table_cell_align_list[d]+".png'></td><td width='6'></td><td>"+
c+"</td></tr></table>",b.innerHTML=c,b.onmouseover=function(){this.className="dze_table_cell_align_unit_over"},b.onmouseout=function(){this.className="dze_table_cell_align_unit"},b.onmousedown=function(){this.className="dze_table_cell_align_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_unit_over"},function(){var a=duzon_dialog.table_cell_align_list[d].split("_"),c=a[0],g=a[1];b.onclick=function(){g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],
g_objTable,c,duzon_dialog.nEditNumber);g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,g,duzon_dialog.nEditNumber);duzon_dialog.closeDialog()}}(),a.appendChild(b);return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.getTableCellAlignContent")}},getTableCellAlignContentWithoutText:function(){try{var a=document.createElement("div");a.className="dze_table_cell_align_ext_container";a.id=this.idx_dze_table_cell_horizontalalign_container;
var b=null,c="",d=dzeUiConfig.bTBPreviewLetterOperation;duzon_dialog.isTableStylePreviewApply=!1;for(var e=0;e<this.table_cell_align_list.length;e++)b=document.createElement("div"),b.className="dze_table_cell_align_ext_unit",c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[e].toUpperCase()),c="<span><img title='"+c+"' src='"+dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_table_cell_align_"+this.table_cell_align_list[e]+".png'></span>",b.innerHTML=c,b.onmouseout=function(){this.className=
"dze_table_cell_align_ext_unit"},b.onmousedown=function(){this.className="dze_table_cell_align_ext_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_ext_unit_over"},function(){var a=duzon_dialog.table_cell_align_list[e].split("_"),c=a[0],h=a[1];b.onmouseover=function(){this.className="dze_table_cell_align_ext_unit_over";d&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,c,duzon_dialog.nEditNumber),
g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,h,duzon_dialog.nEditNumber))};b.onclick=function(){duzon_dialog.isTableStylePreviewApply=!1;d||(g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,c,duzon_dialog.nEditNumber),g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,h,duzon_dialog.nEditNumber));duzon_dialog.closeExtendsDlg();
if(g_objTable){var a=g_objTableSelection.CheckTableSelection(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,duzon_dialog.nEditNumber);updateTableHandlerUI.updateTableUIHandler(a[0],0,0,0,duzon_dialog.nEditNumber);g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)}}}(),a.appendChild(b);d&&(g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),g_objTableSelection.setTableObjectOnCaret(duzon_dialog.nEditNumber),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),
a.onmouseenter=function(){g_objTable&&!GetMultiCellSelection()&&g_objTableSelection.table_SelectionCaretCell(duzon_dialog.nEditNumber);GetMultiCellSelection()&&(g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),duzon_dialog.removeMultiCellSelectionBG(!0))},a.onmouseleave=function(){GetMultiCellSelection()&&g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable)});return a}catch(f){g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.getTableCellAlignContentWithoutText")}},insertZeroWidthCharSpanFocus:function(){try{if(window.attachEvent){var a=
g_objEditorDocument[duzon_dialog.nEditNumber].selection;if(!fnObjectCheckNull(a)){var b=a.type;b=b.toLowerCase();if(ID_STRING_NAME_NONE==b||ID_STRING_NAME_TEXT==b){var c=a.createRange();if(!fnObjectCheckNull(c)&&(a=g_objEditorDocument[duzon_dialog.nEditNumber].selection,""==c.text)){var d="T_"+(new Date).getTime(),e=document.createElement("span");e.innerHTML="&nbsp;";e.id=d;c.pasteHTML(e.outerHTML);var f=g_objEditorDocument[duzon_dialog.nEditNumber].getElementById(d);f.removeAttribute("id");var g=
a.createRange();g.moveToElementText(f);g.moveStart("character",1);g.select();f.innerHTML=""}}}}else if(b=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==b||ID_STRING_NAME_TEXT==b)a=g_objEditWindow[duzon_dialog.nEditNumber].getSelection(),1>=a.rangeCount&&a.getRangeAt(0).collapsed&&(e=document.createElement("span"),e.innerHTML=duzon_dialog.dze_bookmark_last_tag,insertHTMLCodeAtSelection(null,e,duzon_dialog.nEditNumber),duzon_dialog.setFocusElement(e,duzon_dialog.nEditNumber,"start"),duzon_dialog.resetSelection=
!0)}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.insertZeroWidthCharSpanFocus")}},dynamicScriptCall:function(a,b){try{"undefined"==typeof b&&(b=function(){});fullJsSrc=dzeEnvConfig.strPath_JS+a;for(var c=document.getElementsByTagName("head")[0],d=c.getElementsByTagName("script"),e="",f=!1,g=0;g<d.length;g++)if(e=d[g].getAttribute("src"),null!=e&&0<=e.indexOf(a)){f=!0;break}if(1==f)b();else{var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src",
fullJsSrc);var k=!1;document.all?h.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||k||(k=!0,b())}:h.onload=function(){b()};c.appendChild(h)}}catch(l){g_objCommonUtil.displayErrorAlert(l,"duzon_dialog.dynamicScriptCall")}},getActiveDialogWindowSize:function(){try{var a={};g_objLayerKit.getLayerDocument().documentElement.scrollLeft?a.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:a.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft;g_objLayerKit.getLayerDocument().documentElement.scrollTop?
a.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:a.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop;g_objLayerKit.getLayerWindow().innerWidth?(a.view_window_width=g_objLayerKit.getLayerWindow().innerWidth,a.view_window_height=g_objLayerKit.getLayerWindow().innerHeight):(a.view_window_width=g_objLayerKit.getLayerDocument().documentElement.clientWidth,a.view_window_height=g_objLayerKit.getLayerDocument().documentElement.clientHeight);return a}catch(b){return g_objCommonUtil.displayErrorAlert(b,
"duzon_dialog.getActiveDialogWindowSize"),{}}},idx_dze_replace_case_capital:"idx_dze_replace_case_capital",idx_dze_replace_case_small:"idx_dze_replace_case_small",idx_dze_replace_case_reverse:"idx_dze_replace_case_reverse",idx_dze_replace_case_firstword_capital:"idx_dze_replace_case_firstword_capital",replace_case_array:"capital small reverse letter sentence paragraph".split(" "),getReplaceCaseContent:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>";
for(var b="",c="",d="",e=0;e<this.replace_case_array.length;e++)c=this.replace_case_array[e],b="idx_dze_replace_case_"+c,d=eval("ID_RES_CONST_STRING_REPLACE_CASE_"+c.toUpperCase()),a+="<tr><td>",a+="<div class='duzon_dialog_btn_replace_case_item' id='"+b+"'>",a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>",a+="<tr>",a+="<td width='30'>",a+="<div class='duzon_dialog_btn_replace_case_item_image'><img src='"+dzeEnvConfig.strPath_Image+"dialog/popup_btn_replace_case_"+c+".png' width='28' height='28' title='"+
c+"' alt='"+c+"'></div>",a+="</td>",a+="<td style='background-color:#FFFFFF' width='6'></td>",a+="<td style='background-color:#FFFFFF;cursor:pointer'>"+d+"</td>",a+="</tr>",a+="</table>",a+="</div>",a+="</td></tr>",e<this.replace_case_array.length-1&&(a+="<tr><td colspan='2' height='6'></td></tr>");return a+"</table></div>"}catch(f){return g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.getReplaceCaseContent"),""}},selectedReplaceCaseValue:"",initReplaceCaseBtnEvent:function(){try{this.selectedReplaceCaseValue=
"";for(var a=duzon_dialog.dialog_obj.getElementsByTagName("div"),b=0;b<a.length;b++)if("duzon_dialog_btn_replace_case_item"==a[b].className||"duzon_dialog_btn_replace_case_item_over"==a[b].className)a[b].onmouseover=function(){"duzon_dialog_btn_replace_case_item"==this.className&&(this.className="duzon_dialog_btn_replace_case_item_over")},a[b].onmouseout=function(){"duzon_dialog_btn_replace_case_item_over"==this.className&&(this.className="duzon_dialog_btn_replace_case_item")},a[b].onclick=function(){duzon_dialog.selectReplaceCase(this.id)}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"duzon_dialog.initReplaceCaseBtnEvent")}},selectReplaceCase:function(a){try{for(var b=duzon_dialog.dialog_obj.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].id==a?(b[c].className="duzon_dialog_btn_replace_case_item_down",this.selectedReplaceCaseValue=b[c].id.split("_").pop()):"duzon_dialog_btn_replace_case_item_down"==b[c].className&&(b[c].className="duzon_dialog_btn_replace_case_item")}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.selectReplaceCase")}},setReplaceCase:function(){try{if(g_objCommonUtil.log("setReplaceCase START"),
""==this.selectedReplaceCaseValue)g_objCommonUtil.log("selectedReplaceCaseValue : "+this.selectedReplaceCaseValue+" -> return!");else if(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)g_objCommonUtil.log("strSelectionType : "+this.strSelectionType+" -> return!");else{var a=(new Date).getTime(),b="S_"+a;
a="E_"+a;if(window.attachEvent){var c=g_objEditorDocument[duzon_dialog.nEditNumber].selection;if(!fnObjectCheckNull(c)){var d=c.createRange();if(""==d.text)g_objCommonUtil.log("objTxtRange.text : "+d.text+" -> return!");else{c=g_objEditorDocument[this.nEditNumber].selection;9<=g_bBrowserVerInfo&&d.parentElement();var e=d.parentElement(),f='<span id="'+b+'"></span>',g='<span id="'+a+'"></span>',h=d.duplicate();h.collapse(!0);h.pasteHTML(f);var k=d.duplicate();k.collapse(!1);for(k.pasteHTML(g);;){g=
f=!0;var l=e.innerHTML;-1==l.indexOf(b)&&(f=!1,e=e.parentElement);l=e.innerHTML;-1==l.indexOf(a)&&(g=!1,e=e.parentElement);if(f&&g)break}g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1;this.setReplaceCaseStringTree(this.nEditNumber,e,this.selectedReplaceCaseValue,b,a);var m=g_objEditorDocument[this.nEditNumber].getElementById(b),n=g_objEditorDocument[this.nEditNumber].getElementById(a),q=c.createRange();q.moveToElementText(m);var p=c.createRange();p.moveToElementText(n);var r=c.createRange();
r.moveToElementText(e);r.setEndPoint("StartToStart",q);r.setEndPoint("EndToStart",p);r.select();var u=g_objNodeUtil.getParentElement(m);if(null!=u){var v=g_objNodeUtil.getParentElement(n);null!=v&&(u.removeChild(m),v.removeChild(n))}}}}else{d=null;c=g_objEditWindow[duzon_dialog.nEditNumber].getSelection();1>=c.rangeCount&&(d=c.getRangeAt(0));e=!1;var t=d.commonAncestorContainer;if(d.collapsed)g_objCommonUtil.log("objRange.collapsed : "+d.collapsed+" -> return!");else if(ID_SELECTION_TEXT_NODE==t.nodeType&&
(e=!0),m=g_objEditorDocument[this.nEditNumber].createElement("span"),n=g_objEditorDocument[this.nEditNumber].createElement("span"),m.id=b,n.id=a,e){m.innerHTML="&nbsp;";n.innerHTML="&nbsp;";var w=g_objEditorDocument[this.nEditNumber].createElement("span");w.appendChild(d.cloneContents());var B=this.getReplaceCaseString(w.textContent,this.selectedReplaceCaseValue),y=g_objEditorDocument[this.nEditNumber].createTextNode(B);insertHTMLCodeAtSelection(null,n,this.nEditNumber);var x=n.parentNode;x.insertBefore(m,
n);x.insertBefore(y,n);x.removeChild(m);x.removeChild(n);r=g_objEditorDocument[this.nEditNumber].createRange();r.selectNode(y);c.addRange(r)}else{var z=d.startContainer,C=d.startOffset,A=d.endContainer,D=d.endOffset;c.removeAllRanges();k=g_objEditorDocument[this.nEditNumber].createRange();k.setStartBefore(A);k.setEnd(A,D);k.collapse(!1);c.addRange(k);insertHTMLCodeAtSelection(null,n,this.nEditNumber);c.removeAllRanges();h=g_objEditorDocument[this.nEditNumber].createRange();h.setStart(z,C);h.setEndAfter(z);
h.collapse(!0);c.addRange(h);for(insertHTMLCodeAtSelection(null,m,this.nEditNumber);!(ID_SELECTION_ELEMENT_NODE==t.nodeType&&"body"==t.nodeName.toLowerCase()||(g=f=!0,l=t.innerHTML,-1==l.indexOf(b)&&(f=!1,t=t.parentNode),l=t.innerHTML,-1==l.indexOf(a)&&(g=!1,t=t.parentNode),f&&g)););g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1;this.setReplaceCaseStringTree(this.nEditNumber,t,this.selectedReplaceCaseValue,b,a);c.removeAllRanges();r=g_objEditorDocument[this.nEditNumber].createRange();
r.setStartAfter(m);r.setEndBefore(n);c.addRange(r);u=g_objNodeUtil.getParentElement(m);null!=u&&(v=g_objNodeUtil.getParentElement(n),null!=v&&(u.removeChild(m),v.removeChild(n)))}}}}catch(E){g_objCommonUtil.displayErrorAlert(E,"duzon_dialog.setReplaceCase")}},getReplaceCaseString:function(a,b){try{var c="";if("capital"==b)c=a.toUpperCase();else if("small"==b)c=a.toLowerCase();else if("reverse"==b)for(var d=b=null,e=0;e<a.length;e++)b=a[e].match(/[a-z]/),null!=b?c+=a[e].toUpperCase():(d=a[e].match(/[A-Z]/),
c=null!=d?c+a[e].toLowerCase():c+a[e]);else if("letter"==b)if(d=a.split(" "),1<d.length){for(e=0;e<d.length;e++)""!=d[e].trim()&&(d[e]=d[e].capitalizeFirstLetter());c=d.join(" ")}else c=a.capitalizeFirstLetter();else if("sentence"==b)if(d=a.split(". "),1<d.length){for(e=0;e<d.length;e++)""!=d[e].trim()&&(d[e]=d[e].capitalizeFirstLetter());c=d.join(". ")}else c=a.capitalizeFirstLetter();else"paragraph"==b&&(c=a.capitalizeFirstLetter());return c}catch(f){return g_objCommonUtil.displayErrorAlert(f,"duzon_dialog.getReplaceCaseString"),
""}},setReplaceCaseStringTree:function(a,b,c,d,e){try{if(!g_bFindPos_EndLetterOperation&&null!=b.childNodes){if(ID_SELECTION_ELEMENT_NODE==b.nodeType)if(!g_bFindPos_StartLetterOperation)d==b.id&&(g_bFindPos_StartLetterOperation=!0);else if(e==b.id){g_bFindPos_EndLetterOperation=!0;return}for(var f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];this.setReplaceCaseStringTree(a,g,c,d,e);if(g_bFindPos_EndLetterOperation)break;if(g_bFindPos_StartLetterOperation&&ID_SELECTION_TEXT_NODE==g.nodeType){var h=
!0;""==g.nodeValue&&(h=!1);checkTextNodeAllWhiteCode_Plus_Space(g.nodeValue)&&(h=!1);if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var k=g.nodeValue;try{if(g_bBrowserType_FF||g_bBrowserType_WK){if(1==k.length){var l=k.charCodeAt(0);if(10==l||13==l)h=!1}}else g_bBrowserType_OP&&2>=k.length&&(l=k.charCodeAt(0),10==l||13==l)&&(h=!1)}catch(n){}}if(h){var m=this.getReplaceCaseString(g.nodeValue,c);g.nodeValue=m}}}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"duzon_dialog.setReplaceCaseStringTree")}},
viewDetailColorPicker:function(a,b){try{this.color_picker_mode="detail";duzon_dialog.ext_contents_container.innerHTML="";var c=document.createElement("div");c.id="dze_idx_detail_color_picker_div";duzon_dialog.ext_contents_container.appendChild(c);dzeColorPallet.initialize("dze_idx_detail_color_picker_div",a,b);duzon_dialog.ext_contents_container.style.padding="0px";duzon_dialog.ext_contents_container.style.width="auto";duzon_dialog.ext_contents_container.style.height="auto";try{window.detachEvent?
window.detachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos):window.removeEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1)}catch(d){}1!=duzon_dialog.dialogStatus&&duzon_dialog.setDetailColorPickerPosition()}catch(d){g_objCommonUtil.displayErrorAlert(d,"duzon_dialog.viewDetailColorPicker")}},setDetailColorPickerPosition:function(){try{var a=duzon_dialog.ext_contents_container.offsetWidth,b=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+this.nEditNumber),c=g_objPositionUtil.getElementPosition(b,
!1);this.mousedownY=c.top+10;c.width=c.right-c.left;this.mousedownX=c.left+(c.width-a)/2;var d=duzon_dialog.getParentAbsoluteNodePos(duzon_dialog.ext_contents_container,this.nEditNumber);this.mousedownY-=d.top;this.mousedownX-=d.left;duzon_dialog.ext_contents_container.style.left=this.mousedownX+"px";duzon_dialog.ext_contents_container.style.top=this.mousedownY+"px"}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.setDetailColorPickerPosition")}},removeMultiCellSelectionBG:function(a){try{var b=
!1;"undefined"!=typeof a&&(b=a);if(GetMultiCellSelection()){a=null;for(var c="",d=0;d<g_objTable.rows.length;d++)for(var e=g_objTableUtil.getTableCellsLength(g_objTable,d),f=0;f<e;f++)if(a=g_objTableUtil.getTableCellElement(g_objTable,d,f),null!=a&&(c=a.getAttribute("cusSelYN"),null!=c&&"1"==c)){var g=a.getAttribute("cusBGStyleYN"),h=a.getAttribute("cusOriBGColor");1==b&&a.setAttribute("orgOrgBGColor",h);"transparent"==h&&(h="");"1"==g?(a.bgColor="",a.style.backgroundColor=h):"0"==g&&(a.bgColor=h);
a.setAttribute("tempRemoveBG","1");a.removeAttribute("cusBGStyleYN");a.removeAttribute("cusOriBGColor");""==a.bgColor&&a.removeAttribute("bgColor")}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"duzon_dialog.removeMultiCellSelectionBG")}},recoverMultiCellSelectionBG:function(){try{if(GetMultiCellSelection())for(var a=null,b="",c=0;c<g_objTable.rows.length;c++)for(var d=g_objTableUtil.getTableCellsLength(g_objTable,c),e=0;e<d;e++)if(a=g_objTableUtil.getTableCellElement(g_objTable,c,e),null!=a&&(b=
a.getAttribute("tempRemoveBG"))&&"1"==b){a.removeAttribute("tempRemoveBG");a.setAttribute("cusSelYN","1");var f=!0,g=a.style.backgroundColor;""==g&&(f=!1,g=a.bgColor);f?(a.style.backgroundColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR,a.setAttribute("cusBGStyleYN","1")):(a.bgColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR,a.setAttribute("cusBGStyleYN","0"));""==g&&(g="transparent");a.getAttribute("orgOrgBGColor")&&(g=a.getAttribute("orgOrgBGColor"));a.setAttribute("cusOriBGColor",g)}}catch(h){g_objCommonUtil.displayErrorAlert(h,
"duzon_dialog.recoverMultiCellSelectionBG")}},getExtCommonPopupTitle:function(){try{switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_CASCADE_ORDERLIST:var a=ID_RES_DIALOG_STRING_CASCADE_ORDERLIST;break;case DZE_EXTENDS_STYLE_UNORDERLIST:a=ID_RES_CONST_STRING_UNORDERLIST;break;case DZE_EXTENDS_STYLE_ORDERLIST:a=ID_RES_CONST_STRING_ORDERLIST;break;case DZE_EXTENDS_TABLE_CELL_ALIGN:a=ID_RES_CONST_STRING_TABLE_CELL_ALIGN;break;case DZE_EXTENDS_TABLE_STYLE:a=ID_RES_CONST_STRING_STYLE_STYLE;break;
default:return}return a}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getExtCommonPopupTitle")}},getExtCascadeOrderListBody:function(a,b,c){try{for(var d=a.insertRow(),e=null,f="",g="",h=[],k=null,l=0;l<b.length;l++)f=b[l].list_image,g=b[l].over_image,h=b[l].order,e=document.createElement("div"),e.className="dze_cascade_orderlist_unit",e.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"dialog/"+f+"' />",e.title="",function(){var a=g,b=h;e.onmouseover=function(){var b=document.createElement("img");
b.src=dzeEnvConfig.strPath_Image+"dialog/"+a;b.style.top=this.offsetHeight-1+"px";duzon_dialog.setOpacity(b,0);this.appendChild(b);duzon_dialog.animateDlg(b,"down");duzon_dialog.setOpacity(this,1)};e.onmouseout=function(){1<this.childNodes.length&&this.removeChild(this.childNodes[1]);duzon_dialog.setOpacity(this,.5)};e.onclick=function(){duzon_dialog.closeExtendsDlg();setCascadeOrderList(b,c)}}(),duzon_dialog.setOpacity(e,.5),k=d.insertCell(),k.appendChild(e);return a}catch(m){g_objCommonUtil.displayErrorAlert(m,
"duzon_dialog.getExtCascadeOrderListBody")}},getExtStyleUnorderListBody:function(a,b){try{b="<div class='duzon_dialog_content_medium' id='idx_dze_unorderedlist_content_medium'>";b+="<div class='dze_unorderedlist_container' id='"+this.idx_dze_unorderedlist_container+"'>";for(var c="",d="",e=0;e<this.unorderlist_styles.length;e++)c=this.unorderlist_styles[e],d="idx_dze_unorderlist_style_"+c,b="none"==c?b+("\t\t<span class='dze_orderedlist_unit_img' id='"+d+"'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):
b+("\t\t<span class='dze_orderedlist_unit_img' id='"+d+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+c+".png)'></span>");b+="</div>";if(!0===dzeUiConfig.useExtUnorderedListStyleType){b+="<div class='dze_unorderedlist_container' id='"+this.idx_dze_unorderedlist_container2+"'>";d=c="";for(e=0;e<this.unorderlist_ext_styles.length;e++)c=this.unorderlist_ext_styles[e],d="idx_dze_unorderlist_style_"+c,b="none"==c?b+("\t\t<span class='dze_orderedlist_unit_img' id='"+
d+"'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):b+("\t\t<span class='dze_orderedlist_unit_img' id='"+d+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+c+".png)'></span>");b+="</div>"}a.innerHTML=b+"</div>";var f=dzeUiConfig.bTBPreviewLetterOperation,g=a.getElementsByTagName("span");for(e=0;e<g.length;e++)g[e].onmouseover=function(){"dze_orderedlist_unit_img"==this.className&&(this.className="dze_orderedlist_unit_over");!0===f&&"dze_orderedlist_unit_selection"!=this.className&&
(duzon_dialog.selectUnorderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleUnorderedListItem(!1))},g[e].onmouseout=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_img")},g[e].onmousedown=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_down")},g[e].onmouseup=function(){"dze_orderedlist_unit_down"==this.className&&(this.className="dze_orderedlist_unit_over")},g[e].onclick=function(){!0===
f?g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber):(duzon_dialog.selectUnorderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleUnorderedListItem());duzon_dialog.closeExtendsDlg()};return a}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.getExtStyleUnorderListBody")}},getExtStyleOrderListBody:function(a,b){try{var c="<div class='duzon_dialog_content_medium'>";c+="<div class='dze_orderedlist_container' id='"+this.idx_dze_orderedlist_container+
"'>";for(var d="",e="",f=0;f<this.orderlist_styles.length;f++)d=this.orderlist_styles[f],e="idx_dze_unorderlist_style_"+d,c="none"==d?c+("\t\t<span class='dze_orderedlist_unit_img' id='"+e+"'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):c+("\t\t<span class='dze_orderedlist_unit_img' id='"+e+"' style='background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+d+".png)'></span>");a.innerHTML=c+"</div></div>";var g=dzeUiConfig.bTBPreviewLetterOperation,h=a.getElementsByTagName("span");for(f=
0;f<h.length;f++)h[f].onmouseover=function(){"dze_orderedlist_unit_img"==this.className&&(this.className="dze_orderedlist_unit_over");"dze_orderedlist_unit_selection"!=this.className&&!0===g&&(duzon_dialog.selectOrderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleOrderedListItem(!1))},h[f].onmouseout=function(){"dze_orderedlist_unit_over"==this.className&&(this.className="dze_orderedlist_unit_img")},h[f].onmousedown=function(){"dze_orderedlist_unit_over"==this.className&&
(this.className="dze_orderedlist_unit_down")},h[f].onmouseup=function(){"dze_orderedlist_unit_down"==this.className&&(this.className="dze_orderedlist_unit_over")},h[f].onclick=function(){!0===g?g_objUndoRedo.registerUndoRedoStack(0,b):(duzon_dialog.selectOrderedListItem(this.id.replace(/idx_dze_unorderlist_style_/,"")),duzon_dialog.setStyleOrderedListItem());duzon_dialog.closeExtendsDlg()};return a}catch(k){g_objCommonUtil.displayErrorAlert(k,"duzon_dialog.getExtStyleOrderListBody")}},getExtCommonPopupBody:function(a,
b,c){try{var d=a;switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_CASCADE_ORDERLIST:d=duzon_dialog.getExtCascadeOrderListBody(a,b,c);break;case DZE_EXTENDS_STYLE_UNORDERLIST:d=duzon_dialog.getExtStyleUnorderListBody(a,b,c);break;case DZE_EXTENDS_STYLE_ORDERLIST:d=duzon_dialog.getExtStyleOrderListBody(a,b,c);break;case DZE_EXTENDS_TABLE_CELL_ALIGN:d=duzon_dialog.getTableCellAlignContentWithoutText();break;case DZE_EXTENDS_TABLE_STYLE:d=duzon_dialog.getTableStyleContent(b,c);break;default:return null}return d}catch(e){g_objCommonUtil.displayErrorAlert(e,
"duzon_dialog.getExtCommonPopupBody")}},createCascadeOrderListTable:function(a,b){try{if("undefined"!=typeof a&&null!=a&&0!=a.length){var c=document.createElement("table");c.setAttribute("width","100%");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");duzon_dialog.createTitleRowCell(c,0,duzon_dialog.getExtCommonPopupTitle(),!0);var d=document.createElement("table");d.setAttribute("width","100%");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding",
"0");d.setAttribute("border","0");d=duzon_dialog.getExtCommonPopupBody(d,a,b);var e=document.createElement("div");e.className="dze_cascade_orderlist_top_container";e.appendChild(c);var f=document.createElement("div");f.className="dze_cascade_orderlist_body_container";f.appendChild(d);var g=document.createElement("div");g.className="dze_cascade_orderlist_container";g.appendChild(e);g.appendChild(f);!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objUndoRedo.registerUndoRedoStack(0,b),g_objTableSelection.setTableObjectOnCaret(b),
GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),g.onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):(g_objUndoRedo.registerUndoRedoStack(0,b),g_objUndoRedo.operateUndoRedoStack(!0,!0,b))});return g}}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.createCascadeOrderListTable")}},createCommonPopupTable:function(a,b){try{if("undefined"!=typeof a&&null!=a&&0!=a.length){var c=document.createElement("table");
c.setAttribute("width","100%");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");duzon_dialog.createTitleRowCell(c,0,duzon_dialog.getExtCommonPopupTitle(),!0);var d=document.createElement("div");d.className="dze_cascade_orderlist_top_container";d.appendChild(c);var e=duzon_dialog.getExtCommonPopupBody(null,a,b);if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_CELL_ALIGN)return e;var f=document.createElement("div");f.className="dze_cascade_orderlist_container";
f.appendChild(d);f.appendChild(e);return f}}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.createCommonPopupTable")}},isTableStylePreviewApply:!1,getTableStyleContent:function(a,b){try{var c=document.createElement("div");c.className="dze_table_style_container";c.id=this.idx_dze_table_style_container;var d=null,e=null;isTableStylePreviewApply=!1;for(var f="",g=0;g<a.length;g++)d=document.createElement("div"),d.className="dze_table_style_unit",f="<table border=0 cellpadding=0 cellspacing=0><tr><td><img src='"+
dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_table_style_"+(g+1)+".png' width=50 height=35></tr></td></table>",d.innerHTML=f,function(){var c=a[g];d.onmouseover=function(){"dze_table_style_unit_down"!=this.className&&(this.className="dze_table_style_unit_over",!0===dzeUiConfig.bTBPreviewLetterOperation&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_SetTableStyle(g_objEditorDocument[b],g_objTable,c)))};d.onmouseout=function(){"dze_table_style_unit_down"!=this.className&&(this.className=
"dze_table_style_unit",!0===dzeUiConfig.bTBPreviewLetterOperation&&e&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_SetTableStyle(g_objEditorDocument[b],g_objTable,e)))};d.onclick=function(){if("dze_table_style_unit_down"!=this.className){for(var a=this.parentNode.getElementsByTagName("div"),d=0;d<a.length;d++)a[d].className="dze_table_style_unit";this.className="dze_table_style_unit_down";e=c;duzon_dialog.isTableStylePreviewApply=!0;g_objTableOperation.table_SetTableStyle(g_objEditorDocument[b],
g_objTable,c)}}}(),c.appendChild(d);return c}catch(h){g_objCommonUtil.displayErrorAlert(h,"duzon_dialog.getTableStyleContent")}},getHelpImageToTableContentContainer:function(a){a=document.createElement("div");a.id="dze_idx_help_image_to_table";a.style.width="790px";a.style.height="720px";a.style.overflow="auto";a.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_1.png' /><br /><img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_2.png' /><br /><img src='"+
dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_3.png' /><br /><img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_4.png' />";return a},resizeTbColorLinePostion:function(){},createCustomInputBoxDialog:function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_small";var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("width","100%");b.setAttribute("style","border-collapse:collapse;");
var c=b.insertRow(),d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_NAME;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML="<input type='text' name='dze_input_box_name' value='' id='id_dze_input_box_name' style='width:117px;'/>";c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_TAG_NAME;d=c.insertCell();d.style.width="60%";d.style.paddingLeft=
"20px";d.innerHTML="<input type='text' name='dze_input_box_tag_name' value='' id='id_dze_input_box_tag_name' style='width:117px;'/>";c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_TAG_FORMAT;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML="<input type='text' name='dze_input_box_tag_format' value='' id='id_dze_input_box_tag_format' style='width:117px;'/>";c=
b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;for(var e=[],f=0;f<CONTRACTOR_TYPE.length;f++)e.push({value:CONTRACTOR_TYPE[f].name,text:CONTRACTOR_TYPE[f].name});c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_CONTRACTOR_TYPE;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML=this.makeComboInputForm("id_dze_input_box_contractor_type",e,120);c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.innerHTML=
"<div class='duzon_dialog_label_separator'></div>";c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_TEXT_LENGTH;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML="<input type='text' name='dze_input_box_text_length' value='' id='id_dze_input_box_text_length' style='width:117px;'/>";c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;e=[];for(f=1;f<g_arrFontName.length;f++)e.push({value:g_arrFontName[f],text:g_arrFontName[f].replace(/['"]/g,
"")});c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_FONT_FAMILY;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML=this.makeComboInputForm("id_dze_input_box_font_family",e,120);e=[];for(f=1;f<g_objComboBoxWin.arrFontSize.length;f++)e.push({value:g_objComboBoxWin.arrFontSize[f],text:g_objComboBoxWin.arrFontSize[f]});c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width=
"40%";d.textContent=ID_RES_DIALOG_STRING_FONT_SIZE;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML=this.makeComboInputForm("id_dze_input_box_font_size",e,120);c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;e=[];for(f=0;f<FONT_WEIGHT_TYPE.length;f++)e.push({value:FONT_WEIGHT_TYPE[f].value,text:FONT_WEIGHT_TYPE[f].name});c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_FONT_WEIGHT;d=c.insertCell();d.style.width=
"60%";d.style.paddingLeft="20px";d.innerHTML=this.makeComboInputForm("id_dze_input_box_font_weight",e,120);c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.innerHTML="<div class='duzon_dialog_label_separator'></div>";c=b.insertRow();d=c.insertCell();d.style.width="40%";d.textContent=ID_RES_DIALOG_STRING_READONLY;d=c.insertCell();d.style.width="60%";d.style.paddingLeft="20px";d.innerHTML="<input type='radio' name='dze_input_box_readonly' value='1' id='id_dze_input_box_readonly_yes'/><label for='id_dze_input_box_readonly_yes' style='background: none; margin-right: 32px;'>"+
ID_RES_DIALOG_CONFIRM_YES+"</label><input type='radio' name='dze_input_box_readonly' value='2' id='id_dze_input_box_readonly_no'/><label for='id_dze_input_box_readonly_no' style='background: none;'>"+ID_RES_DIALOG_CONFIRM_NO+"</label>";a.appendChild(b);return a.outerHTML}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.createCustomInputBoxDialog")}},customInputBoxDialogElements:[],customInputBox:{name:"",tagName:"",tagFormat:"",contractCode:"",textLength:"",fontFamily:"",fontSize:"",fontWeight:"",
readOnly:""},initCustomInputBox:function(a){try{this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME]=g_objLayerKit.getElementById("id_dze_input_box_name");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME]=g_objLayerKit.getElementById("id_dze_input_box_tag_name");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_FORMAT]=g_objLayerKit.getElementById("id_dze_input_box_tag_format");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE]=g_objLayerKit.getElementById("id_dze_input_box_contractor_type");
this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH]=g_objLayerKit.getElementById("id_dze_input_box_text_length");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY]=g_objLayerKit.getElementById("id_dze_input_box_font_family");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE]=g_objLayerKit.getElementById("id_dze_input_box_font_size");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT]=g_objLayerKit.getElementById("id_dze_input_box_font_weight");
this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES]=g_objLayerKit.getElementById("id_dze_input_box_readonly_yes");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_NO]=g_objLayerKit.getElementById("id_dze_input_box_readonly_no");this.customInputBox.name=a.getAttribute("httl");this.customInputBox.tagName=a.getAttribute("name");this.customInputBox.tagFormat;this.customInputBox.contractCode=a.getAttribute("id");this.customInputBox.textLength=1*a.getAttribute("size");this.customInputBox.fontFamily=
a.style.fontFamily;this.customInputBox.fontSize=a.style.fontSize;this.customInputBox.fontWeight=a.style.fontWeight;this.customInputBox.readOnly=a.getAttribute("readonly");var b=a.getAttribute("general_input");!0===fnObjectCheckNull(this.customInputBox.name)&&(this.customInputBox.name="");!0===fnObjectCheckNull(this.customInputBox.tagName)&&(this.customInputBox.tagName="");!0===fnObjectCheckNull(this.customInputBox.tagFormat)&&(this.customInputBox.tagFormat="");!0===fnObjectCheckNull(this.customInputBox.contractCode)&&
(this.customInputBox.contractCode="");!0===isNaN(this.customInputBox.textLength)&&(this.customInputBox.textLength="");!0===fnObjectCheckNull(this.customInputBox.fontFamily)&&(this.customInputBox.fontFamily="");!0===fnObjectCheckNull(this.customInputBox.fontSize)&&(this.customInputBox.fontSize="9pt");!0===fnObjectCheckNull(this.customInputBox.fontWeight)&&(this.customInputBox.fontWeight="normal");!0===fnObjectCheckNull(this.customInputBox.readOnly)&&(this.customInputBox.readOnly="");b=!1===fnObjectCheckNull(b)&&
"y"===b.toLowerCase()?!0:!1;var c=this.getContractorIndex(this.customInputBox.contractCode),d="readonly"===this.customInputBox.readOnly;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].value=this.customInputBox.name;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].value=this.customInputBox.tagName;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_FORMAT].value=this.customInputBox.tagFormat;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].selectedIndex=
c;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH].value=this.customInputBox.textLength;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY].value=this.customInputBox.fontFamily;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE].value=this.customInputBox.fontSize;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT].value=this.customInputBox.fontWeight;!0===d?this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES].checked=!0:this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_NO].checked=
!0;!1===b&&(this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].setAttribute("disabled",""),this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].setAttribute("disabled",""));""!==this.customInputBox.contractCode&&(this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].setAttribute("disabled",""),this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].style.background="#ebebe4")}catch(e){g_objCommonUtil.displayErrorAlert(e,"duzon_dialog.initCustomInputBox")}},
getContractorIndex:function(a){try{if(""===a)return 0;for(var b=0;b<CONTRACTOR_TYPE.length;b++)if(CONTRACTOR_TYPE[b].code===a)return b;return 0}catch(c){g_objCommonUtil.displayErrorAlert(c,"duzon_dialog.getContractorIndex")}},getContractorCode:function(a){try{return 0>a?"":CONTRACTOR_TYPE[a].code}catch(b){g_objCommonUtil.displayErrorAlert(b,"duzon_dialog.getContractorCode")}},setCustomInputBox:function(a){try{var b=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].value,c=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].value,
d=1*this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].selectedIndex,e=1*this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH].value,f=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY].value,g=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE].value,h=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT].value,k=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES].checked;b!==this.customInputBox.name&&a.setAttribute("httl",
b);c!==this.customInputBox.tagName&&a.setAttribute("name",c);var l=this.getContractorCode(d);l!==this.customInputBox.contractCode&&(a.setAttribute("id",l),a.setAttribute("comptype",l));e!==this.customInputBox.textLength&&a.setAttribute("size",e);b="";f!==this.customInputBox.fontFamily&&(a.style.fontFamily=f);g!==this.customInputBox.fontSize&&(a.style.fontSize=g);h!==this.customInputBox.fontWeight&&(a.style.fontWeight=h);if(f!==this.customInputBox.fontFamily||g!==this.customInputBox.fontSize||h!==
this.customInputBox.fontWeight){b=a.getAttribute("ostyle");var m=b.split(";");a.setAttribute("ostyle","FONT-SIZE:"+g+";FONT-FAMILY:"+f+";FONT-WEIGHT:"+h+";"+m[m.length-2]+";")}k=!0===k?"readonly":"";k!==this.customInputBox.readOnly&&("readonly"===k?a.setAttribute("readonly",k):a.removeAttribute("readonly"))}catch(n){g_objCommonUtil.displayErrorAlert(n,"duzon_dialog.setCustomInputBox")}},createExternalDataBoxDialog:function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_small";
var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("width","100%");b.setAttribute("style","border-collapse:collapse;");var c=b.insertRow(),d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent="id";d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_id' value='' id='id_dze_external_data_id' style='width: 106px; padding: 0px 5px;'/>";c=b.insertRow();
d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent="key";d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_key' value='' id='id_dze_external_data_key' style='width: 106px; padding: 0px 5px;'/>";c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft=
"5px";d.textContent=ID_RES_DIALOG_STRING_WIDTH;d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_size' value='' id='id_dze_external_data_size' style='width: 106px; padding: 0px 5px; text-align: right;'/>";c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.innerHTML="<div class='duzon_dialog_label_separator'></div>";c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent=ID_RES_CONST_STRING_FONT_NAME;
for(var e=[],f=1;f<g_arrFontName.length;f++)e.push({value:g_arrFontName[f],text:g_arrFontName[f].replace(/['"]/g,"")});d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML=this.makeComboInputForm("id_dze_external_data_font_family",e,120);c=b.insertRow();d=c.insertCell();d.setAttribute("colspan","2");d.height=8;c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent=ID_RES_CONST_STRING_FONT_SIZE;e=[];for(f=1;f<g_objComboBoxWin.arrFontSize.length;f++)e.push({value:g_objComboBoxWin.arrFontSize[f],
text:g_objComboBoxWin.arrFontSize[f]});d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML=this.makeComboInputForm("id_dze_external_data_font_size",e,120);a.appendChild(b);return a.outerHTML}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.createExternalDataBoxDialog")}},inputBoxElement:{id:"",key:"",size:"",font_family:"",font_size:""},initExternalDataBoxDialog:function(a){try{var b=g_objLayerKit.getElementById("id_dze_external_data_id"),c=g_objLayerKit.getElementById("id_dze_external_data_key"),
d=g_objLayerKit.getElementById("id_dze_external_data_size"),e=g_objLayerKit.getElementById("id_dze_external_data_font_family"),f=g_objLayerKit.getElementById("id_dze_external_data_font_size");this.inputBoxElement.id=a.getAttribute("id");this.inputBoxElement.key=a.getAttribute("mapping_key");this.inputBoxElement.size=parseFloat(a.getAttribute("size"));this.inputBoxElement.font_family=a.style.fontFamily;this.inputBoxElement.font_size=a.style.fontSize;if(!0===fnObjectCheckNull(this.inputBoxElement.id)||
0===this.inputBoxElement.id.length)this.inputBoxElement.id="";if(!0===fnObjectCheckNull(this.inputBoxElement.key)||0===this.inputBoxElement.key.length)this.inputBoxElement.key="";!0===isNaN(this.inputBoxElement.size)&&(this.inputBoxElement.size=0);!0===fnObjectCheckNull(this.inputBoxElement.font_family)&&(this.inputBoxElement.font_family="\uad74\ub9bc");!0===fnObjectCheckNull(this.inputBoxElement.font_size)&&(this.inputBoxElement.font_size="9pt");b.value=this.inputBoxElement.id;c.value=this.inputBoxElement.key;
d.value=this.inputBoxElement.size;e.value=this.inputBoxElement.font_family;f.value=this.inputBoxElement.font_size;b.select()}catch(g){g_objCommonUtil.displayErrorAlert(g,"duzon_dialog.initExternalDataBoxDialog")}},setExternalDataBoxStyle:function(a){try{var b=g_objLayerKit.getElementById("id_dze_external_data_id"),c=g_objLayerKit.getElementById("id_dze_external_data_key"),d=g_objLayerKit.getElementById("id_dze_external_data_size"),e=g_objLayerKit.getElementById("id_dze_external_data_font_family"),
f=g_objLayerKit.getElementById("id_dze_external_data_font_size"),g=b.value,h=c.value,k=parseFloat(d.value),l=e.value,m=f.value;this.inputBoxElement.id!==g&&a.setAttribute("id",g);this.inputBoxElement.key!==h&&a.setAttribute("mapping_key",h);this.inputBoxElement.size!==k&&a.setAttribute("size",k);this.inputBoxElement.font_family!==l&&(a.style.fontFamily=l);this.inputBoxElement.font_size!==m&&(a.style.fontSize=m)}catch(n){g_objCommonUtil.displayErrorAlert(n,"duzon_dialog.setExternalDataBoxStyle")}}};

var dzeColorPallet={colorno_gap:8,colorRowCnt:32,color_pix:4,colorset:[],default_hexCode:"000000",gray_hexCode:"808080",layerDoc:document,layerWin:window,showButtons:!0,palletViewType:"image",initialize:function(a,b,d,c){this.setLayerDoc();"undefined"!=typeof c&&null!=c&&""!=c&&(dzeColorPallet.layerDoc=c);if("undefined"==typeof a||""==a||null==dzeColorPallet.layerDoc.getElementById(a))g_objCommonUtil.log("please set pallet container id!");else{this.createPalletContainer(a);1==this.showButtons&&this.createPalletButtonContainer(a,
d);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").ondragstart=function(){return!1};dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").onselectstart=function(){return!1};c=255;var e=0,f=0,g="";d=[];for(a=0;a<=this.colorno_gap;a++)e=256/this.colorno_gap*a,255<e&&(e=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)c=256/this.colorno_gap*a,255<c&&(c=255),g=this.getDecToHex(c)+this.getDecToHex(e)+
this.getDecToHex(f),d.push(g);for(a=1;a<=this.colorno_gap;a++)f=256/this.colorno_gap*a,255<f&&(f=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)e=256/this.colorno_gap*a,255<e&&(e=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=1;a<=this.colorno_gap;a++)c=256/this.colorno_gap*a,255<c&&(c=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)f=256/
this.colorno_gap*a,255<f&&(f=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);e=d.length;var h=g=f=0,k={};for(a=0;a<=this.colorRowCnt;a++)if(this.colorset[a]=[],0==a)for(c=0;c<e;c++)this.colorset[a].push(d[c]);else for(c=0;c<e;c++)k=this.getHexToDec(d[c]),0==c&&(f=k.R_val,g=k.G_val,h=k.B_val),128<k.R_val?(f=k.R_val-Math.ceil((k.R_val-128)/this.colorRowCnt*a),128>f&&(f=128)):(f=k.R_val+Math.ceil((128-k.R_val)/this.colorRowCnt*a),128<f&&(f=128)),128<k.G_val?(g=k.G_val-Math.ceil((k.G_val-
128)/this.colorRowCnt*a),128>g&&(g=128)):(g=k.G_val+Math.ceil((128-k.G_val)/this.colorRowCnt*a),128<g&&(g=128)),128<k.B_val?(h=k.B_val-Math.ceil((k.B_val-128)/this.colorRowCnt*a),128>h&&(h=128)):(h=k.B_val+Math.ceil((128-k.B_val)/this.colorRowCnt*a),128<h&&(h=128)),this.colorset[a].push(this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h));d="";if("pixel"==this.palletViewType){d+="<table width='' height='' border='0' cellpadding='0' cellspacing='0'>";e="";for(a=0;a<this.colorset.length;a++){d+=
"<tr>";for(c=0;c<this.colorset[a].length;c++)e=this.colorset[a][c],d+="<td width='"+this.color_pix+"' height='"+this.color_pix+"'><div style=\"cursor:default;width:"+this.color_pix+"px;height:"+this.color_pix+"px;background-color:#"+e+'"></div></td>';d+="</tr>"}d+="</table>"}else"image"==this.palletViewType&&(d+="<div class='dze_color_pallet_bg'></div>");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").innerHTML=d;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").onmousedown=
function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="pallet";dzeColorPallet.showColorSelector(a);a=dzeColorPallet.getColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.viewSubColor(a);dzeColorPallet.showCrossColorSelector("black");g_objCommonUtil.log("\npallet color mouse down color : "+a);g_objCommonUtil.log("\n")};a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_selector";a.className="dze_color_pallet_table_selector_black";
dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").appendChild(a);b=this.checkHexCode(b);!0===dzeUiConfig.showAchromaticColor&&this.viewAchromatic();b==this.default_hexCode||""==b?this.viewSubColor(this.gray_hexCode):this.viewSubColor(b);this.addFormEvent();this.viewOrgColor(b);this.selectCode(b);this.viewRecentColorSet();this.viewUserColorCodeSet();this.addMouseEvent();this.modifySpinnerBtnStyle();g_objCommonUtil.log("\npallet color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.colorset);
g_objCommonUtil.log("\n")}},setLayerDoc:function(){this.layerDoc=g_objLayerKit.getLayerDocument();this.layerWin=g_objLayerKit.getLayerWindow()},color_pallet_container_obj:null,createPalletContainer:function(a){var b="<table width='341' border='0' cellpadding='0' cellspacing='0' id='dze_idx_color_pallet_table_box'>\t<tr>\t\t<td width='196'><div id='dze_idx_color_pallet_table' class='dze_color_pallet_table'></div></td>\t\t<td width='10'></td>\t\t<td width='35'><div id='dze_idx_color_pallet_table_sub' class='dze_color_pallet_table_sub'></div></td>\t\t<td width='100'>";
!0===dzeUiConfig.showPalletRecentColor&&(b+="\t\t\t<div class='dze_color_pallet_table_recent_color_label'>"+ID_RES_CONST_STRING_RECENT_COLOR+"</div><div id='dze_idx_color_pallet_table_recent' class='dze_color_pallet_table_recent'></div>");b+="\t\t</td>\t</tr>\t<tr>\t\t<td height='10' colspan='4'></td>\t</tr>";!0===dzeUiConfig.showAchromaticColor&&(b+="\t<tr>\t\t<td height='35'><div id='dze_idx_color_pallet_table_achromatic' class='dze_color_pallet_table_achromatic'></div></td>\t\t<td colspan='3'></td>\t</tr>\t<tr>\t\t<td height='5' colspan='4'></td>\t</tr>");
b=b+"</table><table width='341' border='0' cellpadding='0' cellspacing='3' id='dze_idx_color_form_table_box'>\t<tr>"+("\t\t<td width='50' align='left'>"+ID_RES_CONST_STRING_RED+"(R):</td>");b+="\t\t<td width='50' align='right'>"+duzon_dialog.makeSpinnerInputForm("dze_idx_color_R_value","",255,0)+"</td>";b+="\t\t<td width='57' align='right'>"+ID_RES_CONST_STRING_HUE+"(H):</td>";b+="\t\t<td width='57' align='right'>"+duzon_dialog.makeSpinnerInputForm("dze_idx_color_H_value","",360,0)+"</td>";b=b+"\t\t<td width='10' colspan='4'></td>\t\t<td width='' rowspan='4' align='center' valign='bottom'>"+
("\t\t\t<div class='dze_color_pallet_table_new_color_box_label'>"+ID_RES_CONST_STRING_NEW_COLOR+"</div>");b=b+"\t\t\t<div id='dze_idx_new_color' class='dze_color_pallet_table_new_color_box'></div>\t\t\t<div id='dze_idx_old_color' class='dze_color_pallet_table_old_color_box'></div>"+("\t\t\t<div class='dze_color_pallet_table_old_color_box_label'>"+ID_RES_CONST_STRING_CURRENT_COLOR+"</div>");b=b+"\t\t</td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_GREEN+"(G):</td>");b+="\t\t<td align='right'>"+
duzon_dialog.makeSpinnerInputForm("dze_idx_color_G_value","",255,0)+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_SATURATION+"(S): </td>";b+="\t\t<td align='right'>"+duzon_dialog.makeSpinnerInputForm("dze_idx_color_S_value","",100,0)+"</td>";b=b+"\t\t<td></td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_BLUE+"(B):</td>");b+="\t\t<td align='right'>"+duzon_dialog.makeSpinnerInputForm("dze_idx_color_B_value","",255,0)+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_LIGHTNESS+
"(L):</td>";b+="\t\t<td align='right'>"+duzon_dialog.makeSpinnerInputForm("dze_idx_color_L_value","",100,0)+"</td>";b+="\t\t<td></td>\t</tr>\t<tr>\t\t<td align='left' colspan='2'>HTML(T):</td>\t\t<td align='right' colspan='2'> #<input type='text' size='3' class='dze_color_pallet_table_htmlcode_form' id='dze_idx_color_value' value='' /></td>\t\t<td></td>\t</tr></table>";!0===dzeUiConfig.showPalletUserColor&&(b+="<table width='341' border='0' cellpadding='0' cellspacing='0'>\t<tr>\t\t<td align='center'><div class='dze_color_pallet_table_hr_separator'></div></td>\t</tr>\t<tr>\t\t<td align='center'><div id='dze_idx_color_pallet_table_user' class='dze_color_pallet_table_user'></div></td>\t</tr></table>");
this.color_pallet_container_obj=dzeColorPallet.layerDoc.createElement("div");this.color_pallet_container_obj.id="dze_idx_color_pallet_container";this.color_pallet_container_obj.className="dze_color_pallet_container";this.color_pallet_container_obj.innerHTML=b;dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_container_obj)},color_pallet_button_container_obj:null,createPalletButtonContainer:function(a,b){this.color_pallet_button_container_obj=dzeColorPallet.layerDoc.createElement("div");
this.color_pallet_button_container_obj.id="dze_idx_color_pallet_button_container";this.color_pallet_button_container_obj.className="duzon_dialog_buttonbox";dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_button_container_obj);"undefined"==typeof b&&(b=function(){});if(null==b||""==b)b=function(){};a=[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE];for(var d=[function(){var a=dzeColorPallet.getColorCode("hex");b(a)},function(){duzon_dialog.closeExtendsDlg()}],c={},e=0;e<a.length;e++)c=
{},c=dzeColorPallet.layerDoc.createElement("input"),c.type="button",c.value=a[e],function(){var a=d[e],b=e;c.onclick=function(b){a(b?b:dzeColorPallet.layerWin.event)};var h="duzon_dialog_btn_normal",k="duzon_dialog_btn_up",l="duzon_dialog_btn_down";0==b&&(h="duzon_dialog_btn_ok_normal",k="duzon_dialog_btn_ok_up",l="duzon_dialog_btn_ok_down");c.className=h;c.onmouseover=function(){this.className=k};c.onmouseout=function(){this.className=h};c.onmousedown=function(){this.className=l};c.onmouseup=function(){this.className=
k}}(),this.color_pallet_button_container_obj.appendChild(c)},addFormEvent:function(){dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_R_value",255,0,0,"dzeColorPallet.evtModifyFormColorR");dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_G_value",255,0,0,"dzeColorPallet.evtModifyFormColorG");
dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_B_value",255,0,0,"dzeColorPallet.evtModifyFormColorB");dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_H_value",360,0,0,"dzeColorPallet.evtModifyFormColorH");dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").onkeyup=
function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_S_value",100,0,0,"dzeColorPallet.evtModifyFormColorS");dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_L_value",100,0,0,"dzeColorPallet.evtModifyFormColorL");dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onkeyup=function(){dzeColorPallet.modifyHexCode(this)};dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onfocus=
function(){this.select()}},evtModifyFormColorR:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorG:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorB:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorH:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value");
dzeColorPallet.modifyHslValue(a)},evtModifyFormColorS:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value");dzeColorPallet.modifyHslValue(a)},evtModifyFormColorL:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value");dzeColorPallet.modifyHslValue(a)},modifySpinnerBtnStyle:function(){dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").className="duzon_spinner_input_form_small";dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").className=
"duzon_spinner_input_form_small";dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").className="duzon_spinner_input_form_small";dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").className="duzon_spinner_input_form_small";dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").className="duzon_spinner_input_form_small";dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").className="duzon_spinner_input_form_small"},addMouseEvent:function(){window.attachEvent?
(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmouseup",dzeColorPallet.evtMouseUp)):window.addEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mouseup",
dzeColorPallet.evtMouseUp,!1))},removeMouseEvent:function(){window.detachEvent?(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmouseup",dzeColorPallet.evtMouseUp)):window.removeEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mouseup",
dzeColorPallet.evtMouseUp,!1))},evtMouseMove:function(a){a=a?a:dzeColorPallet.layerWin.event;if("pallet"==dzeColorPallet.downPosition){dzeColorPallet.showColorSelector(a);var b=dzeColorPallet.getColorCodeFromSelector();dzeColorPallet.selectCode(b);dzeColorPallet.viewSubColor(b)}"subColor"==dzeColorPallet.downPosition&&(dzeColorPallet.showSubColorSelector(a),b=dzeColorPallet.getSubColorCodeFromSelector(),dzeColorPallet.selectCode(b));"achromatic"==dzeColorPallet.downPosition&&(dzeColorPallet.showAchromaticSelector(a),
b=dzeColorPallet.getAchromaticColorCodeFromSelector(),dzeColorPallet.selectCode(b))},evtMouseUp:function(a){dzeColorPallet.downPosition=""},maxRecentColorNum:20,recentColorCodeSet:[],viewRecentColorSet:function(){if(!0===dzeUiConfig.showPalletRecentColor&&null!=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent")){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").innerHTML="";var a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_recent_color_box";
a.className="dze_color_pallet_table_recent_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").appendChild(a);for(var b="",d=this.getRecentColorSet(),c=null,e=0;e<this.maxRecentColorNum;e++)if(c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_recent_color_unit","undefined"!=typeof d[e]&&(b=d[e],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectRecentColor(this,
a)}}()),a.appendChild(c),17==e){var f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_recent_color_delete";f.title=ID_RES_CONST_BTN_DELETE;f.onclick=function(){dzeColorPallet.removeRecentColorListConfirm()};a.appendChild(f)}g_objCommonUtil.log("\nrecent color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);g_objCommonUtil.log("\n")}},selectRecentColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent_color_box").childNodes,
c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor="#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white")},getRecentColorSet:function(){if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeRecentHexCodeList")&&(this.recentColorCodeSet=localStorage.getItem("dzeRecentHexCodeList").split(","))}catch(a){}return this.recentColorCodeSet},setRecentColorSet:function(a){this.recentColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeRecentHexCodeList",
a.join(","))}catch(b){}},addRecentColorSet:function(a){a=this.checkHexCode(a);if(6==a.length){var b=this.getRecentColorSet();b=this.removeValueFromArrayList(a,b);b.unshift(a);b=this.getMaxArrayList(b,this.maxRecentColorNum);this.setRecentColorSet(b);this.viewRecentColorSet()}},removeRecentColorList:function(){this.recentColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeRecentHexCodeList","")}catch(a){}this.viewRecentColorSet()},removeRecentColorListConfirm:function(){0==
this.getRecentColorSet().length?alert(ID_RES_CONST_MSG_ALERT_NO_RECENT_COLOR):confirm(ID_RES_CONST_MSG_ALERT_DELETE_RECENT_COLOR)&&this.removeRecentColorList()},removeValueFromArrayList:function(a,b){for(var d=[],c=0;c<b.length;c++)b[c]!=a&&d.push(b[c]);return d},getMaxArrayList:function(a,b){if(a.length>b){b=a.length-b;for(var d=0;d<b;d++)a.pop()}return a},maxUserColorNum:26,userColorCodeSet:[],viewUserColorCodeSet:function(){if(!0===dzeUiConfig.showPalletUserColor){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").innerHTML=
"";var a=dzeColorPallet.layerDoc.createElement("div");a.className="dze_color_pallet_table_user_label";a.innerHTML=ID_RES_CONST_STRING_USER_SET;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_user_color_box";a.className="dze_color_pallet_table_user_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);for(var b="",d=this.getUserColorCodeSet(),
c=null,e=0;e<this.maxUserColorNum;e++)if(c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_user_color_unit","undefined"!=typeof d[e]&&(b=d[e],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectUserColor(this,a)}}()),a.appendChild(c),12==e){var f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_recent_color_delete";f.title=ID_RES_CONST_BTN_DELETE;f.onclick=
function(){dzeColorPallet.removeUserColorListConfirm()};a.appendChild(f);f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_user_color_add";f.title=ID_RES_CONST_STRING_ADD_USER_COLOR;f.onclick=function(){dzeColorPallet.addUserColorCodeSet()};a.appendChild(f)}g_objCommonUtil.log("\nuser color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);g_objCommonUtil.log("\n")}},selected_user_color:"",selectUserColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user_color_box").childNodes,
c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor="#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white");dzeColorPallet.selected_user_color=b},getUserColorCodeSet:function(){if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeUserHexCodeList")&&(this.userColorCodeSet=localStorage.getItem("dzeUserHexCodeList").split(","))}catch(a){}return this.userColorCodeSet},setUserColorSet:function(a){this.userColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeUserHexCodeList",
a.join(","))}catch(b){}},addUserColorCodeSet:function(){var a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;a=this.checkHexCode(a);if(6==a.length){var b=this.getUserColorCodeSet();b=this.removeValueFromArrayList(a,b);b.unshift(a);b=this.getMaxArrayList(b,this.maxUserColorNum);this.setUserColorSet(b);this.viewUserColorCodeSet()}},removeUserColorList:function(){this.userColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeUserHexCodeList","")}catch(a){}this.viewUserColorCodeSet()},
removeUserColorListConfirm:function(){var a=this.getUserColorCodeSet();0!=a.length&&""!=this.selected_user_color&&(a=this.removeValueFromArrayList(this.selected_user_color,a),this.setUserColorSet(a),this.viewUserColorCodeSet())},achromaticSet:[],achromaticColorPix:9,viewAchromatic:function(){var a="<table border='0' cellpadding='0' cellspacing='0'><tr>";var b=255,d=255,c=255;d="FFFFFF";b=100;b={};for(var e=0;20>=e&&(b=100-5*e,b=this.hsl2rgb(0,0,b),c=d=b=b.r,d=this.getDecToHex(b)+this.getDecToHex(d)+
this.getDecToHex(c),this.achromaticSet.push(d),a+="<td width='"+this.achromaticColorPix+"' height='20'><div style=\"width:"+this.achromaticColorPix+"px; height:20px;background-color:#"+d+';"></div></td>',0!=b);e++);a+="</tr></table>";g_objCommonUtil.log("\nachromatic color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.achromaticSet);g_objCommonUtil.log("\n");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").innerHTML=a;a=dzeColorPallet.layerDoc.createElement("div");
a.id="dze_idx_color_pallet_table_achromatic_selector";a.className="dze_color_pallet_table_achromatic_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").appendChild(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").onmousedown=function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="achromatic";dzeColorPallet.showAchromaticSelector(a);a=dzeColorPallet.getAchromaticColorCodeFromSelector();dzeColorPallet.selectCode(a);
dzeColorPallet.showCrossColorSelector("white")}},subColorStep:16,subColorPix:4,subColorSet:[],viewSubColor:function(a){g_objCommonUtil.log("====== viewSubColor START ======");a=this.checkHexCode(a);6!=a.length&&(a=this.default_hexCode);g_objCommonUtil.log("==== viewSubColor:"+a);a=this.getHexToDec(a);var b="<table width='' height='99' border='0' cellpadding='0' cellspacing='0'>";var d=255-a.R_val;d=Math.ceil(d/this.subColorStep);var c=255-a.G_val;c=Math.ceil(c/this.subColorStep);var e=255-a.B_val;
e=Math.ceil(e/this.subColorStep);var f=255,g=255,h=255,k="FFFFFF";this.subColorSet=[];for(var l=0;l<=this.subColorStep;l++)l==this.subColorStep?(f=a.R_val,g=a.G_val,h=a.B_val):0<l&&(f-=d,g-=c,h-=e),f<a.R_val&&(f=a.R_val),g<a.G_val&&(g=a.G_val),h<a.B_val&&(h=a.B_val),0>f&&(f=0),0>g&&(g=0),0>h&&(h=0),k=this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h),this.subColorSet.push(k),b+="<tr>",b+="<td width='20' height='"+this.subColorPix+"'><div style=\"width:20px;height:"+this.subColorPix+"px;background-color:#"+
k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";d=Math.ceil(f/this.subColorStep);c=Math.ceil(g/this.subColorStep);e=Math.ceil(h/this.subColorStep);for(l=1;l<=this.subColorStep;l++)l==this.subColorStep?h=g=f=0:0<l&&(f-=d,g-=c,h-=e),0>f&&(f=0),0>g&&(g=0),0>h&&(h=0),k=this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h),this.subColorSet.push(k),b+="<tr>",b+="<td width='20' height='"+this.subColorPix+"'><div style=\"width:20px;height:"+this.subColorPix+
"px;background-color:#"+k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";b+="</table>";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").innerHTML=b;g_objCommonUtil.log("\nsub color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.subColorSet);g_objCommonUtil.log("\n");a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_sub_selector";a.className="dze_color_pallet_table_sub_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").appendChild(a);
dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").onmousedown=function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="subColor";dzeColorPallet.showSubColorSelector(a);a=dzeColorPallet.getSubColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.showCrossColorSelector("white")}},downPosition:"",subColorUp:function(){},checkHexCode:function(a){if("undefined"==typeof a||null==a||""==a)return"";a=a.replace(/[^0-9a-fA-F]/gi,"");a=a.substring(0,6);
return a=a.toUpperCase()},selectCode:function(a){g_objCommonUtil.log("====== selectCode START ===htmlCode ==="+a);a=this.checkHexCode(a);if(6==a.length){dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=a.toUpperCase();var b=this.getHexToDec(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=b.R_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=b.G_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=b.B_val;b=this.rgbToHsl(b.R_val,
b.G_val,b.B_val);dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=b[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=b[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=b[2];this.viewNewColor(a);g_objCommonUtil.log("====== selectCode END ======");g_objCommonUtil.log("")}},modifyHexCode:function(a){dzeColorPallet.showCrossColorSelector("white");var b=this.checkHexCode(a.value);a.value=b;6>b.length||(this.selectCode(b),this.viewSubColor(b))},
modifyRgbValue:function(a){dzeColorPallet.showCrossColorSelector("white");a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(255<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"255"),a.value="";else{b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value;var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value,c=dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value;
a=this.rgbToHsl(b,d,c);b=this.getDecToHex(b)+this.getDecToHex(d)+this.getDecToHex(c);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=a[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=a[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=a[2];this.viewNewColor(b);this.viewSubColor(b)}}},modifyHslValue:function(a){dzeColorPallet.showCrossColorSelector("white");
a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(360<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"360"),a.value="";else{a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value;b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value;var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value;a=this.hsl2rgb(a,b,d);b=this.getDecToHex(a.r)+this.getDecToHex(a.g)+
this.getDecToHex(a.b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=a.r;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=a.g;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=a.b;this.viewNewColor(b);this.viewSubColor(b)}}},viewOrgColor:function(a){a=this.checkHexCode(a);6==a.length&&(dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").style.backgroundColor=
"#"+a,dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").title="#"+a.toUpperCase())},viewNewColor:function(a){g_objCommonUtil.log("======  viewNewColor START ======");g_objCommonUtil.log("viewNewColor htmlCode : "+a);dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").style.backgroundColor="#"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").title="#"+a.toUpperCase();g_objCommonUtil.log("======  viewNewColor END ======");g_objCommonUtil.log("")},getColorCode:function(a){"undefined"==
typeof a&&(a="hex");"hex"!=a&&"rgb"!=a&&"hsl"!=a&&(a="hex");var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;b=this.checkHexCode(b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b;if(6!=b.length)return"";this.addRecentColorSet(b);if("hex"==a)return"#"+b;if("rgb"==a)return a=this.getHexToDec(b),[a.R_val,a.G_val,a.B_val];if("hsl"==a)return a=this.getHexToDec(b),this.rgbToHsl(a.R_val,a.G_val,a.B_val)},getDecToHex:function(a){a=parseInt(a,10);255<a&&(a=255);
a=a.toString(16);1==a.length&&(a="0"+a);return a.toString()},getHexToDec:function(a){var b=parseInt(a.substring(0,2),16),d=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return result={R_val:b,G_val:d,B_val:a}},rgbToHsl:function(a,b,d){a/=255;b/=255;d/=255;var c=Math.max(a,b,d),e=Math.min(a,b,d),f=(c+e)/2;if(c==e)var g=e=0;else{var h=c-e;e=.5<f?h/(2-c-e):h/(c+e);switch(c){case a:g=(b-d)/h;break;case b:g=2+(d-a)/h;break;case d:g=4+(a-b)/h}g*=60;0>g&&(g+=360)}g=Math.round(g);e=Math.round(100*
e);f=Math.round(100*f);return[g,e,f]},hsl2rgb:function(a,b,d){isFinite(a)||(a=0);isFinite(b)||(b=0);isFinite(d)||(d=0);a/=60;0>a&&(a=6- -a%6);a%=6;b=Math.max(0,Math.min(1,b/100));d=Math.max(0,Math.min(1,d/100));var c=(1-Math.abs(2*d-1))*b;var e=c*(1-Math.abs(a%2-1));1>a?(a=c,b=e,e=0):2>a?(a=e,b=c,e=0):3>a?(a=0,b=c):4>a?(a=0,b=e,e=c):5>a?(a=e,b=0,e=c):(a=c,b=0);d-=c/2;a=Math.round(255*(a+d));b=Math.round(255*(b+d));e=Math.round(255*(e+d));return{r:a,g:b,b:e}},colorSelectorImageMargin:9,showColorSelector:function(a){g_objCommonUtil.log("====== showColorSelector ======");
var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").getBoundingClientRect(),d=a.clientX-b.left;a=a.clientY-b.top;d-=this.colorSelectorImageMargin;a-=this.colorSelectorImageMargin;d<-this.colorSelectorImageMargin+1&&(d=-this.colorSelectorImageMargin+1);a<-this.colorSelectorImageMargin+1&&(a=-this.colorSelectorImageMargin+1);d>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-this.colorSelectorImageMargin-2&&(d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-
this.colorSelectorImageMargin-2);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-this.colorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-this.colorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left=d+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display=
"block";g_objCommonUtil.log("selectorX:"+d);g_objCommonUtil.log("selectorY:"+a);g_objCommonUtil.log("")},getColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left.replace(/px/gi,""),10),b=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top.replace(/px/gi,""),10);a=Math.floor(Math.floor(a+this.colorSelectorImageMargin)/this.color_pix);b=Math.floor(Math.floor(b+this.colorSelectorImageMargin)/
this.color_pix);g_objCommonUtil.log("colNum:"+a);g_objCommonUtil.log("rowNum:"+b);g_objCommonUtil.log();b=this.colorset[b][a];g_objCommonUtil.log("htmlCode:"+b);return b},showCrossColorSelector:function(a){a="dze_color_pallet_table_selector_"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").className=a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display="block"},subColorSelectorImageMargin:6,showSubColorSelector:function(a){g_objCommonUtil.log("====== showSubColorSelector START ======");
if("undefined"==typeof a)g_objCommonUtil.log("event nothing");else{var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").getBoundingClientRect();a=a.clientY-b.top;a-=this.subColorSelectorImageMargin;a<-this.subColorSelectorImageMargin+2&&(a=-this.subColorSelectorImageMargin+2);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-this.subColorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-
this.subColorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.display="block";g_objCommonUtil.log("====== showSubColorSelector END ======");g_objCommonUtil.log("")}},getSubColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top.replace(/px/gi,""),10);g_objCommonUtil.log("getSubColorCodeFromSelector");
g_objCommonUtil.log("selectorY:"+a);a=Math.floor(Math.floor(a+7)/this.subColorPix);g_objCommonUtil.log("rowNum:"+a);a=this.subColorSet[a];g_objCommonUtil.log("htmlCode:"+a);return a},achromaticSelectorImageMargin:4,showAchromaticSelector:function(a){g_objCommonUtil.log("====== showAchromaticSelector START ======");if("undefined"!=typeof a){var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").getBoundingClientRect();a=a.clientX-b.left;a-=this.achromaticSelectorImageMargin;
0>a&&(a=0);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-2*this.achromaticSelectorImageMargin&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-2*this.achromaticSelectorImageMargin);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.display="block";g_objCommonUtil.log("====== showAchromaticSelector END ======");
g_objCommonUtil.log("")}},getAchromaticColorCodeFromSelector:function(){g_objCommonUtil.log("getAchromaticColorCodeFromSelector START");var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left.replace(/px/gi,""),10);a=Math.floor(a+7);g_objCommonUtil.log("selectorCenterX:"+a);g_objCommonUtil.log("(selectorCenterX/4):"+a/4);a=Math.floor(a/this.achromaticColorPix);g_objCommonUtil.log();a=this.achromaticSet[a];g_objCommonUtil.log("htmlCode:"+a);
g_objCommonUtil.log("getAchromaticColorCodeFromSelector END");return a}};

var ID_TB_QUERY_STATUS_BUTTON=1,ID_TB_QUERY_STATUS_COMBOBOX=2,ID_TB_QUERY_STATUS_DROPDOWN=3,g_objEditSetContainer=[],g_TBContainer=[],g_TBContainerTool=[],g_TBButton=[],g_TBComboBox=[],g_TBComboBoxLabel=[],g_TBDropDown=[],g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_EditNumber=null,g_nContainerBottomResize_Start_Y=null,g_nContainerBottomResize_Start_Height=null,g_arrForceCancelBubbleMouseDown=[];
function TBContainerEvent(a){TBCancelBubbleEvent(a);g_objLayerEventUtil.initHideDynamicLayer()}function initEditSetContainer(a,c){g_objEditSetContainer[c]=a}
function TBInitContainer(a){g_TBContainer[g_TBContainer.length]=a;a.onmouseover=TBCancelBubbleEvent;a.onmouseout=TBCancelBubbleEvent;a.onmousedown=TBCancelBubbleEvent;a.onmouseup=TBCancelBubbleEvent;a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBContainerEvent;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1)}
function TBInitContainerTool(a){g_TBContainerTool[g_TBContainerTool.length]=a;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1)}function QueryStatusItem(a,c,b,d,e,f){this.element=c;this.element.command=a;this.button_type=b;this.command_id=d;this.support_type=e;this.support_control_type=f;this.element.command_id=d;return this}
function TBButtonMouseOver(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a);var f=null;a=null;if(ID_TB_QUERY_STATUS_BUTTON==b)f=g_TBButton[d][c].element;else if(ID_TB_QUERY_STATUS_COMBOBOX==b)f=g_TBComboBox[d][c].element;else if(ID_TB_QUERY_STATUS_DROPDOWN==b)f=g_TBDropDown[d][c].element,a=g_TBDropDown[d][c].objSubElement;else return;f.TBSTATE!=ID_STRING_NAME_GRAY&&(f.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?f.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp,a.className=g_strSkin_DropDown_AreaArrowUp):f.TBSTATE==ID_STRING_NAME_UNCHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&0<=this.className.indexOf("_ribbon")?(this.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",f.className=g_strSkin_DropDown_Area+"_ribbon"):(this.className=g_strSkin_DropDown_AreaArrowOver,
f.className=g_strSkin_DropDown_Area),TBCancelBubbleEvent(a))}):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=g_strSkin_DropDown_AreaArrowOver,a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className=g_strSkin_DropDown_AreaArrowOver,f.className=g_strSkin_DropDown_Area,TBCancelBubbleEvent(a))}):!0===dzeUiConfig.bUseUiMode&&
"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=
g_strSkin_DropDown_AreaArrowOver))}catch(h){}}
function TBButtonMouseOut(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+
"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon",e.className=g_strSkin_DropDown_AreaArrow+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area,e.className=g_strSkin_DropDown_AreaArrow))}catch(f){}}
function TBButtonMouseDown(a,c,b,d,e){try{e&&(TBCancelBubbleEvent(a),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!0)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowDown+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaDown:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown,e.className=g_strSkin_DropDown_AreaArrowDown))}catch(f){}}
function TBButtonMouseUp(a,c,b,d,e){try{e&&(TBCancelBubbleEvent(a),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!1)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b&&(a.className=g_strSkin_Button_Up+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==
b&&(a.className=g_strSkin_DropDown_AreaOver+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaOver,e.className=g_strSkin_DropDown_AreaArrowUp))}catch(f){}}
function TBInitButton(a,c,b){try{var d=g_arrConst[a][0],e=document.getElementById(g_arrConst[a][2]+"_"+b);if(null!=e){var f=g_arrConst[a][3],h=g_arrConst[a][4],k=g_arrConst[a][5],g=0;if(ID_TB_QUERY_STATUS_BUTTON==c)g_TBButton[b][g_TBButton[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBButton[b].length-1,e.className=g_strSkin_Button;else if(ID_TB_QUERY_STATUS_COMBOBOX==c){g_TBComboBox[b][g_TBComboBox[b].length]=new QueryStatusItem(d,e,c,a,h,k);g=g_TBComboBox[b].length-1;e.className=g_strSkin_ComboBox_Area;
var l=e.id;g_TBComboBoxLabel[b][g_TBComboBoxLabel[b].length]=new QueryStatusItem("",document.getElementById(l+"_LABEL"),0,-1,-1,-1);g_objComboBoxWin.setupComboBoxLabel(g_TBComboBoxLabel[b][g_TBComboBoxLabel[b].length-1].element,a)}else ID_TB_QUERY_STATUS_DROPDOWN==c&&(g_TBDropDown[b][g_TBDropDown[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBDropDown[b].length-1,e.className=g_strSkin_DropDown_Area,l=e.id,g_TBDropDown[b][g].objSubElement=document.getElementById(l+"_SUB"),g_TBDropDown[b][g].objSubElement.onclick=
function(a){eval(f+"_Detail")(a,this,b)});e.onmouseover=function(a){TBButtonMouseOver(a,g,c,b,!0)};e.onmouseout=function(a){TBButtonMouseOut(a,g,c,b,!0)};e.onmousedown=function(a){TBButtonMouseDown(a,g,c,b,!0)};e.onmouseup=function(a){TBButtonMouseUp(a,g,c,b,!0)};e.ondragstart=TBCancelBubbleEvent;e.onselectstart=TBCancelBubbleEvent;e.onselect=TBCancelBubbleEvent;e.commandtype=ID_COMMAND_TYPE_TOOL;e.onclick=function(a){eval(f)(a,this,b)};e.TBSTATE==ID_STRING_NAME_GRAY?g_objPropertyUtil.setFilterOpacityStyle(e,
!0):e.TBSTATE=ID_STRING_NAME_UNCHECKED}}catch(m){}}
function TBSetState(a,c,b){try{if(null!=a)switch(c=c.toLowerCase(),a.className){case g_strSkin_Button:case g_strSkin_Button_Over:case g_strSkin_Button_Down:case g_strSkin_Button_Up:case g_strSkin_ComboBox_Area:case g_strSkin_ComboBox_AreaOver:case g_strSkin_ComboBox_AreaDown:case g_strSkin_ComboBox_AreaUp:case g_strSkin_DropDown_Area:case g_strSkin_DropDown_AreaOver:case g_strSkin_DropDown_AreaDown:case g_strSkin_DropDown_AreaUp:case g_strSkin_DropDown_Area+"_ribbon":case g_strSkin_DropDown_AreaOver+
"_ribbon":case g_strSkin_DropDown_AreaDown+"_ribbon":case g_strSkin_DropDown_AreaUp+"_ribbon":case g_strSkin_Button+"_ribbon":case g_strSkin_Button_Over+"_ribbon":case g_strSkin_Button_Down+"_ribbon":case g_strSkin_Button_Up+"_ribbon":if(c==ID_STRING_NAME_GRAY||c==ID_STRING_NAME_CHECKED||c==ID_STRING_NAME_UNCHECKED){var d=a.TBSTATE;c!=d&&(c==ID_STRING_NAME_CHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=
g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_UNCHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),g_objPropertyUtil.setFilterOpacityStyle(a,!0)),a.TBSTATE=c)}}}catch(e){}}
function TBSetState_DropDown_Parent(a,c,b){try{var d=g_objNodeUtil.getParentElement(a),e=g_objNodeUtil.getLoopParentElement(d,"div");null!=e&&TBSetState(e,c,b)}catch(f){}}
function TBSetToolButton(a,c){try{for(var b=0;b<a.length;b++){var d=a[b][0];if(ID_TYPE_TOOLBAR_HANDLE!=d&&ID_TYPE_TOOLBAR_SEPARATOR!=d&&ID_TYPE_TOOLBAR_SPACE!=d&&ID_TYPE_TOOLBAR_CAPTION!=d){var e=g_arrConst[d][6];TBInitButton(d,e,c);ID_TB_QUERY_STATUS_BUTTON==e?handlerUI.setCommandUpdateIndex(c,d,g_TBButton[c].length-1):ID_TB_QUERY_STATUS_COMBOBOX==e?handlerUI.setCommandUpdateIndex(c,d,g_TBComboBox[c].length-1):ID_TB_QUERY_STATUS_DROPDOWN==e&&handlerUI.setCommandUpdateIndex(c,d,g_TBDropDown[c].length-
1)}}}catch(f){}}function TBInitContainerBottomResize(a,c){try{if(g_bBottomResizeYN)if(window.attachEvent){var b=eval("onmousedown_containerBottomResize_"+c);a.attachEvent("onmousedown",b)}else b=eval("onmousedown_containerBottomResize_"+c),a.addEventListener("mousedown",b,!1)}catch(d){}}
function onmousedown_containerBottomResize(a,c){try{if(!g_bFullScreenMode&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_bBottomResizeYN)){g_objTransparentViewUtil.showTransparentView(!0,1);g_bMouseDown_containerBottomResize=!0;g_nContainerBottomResize_EditNumber=c;var b=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop;g_nContainerBottomResize_Start_Y=a.clientY+b;g_nContainerBottomResize_Start_Height=g_arrEditorHeight[c];window.attachEvent?
(document.attachEvent("onmousemove",onmousemove_containerBottomResize),document.attachEvent("onmouseup",onmouseup_containerBottomResize)):(document.addEventListener("mousemove",onmousemove_containerBottomResize,!1),document.addEventListener("mouseup",onmouseup_containerBottomResize,!1))}}catch(d){window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",onmousemove_containerBottomResize,
!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmousemove_containerBottomResize(a){try{if(!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize){TBCancelBubbleEvent(a);var c=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop,b=g_nContainerBottomResize_Start_Height+(a.clientY+c-g_nContainerBottomResize_Start_Y);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(g_nContainerBottomResize_EditNumber,b):resizeEditor_Height(g_nContainerBottomResize_EditNumber,b)}}catch(d){window.detachEvent?
(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmouseup_containerBottomResize(a){try{!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize&&(g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_Start_Height=g_nContainerBottomResize_Start_Y=g_nContainerBottomResize_EditNumber=null,g_objTransparentViewUtil.showTransparentView(!1,null),window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",
onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1)))}catch(c){}}var bottomResizeBtnIntervals=null,resizeBodyStyleInfo=null;
function TBInitContainerBottomResizeBtn(a,c){try{if(dzeUiConfig.bCustomBottomResizeBtnYN&&dzeUiConfig.bCustomize_TabBar_Display){var b=a.childNodes[0],d=a.childNodes[1];d.onmouseover=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals()};d.onmousedown=function(a){(a?a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(this.className="duzon_spinner_btn_arrow_over",bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("increase",c)},7))};
d.onmouseup=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c);a&&(a=a.offsetHeight,removeBottomResizeGuideLineObj(c),a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a,!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(c,a):resizeEditor_Height(c,a));g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&
(g_objLayerKit.getLayerDocument().body.style.overflow=resizeBodyStyleInfo)};d.onmouseout=function(){this.className="duzon_spinner_btn_arrow_up";clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c);g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&(g_objLayerKit.getLayerDocument().body.style.overflow=resizeBodyStyleInfo)};b.onmouseover=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals()};b.onmousedown=function(a){(a?
a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(this.className="duzon_spinner_btn_arrow_over",bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("decrease",c)},7))};b.onmouseup=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c);if(a){var b=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));a=parseInt(a.style.top.replace(/px/,
""),10)-b.bottom;a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a;200>a&&(a=200);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(c,a):resizeEditor_Height(c,a);removeBottomResizeGuideLineObj(c)}};b.onmouseout=function(){this.className="duzon_spinner_btn_arrow_up";clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c)}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"error:TBInitContainerBottomResizeBtn")}}
function clearBottomResizeBtnIntervals(){try{bottomResizeBtnIntervals&&clearInterval(bottomResizeBtnIntervals),bottomResizeBtnIntervals=null}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:clearBottomResizeBtnIntervals")}}
function resizeBottomResizeGuideLine(a,c){try{var b=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+c),d=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c),e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));if(null==d){d=g_objLayerKit.getLayerDocument().createElement("div");d.id="dzeIdxBottomResizeGuideLine_"+c;d.className="dze_bottom_resize_guideline";d.style.width=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetWidth-
2+"px";d.style.height="0px";g_objLayerKit.getLayerDocument().body.appendChild(d);d.style.left=e.left+"px";d.style.top=e.bottom+"px";var f=duzon_dialog.getActiveDialogWindowSize(),h=!1;g_objLayerKit.getLayerDocument().body.scrollHeight>f.view_window_height&&(h=!0);"increase"==a&&0==h&&(g_objLayerKit.getLayerDocument().body.style.overflow&&(resizeBodyStyleInfo=g_objLayerKit.getLayerDocument().body.style.overflow),g_objLayerKit.getLayerDocument().body.style.overflow="hidden");b=g_objLayerKit.getLayerDocument().createElement("div");
b.id="dzeIdxBottomResizeGuideValue_"+c;b.className="dze_bottom_resize_guidevalue";g_objLayerKit.getLayerDocument().body.appendChild(b);var k=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+c).parentNode.parentNode);b.style.left=k.left-b.offsetWidth+12+"px";b.style.top=k.top-23+"px"}if("increase"==a)d.style.height=d.offsetHeight+1+"px",b.style.color="blue",b.innerText="+"+d.style.height;else if("decrease"==a){d.style.borderWidth="1px 1px 0 1px";
d.style.height="0px";var g=parseInt(d.style.top.replace(/px/,""),10)-1,l=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+c));g<l.top+100&&(g=l.top+100);d.style.top=g+"px";e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));var m=parseInt(d.style.top.replace(/px/,""),10)-e.bottom;b.style.color="red";b.innerText=m+"px"}}catch(n){g_objCommonUtil.displayErrorAlert(n,"error:resizeBottomResizeGuideLine")}}
function removeBottomResizeGuideLineObj(a){var c=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+a);null!=c&&c.parentNode.removeChild(c);a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+a);null!=a&&a.parentNode.removeChild(a)};

var ID_TB_TABMODE_PREVIEW=0,ID_TB_TABMODE_EDIT=1,ID_TB_TABMODE_SOURCE=2,g_bEditMode=[],g_TBTabMode=[];function QueryStatusTabModeItem(b,a,d){this.element=b;this.element.TBSTATE=a;this.nTabModeID=d;return this}function TBTabModeButtonMouseOver(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_AreaOver)}catch(f){}}
function TBTabModeButtonMouseOut(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBTabModeButtonMouseDown(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.TBSTATE==ID_STRING_NAME_CHECKED?e.className=g_strSkin_TabMode_AreaUp:e.TBSTATE==ID_STRING_NAME_UNCHECKED?(e.className=g_strSkin_TabMode_AreaDown,g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer()):e.className=g_strSkin_TabMode_AreaDown)}catch(f){}}
function TBTabModeButtonMouseUp(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBInitTabModeButton(b,a,d,c){try{g_TBTabMode[c][g_TBTabMode[c].length]=new QueryStatusTabModeItem(b,d,a);var e=g_TBTabMode[c].length-1;b.onmouseover=function(a){TBTabModeButtonMouseOver(a,e,c,!0)};b.onmouseout=function(a){TBTabModeButtonMouseOut(a,e,c,!0)};b.onmousedown=function(a){TBTabModeButtonMouseDown(a,e,c,!0)};b.onmouseup=function(a){TBTabModeButtonMouseUp(a,e,c,!0)};b.ondragstart=TBCancelBubbleEvent;b.onselectstart=TBCancelBubbleEvent;b.onselect=TBCancelBubbleEvent;var f=g_arrConst_TabMode[a][1];
b.onclick=function(b){eval(f)(b,this,a,c)};b.className=d==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area;b.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!0)}catch(g){}}
function TBTabModeSetState(b,a){try{switch(a=a.toLowerCase(),b.className){case g_strSkin_TabMode_Area:case g_strSkin_TabMode_AreaOver:case g_strSkin_TabMode_AreaDown:case g_strSkin_TabMode_AreaUp:if(a==ID_STRING_NAME_GRAY||a==ID_STRING_NAME_CHECKED||a==ID_STRING_NAME_UNCHECKED){var d=b.TBSTATE;a!=d&&(a==ID_STRING_NAME_CHECKED?(b.className=g_strSkin_TabMode_AreaUp,d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_UNCHECKED?(b.className=g_strSkin_TabMode_Area,
d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_GRAY&&(b.className=g_strSkin_TabMode_Area,g_objPropertyUtil.setFilterOpacityStyle(b,!0)),b.TBSTATE=a)}}}catch(c){}}
function fnTool_TabMode(b,a,d,c){TBCancelBubbleEvent(b);if(ID_STRING_NAME_CHECKED!=a.TBSTATE){!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(c),dzeCopyPasteStyleInfo.unsetPasteStyleMode(c));fnTool_TabMode_Main(d,c);try{g_bBrowserType_FF&&""!=g_strFocusEventFunction&&d==ID_TB_TABMODE_SOURCE&&eval(g_strFocusEventFunction+"("+c+", 0);")}catch(e){}}}
function fnTool_TabMode_Main(b,a){try{if(g_objCommonUtil.log("fnTool_TabMode_Main START"),g_objCommonUtil.log("nTabModeID:"+b),g_objCommonUtil.log("nEditNumber:"+a),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),2==g_nFormEditMode&&b==ID_TB_TABMODE_SOURCE)fnUserWarningMessage(ID_USER_WARNING_MSG_NO_SOURCE_EDIT);else for(var d=0;d<g_TBTabMode[a].length;d++)if(ID_TB_TABMODE_EDIT==g_TBTabMode[a][d].nTabModeID||ID_TB_TABMODE_SOURCE==g_TBTabMode[a][d].nTabModeID)b==g_TBTabMode[a][d].nTabModeID?(TBTabModeSetState(g_TBTabMode[a][d].element,
ID_STRING_NAME_CHECKED),fnTool_ChangeMode(b,a,!1)):TBTabModeSetState(g_TBTabMode[a][d].element,ID_STRING_NAME_UNCHECKED)}catch(c){}}
function fnTool_ChangeMode(b,a,d){setSelectionObjectInfo(!1,null,null);if(b==ID_TB_TABMODE_EDIT){if(!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]||!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE])return;g_bEditMode[a]=!0;g_objEditContainer[a].style.visibility="visible";g_objEditContainer[a].style.display="";if(g_bBrowserType_IE)g_objEditSourceContainer[a].style.visibility="hidden",g_objEditSourceContainer[a].style.display="none";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position=
"absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility="hidden";!0===dzeUiConfig.bRemoveXSS&&(g_objEditObjectSource[a].value=removeXSS(g_objEditObjectSource[a].value));b=g_objEditorDocument[a].body.innerHTML;var c=g_objEditObjectSource[a].value;c.toLowerCase();if(!d){var e=!0;if(!g_bSourceAreaScriptAllowYN){var f=
c.indexOf("<script",0);-1!=f&&(e=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b)}g_bSourceAreaIframeAllowYN||(f=c.indexOf("<iframe>",0),-1!=f&&(e=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b));e&&(g_objEditorDocument[a].body.innerHTML=g_objEditObjectSource[a].value.replace(/(\n|\r\n)/g,""))}if(g_bBrowserType_IE)d||(!g_bSourceAreaScriptAllowYN&&3!=g_nFormEditMode&&0<g_objEditorDocument[a].scripts.length&&
(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(c=g_objEditorDocument[a].getElementsByTagName("iframe"),0<c.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_objEditWindow[a].focus()),g_objTagUtil.force_formTagSwitch(a),editor_onselectionchange(a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&
0<g_objEditorDocument[a].getElementsByTagName("script").length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(c=g_objEditorDocument[a].getElementsByTagName("iframe"),0<c.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_bBrowserType_FF?3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[a].body,a),window.setTimeout("setRestoreEditWinFF("+a+")",100)):g_bBrowserType_WK?
3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[a].body,a),window.setTimeout("setEditModeFocus("+a+")",100)):g_bBrowserType_OP&&window.setTimeout("setEditModeFocus("+a+")",100);tranAllAnchorHrefSharp(a);g_objEditMode.showAllWriteAreaSet(a,!0);!1===g_bBrowserType_FF&&g_objEditMode.showBGImageForLockedCell(!0,a);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);g_objUndoRedo.registerInitialContentStack(a);
editor_onselectionchange(a);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtMouseUpShowDynamicMenu();g_objEditMode.setZeroSpaceCodeToEmptyTd(a);g_objEditMode.convertFormCodeString(a,!1);g_bBrowserType_IE&&checkResetSpanContainsP(a,0);if(dzeUiConfig.bLimitTableWidthSize){b=g_objEditorDocument[a].body.getElementsByTagName("table");var g=g_objTableUtil.hasOverSizedTable(b);null!=g&&setTimeout(function(){alert(ID_RES_DIALOG_ALERT_MAX_VALUE+g)},0)}}else if(b==ID_TB_TABMODE_SOURCE){if(!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]||
!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT])return;isCreatedRulerBar()&&changeViewModeForRulerBar(a);insertSourceSelectionSyncChars(a);tranAllAnchorHrefSharp(a);g_bEditMode[a]=!1;g_objEditContainer[a].style.visibility="hidden";g_objEditContainer[a].style.display="none";if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",
g_objEditSourceContainer[a].style.height="";g_objEditSourceContainer[a].style.visibility="visible";g_objEditSourceContainer[a].style.display="";disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?g_arrEditorHeight[a]-document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).offsetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-25+"px":g_arrEditorHeight[a]-g_nToolbarSetHeight-
g_nTabBarSetHeight-g_nBottomResizeHeight-25+"px");g_objEditMode.showAllWriteAreaSet(a,!1);!1===g_bBrowserType_FF&&g_objEditMode.showBGImageForLockedCell(!1,a);g_bContentPTagStyleApply&&g_objAdjustDoc.setParaInlineStyle(a,g_objEditorDocument[a].body);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.adjustRemoveGarbageText(a);g_objAdjustDoc.adjustGarbageEmptyTag(a,!1);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(a);g_objAdjustDoc.remove_Br_Node_Inside_P_Node(a);g_objLetterFn.removeAllDuplicateStyleByLetterOperation(g_objEditorDocument[a].body,
a);g_objEditMode.restoreFormCodeString(a);g_objTagUtil.updateTagAttribute(a);b=removeZeroWidthSpace(g_objEditorDocument[a].body.innerHTML);!0===dzeUiConfig.bRemoveXSS&&(b=removeXSS(b));g_objEditorDocument[a].body.innerHTML=b;b=getHTMLContentCodeByXHTMLFormat(a);g_bSourceAreaIframeAllowYN&&setIFrameSrcBlankForTabMode(a);g_objEditObjectSource[a].value=b;g_objEditObjectSource[a].focus();syncSourceSelection(a)}try{d||""!=g_strTabModeEventFunction&&eval(g_strTabModeEventFunction+"("+a+");")}catch(h){}}
function changeViewModeForRulerBar(b){try{if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode){var a=document.getElementById("TB_MENU_RIBBON_CONTENT_4_"+b).getElementsByTagName("div").TB_VIEW_RULERBAR_0;a&&TBSetState(a,ID_STRING_NAME_GRAY,g_arrConst[ID_COMMAND_VIEW_RULERBAR][6])}isShowedRulerBar()&&(dze_rulerbar_mgr.changeRulerbarDisplay(b,!dze_rulerbar_mgr.m_bShow),dze_rulerbar_mgr.resizeEditorHeight())}catch(d){}}
function setEditModeFocus(b){try{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[b].body.focus(),editor_onselectionchange(b),g_objMenuWin.TBMenuSetStateAllEnable(!0,b);setStop_DefaultDocumentEditOption_FF(b)}catch(a){}}
function fnTool_TabMode_Preview(b,a,d,c){g_nActiveEditNumber=c;TBCancelBubbleEvent(b);g_objTableFlag.ResetTableInfo(!1);!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(c),dzeCopyPasteStyleInfo.unsetPasteStyleMode(c));""!=g_strPreviewCallFunction?eval(g_strPreviewCallFunction+";"):(a=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+c),b=a.offsetWidth-2,a=a.offsetHeight+200,700<a&&(a=700),g_objCommonUtil.openWindowCommon(dzeEnvConfig.strPreviewPageURL,b,
a,!0,""));updateTableHandlerUI.updateTableUIHandler(0,0,0,0,c)}
function getEditorPreviewHTML(b){try{var a="";g_bAutoIncludeParentCSS&&(a+=getParentCSS());for(var d=0;d<g_arrAdditionalEditAreaCSS.length;d++)a+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[d]+"'>";a=g_bAutoIncludeParentCSS?a+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"editor_style_inherit.css'>"):a+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"editor_style.css'>");a+="<style>";""!=g_strBodyFontFamily&&(a+="body, td {font-family:"+g_strBodyFontFamily+"}");
""!=g_strBodyFontSize&&(a+="body, td {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(a+="body, td {color:"+g_strBodyFontColor+"}");""!=g_strBodyLineHeight&&(a+="body, td {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(a+="body, td {letter-spacing:"+g_strBodyLetterSpacing+"}");a+="</style>";a+=getEditorHTMLCode(!1,b);a=removeEditorTempTagsFromStrHtml(a);return a=a.replace(/\b\b/g,"")}catch(c){}return""}
function getEditorTagCount_script(b){try{return window.attachEvent?g_objEditorDocument[b].scripts.length:g_objEditorDocument[b].getElementsByTagName("script").length}catch(a){}return-1}function getEditorTagCount_iframe(b){try{return g_objEditorDocument[b].getElementsByTagName("iframe").length}catch(a){}return-1};

var ID_COMMAND_TYPE_TOOL=1,ID_COMMAND_TYPE_MENU=2,ID_COMMAND_TYPE_CONTEXT_MENU=3,ID_STRING_NAME_CONTROL="control",ID_STRING_NAME_GRAY="gray",ID_STRING_NAME_UNCHECKED="unchecked",ID_STRING_NAME_CHECKED="checked",ID_STRING_NAME_HIDE="hide",ID_STRING_NAME_UNDEFINED="undefined",ID_STRING_NAME_NONE="none",ID_STRING_NAME_TEXT="text";function fnHandler_dummy(c,b,a){}
function fnHandler_CommonCheck_DynamicLayer_1(c,b,a){try{TBCancelBubbleEvent(c);if(b.TBSTATE==ID_STRING_NAME_GRAY)return!1;if(ID_COMMAND_TYPE_TOOL==b.commandtype){if(g_bDynamicLayer)return g_objLayerEventUtil.initHideDynamicLayer(),!1}else g_objLayerEventUtil.initHideDynamicLayer();return!0}catch(d){}return!1}
function fnHandler_SupportCommand(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command;"selectall"==d.toLowerCase()?ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype?null!=g_objTable&&g_objTableSelection.selectTable(a):fnHandler_SupportCommand_Main(a,d):fnHandler_SupportCommand_Main(a,d)}}catch(e){}}
function fnHandler_SupportCommand_Main(c,b){try{if(""!=b){if(GetMultiCellSelection())"copy"==b.toLowerCase()?dzeClipBoard.copySelectedMultiCells(c):g_objTableMultiCell.setMultiCellCommand_ExecCommand(b,c);else{"copy"==b.toLowerCase()&&dzeClipBoard.initialize();if(ID_STRING_COMMAND_UNLINK==b)(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&g_objNodeUtil.getSelectionElement_Anchor("A",!0,c),g_objEditorDocument[c].execCommand(b,!1,null);else try{if("delete"==b.toLowerCase()&&checkSetIFrameSrcBlankForDelete(c),
"inserthorizontalrule"==b.toLowerCase())g_objEditorDocument[c].execCommand(b,!1,null);else if("paste"==b.toLowerCase())if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var a=dzeClipBoard.paste(c);!0===a?TBCancelBubbleEvent:alert(ID_RES_USER_MSG_STRING_ALERT_PASTE)}else a=dzeClipBoard.paste(c),!0===a?TBCancelBubbleEvent:(dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteClick(c),g_objEditorDocument[c].execCommand(b,!1,null));else g_objEditorDocument[c].execCommand(b,!1,null),g_objUndoRedo.registerUndoRedoStack(0,
c)}catch(d){fnUserMessage(b.toLowerCase())}b.toLowerCase();editor_onselectionchange(c)}tranAllAnchorHrefSharp(c)}}catch(d){}}
function fnHandler_Align(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command,e=b.command_id;c=!1;ID_STRING_NAME_CHECKED==b.TBSTATE&&(c=!0);if(ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype){if(null==g_objTable)return;b="";if(!c)if(e==ID_COMMAND_JUSTIFY_LEFT)b="left";else if(e==ID_COMMAND_JUSTIFY_CENTER)b="center";else if(e==ID_COMMAND_JUSTIFY_RIGHT)b="right";else if(e==ID_COMMAND_JUSTIFY_JUSTIFY)c=!0;else return;g_objTableUtil.setAlignTableByStyleProperty(g_objTable,
b,c)}else fnHandler_Align_Main(a,d,c,e),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a),g_objTable&&g_objTableMiniMenu.objTableMiniMenuLayer&&"none"!=g_objTableMiniMenu.objTableMiniMenuLayer.style.display&&g_objTableMiniMenu.showTableMiniMenu(!0,g_objTable,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(f){}}
function fnHandler_Align_Main(c,b,a,d){g_objCommonUtil.log("strExecCommand:"+b);g_objCommonUtil.log("bAlignRemove:"+a);g_objCommonUtil.log("nCommandID:"+d);try{if(window.attachEvent)if(ID_STRING_NAME_CONTROL==g_objEditorDocument[c].selection.type.toLowerCase()){var e=GetControl_AlignCommand(b);if(""==e)return;var f=g_objEditorDocument[c].selection.createRange();for(b=0;b<f.length;b++)f.item(b).align=e;editor_onselectionchange(c)}else if(GetMultiCellSelection()){e=GetTable_AlignCommand(b);if(""==e)return;
g_objTableMultiCell.setMultiCellCommand_Align(e,c)}else g_objLetterFn.setAlignOperation(d,b,a,c,!1),g_objTableUtil.setAlignTable(d,a,c),editor_onselectionchange(c);else{var g=g_objTableSelection.isTableSelected(c);if(GetMultiCellSelection()&&!g){e=GetTable_AlignCommand(b);if(""==e)return;g_objTableMultiCell.setMultiCellCommand_Align(e,c)}else if(g)g_objTableUtil.setAlignTable(d,a,c);else{var m=getSelectionType();ID_SELECTION_ELEMENT_NODE==m.nodeType&&1==m.length&&getSelectionElementNode(c);g_objLetterFn.setAlignOperation(d,
b,a,c,!1);g_objTableUtil.setAlignTable(d,a,c);editor_onselectionchange(c)}}tranAllAnchorHrefSharp(c)}catch(n){}}function fnHandler_Undo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objUndoRedo.operateUndoRedoStack(!0,!1,a),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(a))}catch(d){}}
function fnHandler_Redo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objUndoRedo.operateUndoRedoStack(!1,!1,a),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(a))}catch(d){}}
function fnHandler_TableAddRow(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(ID_COMMAND_TABLE_ADD_ROW==b.command_id?g_objTableOperation.table_AddTableRow(g_objEditorDocument[a],g_objTable,!0,!1,a):g_objTableOperation.table_AddTableRow(g_objEditorDocument[a],g_objTable,!1,!1,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableCopyRow(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableOperation.table_AddTableRow(g_objEditorDocument[a],g_objTable,!1,!0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableDeleteRow(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableOperation.table_DeleteTableRow(g_objEditorDocument[a],g_objTable,a),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableAddCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(ID_COMMAND_TABLE_ADD_COL==b.command_id?g_objTableOperation.table_AddTableCol(g_objEditorDocument[a],g_objTable,!0,a):g_objTableOperation.table_AddTableCol(g_objEditorDocument[a],g_objTable,!1,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableDeleteCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableOperation.table_DeleteTableCol(g_objEditorDocument[a],g_objTable,a),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableMergeCell(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=g_objTableOperation.table_MergeTableCell(g_objEditorDocument[a],g_objTable,a);null!=d&&(updateTableHandlerUI.updateTableUIHandler(d[0],d[1],0,0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),tranAllAnchorHrefSharp(a),g_objUndoRedo.registerUndoRedoStack(0,a))}}catch(e){}}
function fnHandler_TableSplitRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_SplitTableRow(a,g_objTable,2)){var d=g_objTableCase.CheckSelectedCellCase(g_objTable,!1,a);updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a);g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableMiniMenu.update(g_objTable);tranAllAnchorHrefSharp(a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableSplitCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_SplitTableCol(a,g_objTable,2)){var d=g_objTableCase.CheckSelectedCellCase(g_objTable,!1,a);updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a);g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableMiniMenu.update(g_objTable);tranAllAnchorHrefSharp(a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableSplitCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SPLIT_CELL,g_objPropTagTableSplitCell.buildTagTableSplitCell(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableSplitCell.getPropSettingData();g_objPropTagTableSplitCell.bSplitRow?g_objTableOperation.table_SplitTableRow(a,g_objTable,g_objPropTagTableSplitCell.nSplitCount):
g_objTableOperation.table_SplitTableCol(a,g_objTable,g_objPropTagTableSplitCell.nSplitCount);g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(g_objTable)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableSplitCell.initPropTagTableSplitCell()},function(){},!0,"screen_center")}catch(d){}}
function fnHandler_TableAddRowCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,g_objPropTagTableAddRowCol.buildTagTableAddRowCol(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){g_objPropTagTableAddRowCol.getPropSettingData();duzon_dialog.closeDialog();if(-1==g_nEndClick_Row&&-1==g_nEndClick_Col)if(g_objPropTagTableAddRowCol.bAddRow)for(b=0;b<g_objPropTagTableAddRowCol.nAddCount;b++)0==
g_objPropTagTableAddRowCol.nAddDirection?g_objTableOperation.table_AddTableRow(g_objEditorDocument[a],g_objTable,!0,!1,a):g_objTableOperation.table_AddTableRow(g_objEditorDocument[a],g_objTable,!1,!1,a);else for(b=0;b<g_objPropTagTableAddRowCol.nAddCount;b++)0==g_objPropTagTableAddRowCol.nAddDirection?g_objTableOperation.table_AddTableCol(g_objEditorDocument[a],g_objTable,!0,a):g_objTableOperation.table_AddTableCol(g_objEditorDocument[a],g_objTable,!1,a);g_objUndoRedo.registerUndoRedoStack(0,a)},
function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableAddRowCol.initPropTagTableAddRowCol()},function(){},!0,"center")}catch(d){}}
function fnHandler_TableCellProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,duzon_dialog.getTabContents(1,[ID_RES_DIALOG_TAB_GENERAL],[g_objPropTagTableCell.buildTagTableCell()],[60],g_objPropTagTableCell.buildTagTableCellCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableCell.applyPropTagTableCell();g_objUndoRedo.registerUndoRedoStack(0,
a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCell.initPropTagTableCell(g_objTable,a)},function(){},!0)}catch(d){}}
function fnHandler_TableCellStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_STYLE,duzon_dialog.getTabContents(2,[ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTableCellStyle.buildTagTableCellStyle_Border(),g_objPropTagTableCellStyle.buildTagTableCellStyle_Background()],[60,60],g_objPropTagTableCellStyle.buildTagTableCellStyleCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(b){duzon_dialog.closeDialog();b=g_objPropTagTableCellStyle.getPropSettingData();null!=b&&(g_objTableFunction.setSelectedCellAttribute(b,g_objEditorDocument[a],g_objTable,a),g_objUndoRedo.registerUndoRedoStack(0,a))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCellStyle.initPropTagTableCellStyle(g_objTable,a)},function(){},!0)}catch(d){}}
function fnHandler_table_lock_edit_cell(c,b,a){try{!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableFunction.setLockEditCell(g_objTable,a))}catch(d){g_objCommonUtil.displayErrorAlert(d,"fnHandler_table_lock_edit_cell")}}
function fnHandler_TableProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_PROPERTY,duzon_dialog.getTabContents(3,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTable.buildTagTable_General(),g_objPropTagTable.buildTagTable_Border(),g_objPropTagTable.buildTagTable_Background()],[60,60,60],g_objPropTagTable.buildTagTableCommon()),2,[ID_RES_DIALOG_BTN_OK,
ID_RES_DIALOG_BTN_CANCEL],[function(b){g_objPropTagTable.checkValidateData()&&(duzon_dialog.closeDialog(),b=g_objPropTagTable.getPropSettingData(),null!=b&&(g_objTableFunction.setTableAttribute(b,g_objEditorDocument[a],g_objTable,a),g_objUndoRedo.registerUndoRedoStack(0,a)))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTable.initPropTagTable(g_objTable,a)},function(){},!0)}catch(d){}}
function fnHandler_TableCreate(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),ID_COMMAND_TYPE_MENU==b.commandtype?fnSub_TableCreate_Menu_Command(c,a):ID_COMMAND_TYPE_TOOL==b.commandtype&&(setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),g_objTableSizeBoxWin.showTableSizeBoxLayer(b,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0)))}catch(d){}}
function fnHandler_TableCreate_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),fnSub_TableCreate_Menu_Command(c,a))}catch(d){}}
function fnSub_TableCreate_Menu_Command(c,b){try{duzon_dialog.viewDialog(c,b,ID_RES_CONST_STRING_TABLE_CREATE,duzon_dialog.getTabContents(3,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTableCreate.buildTagTableCreate_General(),g_objPropTagTableCreate.buildTagTableCreate_Border(),g_objPropTagTableCreate.buildTagTableCreate_Background()],[60,60,60],g_objPropTagTableCreate.buildTagTableCreateCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(a){g_objPropTagTableCreate.checkValidateData()&&(duzon_dialog.closeDialog(),a=g_objPropTagTableCreate.getPropSettingData(),null!=a&&g_objTableFunction.createTable(a,b)&&g_objUndoRedo.registerUndoRedoStack(0,b))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCreate.initPropTagTableCreate()},function(){},!0)}catch(a){}}
function fnHandler_TableDelete(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableFunction.deleteTable(g_objTable),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a),g_objTableFlag.ResetTableInfo(!1),tranAllAnchorHrefSharp(a),!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtMouseUpShowDynamicMenu(),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableCellSameHeight(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellSameHeight(g_objEditorDocument[a],g_objTable,a)&&g_objUndoRedo.registerUndoRedoStack(0,a)}catch(d){}}
function fnHandler_TableCellSameWidth(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellSameWidth(g_objEditorDocument[a],g_objTable,a)&&g_objUndoRedo.registerUndoRedoStack(0,a)}catch(d){}}
function fnHandler_execTableCellAlign(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d="left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" ")[b.command_id-155].split("_"),e=d[1];g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[a],g_objTable,d[0],a);g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[a],g_objTable,e,a)}}catch(f){}}
function fnHandler_TableCellAlign(c,b,a){try{0>b.id.indexOf("TB_TABLE_CELL_ALIGN")||fnHandler_TableCellAlign_Detail(c,b,a)}catch(d){}}
function fnHandler_TableCellAlign_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),"ribbon"!=dze_menu_control.getUiMode()?duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_ALIGN,duzon_dialog.getTableCellAlignContent(),0,[],[],function(){},function(){},!0,"toolbar",b):(duzon_dialog.nExtendsDlgType=
DZE_EXTENDS_TABLE_CELL_ALIGN,duzon_dialog.viewExtendsDlg(b,a)))}}catch(e){}}function fnHandler_TableCellHorizontalLeft(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[a],g_objTable,"left",a)}catch(d){}}
function fnHandler_TableCellHorizontalCenter(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[a],g_objTable,"center",a)}catch(d){}}function fnHandler_TableCellHorizontalRight(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellHorizontalAlign(g_objEditorDocument[a],g_objTable,"right",a)}catch(d){}}
function fnHandler_TableCellVerticalTop(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[a],g_objTable,"top",a)}catch(d){}}function fnHandler_TableCellVerticalMiddle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[a],g_objTable,"middle",a)}catch(d){}}
function fnHandler_TableCellVerticalBottom(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableCellVerticalAlign(g_objEditorDocument[a],g_objTable,"bottom",a)}catch(d){}}function fnHandler_TableHorizontalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_SUM)}function fnHandler_TableVerticalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_SUM)}
function fnHandler_TableHorizontalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_AVERAGE)}function fnHandler_TableVerticalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_AVERAGE)}function fnHandler_TableHorizontalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_MULTIPLY)}
function fnHandler_TableVerticalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_MULTIPLY)}function fnHandler_TableFormula(c,b,a,d,e){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableOperation.table_TableFormula(g_objTable,d,e,a)&&(g_objTableMiniMenu.showTableMiniMenu(!0,g_objTable,a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(f){}}
function fnHandler_TableSelectFormula(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,g_objPropTagTableSelectFormula.buildTagTableSelectFormula(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1);g_objPropTagTableSelectFormula.setFormulaResultValue();g_objUndoRedo.registerUndoRedoStack(0,
a)},function(a){duzon_dialog.closeDialog();g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)}],function(){g_objPropTagTableSelectFormula.initPropTagTableSelectFormula(g_objTable,g_nStartClick_Row,g_nStartClick_Col,a)},function(){},!0,"center")}catch(d){}}
function fnHandler_HyperLinkInsert(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HYPERLINK_INSERT,duzon_dialog.getInsertHyperLinkContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.inputHyperLink()},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.setHyperLinkContentData();g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_type_url).onclick=
function(){duzon_dialog.setHyperLinkType()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_type_bookmark).onclick=function(){duzon_dialog.setHyperLinkType()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_unlink_button).onclick=function(){duzon_dialog.unLink();duzon_dialog.closeDialog()}},function(){},!0)}catch(d){}}
function fnHandler_FontName(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(0,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_FontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(1,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_HeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(2,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_Outdent_Indent(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command_id;if(d==ID_COMMAND_OUTDENT||d==ID_COMMAND_INDENT){c=!0;d==ID_COMMAND_INDENT&&(c=!1);if(ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype){if(null==g_objTable)return;g_objTableUtil.setTable_Outdent_Indent(g_objTable,c)}else do_handler_Outdent_Indent(c,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(e){}}
function fnHandler_LetterSpacing(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLetterSpacingWin.showLetterSpacingLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_LineHeight(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLineHeightWin.showLineHeightLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_ForeColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(duzon_dialog.curr_forecolor[a]))}catch(d){}}
function fnHandler_ForeColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){var c=!0;"undefined"!=typeof b&&(c=b);1==c&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;
fnColorCellApply(a,c);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1!=c||GetMultiCellSelection()||editor_onselectionchange(duzon_dialog.nEditNumber)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR],[function(a){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply("")},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",
2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
duzon_dialog.selectionFontStyleList.color,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){}}function fnHandler_BackColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(duzon_dialog.curr_backcolor[a]))}catch(d){}}
function fnHandler_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){var c=!0;"undefined"!=typeof b&&(c=b);1==c&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;
fnColorCellApply(a,c);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1==c&&editor_onselectionchange(duzon_dialog.nEditNumber)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;fnColorCellApply("")},function(d){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,
ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
duzon_dialog.selectionFontStyleList.backgroundColor,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}]))}}catch(e){}}function fnHandler_Help(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objCommonUtil.openWindowCommon(dzeEnvConfig.strHelpPageURL,700,700,!1,"")}catch(d){}}
function fnHandler_Preview(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&fnTool_TabMode_Preview(c,b,ID_TB_TABMODE_PREVIEW,a)}catch(d){}}function fnHandler_WriteAreaSet(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objEditMode.arrWriteAreaSet[a]=!g_objEditMode.arrWriteAreaSet[a],TBSetState(b,g_objEditMode.arrWriteAreaSet[a]?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED,ID_TB_QUERY_STATUS_BUTTON))}catch(d){}}
function fnHandler_Print(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableFlag.ResetTableInfo(!1),g_objEditMode.showAllWriteAreaSet(a,!1),g_objEditMode.showAllContentEditableArea(a,!1),g_objEditMode.showBGImageForLockedCell(!1,a),replaceEditorTempTagsFromEditor(a),g_bBrowserType_IE&&2==g_nFormEditMode?g_objEditorDocument[a].execCommand("print",!1,null):g_bBrowserType_IE?g_objEditorDocument[a].execCommand("print",!1,null):g_objEditWindow[a].print(),
g_objEditMode.showAllWriteAreaSet(a,!0),g_objEditMode.showAllContentEditableArea(a,!0),g_objEditMode.showBGImageForLockedCell(!0,a),recoverEditorTempTagsFromEditor(a))}catch(d){}}function fnHandler_FormTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1),showFormTable(c,a,!0))}catch(d){}}
function showFormTable(c,b,a){try{var d=function(a){a=a?a:window.event;"duzon_dialog_title"==(a.srcElement?a.srcElement:a.target).className&&g_objPropFormEvent.showAllAreaRectangle()},e=function(a){a=a?a:window.event;"duzon_dialog_title"==(a.srcElement?a.srcElement:a.target).className&&g_objPropFormEvent.hideAllAreaRectangle()};g_objPropForm.bGenerateColGroup=!1;g_objPropForm.bShowPropForm=!0;g_objUndoRedo.registerUndoRedoStack(0,b);var f=ID_RES_PROP_FORM_WIN_TITLE;a||(f=ID_RES_CONST_STRING_DRAW_TABLE);
duzon_dialog.viewDialog(c,b,f,g_objPropForm.buildPropForm(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.closeDialog();g_objPropForm.doApplyGenerateFormCode();g_objPropForm.hidePropForm();g_objUndoRedo.registerUndoRedoStack(0,b)},function(a){duzon_dialog.closeDialog();g_objPropForm.hidePropForm();g_objUndoRedo.operateUndoRedoStack(!0,!0,b)}],function(){g_objPropForm.initPropForm(g_objTable);g_objPropForm.dummyAnchorFocus();window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousedown",
e),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",d)):(g_objLayerKit.getLayerDocument().addEventListener("mousedown",e,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",d,!1))},function(){window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousedown",e),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",d)):(g_objLayerKit.getLayerDocument().removeEventListener("mousedown",e,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",d,!1))},!1,
"screen_center")}catch(g){}}function fnHandler_drawTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1),showFormTable(c,a,!1))}catch(d){}}
function fnHandler_FormTagSwitch(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTagUtil.bFormTagSwitch=!g_objTagUtil.bFormTagSwitch,g_objTagUtil.formTagSwitch(g_objTagUtil.bFormTagSwitch,a),editor_onselectionchange(a))}catch(d){}}
function fnHandler_CheckBox(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&ID_STRING_NAME_CONTROL!=g_strSelectionType&&(c="",c+='<span contenteditable="false">',insertHTMLCodeAtSelection(c+'<input type="checkbox"></span>',null,a))}catch(d){}}
function fnHandler_SelectBox(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(ID_STRING_NAME_CONTROL==g_strSelectionType?duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_SELECT_WIN_TITLE,g_objPropTagSelect.buildTagSelect(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){g_objPropTagSelect.applyDisplayInfo();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagSelect.initPropTagSelect(g_objObjectSelectionInfo.objSelectionObject)},
function(){},!0):(c="",c+='<span contenteditable="false">',c+="<select>",c+="<option>"+ID_RES_DIALOG_FORM_LIST1+"</option>",c+="<option>"+ID_RES_DIALOG_FORM_LIST2+"</option>",c+="<option>"+ID_RES_DIALOG_FORM_LIST3+"</option>",insertHTMLCodeAtSelection(c+"</select></span>",null,a),g_objUndoRedo.registerUndoRedoStack(0,a)))}catch(d){}}function dummyFunc(c,b,a){g_objCommonUtil.log("---dummyFunc called---command_id:"+b.command_id)}
function dummyFunc_Detail(c,b,a){g_objCommonUtil.log("---dummyFunc_Detail called---command_id:"+b.command_id)}
function fnHandler_NewFile(c,b,a){g_objCommonUtil.log("fnHandler_NewFile nEditNumber:"+a);try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=fnGetEditorHTMLCode(!1,a);d=d.trim();g_objCommonUtil.log("strEditorHTMLCode:"+d);""!=d&&"<p><br /></p>"!=d&&"<p><br></p>"!=d&&"<p>&nbsp;</p>"!=d&&"<p></p>"!=d&&"<br>"!=d&&"<br />"!=d&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_NEW,ID_RES_DIALOG_CONFIRM_SAVE,3,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO,
ID_RES_DIALOG_BTN_CANCEL],[function(b){saveEditorContentToFile(-1);duzon_dialog.closeDialog();replaceHTMLContent("<p><br /></p>",a)},function(b){replaceHTMLContent("<p><br /></p>",a);duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}])}}catch(e){}}
function fnHandler_SaveAs(c,b,a){-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(c=fnGetEditorHTMLCode(!1,a),c=c.trim(),""==c||"<p><br /></p>"==c||"<p><br></p>"==c||"<p>&nbsp;</p>"==c||"<p></p>"==c||"<br />"==c||"<br>"==c?alert(ID_RES_DIALOG_CONFIRM_EMPTY_DOC):saveEditorContentToFile(a))}
function saveEditorContentToFile(c){try{g_objCommonUtil.log("saveEditorContentToFile act");-1==c&&(c=g_nActiveEditNumber);var b=fnGetEditorHTMLCode(!1,c);g_objCommonUtil.log(b);var a=document.createElement("form");a.action=dzeEnvConfig.strSaveAsPageURL+"?"+duzon_http.getCurrTime();a.method="post";var d=document.createElement("textarea");d.name="content";d.value=b;a.appendChild(d);document.body.appendChild(a);a.submit();g_objCommonUtil.log("saveEditorContentToFile submit ok");g_objCommonUtil.log(b);
document.body.removeChild(a)}catch(e){}}
function fnHandler_OpenFile(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_OPEN,duzon_dialog.getOpenFileFormContent(),2,[ID_RES_CONST_STRING_FILE_OPEN,ID_RES_DIALOG_BTN_CANCEL],[function(b){if(""==g_objLayerKit.getElementById(duzon_dialog.idx_openfile_input).value)alert(ID_RES_DIALOG_ALERT_SELECTFILE);else if(b=fnGetEditorHTMLCode(!1,a),b=b.trim(),""==b||"<p><br /></p>"==b||"<p><br></p>"==
b||"<p>&nbsp;</p>"==b||"<p></p>"==b||"<br>"==b||"<br />"==b||confirm(ID_RES_DIALOG_CONFIRM_FILE_DELETE_CONTENT))if(b=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_input).value.split(".").pop().toLowerCase(),g_objCommonUtil.log("fileExt:"+b),inArray(b,duzon_dialog.avail_openfile_ext)){duzon_dialog.resetTableObjInfo();var c=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_iframe);c.onload=function(){setEditorHTMLCode(c.contentWindow.document.body.innerHTML,!1,duzon_dialog.nEditNumber);
duzon_dialog.closeDialog();fnHandler_InsertParagraph(a,"end")};b=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_form);b.target=duzon_dialog.nm_openfile_iframe;b.action=dzeEnvConfig.strOpenFilePageURL;b.submit()}else alert("'"+b+"' "+ID_RES_DIALOG_ALERT_ALLOWFILES+" : "+duzon_dialog.avail_openfile_ext.join(", "));else duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}],function(){g_objCommonUtil.log("onload callback--------")},function(){g_objCommonUtil.log("unload callback--------")}),
document.getElementById(duzon_dialog.idx_openfile_input).value="")}catch(d){}}function fnHandler_DocForm(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_DOCFORM,duzon_dialog.getDocFormContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.inputSelectDocFormData();fnHandler_InsertParagraph(a,"end")},function(a){duzon_dialog.closeDialog()}])}catch(d){}}
function fnHandler_Layout(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_LAYOUT,duzon_dialog.getLayoutContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.inputSelectLayoutData();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.addLayoutContentEvent()},function(){},!0)}catch(d){}}
function fnHandler_viewEdit(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_EDIT,a)}catch(d){}}function fnHandler_viewHtml(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a)}catch(d){}}
function fnHandler_viewRulerbar(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&g_bRulerbar_Display&&(isCreatedRulerBar()||dze_rulerbar_mgr.createRulerbar(a,window.frameElement.clientWidth-2,3),dze_rulerbar_mgr.changeRulerbarDisplay(a,!dze_rulerbar_mgr.m_bShow),dze_rulerbar_mgr.resizeEditorHeight(),!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode)){g_strSelectionType=getSelectionTypeForUpdateUI();var d=handlerUI.queryCommandStatus(g_objEditorDocument[a],
ID_COMMAND_VIEW_RULERBAR,b.command,a,0,g_strSelectionType);null!=d&&TBSetState(b,d,g_arrConst[ID_COMMAND_VIEW_RULERBAR][6])}}catch(e){}}
function fnHandler_InsertImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a);null!=d.controlObject&&"undefined"!=typeof d.controlObject&&"img"==d.controlObject.nodeName.toLowerCase()?fnHandler_ModifyImage(c,b,a):duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,duzon_dialog.getInsertImageContent(ID_RES_CONST_STRING_INSERT_IMAGE),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){setTimeout(function(){var b=
0,c=duzon_dialog.arrEditingImg;if(null==c||0==c.length)b=ID_RES_DIALOG_ALERT_INSERT_IMAGE;for(var d=0,e=c.length;d<e;d++)if("undefined"==typeof c[d].src){b=ID_RES_DIALOG_ALERT_INSERT_IMAGE;break}else if(0==c[d].width||0==c[d].height){b=ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE;break}if(b)alert(b);else{d=g_objLayerKit.getLayerDocument().dze_insert_image_form;b={};""!=d.dze_image_width.value&&1==c.length&&(b.width=d.dze_image_width.value+"px");""!=d.dze_image_height.value&&1==c.length&&(b.height=d.dze_image_height.value+
"px");""!=d.dze_image_marginleft.value&&(b.marginLeft=d.dze_image_marginleft.value+"px");""!=d.dze_image_margintop.value&&(b.marginTop=d.dze_image_margintop.value+"px");""!=d.dze_image_marginright.value&&(b.marginRight=d.dze_image_marginright.value+"px");""!=d.dze_image_marginbottom.value&&(b.marginBottom=d.dze_image_marginbottom.value+"px");var l={};"default"!=d.dze_image_align.value&&(l.align=d.dze_image_align.value);var k=g_objLayerKit.getLayerDocument().createElement("div");d=0;for(e=c.length;d<
e;d++){var h=g_objLayerKit.getLayerDocument().createElement("img");h.src=c[d].src;h.style.width=c[d].style.width;h.style.height=c[d].style.height;for(var p in b)h.style[p]=b[p];for(var q in l)h.style[q]=l[q];k.appendChild(h)}duzon_dialog.closeDialog();fnAddHTMLContent(k.innerHTML,null,0,a);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)}},100)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_image_marginleft",100,0,0,"");duzon_dialog.modifySpinnerValue("dze_image_margintop",
100,0,0,"");duzon_dialog.modifySpinnerValue("dze_image_marginright",100,0,0,"");duzon_dialog.modifySpinnerValue("dze_image_marginbottom",100,0,0,"");!0===dzeUiConfig.bUseServerUpload&&(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upimage_txt).onchange=function(){duzon_dialog.insertImageForm()});g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).onblur=function(){duzon_dialog.insertImageForm()};g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).onkeydown=
function(a){(a?a:g_objLayerKit.getLayerWindow().event).keyCode==ID_KEYCODE_ENTER&&duzon_dialog.insertImageForm()};g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).onpaste=function(){setTimeout(function(){duzon_dialog.insertImageForm()},100)};g_objLayerKit.getElementById(duzon_dialog.idx_dze_org_imagesize).onclick=function(){duzon_dialog.insertOrgImageSize()};g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_checkbox_orgratio).onclick=function(){duzon_dialog.setImageOrgRatio(this)};
g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_width).onkeyup=function(){duzon_dialog.modInsertImageResize(this,"width")};g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_height).onkeyup=function(){duzon_dialog.modInsertImageResize(this,"height")};if(!0===dzeUiConfig.bUseServerUpload){g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type1).onclick=function(){duzon_dialog.checkDzeInsertType(this)};g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2).onclick=
function(){duzon_dialog.checkDzeInsertType(this)};duzon_dialog.addEventExtFileForm(duzon_dialog.idx_insertimage_upimage_txt,function(){duzon_dialog.insertImageForm()});var a=g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type1),b=g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2);a.addEventListener("change",duzon_dialog.onradiochange_insertType);b.addEventListener("change",duzon_dialog.onradiochange_insertType);duzon_dialog.checkDzeInsertType(a)}else duzon_dialog.enableImageUrlForm(duzon_dialog.idx_insertimage_upurl_txt),
g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).select();duzon_dialog.addEventImageUrlForm(duzon_dialog.idx_insertimage_upurl_txt,function(){duzon_dialog.insertImageForm()})})}}catch(e){}}
function fnHandler_ModifyImage(c,b,a){g_objCommonUtil.log("fnHandler_ModifyImage start");try{var d=null,e=getSelectionControl(a);null==e.controlObject||"undefined"==typeof e.controlObject||"img"!=e.controlObject.nodeName.toLowerCase()?g_objCommonUtil.log("fnHandler_ModifyImage :: no image"):(d=e.controlObject,-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_PROP_INSERT_IMAGE,duzon_dialog.getInsertImageContent(ID_RES_PROP_INSERT_IMAGE),
2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(a){0==duzon_dialog.arrEditingImg[0].width||0==duzon_dialog.arrEditingImg[0].height?alert(ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE):(d.getAttribute("width")&&d.removeAttribute("width"),d.getAttribute("height")&&d.removeAttribute("height"),a=g_objLayerKit.getLayerDocument().dze_insert_image_form,""!=a.dze_image_width.value&&(d.style.width=a.dze_image_width.value+"px"),""!=a.dze_image_height.value&&(d.style.height=a.dze_image_height.value+"px"),
""!=a.dze_image_marginleft.value&&(d.style.marginLeft=a.dze_image_marginleft.value+"px"),""!=a.dze_image_margintop.value&&(d.style.marginTop=a.dze_image_margintop.value+"px"),""!=a.dze_image_marginright.value&&(d.style.marginRight=a.dze_image_marginright.value+"px"),""!=a.dze_image_marginbottom.value&&(d.style.marginBottom=a.dze_image_marginbottom.value+"px"),"default"==a.dze_image_align.value?d.getAttribute("align")&&d.removeAttribute("align"):d.align=a.dze_image_align.value,duzon_dialog.closeDialog())},
function(a){duzon_dialog.closeDialog()}],function(){null!=d&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),duzon_dialog.modifySpinnerValue("dze_image_marginleft",100,0,0,""),duzon_dialog.modifySpinnerValue("dze_image_margintop",100,0,0,""),duzon_dialog.modifySpinnerValue("dze_image_marginright",100,0,0,""),duzon_dialog.modifySpinnerValue("dze_image_marginbottom",100,0,0,""),g_objLayerKit.getElementById(duzon_dialog.idx_dze_org_imagesize).onclick=function(){duzon_dialog.insertOrgImageSize()},g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_checkbox_orgratio).onclick=
function(){duzon_dialog.setImageOrgRatio(this)},g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_width).onkeyup=function(){duzon_dialog.modInsertImageResize(this,"width")},g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_height).onkeyup=function(){duzon_dialog.modInsertImageResize(this,"height")},!0===dzeUiConfig.bUseServerUpload&&(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type1).onclick=function(){duzon_dialog.checkDzeInsertType(this)},g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2).onclick=
function(){duzon_dialog.checkDzeInsertType(this)}),duzon_dialog.imgRatio=parseInt(d.height,10)/parseInt(d.width,10),duzon_dialog.getImageObj(d.src,function(a){duzon_dialog.arrEditingImg=[a]},function(){}),!0===dzeUiConfig.bUseServerUpload?(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2).checked=!0,duzon_dialog.checkDzeInsertType(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2)),g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).value=
d.src,g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).disabled=!0,g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type1).disabled=!0,g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_radio_type2).disabled=!0):(g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).value=d.src,g_objLayerKit.getElementById(duzon_dialog.idx_insertimage_upurl_txt).disabled=!0),g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_width).value=d.offsetWidth,
g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_height).value=d.offsetHeight,g_objLayerKit.getElementById("dze_image_marginleft").value=d.style.marginLeft.replace(/px/,""),g_objLayerKit.getElementById("dze_image_margintop").value=d.style.marginTop.replace(/px/,""),g_objLayerKit.getElementById("dze_image_marginright").value=d.style.marginRight.replace(/px/,""),g_objLayerKit.getElementById("dze_image_marginbottom").value=d.style.marginBottom.replace(/px/,""),g_objLayerKit.getElementById("dze_image_marginbottom").value=
d.style.marginBottom.replace(/px/,""),""!=d.align&&(g_objLayerKit.getElementById(duzon_dialog.idx_dze_insertimage_align).value=d.align))}))}catch(f){}}
function fnHandler_Pastespecial(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&((g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.command_id==ID_COMMAND_EDIT_PASTESPECIAL?alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_EDIT_PASTESPECIAL,duzon_dialog.getPastespecial(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_text).checked?
window.clipboardData&&window.clipboardData.getData?(pastedText=g_objLayerKit.getLayerWindow().clipboardData.getData("Text"),fnAddHTMLContent(pastedText,null,0,a),TBCancelBubbleEvent(b),duzon_dialog.closeDialog()):alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_html).checked&&(duzon_dialog.closeDialog(),fnHandler_SupportCommand_Main(a,"Paste"))},function(a){duzon_dialog.closeDialog()}]))}catch(d){}}
function fnHandler_TabDialogSample(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,duzon_dialog.getSampleTabContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(a){},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(1)},function(){},!0)}catch(d){}}
function fnHandler_FindReplaceText(c,b,a){try{var d=function(a){var b=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value,d=1;d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(e=1);var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(f=1);if(""==b)alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),
g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus();else if(""==c)alert(ID_RES_DIALOG_ALERT_REPLACE_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).focus();else{var g=replaceAllEditorText(a,b,c,d,e,f,0);-1==g?alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR):setTimeout(function(){0==g?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):alert(ID_RES_DIALOG_ALERT_REPLACEALL_COMPLETE+"\n"+g+ID_RES_DIALOG_ALERT_REPLACE_N)},500)}},e=function(a){var b=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,
c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value;var d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(f=1);var g=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(g=1);""==b?(alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus()):""==c?(alert(ID_RES_DIALOG_ALERT_REPLACE_INPUT_TEXT),
g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).focus()):(b=replaceEditorTextDetail(a,b,c,d,f,g,0),-1==b?alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR):0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):1!=b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b?0==d?confirm(ID_RES_DIALOG_CONFIRM_FIND_END)&&e(a):confirm(ID_RES_DIALOG_CONFIRM_FIND_FIRST)&&e(a):4==b&&alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA)))},f=function(a){var b=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value;
var c=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var d=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(d=1);var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(e=1);""==b?(alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus()):(b=findEditorTextDetail(a,b,c,d,e,0),g_objCommonUtil.log("nReturnCode:"+b),-1==b?alert(ID_RES_DIALOG_ALERT_FIND_ERROR):0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):
1!=b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b&&(0==c?confirm(ID_RES_DIALOG_CONFIRM_FIND_END)&&f(a):confirm(ID_RES_DIALOG_CONFIRM_FIND_FIRST)&&f(a))))};-1==a&&(a=g_nActiveEditNumber);if(fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){if(b.command_id==ID_COMMAND_EDIT_SEARCH)var g="find";else if(b.command_id==ID_COMMAND_EDIT_REPLACE)g="replace";else return;g_objCommonUtil.log("mode:"+g);duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FIND_REPLACE,duzon_dialog.getFindReplaceContent(),
4,[ID_RES_DIALOG_BTN_REPLACEALL,ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_DIALOG_BTN_FIND_NEXT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){g_objCommonUtil.log("func : \ubaa8\ub450\ubc14\uafb8\uae30");d(a);g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){g_objCommonUtil.log("func : \ubc14\uafb8\uae30");e(a);g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){g_objCommonUtil.log("func : \ub2e4\uc74c\ucc3e\uae30:"+duzon_dialog.idx_duzon_find_text);f(a)},function(a){g_objCommonUtil.log("func : \ub2eb\uae30");
duzon_dialog.closeDialog()}],function(){setTimeout(function(){"find"==g?duzon_dialog.viewTabContents(0):duzon_dialog.viewTabContents(1)},50);""!=duzon_dialog.strFindText&&(g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value=duzon_dialog.strFindText);g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).onblur=function(){duzon_dialog.strFindText=this.value};duzon_dialog.resetSelection=!0;duzon_dialog.isFindDialog=!0},function(){},!0)}}catch(m){}}
function fnHandler_InsertExtMovie(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_EXT_MOVIE,duzon_dialog.getInsertExtMovieContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.insertExtMovieContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_movie_marginleft",500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_margintop",
500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_marginright",500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_marginbottom",500,0,0,"")},function(){},!0)}catch(d){}}
function fnHandler_InsertExtFile(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&("dzeExtFile"==g_objPropContentLink.getPropContentParam(a).arrValue[3]?fnHandler_ModifyExtFile(c,b,a):duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.insertExtFileContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).onchange=function(){duzon_dialog.uploadExtFile()}},function(){},!0))}catch(d){}}
function fnHandler_ModifyExtFile(c,b,a){g_objCommonUtil.log("fnHandler_ModifyExtFile Call");var d=g_objPropContentLink.getPropContentParam(a);if("dzeExtFile"==d.arrValue[3]){g_objCommonUtil.log("objParam.arrValue:"+d.arrValue);try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.modifyExtFileContent();
g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){var a=d.arrValue[4];g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).disabled=!0;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=a},function(){},!0,"relative")}catch(e){}}}
function fnHandler_InsertHr(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_bBrowserType_IE?g_objEditorDocument[a].execCommand("InsertHorizontalRule",!1,""):g_objEditorDocument[a].execCommand("InsertHorizontalRule",!1,null),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}function fnHandler_InsertEmoticons_Detail(c,b,a){fnHandler_InsertEmoticons(c,b,a)}
function fnHandler_InsertEmoticons(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])if("ribbon"!=dze_menu_control.getUiMode())duzon_dialog.nInsTypeIdx=1,duzon_dialog.makeInsTypeInfo(),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_EMOTICONS,duzon_dialog.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.insertTypeContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){setTimeout(function(){duzon_dialog.loadInsertTypeContent()},150)},function(){},!0);else{var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_EMOTICON,duzon_dialog.makeExtendsDlgInfo(),duzon_dialog.viewExtendsDlg(b,a,null,null,null,"toolbar",null))}}catch(e){}}
function fnHandler_SpecialChars(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.nInsTypeIdx=0,duzon_dialog.makeInsTypeInfo(),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_SPECIALCHARS,duzon_dialog.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.insertTypeContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){setTimeout(function(){duzon_dialog.loadInsertTypeContent()},
100)},function(){},!0))}catch(d){}}
function fnHandler_InsertBookmark(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_BOOKMARK,duzon_dialog.getInsertBookmarkContent(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.printBookmarkList();g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_insert_btn).onclick=function(){duzon_dialog.inputBookmark()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_delete_btn).onclick=
function(){duzon_dialog.removeBookmarkItem()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_move_btn).onclick=function(){duzon_dialog.moveBookmarkPosition()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_sort_name).onclick=function(){duzon_dialog.printBookmarkList()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_sort_position).onclick=function(){duzon_dialog.printBookmarkList()}},function(){},!0)}catch(d){}}
function fnHandler_InsertParagraphStartPoint(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnHandler_InsertParagraph(a,"start")}catch(d){}}function fnHandler_InsertParagraphEndPoint(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnHandler_InsertParagraph(a,"end")}catch(d){}}
function fnHandler_InsertParagraph(c,b){g_objTable?g_objCommonUtil.log("table"):g_objCommonUtil.log("no table");var a=document.createElement("p");a.id="idx_dze_dummy_p_tag_123456789";a.innerHTML=window.attachEvent?"&nbsp;":"<br />";if(g_objTable)if("start"==b)g_objTable.parentNode.insertBefore(a,g_objTable);else{var d=g_objTable.nextSibling;d?g_objTable.parentNode.insertBefore(a,d):g_objTable.parentNode.appendChild(a)}else"start"==b?g_objEditorDocument[c].body.insertBefore(a,g_objEditorDocument[c].body.childNodes[0]):
g_objEditorDocument[c].body.appendChild(a);a.getAttribute("id")&&a.removeAttribute("id");duzon_dialog.setFocusElement(a,c,"start");null==g_objTable&&("start"==b?g_objEditWindow[c].scrollTo(0,0):g_objEditWindow[c].scrollTo(0,g_objEditorDocument[c].body.scrollHeight));g_objUndoRedo.registerUndoRedoStack(0,c)}
function fnHandler_StyleFont(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_objCommonUtil.log("fnHandler_StyleFont element"),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_FONT,duzon_dialog.getStyleFontContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleFont();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_style_font_spacing",
duzon_dialog.max_letterspacing,duzon_dialog.min_letterspacing,duzon_dialog.min_letterspacing,"duzon_dialog.preveiwDzeLetterSpacing");duzon_dialog.modifySpinnerValue("dze_style_font_size",36,8,9,"duzon_dialog.preveiwDzeFontSize");for(var a="",b="",c=0;c<duzon_dialog.dze_font_propertys.length;c++)a="idx_dze_style_font_"+duzon_dialog.dze_font_propertys[c],b=duzon_dialog.dze_font_propertys[c],function(){var c=b;g_objLayerKit.getElementById(a).onclick=function(){duzon_dialog.selectFontProperty(c)}}();
g_objColorComboBoxUtil.initColorComboBox("dze_font_forecolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.color=a},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);g_objColorComboBoxUtil.initColorComboBox("dze_font_backcolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=a});$_("dze_style_font_family").onchange=function(){$_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=this.value};g_objColorComboBoxUtil.setColorValue("dze_font_forecolor",
"");g_objColorComboBoxUtil.setColorValue("dze_font_backcolor","");duzon_dialog.checkSelectionFontStyle()},function(){},!0))}catch(d){}}
function fnHandler_StyleParagraph(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_PARAGRAPH,duzon_dialog.getStyleParagraphContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleParagraph();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a);isShowedRulerBar()&&dze_rulerbar_mgr.updateCtrlPos()},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_style_p_margin_left",
duzon_dialog.marginLeftMax,duzon_dialog.marginLeftMin,0,"");duzon_dialog.modifySpinnerValue("dze_style_p_margin_right",duzon_dialog.marginRightMax,duzon_dialog.marginRightMin,0,"");duzon_dialog.modifySpinnerValue("dze_style_p_firstline_indent",533,0,0,"");duzon_dialog.modifySpinnerValue("dze_style_p_line_height",duzon_dialog.lineHeightMax,duzon_dialog.lineHeightMin,duzon_dialog.lineHeightDefault,"");duzon_dialog.modifySpinnerValue("dze_style_p_margin_top",876,0,0,"");duzon_dialog.modifySpinnerValue("dze_style_p_margin_bottom",
876,0,0,"");g_objLayerKit.getElementById(duzon_dialog.idx_dze_firstline_indent_normal).onclick=function(){duzon_dialog.checkFirstlineIndentSelect()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_firstline_indent_in).onclick=function(){duzon_dialog.checkFirstlineIndentSelect()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_firstline_indent_out).onclick=function(){duzon_dialog.checkFirstlineIndentSelect()};for(var a="",b=0;b<duzon_dialog.dze_style_paragraph_align_propertys.length;b++)curr_property=
duzon_dialog.dze_style_paragraph_align_propertys[b],a="idx_dze_style_paragraph_"+curr_property,function(){var b=curr_property;g_objLayerKit.getElementById(a).onclick=function(){duzon_dialog.selectParagraphAlign(b)}}();duzon_dialog.checkSelectionParagraphStyle()},function(){},!0)}catch(d){}}
function fnHandler_StyleHeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand="Heading",b.command_id==ID_COMMAND_STYLE_STYLE_BASIC?g_objComboBoxWin.setComboBox(0):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT1?g_objComboBoxWin.setComboBox(1):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT2?g_objComboBoxWin.setComboBox(2):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT3?
g_objComboBoxWin.setComboBox(3):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT4?g_objComboBoxWin.setComboBox(4):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT5&&g_objComboBoxWin.setComboBox(5))}catch(d){}}
function fnHandler_StyleUnorderedList(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,duzon_dialog.getStyleUnorderedListContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleUnorderedListItem();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.addEventUnorderedListContent();
duzon_dialog.checkSelectionStyleUnorderedListItem()},function(){},!0)}catch(d){}}
function fnHandler_StyleOrderedList(c,b,a){g_objCommonUtil.log("fnHandler_StyleOrderedList call");try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_ORDEREDLIST,duzon_dialog.getStyleOrderedListContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleOrderedListItem();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){duzon_dialog.addEventOrderedListContent();duzon_dialog.checkSelectionStyleOrderedListItem()},function(){},!0)}catch(d){}}function fnHandler_ProductInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_WEBEDITOR_INFO,duzon_dialog.getWebEditorInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"center")}catch(d){}}
function fnHandler_ShortCutsInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HELP_SHORTCUTS,duzon_dialog.getShortCutsInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.setShortCutsInfo()},function(){},!1,"center")}catch(d){}}
function fnHandler_StyleIncreaseFontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&increaseFontSize(!0,a)}catch(d){}}function fnHandler_StyleDecreaseFontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&increaseFontSize(!1,a)}catch(d){}}
function fnHandler_Tb_OrderedList(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command),cleanPtagForOrderedList(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_Tb_OrderedList")}}
function fnHandler_Tb_OrderedList_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),"ribbon"!=dze_menu_control.getUiMode()?duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_ORDEREDLIST,duzon_dialog.getStyleOrderedListContent(),0,[],[],function(){duzon_dialog.addEventOrderedListContent("toolbar");
duzon_dialog.checkSelectionStyleOrderedListItem()},function(){},!0,"toolbar",b):(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_STYLE_ORDERLIST,duzon_dialog.viewExtendsDlg(b,a)))}}catch(e){}}
function fnHandler_Tb_UnorderedList(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command),cleanPtagForOrderedList(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_Tb_UnorderedList")}}
function fnHandler_Tb_UnorderedList_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),"ribbon"!=dze_menu_control.getUiMode()?duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,duzon_dialog.getStyleUnorderedListContent(),0,[],[],function(){duzon_dialog.addEventUnorderedListContent("toolbar");
duzon_dialog.checkSelectionStyleUnorderedListItem()},function(){},!0,"toolbar",b):(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_STYLE_UNORDERLIST,duzon_dialog.viewExtendsDlg(b,a)))}}catch(e){}}
function fnHandler_ReplaceCase(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_REPLACE_CASE,duzon_dialog.getReplaceCaseContent(),2,[ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.closeDialog();duzon_dialog.setReplaceCase();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.initReplaceCaseBtnEvent()},function(){},
!0,"center")}catch(d){}}
function fnHandler_Table_Cell_BackColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.curr_cell_backcolor[a];null!=g_objTable&&(c=[],c[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""],c[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,d],c[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""],g_objTableFunction.setSelectedCellAttribute(c,g_objEditorDocument[a],g_objTable,a),g_objUndoRedo.registerUndoRedoStack(0,a))}}catch(e){}}
function fnHandler_Table_Cell_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();null!=g_objTable&&(c=
[],c[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""],c[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,b],c[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""],g_objTableFunction.setSelectedCellAttribute(c,g_objEditorDocument[a],g_objTable,a),1==d&&g_objUndoRedo.registerUndoRedoStack(0,a))},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(b){duzon_dialog.closeExtendsDlg();null!=g_objTable&&(b=[],b[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""],b[ID_PROP_NODE_BACKGROUND_COLOR]=
[!1,!0,""],b[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""],g_objTableFunction.setSelectedCellAttribute(b,g_objEditorDocument[a],g_objTable,a),g_objUndoRedo.registerUndoRedoStack(0,a))},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c&&(duzon_dialog.selectColorCode(c,b),duzon_dialog.closeDialog(),null!=g_objTable)){var d=
[];d[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""];d[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,c];d[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""];g_objTableFunction.setSelectedCellAttribute(d,g_objEditorDocument[a],g_objTable,a);g_objUndoRedo.registerUndoRedoStack(0,a)}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b="";if(null!=g_objTable){var c=g_objTableFunction.getSelectedCellAttribute(g_objEditorDocument[a],g_objTable,a);null!=c[ID_PROP_NODE_BACKGROUND_COLOR]&&
(b=c[ID_PROP_NODE_BACKGROUND_COLOR])}dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",b,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){}}function fnHandler_IncreaseOrder(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("increase",a,c)}catch(d){}}
function fnHandler_DecreaseOrder(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("decrease",a,c)}catch(d){}}
function fnHandler_TableConvertText(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTable&&fnHandler_TableConvertTextMain(g_objTable,a)&&(g_objTableFlag.ResetTableInfo(!0),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}
function fnHandler_TableConvertTextMain(c,b){try{var a=g_objNodeUtil.getParentElement(c),d=g_objPropertyUtil.getTextContent(c),e=g_objEditorDocument[b].createElement("p");e.innerHTML=d;a.insertBefore(e,c);a.removeChild(c);return!0}catch(f){}return!1}function fnHandler_FullScreen(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;dzeFullScreen.view(a)}catch(d){}return!1}
function fnHandler_InsertPrintPageBreak(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;insertPrintPageBreak(a)}catch(d){}return!1}function fnHandler_cascadeOrderList(c,b,a){try{fnHandler_cascadeOrderList_Detail(c,b,a)}catch(d){}return!1}
function fnHandler_cascadeOrderList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_CASCADE_ORDERLIST;duzon_dialog.viewExtendsDlg(b,a)}catch(e){}return!1}
function fnHandler_CopyExt(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COPY_EXT;duzon_dialog.viewExtendsDlg(b,a)}catch(e){g_objCommonUtil.displayErrorAlert(e,"fnHandler_CopyExt")}return!1}
function fnHandler_CopyExt_Detail(c,b,a){fnHandler_CopyExt(c,b,a)}function fnHandler_CopyExtStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;dzeCopyPasteStyleInfo.copy(a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"fnHandler_CopyExtStyle")}return!1}
function fnHandler_SelectParagraphDropDown(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_INSERT_PARAGRAPH,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_SelectParagraphDropDown_Detail(c,b,a){fnHandler_SelectParagraphDropDown(c,b,a)}function fnHandler_PasteExt(c,b,a){fnHandler_SupportCommand(c,b,a)}
function fnHandler_PasteExt_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_PASTE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TalbeDeleteExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_DELETE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TalbeDeleteExt_Detail(c,b,a){fnHandler_TalbeDeleteExt(c,b,a)}
function fnHandler_TableSelect(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_SELECT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableSelect_Detail(c,b,a){fnHandler_TableSelect(c,b,a)}
function fnHandler_TableFomulaExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_FORMULA_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableFomulaExt_Detail(c,b,a){fnHandler_TableFomulaExt(c,b,a)}
function fnHandler_TableNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_NUMBER_FORMAT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableNumberFormat_Detail(c,b,a){fnHandler_TableNumberFormat(c,b,a)}
function fnHandler_ImageBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_ImageBorderType_Detail(c,b,a){fnHandler_ImageBorderType(c,b,a)}
function fnHandler_ImageBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_ImageBorderThickness_Detail(c,b,a){fnHandler_ImageBorderThickness(c,b,a)}function fnHandler_ImageBorderColor(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject;e.style.borderColor=duzon_dialog.curr_image_border_backcolor[a];commonImageUpdateAfterChange(e,a)}}catch(f){}}
function fnHandler_ImageBorderColor_Detail(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=d.controlObject;duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();f.style.borderColor=
b;1==d&&commonImageUpdateAfterChange(f,a)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(c){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("#FFFFFF",b);f.style.borderColor="#FFFFFF";commonImageUpdateAfterChange(f,a)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");""!=c&&(duzon_dialog.selectColorCode(c,
b),duzon_dialog.closeDialog(),f.style.borderColor=c,commonImageUpdateAfterChange(f,a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0)}}catch(g){}}
function imageExceptionCheck(c){try{return null==c||"undefined"==typeof c||"img"!=c.nodeName.toLowerCase()?(g_objCommonUtil.log("imageExceptionCheck :: no image"),!1):!0}catch(b){}}function commonExceptionCheck(c,b,a){try{return document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]?!0:!1}catch(d){}}
function commonImageUpdateAfterChange(c,b){try{(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(c,!0,!1,b),dze_menu_control.setTBImageSizeInfo(b),g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b)}catch(a){}}
function fnHandler_ImageResetPicture(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject;e.removeAttribute("style");e.removeAttribute("width");e.removeAttribute("height");var f=new Image;f.src=e.src;f.onload=function(){e.setAttribute("width",this.width);e.setAttribute("height",this.height);commonImageUpdateAfterChange(e,a)};f.onerror=function(){}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"error:fnHandler_ImageResetPicture")}}
function fnHandler_ObjectBorderNoLine(c,b,a){setObjectBorderLineWithType(c,b,a,"noline")}function fnHandler_ObjectBorderSolidLine(c,b,a){setObjectBorderLineWithType(c,b,a,"solid")}function fnHandler_ObjectBorderDashedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dashed")}function fnHandler_ObjectBorderDottedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dotted")}function fnHandler_ObjectBorderDoubleLine(c,b,a){setObjectBorderLineWithType(c,b,a,"double")}
function setObjectBorderLineWithType(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=getSelectionControl(a).controlObject;if("noline"==d)e.style.borderWidth="0px";else{var f=e.style.borderWidth,g=e.style.borderColor;e.style.border=d;"double"==d&&(null==f||""==f||3>parseInt(f))&&(f="3px");0<parseInt(f)&&(e.style.borderWidth=f);g&&(e.style.borderColor=
g)}commonImageUpdateAfterChange(e,a)}else if((duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE)&&null!=g_objTable){var m=g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],g_objTable,a);if(null!==m){if(m[0]!=UI_TABLE_SELECT_TYPE_NONE){var n=g_objTable.rows.length;for(c=0;c<n;c++){var l=g_objTableUtil.getTableCellsLength(g_objTable,c);for(b=0;b<l;b++){var k=g_objTableFlag.GetCellAttribute_Flag(g_objTable,c,b);
if(2==k||3==k||4==k){var h=g_objTableUtil.getTableCellElement(g_objTable,c,b);"noline"==d?h.style.borderWidth="0px":(f=h.style.borderWidth,g=h.style.borderColor,h.style.border=d,"double"==d&&3>parseInt(f)&&(f="3px"),0<parseInt(f)&&(h.style.borderWidth=f),g&&(h.style.borderColor=g))}}}}else h=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col),"noline"==d?h.style.borderWidth="0px":(f=h.style.borderWidth,g=h.style.borderColor,h.style.border=d,"double"==d&&3>parseInt(f)&&
(f="3px"),0<parseInt(f)&&(h.style.borderWidth=f),g&&(h.style.borderColor=g));updateTableHandlerUI.updateTableUIHandler(m[0],0,0,0,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(p){g_objCommonUtil.displayErrorAlert(p,"error:setObjectBorderLineWithType - "+d)}}function fnHandler_ObjectBorder1pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"1px")}function fnHandler_ObjectBorder2pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"2px")}
function fnHandler_ObjectBorder3pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"3px")}function fnHandler_ObjectBorder4pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"4px")}function fnHandler_ObjectBorder5pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"5px")}function fnHandler_ObjectBorder6pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"6px")}function fnHandler_ObjectBorder7pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"7px")}
function fnHandler_ObjectBorder8pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"8px")}function fnHandler_ObjectBorder9pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"9px")}function fnHandler_ObjectBorder10pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"10px")}
function setObjectBorderWidthLineWithValue(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=getSelectionControl(a).controlObject,f=e.style.borderColor;if(null==e.style.border||""==e.style.border)e.style.border="solid";e.style.borderWidth=d;e.style.borderColor=f;commonImageUpdateAfterChange(e,a)}else if((duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||
duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE)&&null!=g_objTable){var g=g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],g_objTable,a);if(null!==g){if(g[0]!=UI_TABLE_SELECT_TYPE_NONE){var m=g_objTable.rows.length;for(c=0;c<m;c++){var n=g_objTableUtil.getTableCellsLength(g_objTable,c);for(b=0;b<n;b++){var l=g_objTableFlag.GetCellAttribute_Flag(g_objTable,c,b);if(2==l||3==l||4==l){var k=g_objTableUtil.getTableCellElement(g_objTable,c,b);f=k.style.borderColor;if(null==k.style.border||
""==k.style.border)k.style.border="solid";k.style.borderWidth=d;k.style.borderColor=f}}}}else{k=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col);f=k.style.borderColor;if(null==k.style.border||""==k.style.border)k.style.border="solid";k.style.borderWidth=d;k.style.borderColor=f}updateTableHandlerUI.updateTableUIHandler(g[0],0,0,0,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"error:setObjectBorderLineWithType - "+type)}}
function fnHandler_TableSelectCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable&&(g_objTableSelection.table_SelectionCaretCell(a),updateTableHandlerUI.updateTableUIHandler(6,0,0,0,a))}catch(d){}}
function fnHandler_TableSelectCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable&&(g_objTableMiniMenu.prepareTableSelectAll(a),g_objTableMiniMenu.table_selectCol(g_objTable,a),g_objTableMiniMenu.updateManualTableUIHandler(a),updateTableHandlerUI.updateTableUIHandler(7,0,0,0,a))}catch(d){}}
function fnHandler_TableSelectRow(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable&&(g_objTableMiniMenu.prepareTableSelectAll(a),g_objTableMiniMenu.table_selectRow(g_objTable,a),g_objTableMiniMenu.updateManualTableUIHandler(a),updateTableHandlerUI.updateTableUIHandler(8,0,0,0,a))}catch(d){}}
function fnHandler_TableSelectTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable&&(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableMiniMenu.showTableMiniMenu(!1,null,a),g_objTableSelection.selectTable(a),updateTableHandlerUI.updateTableUIHandler(3,0,0,0,a))}catch(d){}}
function fnHandler_imageToTable(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&0!=dzeUiConfig.bUseImageToTableMenu&&"undefined"!=typeof dzeUiConfig.strImageToTableURL&&""!=dzeUiConfig.strImageToTableURL){var d=getSelectionControl(a);if(null!=d.controlObject&&"undefined"!=typeof d.controlObject&&"img"==d.controlObject.nodeName.toLowerCase()){g_objCommonUtil.openWindowCommon("about:blank",g_nPreviewWindowWidth,
g_nPreviewWindowHeight,!0,"targetWin");var e=document.createElement("form");e.action=dzeUiConfig.strImageToTableURL;e.method="post";e.target="targetWin";var f=document.createElement("input");f.type="hidden";f.name="imgSrc";f.value=d.controlObject.src;e.appendChild(f);document.body.appendChild(e);e.submit();document.body.removeChild(e)}else g_objCommonUtil.openWindowCommon(dzeUiConfig.strImageToTableURL,g_nPreviewWindowWidth,g_nPreviewWindowHeight,!0,"targetWin")}}catch(g){}}
function fnHandler_TableAddNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable){var d=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var e=c.setComma();c!=e&&(d=!0,a.textContent=e)}for(a=0;a<b.length;a++)c=b[a].innerHTML,e=c.setComma(),c!=e&&(d=!0,b[a].innerHTML=e)});d&&g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableRemoveNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable){var d=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var e=c.removeComma();c!=e&&(d=!0,a.textContent=e)}for(a=0;a<b.length;a++)c=b[a].innerHTML,e=c.removeComma(),c!=e&&(d=!0,b[a].innerHTML=e)});d&&g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TableBorderThickness_Detail(c,b,a){fnHandler_TableBorderThickness(c,b,a)}function fnHandler_TableBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TableBorderType_Detail(c,b,a){fnHandler_TableBorderType(c,b,a)}
function fnHandler_TableBorderColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable){var d=g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],g_objTable,a);if(null!==d){var e=duzon_dialog.curr_table_border_backcolor[a];if(d[0]!=UI_TABLE_SELECT_TYPE_NONE)for(c=g_nStartClick_Row;c<=g_nEndClick_Row;c++)for(b=g_nStartClick_Col;b<=g_nEndClick_Col;b++){var f=g_objTableUtil.getTableCellElement(g_objTable,c,b);f.style.borderColor=e}else f=g_objTableUtil.getTableCellElement(g_objTable,
g_nStartClick_Row,g_nStartClick_Col),f.style.borderColor=e;updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(g){}}
function fnHandler_TableBorderColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable){var d=g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],g_objTable,a);if(null!==d){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,a,function(b,c){var e=!0;"undefined"!=typeof c&&(e=c);1==
e&&duzon_dialog.closeExtendsDlg();if(d[0]!=UI_TABLE_SELECT_TYPE_NONE)for(c=g_nStartClick_Row;c<=g_nEndClick_Row;c++)for(var f=g_nStartClick_Col;f<=g_nEndClick_Col;f++){var g=g_objTableUtil.getTableCellElement(g_objTable,c,f);g.style.borderColor=b}else g=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col),g.style.borderColor=b;1==e&&(updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a),g_objUndoRedo.registerUndoRedoStack(0,a))},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],
[function(c){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("#FFFFFF",b);if(d[0]!=UI_TABLE_SELECT_TYPE_NONE)for(c=g_nStartClick_Row;c<=g_nEndClick_Row;c++)for(var e=g_nStartClick_Col;e<=g_nEndClick_Col;e++){var f=g_objTableUtil.getTableCellElement(g_objTable,c,e);f.style.borderColor="#FFFFFF"}else f=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col),f.style.borderColor="#FFFFFF";updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a);g_objUndoRedo.registerUndoRedoStack(0,
a)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);duzon_dialog.closeDialog();imgElement.style.borderColor=c;if(d[0]!=UI_TABLE_SELECT_TYPE_NONE)for(var e=g_nStartClick_Row;e<=g_nEndClick_Row;e++)for(var f=g_nStartClick_Col;f<=g_nEndClick_Col;f++){var l=g_objTableUtil.getTableCellElement(g_objTable,
e,f);l.style.borderColor=c}else l=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col),l.style.borderColor=c;updateTableHandlerUI.updateTableUIHandler(d[0],0,0,0,a);g_objUndoRedo.registerUndoRedoStack(0,a)}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding=
"0px"},function(){},!0,"screen_center")}],"toolbar",!0)}}}catch(f){}}function fnHandler_TableStyle(c,b,a){try{fnHandler_TableStyle_Detail(c,b,a)}catch(d){}}
function fnHandler_TableStyle_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=g_objTable&&null!==g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],g_objTable,a)){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),g_objUndoRedo.registerUndoRedoStack(0,a),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_STYLE,duzon_dialog.viewExtendsDlg(b,a,null,
[ID_RES_PROP_BUILDER_BLOCK_PROP_ITEM_APPLY,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.isTableStylePreviewApply=!1;duzon_dialog.closeExtendsDlg();g_objTable&&(b=g_objTableSelection.CheckTableSelection(g_objEditorDocument[duzon_dialog.nEditNumber],g_objTable,duzon_dialog.nEditNumber),updateTableHandlerUI.updateTableUIHandler(b[0],0,0,0,duzon_dialog.nEditNumber),g_objUndoRedo.registerUndoRedoStack(0,a))},function(b){duzon_dialog.closeExtendsDlg();g_objTable&&(b=g_objTableSelection.CheckTableSelection(g_objEditorDocument[duzon_dialog.nEditNumber],
g_objTable,duzon_dialog.nEditNumber),updateTableHandlerUI.updateTableUIHandler(b[0],0,0,0,a))}],"toolbar"))}}catch(e){}}function fnHandler_TBSetImageHeight(c,b,a){try{TBSetImageWidthHeight(b,c,a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_TBSetImageHeight")}}function fnHandler_TBSetImageWidth(c,b,a){try{TBSetImageWidthHeight(b,c,a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_TBSetImageWidth")}}
function TBSetImageWidthHeight(c,b,a){try{g_objWrapperOutlineResize.resetExtOutlineInfo_call();var d=getSelectionControl(a).controlObject;if("undefined"==typeof d||null==d)if(d=dze_menu_control.currControlObject,null==d)return;if("img"==d.nodeName.toLowerCase()){var e=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_WIDTH][2]+"_"+a);e&&(widthValue=parseInt(e.value,10),d.style.width=widthValue+"px",d.offsetWidth!=widthValue&&(widthValue-=d.offsetWidth-widthValue,d.style.width=widthValue+
"px"));var f=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_HEIGHT][2]+"_"+a);f&&(heightValue=parseInt(f.value,10),d.style.height=heightValue+"px",d.offsetHeight!=heightValue&&(heightValue-=d.offsetHeight-heightValue,d.style.height=heightValue+"px"))}}catch(g){g_objCommonUtil.displayErrorAlert(g,"error:TBSetImageWidthHeight")}}
function fnHandler_Help_ImageToTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HELP_IMAGE_TO_TABLE,duzon_dialog.getHelpImageToTableContentContainer(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"screen_center")}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_Help_ImageToTable")}}
function fnHandler_Custom_Input_Box(c,b){try{var a=c.target;duzon_dialog.viewDialog(c,b,ID_RES_DIALOG_STRING_CUSTOM_INPUT_BOX,duzon_dialog.createCustomInputBoxDialog(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.setCustomInputBox(a);duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.initCustomInputBox(a)},function(){},!0,"screen_center")}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_Custom_Input_Box")}}
function fnHandler_insertExternalDataBox(c,b,a){try{if(!1!==dzeUiConfig.bUseDataBinding&&(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))){var d=g_objEditorDocument[a].createElement("input");d.type="text";g_objPropertyUtil.element_addClass(d,"dze_external_data_area");d.style.fontFamily="\uad74\ub9bc";d.style.fontSize="9pt";d.setAttribute("readonly","");d.setAttribute("size","10");insertHTMLCodeAtSelection(d.outerHTML,null,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"error:fnHandler_insertExternalDataBox")}}
function fnHandler_showExternalDataBoxDialog(c,b){try{var a=c.target;duzon_dialog.viewDialog(c,b,"\ubc15\uc2a4 \uc18d\uc131",duzon_dialog.createExternalDataBoxDialog(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.setExternalDataBoxStyle(a);duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,b)},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.initExternalDataBoxDialog(a)},function(){},!0,"relative")}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:fnHandler_showExternalDataBoxDialog")}}
;

var g_objEditMode=new function(){this.ID_FORM_TYPE_DISABLE=0;this.ID_FORM_TYPE_MANAGER=1;this.ID_FORM_TYPE_USER=2;this.strCusEditContainer="editcell";this.strCusEditField="editfield";this.bWriteAreaSetMouseMoveING=this.bRestrictAreaMouseDown=!1;this.ID_EDIT_MODE_BORDER_STYLE_DOTTED="dotted";this.ID_WRITE_AREA_SET_BORDER_WIDTH="1px";this.ID_WRITE_AREA_SET_BORDER_COLOR="#FE0000";this.ID_SHOW_EDITABLE_AREA_BORDER_WIDTH="1px";this.ID_SHOW_EDITABLE_AREA_BORDER_COLOR="#0000FE";this.arrWriteAreaSet=[];this.arrShowEditableAreaOrder=
[];this.strCusDisableContainer="disablecell";this.strCusDisableField="disablefield";this.strDisableColor="#dedede";this.strTempString_Head="!#@$";this.strTempString_Tail="^$%#";this.strDivFormCodeBgColor="#dddddd";this.strCusFormCode="cusFormCode";this.strCusParentClassName="cusParentClassName";this.strCusParentIDSettingName="cusParentIDSettingName";this.strCusRestrictCell="cusRestrictCell";this.strCusRestrictWidth="cusRestrictWidth";this.strDivFormCodeContainerClassName="formCodeContainer";this.strDivFormCodeCloseContainerClassName=
"formCodeCloseContainer";this.strDivFormCodeCloseClassName="formCodeClose";this.strDivFormCodeContentClassName="formCodeContent";this.strDivFormCodeContentSubClassName="formCodeContentSub";this.strDivFormCodeContentTableClassName="formCodeContentTable";this.strFormCodeConvertDoneClassName="formCodeConvertDone";this.strReservedFormCode="dzFormCode";this.arrTempRestrictCell=[];this.switchWriteAreaSet=function(a,c,b,d){try{if(c){var e=this.checkWriteArea_In_Children(a,b);if(null==e){var f=g_objEditorDocument[d].createElement("div");
if(b==this.ID_FORM_TYPE_MANAGER||b==this.ID_FORM_TYPE_USER)g_objPropertyUtil.setTargetCellFlagString(f,this.strCusEditField,"true");else return null;for(;0<a.childNodes.length;){var g=a.childNodes[0];f.appendChild(g)}a.appendChild(f);if(b==this.ID_FORM_TYPE_MANAGER||b==this.ID_FORM_TYPE_USER){a=!1;for(c=0;c<f.childNodes.length;c++)if(g=f.childNodes[c],ID_SELECTION_ELEMENT_NODE==g.nodeType){a=!0;break}else if(ID_SELECTION_TEXT_NODE==g.nodeType&&!checkTextNodeAllWhiteCode(g.nodeValue)){a=!0;break}a||
(f.innerHTML="<p><br /></p>");b==this.ID_FORM_TYPE_MANAGER&&this.switchWriteAreaBorder(f,!0)}else return null;return f}b==this.ID_FORM_TYPE_MANAGER&&this.switchWriteAreaBorder(e,!0);return e}e=this.checkWriteArea_In_Children(a,b);if(null!=e){for(var h=g_objNodeUtil.getParentElement(e);0<e.childNodes.length;)g=e.childNodes[0],h.insertBefore(g,e);h.removeChild(e)}}catch(k){g_objCommonUtil.displayErrorAlert(k,"switchWriteAreaSet")}return null};this.checkWriteArea_In_Children=function(a,c){try{for(var b=
0;b<a.childNodes.length;b++){var d=this.checkLoopWriteArea_In_Children(a.childNodes[b],c);if(null!=d)return d}}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkWriteArea_In_Children")}return null};this.checkLoopWriteArea_In_Children=function(a,c){try{if(ID_SELECTION_ELEMENT_NODE!=a.nodeType)return null;for(var b=0;b<a.childNodes.length;b++){var d=this.checkLoopWriteArea_In_Children(a.childNodes[b],c);if(null!=d)return d}if("div"==g_objNodeUtil.getElementTagName(a).toLowerCase()&&(c==this.ID_FORM_TYPE_MANAGER||
c==this.ID_FORM_TYPE_USER)&&"true"==g_objPropertyUtil.getTargetCellFlagString(a,this.strCusEditField))return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkLoopWriteArea_In_Children")}return null};this.setupDefined_WriteAreaSet=function(a,c){try{if(1==g_nFormEditMode&&!fnObjectCheckNull(g_objEditorDocument[c])){var b=g_objNodeUtil.getEventSrcElement(g_objEditorDocument[c],a);if(!fnObjectCheckNull(b)&&"table"!=g_objNodeUtil.getElementTagName(b).toLowerCase()){var d=g_objNodeUtil.getLoopParentElement(b,
"td");fnObjectCheckNull(d)||("true"==g_objPropertyUtil.getTargetCellFlagString(d,this.strCusEditContainer)?(d.removeAttribute(this.strCusEditContainer),this.switchWriteAreaSet(d,!1,this.ID_FORM_TYPE_MANAGER,c)):(g_objPropertyUtil.setTargetCellFlagString(d,this.strCusEditContainer,"true"),this.switchWriteAreaSet(d,!0,this.ID_FORM_TYPE_MANAGER,c)))}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"setupDefined_WriteAreaSet")}};this.showAllWriteAreaSet=function(a,c){try{if(1==g_nFormEditMode)for(var b=
g_objEditorDocument[a].getElementsByTagName("td"),d=0;d<b.length;d++)"true"==g_objPropertyUtil.getTargetCellFlagString(b[d],this.strCusEditContainer)&&this.switchWriteAreaSet(b[d],c,this.ID_FORM_TYPE_MANAGER,a)}catch(e){g_objCommonUtil.displayErrorAlert(e,"showAllWriteAreaSet")}};this.switchWriteAreaBorder=function(a,c){try{a&&(c?(a.style.borderStyle=this.ID_EDIT_MODE_BORDER_STYLE_DOTTED,a.style.borderWidth=this.ID_WRITE_AREA_SET_BORDER_WIDTH,a.style.borderColor=this.ID_WRITE_AREA_SET_BORDER_COLOR):
(a.style.borderStyle="",a.style.borderWidth="",a.style.borderColor=""))}catch(b){g_objCommonUtil.displayErrorAlert(b,"switchWriteAreaBorder")}};this.initShowEditableArea=function(a){try{2==g_nFormEditMode&&(this.initAssignAreaToArray(a),this.showAllContentEditableArea(a,!0),g_objUndoRedo.registerInitialContentStack(a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"initShowEditableArea")}};this.initAssignAreaToArray=function(a){try{if(2==g_nFormEditMode){this.arrShowEditableAreaOrder[a]=[];for(var c=
g_objEditorDocument[a].getElementsByTagName("td"),b=0;b<c.length;b++)"true"==g_objPropertyUtil.getTargetCellFlagString(c[b],this.strCusEditContainer)&&this.arrShowEditableAreaOrder[a].push(c[b])}}catch(d){g_objCommonUtil.displayErrorAlert(d,"initAssignAreaToArray")}};this.showAllContentEditableArea=function(a,c){try{if(2==g_nFormEditMode)if(c)for(var b=0;b<this.arrShowEditableAreaOrder[a].length;b++){var d=this.arrShowEditableAreaOrder[a][b],e=this.switchWriteAreaSet(d,!0,this.ID_FORM_TYPE_USER,a);
e&&(e.contentEditable="true",this.showEditableAreaBorder(e,!0))}else for(b=0;b<this.arrShowEditableAreaOrder[a].length;b++)d=this.arrShowEditableAreaOrder[a][b],this.switchWriteAreaSet(d,!1,this.ID_FORM_TYPE_USER,a)}catch(f){g_objCommonUtil.displayErrorAlert(f,"showAllContentEditableArea")}};this.showEditableAreaBorder=function(a,c){try{a&&(c?(a.style.borderStyle=this.ID_EDIT_MODE_BORDER_STYLE_DOTTED,a.style.borderWidth=this.ID_SHOW_EDITABLE_AREA_BORDER_WIDTH,a.style.borderColor=this.ID_SHOW_EDITABLE_AREA_BORDER_COLOR):
(a.style.borderStyle="",a.style.borderWidth="",a.style.borderColor=""))}catch(b){g_objCommonUtil.displayErrorAlert(b,"showEditableAreaBorder")}};this.getLoopContentEditable=function(a){try{if(2!=g_nFormEditMode||null==a)return!1;var c="";a.contentEditable&&(c=a.contentEditable.toLowerCase());if("true"==c)return!0;var b=g_objNodeUtil.getParentElement(a);return fnObjectCheckNull(b)?!1:this.getLoopContentEditable(b)}catch(d){g_objCommonUtil.displayErrorAlert(d,"getLoopContentEditable")}return!1};this.isLoopContentEditable=
function(a){try{for(;a&&(a.nodeType!=ID_SELECTION_ELEMENT_NODE||"dze_document_container"!=a.className&&"body"!=a.tagName.toLowerCase());){if(a.contentEditable){var c=a.contentEditable.toLowerCase();if("true"==c)break;else if("false"==c)return!1}a=a.parentNode}return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"isContentEditable")}};this.restrictWriteArea_onmousedown=function(a,c){try{this.bWriteAreaSetMouseMoveING=!0;if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(g_objEditorDocument[c],
a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b)){this.bRestrictAreaMouseDown=!1;if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)editor_onfocus(a,c),editor_onselectionchange(c);return!1}this.bRestrictAreaMouseDown=!0;g_bBrowserType_WK||TBCancelBubbleEvent(a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"restrictWriteArea_onmousedown")}return!0};this.restrictWriteArea_onmousemove=function(a,c){try{if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(g_objEditorDocument[c],
a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b))if(this.bRestrictAreaMouseDown&&this.bWriteAreaSetMouseMoveING)g_objEditorDocument[c].body.style.cursor="not-allowed",TBCancelBubbleEvent(a);else return g_objEditorDocument[c].body.style.cursor="default",!1;else g_objEditorDocument[c].body.style.cursor="not-allowed",TBCancelBubbleEvent(a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"restrictWriteArea_onmousemove")}return!0};this.restrictWriteArea_onmouseup=function(a,c){try{this.bWriteAreaSetMouseMoveING=
!1;if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(g_objEditorDocument[c],a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b))return!1;TBCancelBubbleEvent(a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"restrictWriteArea_onmouseup")}return!0};this.checkSelectionContentEditableArea=function(a){try{if(2!=g_nFormEditMode)return!0;if(window.attachEvent)var c=g_objEditorDocument[a].selection,b=c.createRange(),d=b.parentElement();else{c=g_objEditWindow[a].getSelection();
if(1!=c.rangeCount)return!1;b=c.getRangeAt(0);d=b.commonAncestorContainer}return this.getLoopContentEditable(d)}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkSelectionContentEditableArea")}return!0};this.checkSelectionContentEditable=function(a){try{if(!1===dzeUiConfig.bUseLockEditCellFunction||!g_objEditWindow[a].getSelection)return!0;var c=g_objEditWindow[a].getSelection();if(1>c.rangeCount)return!0;var b=c.getRangeAt(0);if(0==this.isLoopContentEditable(b.commonAncestorContainer))return!1;
var d=!0;g_objNodeUtil.traverseNodesInRange(b,function(a){a.nodeType==ID_SELECTION_ELEMENT_NODE&&"false"==a.getAttribute("contenteditable")&&(d=!1);return d});return d}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkSelectionContentEditable")}};this.showBGImageForLockedCell=function(a,c){try{if(!1!==dzeUiConfig.bUseLockEditCellFunction){var b=g_objEditorDocument[c].getElementsByTagName("td");a=!1===a;for(var d=0;d<b.length;d++){var e=b[d];!0===g_objTableFunction.isCellLocked(e)&&g_objTableFunction.controlBackgroundImage(e,
c,a)}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"showBGImageForLockedCell")}};this.setInputFormClickable=function(a){try{for(var c=g_objEditorDocument[a].getElementsByTagName("input"),b,d,e,f=0;f<c.length;f++)if(b=c[f],"checkbox"===b.type||"radio"===b.type)d=g_objNodeUtil.getParentElement(b),!0===fnObjectCheckNull(d)||"p"!==d.nodeName.toLowerCase()&&"span"!==d.nodeName.toLowerCase()?(e=g_objEditorDocument[a].createElement("span"),e.setAttribute("contenteditable",!1),e.setAttribute("style","-moz-user-select: auto"),
d.insertBefore(e,b),e.appendChild(b)):"false"!==d.getAttribute("contenteditable")&&(d.setAttribute("contenteditable",!1),d.setAttribute("style","-moz-user-select: auto"))}catch(g){g_objCommonUtil.displayErrorAlert(g,"showBGImageForLockedCell")}};this.initApplyStringToDisableCell=function(a,c){};this.showAllDisableCellSet=function(a,c){};this.displayDisableArea=function(a){};this.getLoopDisableCell=function(a){return!1};this.restrictDisableCell_onmousedown=function(a,c){return!1};this.restrictDisableCell_onmousemove=
function(a,c){return!1};this.restrictDisableCell_onmouseup=function(a,c){return!1};this.convertFormCodeString=function(a,c){try{if("undefined"!=typeof dzeUiConfig.arrFormCodeString&&0!=dzeUiConfig.arrFormCodeString.length){for(var b=g_objEditorDocument[a].body.innerHTML,d=[],e=0;e<dzeUiConfig.arrFormCodeString.length;e++)-1!=b.indexOf(dzeUiConfig.arrFormCodeString[e][0])&&d.push(e);if(0!=d.length){if(window.attachEvent)g_objEditorDocument[a].selection.empty();else{var f=g_objEditWindow[a].getSelection();
f&&f.removeAllRanges()}b=[];this.setTempFormCodeString(d,b,a);this.replaceFormCodeString(b,a);this.doReservedCallback(a);if(c){for(e=0;e<b.length;e++)if(""!=b[e][6]){alert(b[e][6]);break}for(e=0;e<b.length;e++)if(1==b[e][5][0]){var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++){var h=g[c];if(g_objPropertyUtil.element_hasClass(h,this.strDivFormCodeContainerClassName)){var k=g_objNodeUtil.getLoopParentElement(h,"td");if(k){var l=h.getAttribute(this.strCusRestrictCell);
if(!fnObjectCheckNull(l)){var n=parseInt(b[e][5][1],10),m=parseInt(b[e][5][2],10);g_objTableUtil.setNodeValue_Width(k,n,"px");g_objTableUtil.setNodeValue_Height(k,m,"px")}}}}}}}}}catch(p){g_objCommonUtil.displayErrorAlert(p,"convertFormCodeString")}};this.setTempFormCodeString=function(a,c,b){try{for(var d=0;d<a.length;d++){var e=a[d];this.loopSetTempFormCodeString(g_objEditorDocument[b].body,dzeUiConfig.arrFormCodeString[e][0],c,e)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setTempFormCodeString")}};
this.loopSetTempFormCodeString=function(a,c,b,d){try{for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(ID_SELECTION_ELEMENT_NODE==f.nodeType)g_objPropertyUtil.element_hasClass(f,this.strDivFormCodeContainerClassName)||this.loopSetTempFormCodeString(f,c,b,d);else if(ID_SELECTION_TEXT_NODE==f.nodeType){var g=f.nodeValue;if(-1!=g.indexOf(c)){var h=this.strTempString_Head+c+this.strTempString_Tail;g=g.replace(c,h);f.nodeValue=g;this.registerTempFormCodeArray(b,h,d)}}}}catch(k){g_objCommonUtil.displayErrorAlert(k,
"loopSetTempFormCodeString")}};this.registerTempFormCodeArray=function(a,c,b){try{var d=[];d[0]=c;d[1]=dzeUiConfig.arrFormCodeString[b][0];d[2]=dzeUiConfig.arrFormCodeString[b][1];d[3]=dzeUiConfig.arrFormCodeString[b][3];d[4]=dzeUiConfig.arrFormCodeString[b][4];d[5]=dzeUiConfig.arrFormCodeString[b][5];d[6]=dzeUiConfig.arrFormCodeString[b][6];d[7]=dzeUiConfig.arrFormCodeString[b][7];d[8]="boolean"==typeof dzeUiConfig.arrFormCodeString[b][8]?dzeUiConfig.arrFormCodeString[b][8]:!0;a.push(d)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"registerTempFormCodeArray")}};this.replaceFormCodeString=function(a,c){try{if(0!=a.length){for(var b=g_objEditorDocument[c].body.innerHTML,d=0;d<a.length;d++){var e=a[d][0],f=this.makeFormCodeDisplayHTML(a[d]);null!=f&&""!=f&&(b=b.replace(e,f))}g_objEditorDocument[c].body.innerHTML=b;this.initDivFormCodeObject(c);this.initDivFormCodeObjectEvent(c)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"replaceFormCodeString")}};this.makeFormCodeDisplayHTML=function(a){try{var c=a[1],b=a[2],d=Number(a[3][0]),
e=a[3][1],f=Number(a[3][2]),g=a[4],h=Number(a[5][0]),k=Number(a[5][1]),l=a[7],n=a[8];a="";var m=!1;1==d&&1==f&&(m=!0);m?(m="background:url("+e+") no-repeat;background-size:100% 100%;",1==h?(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="height:100%;border:1px solid #ff0000;',a+=" "+m,a+=" background-color:"+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+l+'" ',a+=" "+this.strCusParentClassName+'="'+g+'" ',a+=" "+this.strCusRestrictCell+
'="true" '+this.strCusRestrictWidth+'="'+k+'">'):(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="width:100%;height:100%;',a+=" "+m,a+=" background-color:"+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+l+'" ',a+=" "+this.strCusParentClassName+'="'+g+'">')):1==h?(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="height:100%;border:1px solid #ff0000;',a+=" background-color:"+
this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+l+'" ',a+=" "+this.strCusParentClassName+'="'+g+'" ',a+=" "+this.strCusRestrictCell+'="true" '+this.strCusRestrictWidth+'="'+k+'">'):(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="width:100%;height:100%;background-color:'+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+l+'" ',a+=" "+this.strCusParentClassName+'="'+g+'">');if(n){var p="border:1px solid "+
this.strDivFormCodeBgColor+";";a+='<div class="'+this.strDivFormCodeCloseContainerClassName+'" style="float:right;margin:1px 1px 1px -20px;">';a+='<img class="'+this.strDivFormCodeCloseClassName+'" src="'+dzeEnvConfig.strPath_Image+'toolbar/minibar_btn_delete.gif" alt="" width="12" height="12" style="'+p+'" />';a+="</div>"}a+='<div class="'+this.strDivFormCodeContentClassName+'" '+this.strCusFormCode+'="'+c+'" style="height:100%;">';0==d?(a+='<div class="'+this.strDivFormCodeContentSubClassName+'" style="padding:0px;margin:0px;width:100%;height:100%;border:0px;">',
a+='<div class="'+this.strDivFormCodeContentTableClassName+'" style="display:table;width:90%;height:100%;" >',a+='<div style="display:table-cell;vertical-align:middle;">',a+='<div style="margin-left:auto;margin-right:auto;width:100%;text-align:center;">',a+='<span style="color:'+b+';">'+e+"</span>",a+="</div>",a+="</div>",a+="</div>",a+="</div>"):1==d?1==f?a+="&nbsp;":(a+='<div style="display:table;width:90%;height:100%;" >',a+='<div style="display:table-cell;vertical-align:middle;">',a+='<div style="margin-left:auto;margin-right:auto;width:100%;text-align:center;">',
a+='<img src="'+e+'" style="border:1px solid #00ffff;" />',a+="</div>",a+="</div>",a+="</div>"):a+="&nbsp;";return a+"</div></div>"}catch(q){g_objCommonUtil.displayErrorAlert(q,"makeFormCodeDisplayHTML")}return null};this.doReservedCallback=function(a){try{if(""!=dzeUiConfig.strChangeFormCodeFunction){for(var c=0;c<dzeUiConfig.arrFormCodeString.length;c++){var b=this.getCountFormCodeString(dzeUiConfig.arrFormCodeString[c][0],a);dzeUiConfig.arrFormCodeString[c][2]=b}eval(dzeUiConfig.strChangeFormCodeFunction+
"("+a+", 0);")}}catch(d){g_objCommonUtil.displayErrorAlert(d,"doReservedCallback")}};this.doChangeCellCallback=function(a){try{if("undefined"!=typeof dzeUiConfig.strChangeFormCodeFunction&&""!=dzeUiConfig.strChangeFormCodeFunction){for(var c=g_objEditorDocument[a].querySelectorAll("."+this.strDivFormCodeContainerClassName),b=0;b<c.length;b++){var d=c[b],e=d.getAttribute(this.strCusRestrictCell);if(!fnObjectCheckNull(e)){var f=this.getModule_include_byElementClassName(d,this.strDivFormCodeContentClassName);
if(f){var g=f.getAttribute(this.strCusFormCode);if(!fnObjectCheckNull(g)){var h=this.getIndexFormCodeString(g);if(-1!=h){var k=g_objNodeUtil.getLoopParentElement(d,"td");dzeUiConfig.arrFormCodeString[h][5][1]=k.offsetWidth;dzeUiConfig.arrFormCodeString[h][5][2]=k.offsetHeight}}}}}eval(dzeUiConfig.strChangeFormCodeFunction+"("+a+", 1);")}}catch(l){g_objCommonUtil.displayErrorAlert(l,"doChangeCellCallback")}};this.getIndexFormCodeString=function(a){try{for(var c=0;c<dzeUiConfig.arrFormCodeString.length;c++)if(a==
dzeUiConfig.arrFormCodeString[c][0])return c}catch(b){g_objCommonUtil.displayErrorAlert(b,"getIndexFormCodeString")}return-1};this.getCountFormCodeString=function(a,c){try{var b=0,d=g_objEditorDocument[c].getElementsByTagName("div");for(c=0;c<d.length;c++){var e=d[c];if(g_objPropertyUtil.element_hasClass(e,this.strDivFormCodeContainerClassName)){var f=this.getModule_include_byElementClassName(e,this.strDivFormCodeContentClassName);if(f){var g=f.getAttribute(this.strCusFormCode);fnObjectCheckNull(g)||
a==g&&b++}}}return b}catch(h){g_objCommonUtil.displayErrorAlert(h,"getCountFormCodeString")}return 0};this.initDivFormCodeObject=function(a){try{var c=g_objEditorDocument[a].getElementsByTagName("div");for(a=0;a<c.length;a++){var b=c[a];if(g_objPropertyUtil.element_hasClass(b,this.strDivFormCodeContainerClassName)&&!g_objPropertyUtil.element_hasClass(b,this.strFormCodeConvertDoneClassName)){var d=g_objNodeUtil.getLoopParentElement(b,"td");if(null==d){var e=!0,f=g_objPropertyUtil.getBackgroundImageURL(b);
if(null!=f&&""!=f){var g=b.getAttribute(this.strCusRestrictCell);fnObjectCheckNull(g)||(e=!1)}e&&(b.style.width="",b.style.height="");b.style.display="table-cell";var h=this.getModule_include_byElementClassName(b,this.strDivFormCodeCloseContainerClassName);h&&(h.style.margin="1px");var k=this.getModule_include_byElementClassName(b,this.strDivFormCodeContentClassName);if(k){k.style.height="";e&&(k.style.padding="8px 20px 5px 10px");var l=this.getModule_include_byElementClassName(k,this.strDivFormCodeContentSubClassName);
if(l){l.style.height="";var n=this.getModule_include_byElementClassName(l,this.strDivFormCodeContentTableClassName);n&&(n.style.width="",n.style.height="")}}}else{this.removeOtherChild(d,b,this.strDivFormCodeContainerClassName);g=b.getAttribute(this.strCusRestrictCell);if(!fnObjectCheckNull(g)){var m=b.getAttribute(this.strCusRestrictWidth);fnObjectCheckNull(m)||parseInt(m,10)}var p=b.getAttribute(this.strCusParentClassName);if(!fnObjectCheckNull(p)&&""!=p){var q=p.split(" ");for(e=0;e<q.length;e++)g_objPropertyUtil.element_hasClass(d,
q[e])||g_objPropertyUtil.element_addClass(d,q[e])}var r=b.getAttribute(this.strCusParentIDSettingName);if(!fnObjectCheckNull(r)&&""!=r){var t=d.getAttribute("id");null==t||""==t?d.id=r:r!=t&&(d.setAttribute("previd",t),d.id=r)}}g_objPropertyUtil.element_addClass(b,this.strFormCodeConvertDoneClassName)}}}catch(u){g_objCommonUtil.displayErrorAlert(u,"initDivFormCodeObject")}};this.initDivFormCodeObjectEvent=function(a){try{for(var c=g_objEditorDocument[a].getElementsByTagName("div"),b=0;b<c.length;b++){var d=
c[b];if(g_objPropertyUtil.element_hasClass(d,this.strDivFormCodeContainerClassName)){d.onmousedown=TBCancelBubbleEvent;d.onmouseup=TBCancelBubbleEvent;var e=this.getModule_include_byElementClassName(d,this.strDivFormCodeCloseClassName);e&&(e.onmouseover=function(a){this.style.border="1px solid #000000"},e.onmouseout=function(a){this.style.border="1px solid #dddddd"},e.onclick=function(b){g_objEditMode.clickDivFormCodeClose(this,a)})}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"initDivFormCodeObjectEvent")}};
this.removeOtherChild=function(a,c,b){try{if(!fnObjectCheckNull(a)){for(;0<a.childNodes.length;)a.removeChild(a.childNodes[0]);a.appendChild(c)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"removeOtherChild")}};this.clickDivFormCodeClose=function(a,c){try{var b=this.getModule_loopParent_byElementClassName(a,this.strDivFormCodeContainerClassName);if(b){var d=g_objNodeUtil.getLoopParentElement(b,"td");if(d){var e=b.getAttribute(this.strCusParentClassName);if(!fnObjectCheckNull(e)&&""!=e){var f=e.split(" ");
for(a=0;a<f.length;a++)g_objPropertyUtil.element_hasClass(d,f[a])&&g_objPropertyUtil.element_removeClass(d,f[a])}var g=b.getAttribute(this.strCusParentIDSettingName);if(!fnObjectCheckNull(g)&&""!=g){var h=d.getAttribute("previd");null==h||""==h?d.removeAttribute("id"):d.id=h}}var k=this.getModule_include_byElementClassName(b,this.strDivFormCodeContentClassName);if(k){var l=k.getAttribute(this.strCusFormCode);fnObjectCheckNull(l)||(g_objNodeUtil.getParentElement(b).removeChild(b),this.doReservedCallback(c))}}}catch(n){g_objCommonUtil.displayErrorAlert(n,
"clickDivFormCodeClose")}};this.getModule_include_byElementClassName=function(a,c){try{for(var b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(g_objPropertyUtil.element_hasClass(d,c))return d;var e=this.getModule_include_byElementClassName(d,c);if(e)return e}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getModule_include_byElementClassName")}return null};this.getModule_loopParent_byElementClassName=function(a,c){try{if(null==a)return null;var b=
g_objNodeUtil.getElementTagName(a).toLowerCase();if("body"==b)return null;if("div"==b&&g_objPropertyUtil.element_hasClass(a,c))return a;for(;;){var d=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(d))break;b=g_objNodeUtil.getElementTagName(d).toLowerCase();if("body"==b)break;if("div"==b&&g_objPropertyUtil.element_hasClass(d,c))return d;a=d;if(fnObjectCheckNull(a))break}}catch(e){g_objCommonUtil.displayErrorAlert(e,"getModule_loopParent_byElementClassName")}return null};this.restoreFormCodeString=
function(a){try{for(var c=!1;;){c=!1;for(var b=g_objEditorDocument[a].getElementsByTagName("div"),d=0;d<b.length;d++){var e=b[d];if(g_objPropertyUtil.element_hasClass(e,this.strDivFormCodeContainerClassName)){var f=this.getModule_include_byElementClassName(e,this.strDivFormCodeContentClassName);if(f){var g=f.getAttribute(this.strCusFormCode);if(!fnObjectCheckNull(g)){var h=g_objEditorDocument[a].createTextNode(g),k=g_objNodeUtil.getParentElement(e);k.insertBefore(h,e);k.removeChild(e);c=!0;break}}}}if(!c)break}}catch(l){g_objCommonUtil.displayErrorAlert(l,
"restoreFormCodeString")}};this.checkDropReservedFormCode=function(a){try{for(var c=!1,b=g_objEditorDocument[a].getElementsByTagName("a"),d=0;d<b.length;d++){var e=b[d],f=e.getAttribute(this.strReservedFormCode);if(!fnObjectCheckNull(f)){var g=g_objEditorDocument[a].createTextNode(f);g_objNodeUtil.getParentElement(e).replaceChild(g,e);d--;c=!0}}c&&this.convertFormCodeString(a,!0)}catch(h){g_objCommonUtil.displayErrorAlert(h,"checkDropReservedFormCode")}};this.setEditModeAreaWidth=function(a,c){try{var b=
g_objParent_EditObject[c].clientWidth;if(a<b){if(a=b-a,0<a){var d=parseInt(a/2,10);g_objParent_EditObject[c].style.paddingLeft=d+"px";g_objParent_EditObject[c].style.paddingRight=d+"px";g_objParent_EditObject[c].style.backgroundColor="#9d9d9d"}}else g_objParent_EditObject[c].style.paddingLeft="0px",g_objParent_EditObject[c].style.paddingRight="0px",g_objParent_EditObject[c].style.backgroundColor="#9d9d9d"}catch(e){g_objCommonUtil.displayErrorAlert(e,"setEditModeAreaWidth")}};this.setZeroSpaceCodeToEmptyTd=
function(a,c){try{c=c||g_objEditorDocument[a];var b=g_objTagUtil;g_objCaretUtil.saveCaret(a);var d=c.getElementsByTagName("td");for(c=0;c<d.length;c++){if(0==d[c].childNodes.length)""!=d[c].innerHTML.trim()||window.attachEvent||(d[c].innerHTML="<p><br /></p>");else for(var e=0;e<d[c].childNodes.length;e++)if("p"==d[c].childNodes[e].nodeName.toLowerCase()){""!=d[c].childNodes[e].innerHTML.trim()||window.attachEvent||(d[c].childNodes[e].innerHTML="<br />");break}b.updateTagAttribute(a,d[c]);g_objNodeUtil.clean(d[c])}g_objCaretUtil.restoreCaret(a)}catch(f){g_objCommonUtil.displayErrorAlert(f,
"error:setZeroSpaceCodeToEmptyTd")}}};

var g_objTableMultiCell=new function(){this.setMultiCellCommand_Common=function(a,b,d,c,e){try{var f=null,h=null;if(window.attachEvent){f=g_objEditorDocument[a].selection;if(fnObjectCheckNull(f))return;h=f.createRange();if(fnObjectCheckNull(h))return}else{f=g_objEditWindow[a].getSelection();if(fnObjectCheckNull(f))return;f.removeAllRanges();g_bBrowserType_IE&&1==b&&g_objTableUtil.removeChildNode_AllWhiteCode_For_TableOperation(g_objTable)}for(var g=0;g<g_objTable.rows.length;g++)for(var m=g_objTableUtil.getTableCellsLength(g_objTable,
g),k=0;k<m;k++){var n=g_objTableUtil.getTableCellElement(g_objTable,g,k);if("1"==n.getAttribute("cusSelYN"))if(window.attachEvent?(h.moveToElementText(n),h.select()):f.selectAllChildren(n),1==b)g_objEditorDocument[a].execCommand(d,!1,null);else if(2==b)if(window.attachEvent)c==ID_LETTER_OPERATION_HEADING_SIZE?g_objLetterFn.setLetterOperation_HeadingSize(0,e,a):c==ID_LETTER_OPERATION_OUTDENT_INDENT?g_objLetterFn.setLetterOperation_HeadingSize(1,e,a):g_objLetterFn.setLetterOperation(c,e,h,a,!1);else{var q=
f.getRangeAt(0);c==ID_LETTER_OPERATION_HEADING_SIZE?g_objLetterFn.setLetterOperation_HeadingSize(0,e,a):c==ID_LETTER_OPERATION_OUTDENT_INDENT?g_objLetterFn.setLetterOperation_HeadingSize(1,e,a):g_objLetterFn.setLetterOperation(c,e,q,a,!1)}}g_bBrowserType_IE&&(window.attachEvent?g_objEditorDocument[a].selection.empty():(f=g_objEditWindow[a].getSelection(),f.removeAllRanges()));updateTableHandlerUI.updateTableUICommand(a)}catch(l){g_objCommonUtil.displayErrorAlert(l,"setMultiCellCommand_Common")}};
this.setMultiCellCommand_ExecCommand=function(a,b){try{fnObjectCheckNull(g_objEditorDocument[b])||fnObjectCheckNull(g_objTable)||fnObjectCheckNull(a)||this.setMultiCellCommand_Common(b,1,a,0,"")}catch(d){g_objCommonUtil.displayErrorAlert(d,"setMultiCellCommand_ExecCommand")}};this.setMultiCellCommand_LetterOperation=function(a,b,d){try{fnObjectCheckNull(g_objEditorDocument[d])||fnObjectCheckNull(g_objTable)||fnObjectCheckNull(b)||this.setMultiCellCommand_Common(d,2,"",a,b)}catch(c){g_objCommonUtil.displayErrorAlert(c,
"setMultiCellCommand_LetterOperation")}};this.setMultiCellCommand_Align=function(a,b){try{if(!(fnObjectCheckNull(g_objEditorDocument[b])||fnObjectCheckNull(g_objTable)||fnObjectCheckNull(a)))for(b=0;b<g_objTable.rows.length;b++)for(var d=g_objTableUtil.getTableCellsLength(g_objTable,b),c=0;c<d;c++){var e=g_objTableUtil.getTableCellElement(g_objTable,b,c);"1"==e.getAttribute("cusSelYN")&&(e.align=a,e.style.textAlign=a,this.doLoop_ChildNode_Align(e,a))}}catch(f){g_objCommonUtil.displayErrorAlert(f,
"setMultiCellCommand_Align")}};this.doLoop_ChildNode_Align=function(a,b){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==c.nodeType){this.doLoop_ChildNode_Align(c,b);var e=c.nodeName.toLowerCase();0!=g_objNodeUtil.checkIsAlignAvailableNode(e)&&g_objLetterFn.setNodeAlignValue(c,b,!1)}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"doLoop_ChildNode_Align")}}};
function GetMultiCellSelection(){try{return g_objTable&&!g_objTableFlag.bOneCell?!0:!1}catch(a){}}
function getAlignValueForSelectionArea(a){try{var b={nAlignCode:-1,bSameValue:!0};if(window.attachEvent){var d=g_objEditorDocument[a].selection,c=d.createRange(),e=c.parentElement();if(""==c.text)b.nAlignCode=g_objLetterFn.getTextOnlyAlignOperation(e,a);else{var f=!1;"p"==e.nodeName.toLowerCase()&&(e=g_objNodeUtil.getParentElement(e));for(var h=0;h<e.childNodes.length;h++){var g=e.childNodes[h];if(ID_SELECTION_ELEMENT_NODE==g.nodeType&&ID_SELECTION_ELEMENT_NODE==g.nodeType){var m=d.createRange();
m.moveToElementText(g);m.collapse(!0);var k=d.createRange();k.moveToElementText(g);k.collapse(!1);var n=c.inRange(m),q=c.inRange(k);if(f)if(n)g_objLetterFn.doLoop_GetAlignValue(g,c,null,b,a);else break;else q&&(g_objLetterFn.doLoop_GetAlignValue(g,c,null,b,a),f=!0)}}f||(b.nAlignCode=g_objLetterFn.getTextOnlyAlignOperation(e,a))}}else{d=g_objEditWindow[a].getSelection();if(1!=d.rangeCount)return null;c=d.getRangeAt(0);d=!1;e=c.commonAncestorContainer;c.collapsed||ID_SELECTION_TEXT_NODE==e.nodeType&&
(d=!0);if(c.collapsed)b.nAlignCode=g_objLetterFn.getTextOnlyAlignOperation(e,a);else if(d)b.nAlignCode=g_objLetterFn.getTextOnlyAlignOperation(e,a);else{var l=g_objEditorDocument[a].createRange();f=!1;for(h=0;h<e.childNodes.length;h++)if(g=e.childNodes[h],ID_SELECTION_ELEMENT_NODE==g.nodeType)if(l.selectNode(g),f)if(p=c.compareBoundaryPoints(Range.START_TO_END,l),0==p||-1==p)break;else ID_SELECTION_ELEMENT_NODE==g.nodeType&&g_objLetterFn.doLoop_GetAlignValue(g,c,l,b,a);else{var p=c.compareBoundaryPoints(Range.END_TO_START,
l);if(0==p||-1==p)ID_SELECTION_ELEMENT_NODE==g.nodeType&&g_objLetterFn.doLoop_GetAlignValue(g,c,l,b,a),f=!0}}}return b.bSameValue?b.nAlignCode:-1}catch(r){}return 0}
function do_handler_Outdent_Indent(a,b){if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(ID_LETTER_OPERATION_OUTDENT_INDENT,a,b);else{if(window.attachEvent){var d=g_objEditorDocument[b].selection;if(fnObjectCheckNull(d))return;d=d.type;d=d.toLowerCase()}else d=getSelectionTypeForUpdateUI();ID_STRING_NAME_NONE!=d&&ID_STRING_NAME_TEXT!=d||g_objLetterFn.setLetterOperation_HeadingSize(1,a,b)}}
function doLoop_Node_FistLineIndent(a,b,d){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==e.nodeType&&(doLoop_Node_FistLineIndent(e,b,d),setNode_FistLineIndent(e,b,d))}}catch(f){}}
function setNode_FistLineIndent(a,b,d){try{if("1"==a.getAttribute("cusHead")){a.removeAttribute("cusHead");d=0;var c=g_objCommonUtil.extractNumberValueUnit(a.style.textIndent);null!=c&&(d=c.nValue,"pt"==c.strUnit&&g_objCommonUtil.mappingFrom_Pt_To_Px(d),a.style.removeAttribute?a.style.removeAttribute("text-indent"):a.style.removeProperty&&a.style.removeProperty("text-indent"));0!=b.value&&(a.style.textIndent=b.value+"px")}}catch(e){}};

function editor_onmousedown_0(a){try{editor_onmousedown(a,0)}catch(b){}}function editor_onmousedown_1(a){try{editor_onmousedown(a,1)}catch(b){}}function editor_onmousedown_2(a){try{editor_onmousedown(a,2)}catch(b){}}function editor_onmousedown_3(a){try{editor_onmousedown(a,3)}catch(b){}}function editor_onmousedown_4(a){try{editor_onmousedown(a,4)}catch(b){}}function editor_onmousedown_5(a){try{editor_onmousedown(a,5)}catch(b){}}
function editor_onmousedown_6(a){try{editor_onmousedown(a,6)}catch(b){}}function editor_onmousedown_7(a){try{editor_onmousedown(a,7)}catch(b){}}function editor_onmousedown_8(a){try{editor_onmousedown(a,8)}catch(b){}}function editor_onmousedown_9(a){try{editor_onmousedown(a,9)}catch(b){}}function editor_onmousedown_10(a){try{editor_onmousedown(a,10)}catch(b){}}function editor_onmousedown_11(a){try{editor_onmousedown(a,11)}catch(b){}}
function editor_onmousedown_12(a){try{editor_onmousedown(a,12)}catch(b){}}function editor_onmousedown_13(a){try{editor_onmousedown(a,13)}catch(b){}}function editor_onmousedown_14(a){try{editor_onmousedown(a,14)}catch(b){}}function editor_onmousedown_15(a){try{editor_onmousedown(a,15)}catch(b){}}function editor_onmousedown_16(a){try{editor_onmousedown(a,16)}catch(b){}}function editor_onmousedown_17(a){try{editor_onmousedown(a,17)}catch(b){}}
function editor_onmousedown_18(a){try{editor_onmousedown(a,18)}catch(b){}}function editor_onmousedown_19(a){try{editor_onmousedown(a,19)}catch(b){}}function editor_onmousemove_0(a){try{editor_onmousemove(a,0)}catch(b){}}function editor_onmousemove_1(a){try{editor_onmousemove(a,1)}catch(b){}}function editor_onmousemove_2(a){try{editor_onmousemove(a,2)}catch(b){}}function editor_onmousemove_3(a){try{editor_onmousemove(a,3)}catch(b){}}
function editor_onmousemove_4(a){try{editor_onmousemove(a,4)}catch(b){}}function editor_onmousemove_5(a){try{editor_onmousemove(a,5)}catch(b){}}function editor_onmousemove_6(a){try{editor_onmousemove(a,6)}catch(b){}}function editor_onmousemove_7(a){try{editor_onmousemove(a,7)}catch(b){}}function editor_onmousemove_8(a){try{editor_onmousemove(a,8)}catch(b){}}function editor_onmousemove_9(a){try{editor_onmousemove(a,9)}catch(b){}}
function editor_onmousemove_10(a){try{editor_onmousemove(a,10)}catch(b){}}function editor_onmousemove_11(a){try{editor_onmousemove(a,11)}catch(b){}}function editor_onmousemove_12(a){try{editor_onmousemove(a,12)}catch(b){}}function editor_onmousemove_13(a){try{editor_onmousemove(a,13)}catch(b){}}function editor_onmousemove_14(a){try{editor_onmousemove(a,14)}catch(b){}}function editor_onmousemove_15(a){try{editor_onmousemove(a,15)}catch(b){}}
function editor_onmousemove_16(a){try{editor_onmousemove(a,16)}catch(b){}}function editor_onmousemove_17(a){try{editor_onmousemove(a,17)}catch(b){}}function editor_onmousemove_18(a){try{editor_onmousemove(a,18)}catch(b){}}function editor_onmousemove_19(a){try{editor_onmousemove(a,19)}catch(b){}}function editor_onmouseup_0(a){try{editor_onmouseup(a,0)}catch(b){}}function editor_onmouseup_1(a){try{editor_onmouseup(a,1)}catch(b){}}function editor_onmouseup_2(a){try{editor_onmouseup(a,2)}catch(b){}}
function editor_onmouseup_3(a){try{editor_onmouseup(a,3)}catch(b){}}function editor_onmouseup_4(a){try{editor_onmouseup(a,4)}catch(b){}}function editor_onmouseup_5(a){try{editor_onmouseup(a,5)}catch(b){}}function editor_onmouseup_6(a){try{editor_onmouseup(a,6)}catch(b){}}function editor_onmouseup_7(a){try{editor_onmouseup(a,7)}catch(b){}}function editor_onmouseup_8(a){try{editor_onmouseup(a,8)}catch(b){}}function editor_onmouseup_9(a){try{editor_onmouseup(a,9)}catch(b){}}
function editor_onmouseup_10(a){try{editor_onmouseup(a,10)}catch(b){}}function editor_onmouseup_11(a){try{editor_onmouseup(a,11)}catch(b){}}function editor_onmouseup_12(a){try{editor_onmouseup(a,12)}catch(b){}}function editor_onmouseup_13(a){try{editor_onmouseup(a,13)}catch(b){}}function editor_onmouseup_14(a){try{editor_onmouseup(a,14)}catch(b){}}function editor_onmouseup_15(a){try{editor_onmouseup(a,15)}catch(b){}}function editor_onmouseup_16(a){try{editor_onmouseup(a,16)}catch(b){}}
function editor_onmouseup_17(a){try{editor_onmouseup(a,17)}catch(b){}}function editor_onmouseup_18(a){try{editor_onmouseup(a,18)}catch(b){}}function editor_onmouseup_19(a){try{editor_onmouseup(a,19)}catch(b){}}function editor_onkeydown_0(a){try{editor_onkeydown(a,0)}catch(b){}}function editor_onkeydown_1(a){try{editor_onkeydown(a,1)}catch(b){}}function editor_onkeydown_2(a){try{editor_onkeydown(a,2)}catch(b){}}function editor_onkeydown_3(a){try{editor_onkeydown(a,3)}catch(b){}}
function editor_onkeydown_4(a){try{editor_onkeydown(a,4)}catch(b){}}function editor_onkeydown_5(a){try{editor_onkeydown(a,5)}catch(b){}}function editor_onkeydown_6(a){try{editor_onkeydown(a,6)}catch(b){}}function editor_onkeydown_7(a){try{editor_onkeydown(a,7)}catch(b){}}function editor_onkeydown_8(a){try{editor_onkeydown(a,8)}catch(b){}}function editor_onkeydown_9(a){try{editor_onkeydown(a,9)}catch(b){}}function editor_onkeydown_10(a){try{editor_onkeydown(a,10)}catch(b){}}
function editor_onkeydown_11(a){try{editor_onkeydown(a,11)}catch(b){}}function editor_onkeydown_12(a){try{editor_onkeydown(a,12)}catch(b){}}function editor_onkeydown_13(a){try{editor_onkeydown(a,13)}catch(b){}}function editor_onkeydown_14(a){try{editor_onkeydown(a,14)}catch(b){}}function editor_onkeydown_15(a){try{editor_onkeydown(a,15)}catch(b){}}function editor_onkeydown_16(a){try{editor_onkeydown(a,16)}catch(b){}}function editor_onkeydown_17(a){try{editor_onkeydown(a,17)}catch(b){}}
function editor_onkeydown_18(a){try{editor_onkeydown(a,18)}catch(b){}}function editor_onkeydown_19(a){try{editor_onkeydown(a,19)}catch(b){}}function editor_onkeyup_0(a){try{editor_onkeyup(a,0)}catch(b){}}function editor_onkeyup_1(a){try{editor_onkeyup(a,1)}catch(b){}}function editor_onkeyup_2(a){try{editor_onkeyup(a,2)}catch(b){}}function editor_onkeyup_3(a){try{editor_onkeyup(a,3)}catch(b){}}function editor_onkeyup_4(a){try{editor_onkeyup(a,4)}catch(b){}}
function editor_onkeyup_5(a){try{editor_onkeyup(a,5)}catch(b){}}function editor_onkeyup_6(a){try{editor_onkeyup(a,6)}catch(b){}}function editor_onkeyup_7(a){try{editor_onkeyup(a,7)}catch(b){}}function editor_onkeyup_8(a){try{editor_onkeyup(a,8)}catch(b){}}function editor_onkeyup_9(a){try{editor_onkeyup(a,9)}catch(b){}}function editor_onkeyup_10(a){try{editor_onkeyup(a,10)}catch(b){}}function editor_onkeyup_11(a){try{editor_onkeyup(a,11)}catch(b){}}
function editor_onkeyup_12(a){try{editor_onkeyup(a,12)}catch(b){}}function editor_onkeyup_13(a){try{editor_onkeyup(a,13)}catch(b){}}function editor_onkeyup_14(a){try{editor_onkeyup(a,14)}catch(b){}}function editor_onkeyup_15(a){try{editor_onkeyup(a,15)}catch(b){}}function editor_onkeyup_16(a){try{editor_onkeyup(a,16)}catch(b){}}function editor_onkeyup_17(a){try{editor_onkeyup(a,17)}catch(b){}}function editor_onkeyup_18(a){try{editor_onkeyup(a,18)}catch(b){}}
function editor_onkeyup_19(a){try{editor_onkeyup(a,19)}catch(b){}}function editor_oncompositionstart_0(a){try{editor_oncompositionstart(a,0)}catch(b){}}function editor_oncompositionstart_1(a){try{editor_oncompositionstart(a,1)}catch(b){}}function editor_oncompositionstart_2(a){try{editor_oncompositionstart(a,2)}catch(b){}}function editor_oncompositionstart_3(a){try{editor_oncompositionstart(a,3)}catch(b){}}function editor_oncompositionstart_4(a){try{editor_oncompositionstart(a,4)}catch(b){}}
function editor_oncompositionstart_5(a){try{editor_oncompositionstart(a,5)}catch(b){}}function editor_oncompositionstart_6(a){try{editor_oncompositionstart(a,6)}catch(b){}}function editor_oncompositionstart_7(a){try{editor_oncompositionstart(a,7)}catch(b){}}function editor_oncompositionstart_8(a){try{editor_oncompositionstart(a,8)}catch(b){}}function editor_oncompositionstart_9(a){try{editor_oncompositionstart(a,9)}catch(b){}}
function editor_oncompositionstart_10(a){try{editor_oncompositionstart(a,10)}catch(b){}}function editor_oncompositionstart_11(a){try{editor_oncompositionstart(a,11)}catch(b){}}function editor_oncompositionstart_12(a){try{editor_oncompositionstart(a,12)}catch(b){}}function editor_oncompositionstart_13(a){try{editor_oncompositionstart(a,13)}catch(b){}}function editor_oncompositionstart_14(a){try{editor_oncompositionstart(a,14)}catch(b){}}
function editor_oncompositionstart_15(a){try{editor_oncompositionstart(a,15)}catch(b){}}function editor_oncompositionstart_16(a){try{editor_oncompositionstart(a,16)}catch(b){}}function editor_oncompositionstart_17(a){try{editor_oncompositionstart(a,17)}catch(b){}}function editor_oncompositionstart_18(a){try{editor_oncompositionstart(a,18)}catch(b){}}function editor_oncompositionstart_19(a){try{editor_oncompositionstart(a,19)}catch(b){}}
function editor_oncompositionend_0(a){try{editor_oncompositionend(a,0)}catch(b){}}function editor_oncompositionend_1(a){try{editor_oncompositionend(a,1)}catch(b){}}function editor_oncompositionend_2(a){try{editor_oncompositionend(a,2)}catch(b){}}function editor_oncompositionend_3(a){try{editor_oncompositionend(a,3)}catch(b){}}function editor_oncompositionend_4(a){try{editor_oncompositionend(a,4)}catch(b){}}function editor_oncompositionend_5(a){try{editor_oncompositionend(a,5)}catch(b){}}
function editor_oncompositionend_6(a){try{editor_oncompositionend(a,6)}catch(b){}}function editor_oncompositionend_7(a){try{editor_oncompositionend(a,7)}catch(b){}}function editor_oncompositionend_8(a){try{editor_oncompositionend(a,8)}catch(b){}}function editor_oncompositionend_9(a){try{editor_oncompositionend(a,9)}catch(b){}}function editor_oncompositionend_10(a){try{editor_oncompositionend(a,10)}catch(b){}}function editor_oncompositionend_11(a){try{editor_oncompositionend(a,11)}catch(b){}}
function editor_oncompositionend_12(a){try{editor_oncompositionend(a,12)}catch(b){}}function editor_oncompositionend_13(a){try{editor_oncompositionend(a,13)}catch(b){}}function editor_oncompositionend_14(a){try{editor_oncompositionend(a,14)}catch(b){}}function editor_oncompositionend_15(a){try{editor_oncompositionend(a,15)}catch(b){}}function editor_oncompositionend_16(a){try{editor_oncompositionend(a,16)}catch(b){}}
function editor_oncompositionend_17(a){try{editor_oncompositionend(a,17)}catch(b){}}function editor_oncompositionend_18(a){try{editor_oncompositionend(a,18)}catch(b){}}function editor_oncompositionend_19(a){try{editor_oncompositionend(a,19)}catch(b){}}function editor_onfocus_0(a){try{editor_onfocus(a,0)}catch(b){}}function editor_onfocus_1(a){try{editor_onfocus(a,1)}catch(b){}}function editor_onfocus_2(a){try{editor_onfocus(a,2)}catch(b){}}
function editor_onfocus_3(a){try{editor_onfocus(a,3)}catch(b){}}function editor_onfocus_4(a){try{editor_onfocus(a,4)}catch(b){}}function editor_onfocus_5(a){try{editor_onfocus(a,5)}catch(b){}}function editor_onfocus_6(a){try{editor_onfocus(a,6)}catch(b){}}function editor_onfocus_7(a){try{editor_onfocus(a,7)}catch(b){}}function editor_onfocus_8(a){try{editor_onfocus(a,8)}catch(b){}}function editor_onfocus_9(a){try{editor_onfocus(a,9)}catch(b){}}
function editor_onfocus_10(a){try{editor_onfocus(a,10)}catch(b){}}function editor_onfocus_11(a){try{editor_onfocus(a,11)}catch(b){}}function editor_onfocus_12(a){try{editor_onfocus(a,12)}catch(b){}}function editor_onfocus_13(a){try{editor_onfocus(a,13)}catch(b){}}function editor_onfocus_14(a){try{editor_onfocus(a,14)}catch(b){}}function editor_onfocus_15(a){try{editor_onfocus(a,15)}catch(b){}}function editor_onfocus_16(a){try{editor_onfocus(a,16)}catch(b){}}
function editor_onfocus_17(a){try{editor_onfocus(a,17)}catch(b){}}function editor_onfocus_18(a){try{editor_onfocus(a,18)}catch(b){}}function editor_onfocus_19(a){try{editor_onfocus(a,19)}catch(b){}}function editor_onblur_0(a){try{editor_onblur(a,0)}catch(b){}}function editor_onblur_1(a){try{editor_onblur(a,1)}catch(b){}}function editor_onblur_2(a){try{editor_onblur(a,2)}catch(b){}}function editor_onblur_3(a){try{editor_onblur(a,3)}catch(b){}}
function editor_onblur_4(a){try{editor_onblur(a,4)}catch(b){}}function editor_onblur_5(a){try{editor_onblur(a,5)}catch(b){}}function editor_onblur_6(a){try{editor_onblur(a,6)}catch(b){}}function editor_onblur_7(a){try{editor_onblur(a,7)}catch(b){}}function editor_onblur_8(a){try{editor_onblur(a,8)}catch(b){}}function editor_onblur_9(a){try{editor_onblur(a,9)}catch(b){}}function editor_onblur_10(a){try{editor_onblur(a,10)}catch(b){}}function editor_onblur_11(a){try{editor_onblur(a,11)}catch(b){}}
function editor_onblur_12(a){try{editor_onblur(a,12)}catch(b){}}function editor_onblur_13(a){try{editor_onblur(a,13)}catch(b){}}function editor_onblur_14(a){try{editor_onblur(a,14)}catch(b){}}function editor_onblur_15(a){try{editor_onblur(a,15)}catch(b){}}function editor_onblur_16(a){try{editor_onblur(a,16)}catch(b){}}function editor_onblur_17(a){try{editor_onblur(a,17)}catch(b){}}function editor_onblur_18(a){try{editor_onblur(a,18)}catch(b){}}
function editor_onblur_19(a){try{editor_onblur(a,19)}catch(b){}}function editor_ondblclick_0(a){try{editor_ondblclick(a,0)}catch(b){}}function editor_ondblclick_1(a){try{editor_ondblclick(a,1)}catch(b){}}function editor_ondblclick_2(a){try{editor_ondblclick(a,2)}catch(b){}}function editor_ondblclick_3(a){try{editor_ondblclick(a,3)}catch(b){}}function editor_ondblclick_4(a){try{editor_ondblclick(a,4)}catch(b){}}function editor_ondblclick_5(a){try{editor_ondblclick(a,5)}catch(b){}}
function editor_ondblclick_6(a){try{editor_ondblclick(a,6)}catch(b){}}function editor_ondblclick_7(a){try{editor_ondblclick(a,7)}catch(b){}}function editor_ondblclick_8(a){try{editor_ondblclick(a,8)}catch(b){}}function editor_ondblclick_9(a){try{editor_ondblclick(a,9)}catch(b){}}function editor_ondblclick_10(a){try{editor_ondblclick(a,10)}catch(b){}}function editor_ondblclick_11(a){try{editor_ondblclick(a,11)}catch(b){}}function editor_ondblclick_12(a){try{editor_ondblclick(a,12)}catch(b){}}
function editor_ondblclick_13(a){try{editor_ondblclick(a,13)}catch(b){}}function editor_ondblclick_14(a){try{editor_ondblclick(a,14)}catch(b){}}function editor_ondblclick_15(a){try{editor_ondblclick(a,15)}catch(b){}}function editor_ondblclick_16(a){try{editor_ondblclick(a,16)}catch(b){}}function editor_ondblclick_17(a){try{editor_ondblclick(a,17)}catch(b){}}function editor_ondblclick_18(a){try{editor_ondblclick(a,18)}catch(b){}}
function editor_ondblclick_19(a){try{editor_ondblclick(a,19)}catch(b){}}function editor_onactivate_0(a){try{editor_onactivate(a,0)}catch(b){}}function editor_onactivate_1(a){try{editor_onactivate(a,1)}catch(b){}}function editor_onactivate_2(a){try{editor_onactivate(a,2)}catch(b){}}function editor_onactivate_3(a){try{editor_onactivate(a,3)}catch(b){}}function editor_onactivate_4(a){try{editor_onactivate(a,4)}catch(b){}}function editor_onactivate_5(a){try{editor_onactivate(a,5)}catch(b){}}
function editor_onactivate_6(a){try{editor_onactivate(a,6)}catch(b){}}function editor_onactivate_7(a){try{editor_onactivate(a,7)}catch(b){}}function editor_onactivate_8(a){try{editor_onactivate(a,8)}catch(b){}}function editor_onactivate_9(a){try{editor_onactivate(a,9)}catch(b){}}function editor_onactivate_10(a){try{editor_onactivate(a,10)}catch(b){}}function editor_onactivate_11(a){try{editor_onactivate(a,11)}catch(b){}}function editor_onactivate_12(a){try{editor_onactivate(a,12)}catch(b){}}
function editor_onactivate_13(a){try{editor_onactivate(a,13)}catch(b){}}function editor_onactivate_14(a){try{editor_onactivate(a,14)}catch(b){}}function editor_onactivate_15(a){try{editor_onactivate(a,15)}catch(b){}}function editor_onactivate_16(a){try{editor_onactivate(a,16)}catch(b){}}function editor_onactivate_17(a){try{editor_onactivate(a,17)}catch(b){}}function editor_onactivate_18(a){try{editor_onactivate(a,18)}catch(b){}}
function editor_onactivate_19(a){try{editor_onactivate(a,19)}catch(b){}}function editor_onscroll_0(a){try{editor_onscroll(a,0)}catch(b){}}function editor_onscroll_1(a){try{editor_onscroll(a,1)}catch(b){}}function editor_onscroll_2(a){try{editor_onscroll(a,2)}catch(b){}}function editor_onscroll_3(a){try{editor_onscroll(a,3)}catch(b){}}function editor_onscroll_4(a){try{editor_onscroll(a,4)}catch(b){}}function editor_onscroll_5(a){try{editor_onscroll(a,5)}catch(b){}}
function editor_onscroll_6(a){try{editor_onscroll(a,6)}catch(b){}}function editor_onscroll_7(a){try{editor_onscroll(a,7)}catch(b){}}function editor_onscroll_8(a){try{editor_onscroll(a,8)}catch(b){}}function editor_onscroll_9(a){try{editor_onscroll(a,9)}catch(b){}}function editor_onscroll_10(a){try{editor_onscroll(a,10)}catch(b){}}function editor_onscroll_11(a){try{editor_onscroll(a,11)}catch(b){}}function editor_onscroll_12(a){try{editor_onscroll(a,12)}catch(b){}}
function editor_onscroll_13(a){try{editor_onscroll(a,13)}catch(b){}}function editor_onscroll_14(a){try{editor_onscroll(a,14)}catch(b){}}function editor_onscroll_15(a){try{editor_onscroll(a,15)}catch(b){}}function editor_onscroll_16(a){try{editor_onscroll(a,16)}catch(b){}}function editor_onscroll_17(a){try{editor_onscroll(a,17)}catch(b){}}function editor_onscroll_18(a){try{editor_onscroll(a,18)}catch(b){}}function editor_onscroll_19(a){try{editor_onscroll(a,19)}catch(b){}}
function onmousedown_containerBottomResize_0(a){try{onmousedown_containerBottomResize(a,0)}catch(b){}}function onmousedown_containerBottomResize_1(a){try{onmousedown_containerBottomResize(a,1)}catch(b){}}function onmousedown_containerBottomResize_2(a){try{onmousedown_containerBottomResize(a,2)}catch(b){}}function onmousedown_containerBottomResize_3(a){try{onmousedown_containerBottomResize(a,3)}catch(b){}}
function onmousedown_containerBottomResize_4(a){try{onmousedown_containerBottomResize(a,4)}catch(b){}}function onmousedown_containerBottomResize_5(a){try{onmousedown_containerBottomResize(a,5)}catch(b){}}function onmousedown_containerBottomResize_6(a){try{onmousedown_containerBottomResize(a,6)}catch(b){}}function onmousedown_containerBottomResize_7(a){try{onmousedown_containerBottomResize(a,7)}catch(b){}}
function onmousedown_containerBottomResize_8(a){try{onmousedown_containerBottomResize(a,8)}catch(b){}}function onmousedown_containerBottomResize_9(a){try{onmousedown_containerBottomResize(a,9)}catch(b){}}function onmousedown_containerBottomResize_10(a){try{onmousedown_containerBottomResize(a,10)}catch(b){}}function onmousedown_containerBottomResize_11(a){try{onmousedown_containerBottomResize(a,11)}catch(b){}}
function onmousedown_containerBottomResize_12(a){try{onmousedown_containerBottomResize(a,12)}catch(b){}}function onmousedown_containerBottomResize_13(a){try{onmousedown_containerBottomResize(a,13)}catch(b){}}function onmousedown_containerBottomResize_14(a){try{onmousedown_containerBottomResize(a,14)}catch(b){}}function onmousedown_containerBottomResize_15(a){try{onmousedown_containerBottomResize(a,15)}catch(b){}}
function onmousedown_containerBottomResize_16(a){try{onmousedown_containerBottomResize(a,16)}catch(b){}}function onmousedown_containerBottomResize_17(a){try{onmousedown_containerBottomResize(a,17)}catch(b){}}function onmousedown_containerBottomResize_18(a){try{onmousedown_containerBottomResize(a,18)}catch(b){}}function onmousedown_containerBottomResize_19(a){try{onmousedown_containerBottomResize(a,19)}catch(b){}}function editor_onpaste_0(a){try{editor_onpaste(a,0)}catch(b){}}
function editor_onpaste_1(a){try{editor_onpaste(a,1)}catch(b){}}function editor_onpaste_2(a){try{editor_onpaste(a,2)}catch(b){}}function editor_onpaste_3(a){try{editor_onpaste(a,3)}catch(b){}}function editor_onpaste_4(a){try{editor_onpaste(a,4)}catch(b){}}function editor_onpaste_5(a){try{editor_onpaste(a,5)}catch(b){}}function editor_onpaste_6(a){try{editor_onpaste(a,6)}catch(b){}}function editor_onpaste_7(a){try{editor_onpaste(a,7)}catch(b){}}
function editor_onpaste_8(a){try{editor_onpaste(a,8)}catch(b){}}function editor_onpaste_9(a){try{editor_onpaste(a,9)}catch(b){}}function editor_onpaste_10(a){try{editor_onpaste(a,10)}catch(b){}}function editor_onpaste_11(a){try{editor_onpaste(a,11)}catch(b){}}function editor_onpaste_12(a){try{editor_onpaste(a,12)}catch(b){}}function editor_onpaste_13(a){try{editor_onpaste(a,13)}catch(b){}}function editor_onpaste_14(a){try{editor_onpaste(a,14)}catch(b){}}
function editor_onpaste_15(a){try{editor_onpaste(a,15)}catch(b){}}function editor_onpaste_16(a){try{editor_onpaste(a,16)}catch(b){}}function editor_onpaste_17(a){try{editor_onpaste(a,17)}catch(b){}}function editor_onpaste_18(a){try{editor_onpaste(a,18)}catch(b){}}function editor_onpaste_19(a){try{editor_onpaste(a,19)}catch(b){}};

var g_bDynamicLayer=!1,g_strSelectionType="",g_bForceNoSelectionChange=!1,g_bMenuEnabled=!0,g_bActivate=[],ID_STRING_COMMAND_CREATELINK="CreateLink",ID_STRING_COMMAND_UNLINK="Unlink",g_objLastRange=[],g_strBookmark_IE=null,g_objObjectSelectionInfo=null,g_objCurrentRange=[];function initSelectionObjectInfo(){this.bSelectObject=!1;this.objSelectionObject=this.strNodeName=null;return this}
function setSelectionObjectInfo(a,c,b){g_objObjectSelectionInfo.bSelectObject=a;g_objObjectSelectionInfo.strNodeName=c;g_objObjectSelectionInfo.objSelectionObject=b}
function editor_onbeforedeactivate(a){try{if(g_objCommonUtil.log("editor_onbeforedeactivate"),g_bEditMode[a]&&!g_bForceNoSelectionChange&&null==duzon_dialog.dialog_obj)if(g_bBrowserType_IE&&g_arrForceCancelBubbleMouseDown[a])g_arrForceCancelBubbleMouseDown[a]=!1,TBCancelBubbleEvent(null);else{var c=g_objPositionUtil.GetDocumentClientPos_XY(null),b=c.nPos_X,d=c.nPos_Y;if(!fnObjectCheckNull(g_objEditAreaContainer[a])&&!fnObjectCheckNull(g_objEditSetContainer[a])){var e=g_objPositionUtil.getDocumentScrollPosition(!1),
g=e.nScrollLeft,f=e.nScrollTop,k=e=c=0,m=0,h=g_objEditAreaContainer[a].getBoundingClientRect();c=h.left+g;e=h.top+f;k=h.right+g;m=h.bottom+f;c<=b&&e<=d&&b<=k&&d<=m&&TBCancelBubbleEvent(null)}g_bDynamicLayer&&TBCancelBubbleEvent(null);if(window.attachEvent){var l=g_objEditorDocument[a].selection;g_objLastRange[a]=l.createRange()}else g_bBrowserType_IE&&(l=g_objEditWindow[a].getSelection(),g_objLastRange[a]=l.getRangeAt(0))}}catch(n){g_objLastRange[a]=null}}
function editor_ondeactivate(a){g_bForceNoSelectionChange||(disableAllControl(a),g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1,g_bActivate[a]=!1,g_objLayerEventUtil.initHideDynamicLayer());try{g_bBrowserType_IE&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+a+", 0);"),dzeClipBoard.initialize()}catch(c){}}
function editor_onactivate(a,c){g_bActivate[c]=!0;g_nActiveEditNumber=c;try{g_bBrowserType_IE&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+c+", 1);")}catch(b){}}function editor_onselectionchange_for_iframe(a){try{var c=getSelectionControl(a);if(1==c.rangeLength){var b=c.controlObject.tagName.toLowerCase();"iframe"==b&&(setSelectionObjectInfo(!0,b,c.controlObject),editor_onselectionchange(a))}}catch(d){}}
function editor_onselectionchange(a){try{if(g_nActiveEditNumber=a,duzon_dialog.nEditNumber=a,duzon_menubar.nEditNumber=a,!(g_bBrowserType_IE&&ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID||g_bBrowserType_IE&&!g_bActivate[a])){g_bMenuEnabled||(g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0);if(window.attachEvent)if(g_strSelectionType=g_objEditorDocument[a].selection.type.toLowerCase(),ID_STRING_NAME_CONTROL==g_strSelectionType){g_objTableFlag.ResetTableInfo(!1);var c=g_objEditorDocument[a].selection.createRange();
if(fnObjectCheckNull(c.length)){disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1;return}g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1}else{var b=g_objEditorDocument[a].selection.createRange();fnObjectCheckNull(b)||(g_strBookmark_IE=b.getBookmark())}else if(g_strSelectionType=getSelectionTypeForUpdateUI(),ID_STRING_NAME_CONTROL==g_strSelectionType)g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1;else if(1!=g_objEditWindow[a].getSelection().rangeCount){disableAllControl(a);
g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1;return}dzeUiConfig.bUseLockEditCellFunction&&!g_objTable&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(a));c=!0;2==g_nFormEditMode&&(g_objEditMode.checkSelectionContentEditableArea(a)||(c=!1));c?(updateHandlerUI.update_toolbar_button(g_strSelectionType,a),updateHandlerUI.update_toolbar_combobox(g_strSelectionType,a),updateHandlerUI.update_toolbar_dropdown(g_strSelectionType,a),2==g_nFormEditMode&&g_objEditMode.bRestrictAreaMouseDown?
updateHandlerUI.update_toolbar_manual(g_strSelectionType,!0,a):updateHandlerUI.update_toolbar_manual(g_strSelectionType,!1,a),g_objInsertUtil.saveSelectionRange_IE(1,a)):(disableAllControl(a),g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1);isShowedRulerBar()&&!isPressedRulerBarBtn()&&(dze_rulerbar_mgr.setCurLineEle(),dze_rulerbar_mgr.updateCtrlPos())}}catch(d){}}
function disableAllControl(a){try{for(var c=g_objEditorDocument[a],b=0;b<g_TBButton[a].length;b++){var d=g_TBButton[a][b].command_id,e=g_TBButton[a][b].element,g=g_TBButton[a][b].element.command;if(ID_SUPPORT_TYPE_PERSISTENCE!=g_TBButton[a][b].support_type)if(3==g_nFormEditMode)if(ID_COMMAND_UNDO==d||ID_COMMAND_REDO==d){var f=handlerUI.queryCommandStatus(c,d,g,a,-1,null);null!=f&&TBSetState(e,f,g_TBButton[a][b].button_type)}else TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type);
else TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type)}for(b=0;b<g_TBDropDown[a].length;b++)ID_SUPPORT_TYPE_PERSISTENCE!=g_TBDropDown[a][b].support_type&&TBSetState(g_TBDropDown[a][b].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][b].button_type);for(b=0;b<g_TBComboBox[a].length;b++)ID_SUPPORT_TYPE_PERSISTENCE!=g_TBComboBox[a][b].support_type&&TBSetState(g_TBComboBox[[a]][b].element,ID_STRING_NAME_GRAY,g_TBComboBox[[a]][b].button_type);g_objTableFlag.ResetTableInfo(!1);
duzon_dialog.closeExtendsDlg()}catch(k){}};

var ID_TABLE_EVENT_NOTHING=0,ID_TABLE_EVENT_ROW_RESIZE=1,ID_TABLE_EVENT_COL_RESIZE=2,ID_TABLE_EVENT_CELL_SELECT=3,g_nTableEventID=0,g_bResizeRButtonClick=!1,g_bAttachMouseEvent=!1,g_bFirst_OnBeforeUnload=!0,g_bFirst_OnUnload=!0,g_arrOnFocus_FF_WK=[];
function initGlobalEvent(){try{g_objTableFlag.initTableInfo(),window.attachEvent?(window.attachEvent("onresize",window_onresize),g_objLayerKit.getLayerDocument().attachEvent("onkeydown",document_onkeydown),g_objLayerKit.getLayerDocument().attachEvent("onkeyup",document_onkeyup),document.attachEvent("onmousedown",document_onmousedown),g_objLayerKit.getLayerDocument().attachEvent("mouseup",document_onmouseup)):(window.addEventListener("resize",window_onresize,!1),g_objLayerKit.getLayerDocument().addEventListener("keydown",
document_onkeydown,!1),g_objLayerKit.getLayerDocument().addEventListener("keyup",document_onkeyup,!1),document.addEventListener("mousedown",document_onmousedown,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",document_onmouseup))}catch(a){}}
function initEditorEvent(a){if(g_bBrowserType_IE)if(g_objLastRange[a]=null,g_objCurrentRange[a]=null,g_objEditorDocument[a].oncontextmenu=fnReturnFalsePropagation,g_objEditorDocument[a].body.onunload=editor_onunload,eval("g_objEditObject["+a+"].onbeforedeactivate = function(evnt){editor_onbeforedeactivate("+a+");};"),eval("g_objEditObject["+a+"].ondeactivate = function(evnt){editor_ondeactivate("+a+");};"),window.attachEvent){eval("g_objEditorDocument["+a+"].onselectionchange = function(evnt){editor_onselectionchange("+
a+");};");eval("g_objEditorDocument["+a+'].body.attachEvent("onpaste", editor_onpaste_'+a+");");eval("g_objEditorDocument["+a+'].attachEvent("onactivate", editor_onactivate_'+a+");");eval("g_objEditorDocument["+a+'].attachEvent("onkeydown", editor_onkeydown_'+a+");");eval("g_objEditorDocument["+a+'].attachEvent("onkeyup", editor_onkeyup_'+a+");");try{eval("g_objEditWindow["+a+'].attachEvent("onscroll", editor_onscroll_'+a+");")}catch(b){try{g_objEditorDocument[a].attachEvent("onmousewheel",editor_onmousewheel)}catch(c){}}}else{eval("g_objEditorDocument["+
a+"].onselectionchange = function(evnt){editor_onselectionchange_for_iframe("+a+");};");eval("g_objEditorDocument["+a+'].body.addEventListener("paste", editor_onpaste_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("activate", editor_onactivate_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("keydown", editor_onkeydown_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("keyup", editor_onkeyup_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("compositionstart", editor_oncompositionstart_'+
a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("compositionend", editor_oncompositionend_'+a+", false);");try{eval("g_objEditWindow["+a+'].addEventListener("scroll", editor_onscroll_'+a+", false);")}catch(b){try{g_objEditorDocument[a].addEventListener("mousewheel",editor_onmousewheel,!1)}catch(c){}}}else{g_objEditorDocument[a].addEventListener("contextmenu",fnReturnFalsePropagation,!1);g_objEditWindow[a].addEventListener("unload",editor_onunload,!1);g_arrOnFocus_FF_WK[a]=!1;if(g_bBrowserType_FF)eval("g_objEditorDocument["+
a+'].addEventListener("focus", editor_onfocus_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("blur", editor_onblur_'+a+", false);");else if(g_bBrowserType_WK||g_bBrowserType_OP)eval("g_objEditWindow["+a+'].addEventListener("focus", editor_onfocus_'+a+", false);"),eval("g_objEditWindow["+a+'].addEventListener("blur", editor_onblur_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("keydown", editor_onkeydown_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("keyup", editor_onkeyup_'+
a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("compositionstart", editor_oncompositionstart_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("compositionend", editor_oncompositionend_'+a+", false);");eval("g_objEditWindow["+a+'].addEventListener("scroll", editor_onscroll_'+a+", false);");eval("g_objEditorDocument["+a+'].addEventListener("paste", editor_onpaste_'+a+", false);")}attachMouseEvent()}
function setWindowResizeEvent(a){try{a?window.setTimeout("setRestoreWindowResizeEvent()",100):window.detachEvent?window.detachEvent("onresize",window_onresize):window.removeEventListener("resize",window_onresize,!1)}catch(b){}}function setRestoreWindowResizeEvent(){try{window.attachEvent?window.attachEvent("onresize",window_onresize):window.addEventListener("resize",window_onresize,!1)}catch(a){}}
function window_onresize(){g_objLayerEventUtil.initHideDynamicLayer();g_objWrapperOutlineResize.resetExtOutlineInfo();if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode){if(g_bEditorHeightIFrameYN&&"undefined"!=typeof window.frameElement&&null!=window.frameElement&&null!=window.frameElement.getAttribute("dzeditor_no")){var a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10);dze_menu_control.resizeEditorHeight(a)}}else if(g_bEditorHeightIFrameYN){a=document.documentElement.clientHeight;
var b=0;"undefined"!=typeof window.frameElement&&null!=window.frameElement&&(null!=window.frameElement.getAttribute("dzeditor_no")&&(b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10)),resizeEditor_Height(b,a))}if("undefined"!=typeof duzon_menubar&&(duzon_menubar.rebuildHiddenToolbar(),isCreatedRulerBar()))dze_rulerbar_mgr.onResize(duzon_menubar.availToolbarWidth);addParentScrollEvent();if("undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&""!=dzeUiConfig.nEditModeAreaWidth){a=
Number(dzeUiConfig.nEditModeAreaWidth);for(var c in g_arrEditorAreaContainer)g_objEditMode.setEditModeAreaWidth(a,c)}}function document_onmousedown(a){try{g_objCommonUtil.log("document_onmousedown")}catch(b){g_objCommonUtil.displayErrorAlert(b,"document_onmousedown")}}function document_onmouseup(a){try{if(g_objCommonUtil.log("document_onmouseup"),isShowedRulerBar())dze_rulerbar_mgr.onMouseUpProcess(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"document_onmouseup")}}
function document_onkeydown(a){try{if(g_objPropForm.bShowPropForm){var b=a.keyCode;a.ctrlKey?86==b?g_objPropFormKeyCode.keyDownPaste(a):(ID_KEYCODE_ARROW_LEFT!=b&&ID_KEYCODE_ARROW_TOP!=b&&ID_KEYCODE_ARROW_RIGHT!=b&&ID_KEYCODE_ARROW_BOTTOM!=b||g_objPropFormKeyCode.keyDownResizeArrow(b,a),g_objPropFormKeyCode.bCtrlKeyDown=!0):a.shiftKey?g_objPropFormKeyCode.bShiftKeyDown=!0:ID_KEYCODE_TAB!=b&&(ID_KEYCODE_ESCAPE==b?g_objPropFormKeyCode.keyDownEscape(a):ID_KEYCODE_DELETE==b?g_objPropFormKeyCode.keyDownDelete(a):
(ID_KEYCODE_ARROW_LEFT==b||ID_KEYCODE_ARROW_TOP==b||ID_KEYCODE_ARROW_RIGHT==b||ID_KEYCODE_ARROW_BOTTOM==b)&&g_objPropFormKeyCode.keyDownMoveArrow(b,a))}else g_objPropTagTableSelectFormula.bShowTagTableSelectFormula&&(b=a.keyCode,ID_KEYCODE_ESCAPE==b&&(duzon_dialog.closeDialog(),g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)))}catch(c){}}
function document_onkeyup(a){try{g_objPropForm.bShowPropForm&&(0==a.ctrlKey&&(g_objPropFormKeyCode.bCtrlKeyDown=!1),0==a.shiftKey&&(g_objPropFormKeyCode.bShiftKeyDown=!1))}catch(b){}}
function editor_onkeydown(a,b){try{var c=a?a.keyCode:0;DZESHORTCUT.setDzeShortCutEvent(a,b);isShowedRulerBar()&&dze_rulerbar_mgr.setPressedKeyType(a);!a.altKey||a.ctrlKey||a.shiftKey||(ID_KEYCODE_ARROW_LEFT==a.keyCode||ID_KEYCODE_ARROW_RIGHT==a.keyCode)&&TBCancelBubbleEvent(a);var d=g_objTableFunction.getCurrentCell(b);if(null!=d&&null!=d.table||g_objTable){g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();if(dzeUiConfig.bUseLockEditCellFunction){if(!0===checkDzeCellLocked(a,b)){TBCancelBubbleEvent(a);
return}var e=checkMoveCellForce(b,a);if(e&&g_objTableFunction.moveFocusCell(a.keyCode,b)){TBCancelBubbleEvent(a);return}}if(ID_KEYCODE_DELETE==a.keyCode&&null!=g_objTable){if(!g_objTableFlag.bOneCell&&g_objTableFunction.DeleteSelectedCellContent(g_objTable))return}else if((ID_KEYCODE_ARROW_LEFT==a.keyCode||ID_KEYCODE_ARROW_RIGHT==a.keyCode||ID_KEYCODE_ARROW_TOP==a.keyCode||ID_KEYCODE_ARROW_BOTTOM==a.keyCode||ID_KEYCODE_TAB==a.keyCode)&&!GetMultiCellSelection()&&2!=g_nFormEditMode){if(ID_KEYCODE_TAB==
a.keyCode){g_objTableFunction.moveFocusNextCell(g_objTable,b);TBCancelBubbleEvent(a);return}if(a.altKey||a.ctrlKey||a.shiftKey)return;e=checkMoveCellForce(b,a);if(!0===e){d=!1;if(ID_KEYCODE_ARROW_LEFT==a.keyCode||ID_KEYCODE_ARROW_RIGHT==a.keyCode)d=g_objTableFunction.moveFocusCell(a.keyCode,b);else if(ID_KEYCODE_ARROW_TOP==a.keyCode||ID_KEYCODE_ARROW_BOTTOM==a.keyCode)d=g_objTableFunction.moveFocusUpDownCell(g_objTable,a.keyCode,b);if(!0===d){TBCancelBubbleEvent(a);g_objTableFlag.ResetTableInfo(!1);
updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b);return}}}a.altKey||a.ctrlKey||a.shiftKey||(g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b))}isModifierKeyCode(c)||g_objWrapperOutlineResize.resetExtOutlineInfo();if(g_bBrowserType_IE&&(ID_KEYCODE_ENTER==a.keyCode&&checkResetSpanContainsP(b,0),ID_KEYCODE_DELETE==a.keyCode)){checkSetIFrameSrcBlankForDelete(b);return}switch(c){case ID_KEYCODE_ESCAPE:return;case ID_KEYCODE_ENTER:case ID_KEYCODE_SPACE:!1===g_bBrowserType_IE&&
setHyperlinkAuto(b,!1);break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();break;case ID_KEYCODE_BACKSPACE:!1===g_bBrowserType_IE&&!0===removeHyperlink(b)&&TBCancelBubbleEvent(a);break;case ID_KEYCODE_Y:case ID_KEYCODE_Z:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();!a.ctrlKey||a.altKey||a.shiftKey||(TBCancelBubbleEvent(a),c==ID_KEYCODE_Y?g_objUndoRedo.operateUndoRedoStack(!1,
!1,b):g_objUndoRedo.operateUndoRedoStack(!0,!1,b),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(b));break;default:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer()}dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteKeyDown(a,b)}catch(g){g_objCommonUtil.displayErrorAlert(g,"editor_onkeydown")}}
function editor_onkeyup(a,b){try{var c=a.keyCode;if(window.addEventListener&&229!=a.keyCode){isShowedRulerBar()&&dze_rulerbar_mgr.setPressedKeyType(a);if(ID_KEYCODE_CTRL==c||ID_KEYCODE_ALT==c||ID_KEYCODE_CAPSLOCK==c)return;setSelectionObjectInfo(!1,null,null);editor_onselectionchange(b)}a.ctrlKey?89!=c&&90!=c||TBCancelBubbleEvent(a):ID_KEYCODE_V!=c&&(g_objUndoRedo.checkKeyCodeInput(c,b),ID_KEYCODE_CTRL!=c&&ID_KEYCODE_ALT!=c&&ID_KEYCODE_CAPSLOCK!=c&&(c==ID_KEYCODE_ENTER&&(applyListStyleEnter(a,b),
applyParagraphStyleEnter(a,b)),(c==ID_KEYCODE_SPACE||c==ID_KEYCODE_ARROW_LEFT||c==ID_KEYCODE_ARROW_TOP||c==ID_KEYCODE_ARROW_RIGHT||c==ID_KEYCODE_ARROW_BOTTOM)&&g_objTagUtil&&g_objTagUtil.undoRedoCheckBoxRadioTagAttribute&&g_objTagUtil.undoRedoCheckBoxRadioTagAttribute(a,b)))}catch(d){g_objCommonUtil.displayErrorAlert(d,"editor_onkeyup")}}function editor_oncompositionstart(a,b){try{g_objCaretUtil.bComposing=!0}catch(c){g_objCommonUtil.displayErrorAlert(c,"editor_oncompositionstart")}}
function editor_oncompositionend(a,b){try{g_objCaretUtil.bComposing=!1}catch(c){g_objCommonUtil.displayErrorAlert(c,"editor_oncompositionend")}}function editor_onfocus(a,b){try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&!g_arrOnFocus_FF_WK[b]&&(g_arrOnFocus_FF_WK[b]=!0,g_bActivate[b]=!0,g_nActiveEditNumber=b)}catch(c){}try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 1);")}catch(c){}}
function editor_onblur(a,b){try{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){if(g_objTableResize.bResizeMouseDown)return;g_arrOnFocus_FF_WK[b]&&(g_arrOnFocus_FF_WK[b]=!1,editor_ondeactivate(b))}var c=g_objEditorDocument[b].getSelection().getRangeAt(0),d=c.commonAncestorContainer;if(!0===c.collapsed&&d.nodeType===ID_SELECTION_ELEMENT_NODE){var e=d.childNodes[c.startOffset];"input"===e.nodeName.toLowerCase()&&"text"===e.type.toLowerCase()&&!0===g_objPropertyUtil.element_hasClass(e,"external_inputbox_area")&&
g_objCaretUtil.saveCaret(b,"select_custom_inputbox")}}catch(g){}try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 0);")}catch(g){}}
function editor_onunload(){try{if(g_bFirst_OnBeforeUnload){g_bFirst_OnBeforeUnload=!1;for(var a in g_arrEditorAreaContainer)if(g_bBrowserType_IE)g_objEditorDocument[a].execCommand("Unselect"),g_objEditorDocument[a].body.contentEditable=!1,g_objEditorDocument[a].body.innerHTML="";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[a].body.innerHTML=""}}catch(b){}try{if(g_bFirst_OnUnload)for(a in g_bFirst_OnUnload=!1,detachMouseEvent(),window.detachEvent?window.detachEvent("onresize",
window_onresize):window.removeEventListener("resize",window_onresize,!1),g_arrEditorAreaContainer){if(g_bBrowserType_IE)g_objEditorDocument[a].execCommand("Unselect"),g_objEditorDocument[a].body.contentEditable=!1,g_objEditorDocument[a].body.innerHTML="";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[a].body.innerHTML="";if(g_bBrowserType_IE)window.detachEvent?(g_objEditorDocument[a].detachEvent("onkeydown",editor_onkeydown),g_objEditorDocument[a].detachEvent("onkeyup",
editor_onkeyup),g_objEditorDocument[a].body.detachEvent("onpaste",editor_onpaste),eval("g_objEditorDocument["+a+'].detachEvent("onactivate", editor_onactivate_'+a+");")):(g_objEditorDocument[a].removeEventListener("keydown",editor_onkeydown,!1),g_objEditorDocument[a].removeEventListener("keyup",editor_onkeyup,!1),g_objEditorDocument[a].removeEventListener("compositionstart",editor_oncompositionstart,!1),g_objEditorDocument[a].removeEventListener("compositionend",editor_oncompositionend,!1),g_objEditorDocument[a].body.removeEventListener("paste",
editor_onpaste,!1),eval("g_objEditorDocument["+a+'].removeEventListener("activate", editor_onactivate_'+a+", false);"));else{g_objEditorDocument[a].removeEventListener("keydown",editor_onkeydown,!1);g_objEditorDocument[a].removeEventListener("keyup",editor_onkeyup,!1);g_objEditorDocument[a].removeEventListener("compositionstart",editor_oncompositionstart,!1);g_objEditorDocument[a].removeEventListener("compositionend",editor_oncompositionend,!1);if(g_bBrowserType_FF)eval("g_objEditorDocument["+a+'].removeEventListener("focus", editor_onfocus_'+
a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("blur", editor_onblur_'+a+", false);");else if(g_bBrowserType_WK||g_bBrowserType_OP)eval("g_objEditWindow["+a+'].removeEventListener("focus", editor_onfocus_'+a+", false);"),eval("g_objEditWindow["+a+'].removeEventListener("blur", editor_onblur_'+a+", false);");g_bBrowserType_FF&&eval("g_objEditWindow["+a+'].removeEventListener("scroll", editor_onscroll_'+a+", false);")}}}catch(b){}}
function attachMouseEvent(){if(!g_bAttachMouseEvent){g_bAttachMouseEvent=!0;for(var a in g_arrEditorAreaContainer)g_bBrowserType_IE?window.attachEvent?(eval("g_objEditorDocument["+a+'].attachEvent("onmousedown", editor_onmousedown_'+a+");"),eval("g_objEditorDocument["+a+'].attachEvent("onmousemove", editor_onmousemove_'+a+");"),eval("g_objEditorDocument["+a+'].attachEvent("onmouseup", editor_onmouseup_'+a+");"),eval("g_objEditorDocument["+a+'].attachEvent("ondblclick", editor_ondblclick_'+a+");")):
(eval("g_objEditorDocument["+a+'].addEventListener("mousedown", editor_onmousedown_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("mousemove", editor_onmousemove_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("mouseup", editor_onmouseup_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("dblclick", editor_ondblclick_'+a+", false);")):(eval("g_objEditorDocument["+a+'].addEventListener("mousedown", editor_onmousedown_'+a+", false);"),eval("g_objEditorDocument["+
a+'].addEventListener("mousemove", editor_onmousemove_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("mouseup", editor_onmouseup_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("dblclick", editor_ondblclick_'+a+", false);"))}}
function detachMouseEvent(){if(g_bAttachMouseEvent){g_bAttachMouseEvent=!1;for(var a in g_arrEditorAreaContainer)g_bBrowserType_IE?window.detachEvent?(eval("g_objEditorDocument["+a+'].detachEvent("onmousedown", editor_onmousedown_'+a+");"),eval("g_objEditorDocument["+a+'].detachEvent("onmousemove", editor_onmousemove_'+a+");"),eval("g_objEditorDocument["+a+'].detachEvent("onmouseup", editor_onmouseup_'+a+");"),eval("g_objEditorDocument["+a+'].detachEvent("ondblclick", editor_ondblclick_'+a+");")):
(eval("g_objEditorDocument["+a+'].removeEventListener("mousedown", editor_onmousedown_'+a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("mousemove", editor_onmousemove_'+a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("mouseup", editor_onmouseup_'+a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("dblclick", editor_ondblclick_'+a+", false);")):(eval("g_objEditorDocument["+a+'].removeEventListener("mousedown", editor_onmousedown_'+a+", false);"),
eval("g_objEditorDocument["+a+'].removeEventListener("mousemove", editor_onmousemove_'+a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("mouseup", editor_onmouseup_'+a+", false);"),eval("g_objEditorDocument["+a+'].removeEventListener("dblclick", editor_ondblclick_'+a+", false);"))}}
function editor_oncontextmenu(a,b){try{if(g_bContextMenuUseYN&&g_nActiveEditNumber==b){g_bBrowserType_IE&&(g_objEditorDocument[b].oncontextmenu=fnReturnFalsePropagation);var c=g_objContextMenuWin.getContextMenuType(a,b);if(null!=c){g_objWrapperOutlineResize.resetExtOutlineInfo();var d=g_objPositionUtil.getNodeElementPosition(g_objEditObject[b]),e=d.left,g=d.top;d=null;d=window.attachEvent?g_objEditorDocument[b].parentWindow.event:a;var f=e+d.clientX,h=g+d.clientY;dzeEnvConfig.iFrameLayer&&g_bBrowserType_IE&&
(f+=8,h+=8);g_objContextMenuWin.showContextMenuLayer(c,f,h,b)}}}catch(k){}}
function editor_onmousedown(a,b){try{if(dzeUiConfig.bTempChromeIme&&g_objCaretUtil.bComposing&&g_browserCHK.cr&&!g_browserCHK.edge){var c=g_objEditorDocument[b],d=c?c.body:null;d&&"true"==d.getAttribute("contenteditable")&&(d.setAttribute("contenteditable","false"),d.setAttribute("contenteditable","true"))}g_nActiveEditNumber=b;g_objUndoRedo.setKeyCodeContinue(!1,b);g_objWrapperOutlineResize.resetExtOutlineInfo();if(-1==b)return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;if(g_objEditMode.arrWriteAreaSet[b])return g_nTableEventID=
ID_TABLE_EVENT_NOTHING,g_objEditMode.setupDefined_WriteAreaSet(a,b),!1;if(2==g_nFormEditMode){if(g_objEditMode.restrictWriteArea_onmousedown(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!1}else if(1==dzeUiConfig.bUseDisableCell&&g_objEditMode.restrictDisableCell_onmousedown(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!1;c=-1;c=window.attachEvent?g_objEditorDocument[b].parentWindow.event.button:
a.button;if(ID_EVENT_MOUSE_CLICK_LEFT!=c)return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;if(!g_objTableSelection.table_OnEventMouseDown(g_objEditorDocument[b],a,b))return updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!0;if(2==g_nFormEditMode&&!g_objEditMode.getLoopContentEditable(g_objTable))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),g_nTableEventID=ID_TABLE_EVENT_NOTHING,!0;g_nTableEventID=ID_TABLE_EVENT_CELL_SELECT;return!0}catch(e){}return!1}
function editor_onmousemove(a,b){try{if(g_objEditMode.arrWriteAreaSet[b])g_nTableEventID=ID_TABLE_EVENT_NOTHING;else{if(2==g_nFormEditMode){if(g_objEditMode.restrictWriteArea_onmousemove(a,b))return}else if(1==dzeUiConfig.bUseDisableCell&&g_objEditMode.restrictDisableCell_onmousemove(a,b))return;if(g_bResizeRButtonClick)g_nTableEventID=ID_TABLE_EVENT_NOTHING;else if(ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID){if(2==g_objTableSelection.table_SelectTableCell(g_objEditorDocument[b],a,b)&&(a=!1,"undefined"!=
typeof dzeUiConfig.bCellUnSelectForMouseMove&&null!=dzeUiConfig.bCellUnSelectForMouseMove&&""!=dzeUiConfig.bCellUnSelectForMouseMove&&1==dzeUiConfig.bCellUnSelectForMouseMove&&(a=!0),a))if(g_bBrowserType_IE)g_objEditorDocument[b].execCommand("Unselect");else if(g_bBrowserType_WK){var c=g_objEditWindow[b].getSelection();fnObjectCheckNull(c)||c.removeAllRanges()}}else if(g_objTableResize.checkResizeLineLayer(g_objEditorDocument[b],a,b),isShowedRulerBar())dze_rulerbar_mgr.onmousemoveFromParent(g_objEditorDocument[b],
a,b)}}catch(d){}}
function editor_onmouseup(a,b){try{g_objTableResize.bResizeMouseDown=!1;if(g_objEditMode.arrWriteAreaSet[b])return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;if(2==g_nFormEditMode){if(g_objEditMode.restrictWriteArea_onmouseup(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!1}else if(1==dzeUiConfig.bUseDisableCell&&g_objEditMode.restrictDisableCell_onmouseup(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,
0,0,b),!1;var c=-1;c=window.attachEvent?g_objEditorDocument[b].parentWindow.event.button:a.button;if(ID_EVENT_MOUSE_CLICK_LEFT!=c)return g_nTableEventID=ID_TABLE_EVENT_NOTHING,ID_EVENT_MOUSE_CLICK_RIGHT==c&&(g_bResizeRButtonClick||editor_oncontextmenu(a,b)),g_bResizeRButtonClick=!1;if(a.ctrlKey){var d=g_objALinkMgr.getALink(a,a.target||a.srcElement);if(d&&"A"==d.nodeName&&"dze_bookmark_flag"!=d.className){var e=g_objALinkMgr.getTargetLink(d);if(g_objALinkMgr.isBookmark(e)){var g=g_objALinkMgr.getBookmarkName(e);
g_objALinkMgr.goBookmarksPos(null,g,b)}else window.open(d.href,"","width=1366,height=768,left=0,top=0,resizable=yes,scrollbars=yes");TBCancelBubbleEvent(a)}}if(ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID){g=e=d=c=0;var f=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[b],b);if(null!=f&&(c=f[0],d=f[1],e=f[2],g=f[3],GetMultiCellSelection()))if(g_bBrowserType_IE)if(window.attachEvent)g_objEditorDocument[b].execCommand("Unselect");else{var h=g_objEditWindow[b].getSelection();if(fnObjectCheckNull(h))return;
var k=h.getRangeAt(0);k.collapse(!0);h.addRange(k);h.removeAllRanges()}else if(g_bBrowserType_WK){h=g_objEditWindow[b].getSelection();if(fnObjectCheckNull(h))return;h.removeAllRanges()}if(null!=g_objTable){if(g_bTableCellResizingYN&&(f=!1,-1==g_nEndClick_Row&&-1==g_nEndClick_Col&&(f=!0),g_nStartClick_Row==g_nEndClick_Row&&g_nStartClick_Col==g_nEndClick_Col&&(f=!0),f)){var l=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col);g_objWrapperOutlineResize.newExtSelectedInfo(2,
null,g_objTable,g_nStartClick_Row,g_nStartClick_Col,l);g_objWrapperOutlineResize.prepareResizeTargetElement(b);g_objWrapperOutlineUtil.showExtOutline(l,!0,!0,!1,b)}g_objTableMiniMenu.showTableMiniMenu(!0,g_objTable,b)}else g_objTableMiniMenu.showTableMiniMenu(!1,null,b);updateTableHandlerUI.updateTableUIHandler(c,d,e,g,b);GetMultiCellSelection()&&(updateHandlerUI.update_toolbar_combobox("",b),dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&updateHandlerUI.update_toolbar_for_locked_cell_option(b))}else g_objTableMiniMenu.showTableMiniMenu(!1,
null,b);g_nTableEventID=ID_TABLE_EVENT_NOTHING;g_bResizeRButtonClick=!1;if(window.attachEvent)GetMultiCellSelection();else{if(isShowedRulerBar())dze_rulerbar_mgr.onMouseUpProcess(a);GetMultiCellSelection()||isPressedRulerBarBtn()||checkObjectElemetMouseUp(a,b)}GetMultiCellSelection()||isPressedRulerBarBtn()||window.setTimeout(function(){editor_onselectionchange(b)},0);dzeCopyPasteStyleInfo.paste(b);g_objTagUtil&&g_objTagUtil.undoRedoCheckBoxRadioTagAttribute&&g_objTagUtil.undoRedoCheckBoxRadioTagAttribute(a,
b);return!0}catch(m){g_objCommonUtil.displayErrorAlert(m,"error:editor_onmouseup")}return!1}
function editor_onpaste(a,b){try{if(dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.isPasting())a.preventDefault();else{g_objAdjustDoc.setTarget(null,b);dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteBefore(a,b)&&g_objAdjustDoc.setTarget(g_objCopyPaste.getPasteDiv(),b);!0===dzeUiConfig.bLimitTableWidthSize&&g_objAdjustDoc.checkOversizedContents(b);if(g_bAutoAdjustHwpWordYN){if(g_bBrowserType_WK&&g_objAdjustDoc.checkPasteCode_Excel_WK(a)){!0===dzeUiConfig.bUseImageExtUpload?g_objExtUploader.pasteImageFromClipboard(a,
b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustPasteCode_WK(b)},300);return}var c=!0;if(g_bBrowserType_WK||g_bBrowserType_OP)for(var d=(a.clipboardData||a.originalEvent.clipboardData).items,e=0;e<d.length;e++)if(0===d[e].type.indexOf("image")){c=!1;break}!0===c&&g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustDocProcess(b)},300)}!0===dzeUiConfig.bUseImageExtUpload?g_objExtUploader.pasteImageFromClipboard(a,
b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b);g_bBrowserType_IE&&checkResetSpanContainsP(b,10);pasteOnefficeLink(a,b)}}catch(g){}}function editor_onpaste_complete(a,b){try{dzeUiConfig.bUsePasteCapture&&(g_objAdjustDoc.setTarget(null),g_objUndoRedo.registerUndoRedoStack(0,b),g_objAdjustDoc.checkContentsWidthSize(b))}catch(c){g_objCommonUtil.displayErrorAlert(c,"branchevent.editor_onpaste_complete")}}
function editor_ondblclick(a,b){try{if(!0===dzeUiConfig.bUseCustomInputBox){var c=a.target;!1===fnObjectCheckNull(c.getAttribute("ostyle"))&&("input"!==c.nodeName.toLowerCase()||"text"!==c.type.toLowerCase()&&"textarea"!==c.type.toLowerCase()||!1!==fnObjectCheckNull(c.getAttribute("ostyle"))||fnHandler_Custom_Input_Box(a,b))}!0===dzeUiConfig.bUseDataBinding&&(c=a.target,!0===g_objPropertyUtil.element_hasClass(c,"dze_external_data_area")&&fnHandler_showExternalDataBoxDialog(a,b))}catch(d){}}
function editor_onscroll(a,b){try{g_objContextMenuWin.bContextMenuAttachMouseEvent&&(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0)),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,b),g_objTable&&g_objTableMiniMenu.objTableMiniMenuLayer&&"none"!=g_objTableMiniMenu.objTableMiniMenuLayer.style.display&&g_objTableMiniMenu.showTableMiniMenu(!0,
g_objTable,b)}catch(c){}}function editor_onmousewheel(){try{editor_onscroll(null,g_nActiveEditNumber)}catch(a){}}
function attachMouseDragDropEvent(a){try{if(window.addEventListener){dlog("Add dragdrop listener ("+a+")");a=parseInt(a);var b=function(a){(a=a||window.event)&&a.preventDefault()};document.addEventListener("dragenter",b,!1);document.addEventListener("dragover",b,!1);document.addEventListener("drop",b,!1);document.addEventListener("dragleave",b,!1);g_objEditorDocument[a].addEventListener("dragenter",function(b){b=b||window.event;editor_ondragenter(b,a)},!1);g_objEditorDocument[a].addEventListener("dragover",
function(b){b=b||window.event;editor_ondragover(b,a)},!1);g_objEditorDocument[a].addEventListener("drop",function(b){b=b||window.event;editor_ondrop(b,a)},!1);g_objEditorDocument[a].addEventListener("dragleave",function(b){b=b||window.event;editor_ondragleave(b,a)},!1)}}catch(c){dalert(c)}}function editor_ondragenter(a,b){try{g_nActiveEditNumber=b,g_bBrowserType_IE||g_objEditorDocument[b].body.focus()}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:editor_ondragenter")}}
function editor_ondragover(a,b){try{if(g_objEditorDocument[b].body.focus(),g_bBrowserType_IE&&("Files"==a.dataTransfer.types[0]&&TBCancelBubbleEvent(a),!0===dzeUiConfig.bUseLockEditCellFunction)){var c=g_objNodeUtil.getLoopParentElement(a.target,"td");c&&c.contentEditable&&"false"==c.contentEditable.toLowerCase()&&TBCancelBubbleEvent(a)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:editor_ondragover")}}
function editor_ondrop(a,b){try{g_objCommonUtil.log("editor_ondrop Call nEditNumber : "+b);!0===dzeUiConfig.bLimitTableWidthSize&&g_objAdjustDoc.checkOversizedContents(b);"undefined"!=typeof a.dataTransfer.files&&null!=a.dataTransfer.files&&a.dataTransfer.files.length?(TBCancelBubbleEvent(a),DZE_UPLOAD_EVENT.dragNdropInsertImage(a.dataTransfer.files,b)):"undefined"!=dzeUiConfig.arrFormCodeString&&0<dzeUiConfig.arrFormCodeString.length&&window.setTimeout(function(){g_objEditMode.checkDropReservedFormCode(b)},
200);if(g_bBrowserType_IE&&!0===dzeUiConfig.bUseLockEditCellFunction){var c=g_objNodeUtil.getLoopParentElement(a.target,"td");c&&c.contentEditable&&"false"==c.contentEditable.toLowerCase()&&TBCancelBubbleEvent(a)}g_objUndoRedo.registerUndoRedoStack(0,b);!0===dzeUiConfig.bLimitTableWidthSize&&setTimeout(function(){g_objAdjustDoc.checkContentsWidthSize(b)},500)}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:editor_ondrop")}}function editor_ondragleave(a,b){}
function setDragNDropBg(a,b){try{1==b?(g_objEditorDocument[a].body.style.opacity="0.3",document.getElementById("dzeditor_Parent_"+a).className="editor_drag_frame"):(g_objEditorDocument[a].body.style.opacity="",document.getElementById("dzeditor_Parent_"+a).className="editor_frame")}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setDragNDropBg")}}
function addParentScrollEvent(){try{g_objCommonUtil.log("addParentScrollEvent");var a=null,b;for(b in g_arrEditorAreaContainer)g_objCommonUtil.log("i:"+b),a=dzeEnvConfig.iFrameLayer?window.frameElement:document.getElementById("INIT_LOAD_AREA_"+b),g_objCommonUtil.log(a),addEventParentScrollElement(a,b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:addParentScrollEvent")}}
function addEventParentScrollElement(a,b){try{var c=a;for(a=0;!(1E3<a)&&c.parentNode;){c=c.parentNode;if("body"==c.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var d=c.currentStyle.getAttribute("overflow");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)d=g_objEditWindow[b].getComputedStyle(c,null).getPropertyValue("overflow");"auto"!=d.toLowerCase()&&"scroll"!=d.toLowerCase()||function(){var a=c;window.attachEvent?a.attachEvent("onscroll",function(){g_objMenuWin.closeMenuLayer()}):
a.addEventListener("scroll",function(){g_objMenuWin.closeMenuLayer()},!1)}();a++}return null}catch(e){g_objCommonUtil.displayErrorAlert(e,"error:addEventParentScrollElement")}};

var g_strSkin_ClassName="",g_strSkin_HandleDiv="",g_strSkin_Separator="",g_strSkin_Button="",g_strSkin_Button_Over="",g_strSkin_Button_Down="",g_strSkin_Button_Up="",g_strSkin_ComboBox_Area="",g_strSkin_ComboBox_AreaOver="",g_strSkin_ComboBox_AreaDown="",g_strSkin_ComboBox_AreaUp="",g_strSkin_DropDown_Area="",g_strSkin_DropDown_AreaOver="",g_strSkin_DropDown_AreaDown="",g_strSkin_DropDown_AreaUp="",g_strSkin_DropDown_AreaArrow="",g_strSkin_DropDown_AreaArrowOver="",g_strSkin_DropDown_AreaArrowDown=
"",g_strSkin_DropDown_AreaArrowUp="",g_strSkin_Menu_Area="",g_strSkin_Menu_AreaOver="",g_strSkin_Menu_AreaDown="",g_strSkin_Menu_AreaUp="",g_strSkin_TabMode_Area="",g_strSkin_TabMode_AreaOver="",g_strSkin_TabMode_AreaDown="",g_strSkin_TabMode_AreaUp="",g_strSkin_MenuWin="",g_strSkin_MenuItem_Default="",g_strSkin_MenuItem_Icon_Over="",g_strSkin_MenuItem_Blank_Over="",g_strSkin_MenuItem_Caption_Over="",g_strSkin_ComboBoxWin="",g_strSkin_ComboBoxItem_Over="",g_strSkin_ComboBoxItem_Out="",g_strSkin_ComboBoxItem_Down=
"",g_strSkin_SizeBoxBackWin="",g_strSkin_SizeBoxStatus="",g_strSkin_SizeBoxCell="",g_arrToolbar1=null,g_arrToolbar2=null,g_arrToolbar3=null,g_arrMenuBar=null,g_arrTabBar=[],g_strSkin_ComboBox_Caption="",g_strSkin_ComboBox_AreaArrow="",g_strSkin_SizeBoxBG="",g_strSkin_SizeBoxStatusText="",g_nIframeBorderSetting=0,g_bEnableEditHorizontalScroll=!0,g_strBodyFontFamily="",g_strBodyFontSize="",g_strBodyFontColor="",g_strBodyLineHeight="",g_strBodyLetterSpacing="",g_strPTagMarginTop="",g_strPTagMarginBottom=
"",g_nPreviewWindowWidth=0,g_nPreviewWindowHeight=0,g_arrFontName=[],g_strPreviewCallFunction="",g_arrAdditionalEditAreaCSS=[],g_strAdditionalHeadContent="",g_bEditFocusYN=!0,g_bSourceAreaScriptAllowYN=!1,g_bSourceAreaIframeAllowYN=!1,g_bTableOperationYN=!0,g_bTableResizingYN=!0,g_bTableCellResizingYN=!0,g_nFormEditMode=0,g_bLockEditCellMode=!1,g_bEditSourceMode=!0,g_bAnchorTargetBlankYN=!1,g_bContentPTagStyleApply=!1,g_bContentXHTMLFormatYN=!1,g_bContentXHTMLTabSettingYN=!0,g_strAdditionalStyle=
"",g_strCustomAdditionalStyle="",g_bConvertPTagToBrTag=!1,g_arrImgSrcRemoveDomain=null,g_bAnchorHrefRemoveDomainYN=!1,g_bContextMenuUseYN=!0,g_bContextMenuDisplayInEditAreaYN=!1,g_bEditorWidthPercentageYN=!1,g_bEditorHeightIFrameYN=!1,g_strTabModeEventFunction="",g_bSetTableCellBlank=!1,g_strFocusEventFunction="",g_bBottomResizeYN=!1,g_arrAdjustRemoveAttributeName=[],g_arrAdjustRemoveStyleName=[],g_nAdjustFromPtToPxRatio=60,g_bAutoAdjustHwpWordYN=!0,g_bCheckImgSrcProperty=!0,g_arrCheckImgSrcPropertyValue=
[],g_bEncodeEndCharacterYN=!1,g_strDomainPageName="",g_bEditorHeightReSettingYN=!1,g_bAutoIncludeParentCSS=!1,g_nOutdentIndentWidth=7,g_bAutoBrConvertPTag=!0,g_arrRemoveGarbageText=[],g_nFireFoxLayerSetting_X=0,g_nFireFoxLayerSetting_Y=0,g_arrSkinColor=[],g_bFullScreenMode=!1;
function setSkinToolBar(){g_strSkin_ClassName="duzon_menubar_line";g_strSkin_ToolBarLine="duzon_toolbar_line";g_strSkin_Menu_Area="duzon_menubar_title";g_strSkin_Menu_AreaOver="duzon_menubar_title_over";g_strSkin_Menu_AreaDown="duzon_menubar_title_down";g_strSkin_Menu_AreaUp="duzon_menubar_title_up";g_strSkin_MenuItem_Default="duzon_menubar_select_item";g_strSkin_MenuItem_Icon_Over="duzon_menubar_select_item_icon_over";g_strSkin_MenuItem_Blank_Over="duzon_menubar_select_item_blank_over";g_strSkin_MenuItem_Caption_Over=
"duzon_menubar_select_item_caption_over";g_strSkin_Separator="duzon_tb_separator";g_strSkin_MenuWin="duzon_context_container";g_strSkin_Button="duzon_tb_button";g_strSkin_Button_Over="duzon_tb_button_over";g_strSkin_Button_Down="duzon_tb_button_down";g_strSkin_Button_Up="duzon_tb_button_up";g_strSkin_DropDown_Area="duzon_tb_dropdown";g_strSkin_DropDown_AreaOver="duzon_tb_dropdown_over";g_strSkin_DropDown_AreaDown="duzon_tb_dropdown_down";g_strSkin_DropDown_AreaUp="duzon_tb_dropdown_up";g_strSkin_DropDown_AreaArrow=
"duzon_tb_dropdown_arrow";g_strSkin_DropDown_AreaArrowOver="duzon_tb_dropdown_arrow_over";g_strSkin_DropDown_AreaArrowDown="duzon_tb_dropdown_arrow_down";g_strSkin_DropDown_AreaArrowUp="duzon_tb_dropdown_arrow_up";g_strSkin_TabMode_AreaDown=g_strSkin_TabMode_AreaOver=g_strSkin_TabMode_Area="duzon_btn_tabmod_area_off";g_strSkin_TabMode_AreaUp="duzon_btn_tabmod_area_on";g_strSkin_ComboBoxWin="duzon_btn_combobox";g_strSkin_ComboBoxItem_Over="duzon_btn_comboboxitem_over";g_strSkin_ComboBoxItem_Out="duzon_btn_comboboxitem_out";
g_strSkin_ComboBoxItem_Down="duzon_btn_comboboxitem_down";g_strSkin_ComboBox_AreaArrow="tbComboBox_AreaArrow";g_strSkin_HandleDiv="dze_tbHandleDiv";g_strSkin_ComboBox_Area="dze_tbComboBox_Area";g_strSkin_ComboBox_AreaOver="dze_tbComboBox_AreaOver";g_strSkin_ComboBox_AreaDown="dze_tbComboBox_AreaDown";g_strSkin_ComboBox_AreaUp="dze_tbComboBox_AreaUp";g_strSkin_SizeBoxBackWin="dze_tbSizeBoxBackWin";g_strSkin_SizeBoxStatus="dze_tbSizeBoxStatus";g_strSkin_SizeBoxCell="dze_tbSizeBoxCell";g_strSkin_ComboBox_Caption=
"tbComboBox_Caption";g_strSkin_ComboBox_AreaArrow="tbComboBox_AreaArrow";g_strSkin_SizeBoxBG="tbSizeBoxBG";g_strSkin_SizeBoxStatusText="tbSizeBoxStatusText"}
function setCustomDisplay(){try{dzeUiConfig.setCustomToolbars();dzeUiConfig.setCustomContextMenus();g_bMenuBar_Display=dzeUiConfig.bCustomize_MenuBar_Display;g_bTabBar_Display=dzeUiConfig.bCustomize_TabBar_Display;g_bRulerbar_Display=dzeUiConfig.bRulerbar;g_bToolBar1_Display=dzeUiConfig.bCustomize_ToolBar1_Display;g_bToolBar2_Display=dzeUiConfig.bCustomize_ToolBar2_Display;g_bToolBar3_Display=dzeUiConfig.bCustomize_ToolBar3_Display;g_arrToolbar1=dzeUiConfig.arrCustomToolbar1;g_arrToolbar2=dzeUiConfig.arrCustomToolbar2;
g_arrToolbar3=dzeUiConfig.arrCustomToolbar3;null!=dzeUiConfig.arrCustomTabBar&&3==dzeUiConfig.arrCustomTabBar.length?(g_arrTabBar=dzeUiConfig.arrCustomTabBar,!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&(g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0)):(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0);for(var b=!1,c=!1,a=0;a<dzeUiConfig.arrContextMenu_General.length;a++)ID_COMMAND_HYPERLINK_INSERT==
dzeUiConfig.arrContextMenu_General[a]?b=!0:ID_COMMAND_HYPERLINK_REMOVE==dzeUiConfig.arrContextMenu_General[a]&&(c=!0);if(b||c)dzeUiConfig.arrContextMenu_Control.push(ID_TYPE_MENU_SEPARATOR),b&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_HYPERLINK_INSERT),c&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_HYPERLINK_REMOVE);dzeUiConfig.arrContextMenu_Control.unshift(ID_TYPE_MENU_SEPARATOR);dzeUiConfig.arrContextMenu_Control.unshift(ID_COMMAND_IMAGE_PROPERTY);"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&
"undefined"!=typeof dzeUiConfig.strImageToTableURL&&1==dzeUiConfig.bUseImageToTableMenu&&""!=dzeUiConfig.strImageToTableURL&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_IMAGE_TO_TABLE);g_arrMenuBar=dzeUiConfig.arrCustomMenuBar;g_nIframeBorderSetting=dzeUiConfig.nCustomIframeBorderSetting;g_nFireFoxLayerSetting_X=dzeUiConfig.nCustomFireFoxLayerSetting_X;g_nFireFoxLayerSetting_Y=dzeUiConfig.nCustomFireFoxLayerSetting_Y;g_bEnableEditHorizontalScroll=dzeUiConfig.bCustomEnableEditHorizontalScroll;
g_strBodyFontFamily=dzeUiConfig.strCustomBodyFontFamily.length?quoteFontFamily(dzeUiConfig.strCustomBodyFontFamily.replace(/["']/g,"")):quoteFontFamily(dzeUiConfig.arrCustomFontName[1].replace(/["']/g,""));g_strBodyFontSize=dzeUiConfig.strCustomBodyFontSize.length?dzeUiConfig.strCustomBodyFontSize:"9pt";g_strBodyFontColor=dzeUiConfig.strCustomBodyFontColor.length?dzeUiConfig.strCustomBodyFontColor:"#000000";g_strBodyLineHeight=dzeUiConfig.strCustomBodyLineHeight.length?dzeUiConfig.strCustomBodyLineHeight:
"1.2";g_strBodyLetterSpacing=dzeUiConfig.strCustomBodyLetterSpacing;g_strPTagMarginTop=dzeUiConfig.strCustomPTagMarginTop.length?dzeUiConfig.strCustomPTagMarginTop:"0px";g_strPTagMarginBottom=dzeUiConfig.strCustomPTagMarginBottom.length?dzeUiConfig.strCustomPTagMarginBottom:"0px";g_nPreviewWindowWidth=dzeUiConfig.nCustomPreviewWindowWidth;g_nPreviewWindowHeight=dzeUiConfig.nCustomPreviewWindowHeight;if(null!=dzeUiConfig.arrCustomFontName&&0<dzeUiConfig.arrCustomFontName.length)for(g_arrFontName=dzeUiConfig.arrCustomFontName,
a=0;a<g_arrFontName.length;a++)g_arrFontName[a]=quoteFontFamily(g_arrFontName[a].replace(/["']/g,""));else g_arrFontName[g_arrFontName.length]="",""!=ID_RES_COOMBOBOX_FONT_NAME_0&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_0),""!=ID_RES_COOMBOBOX_FONT_NAME_1&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_1),""!=ID_RES_COOMBOBOX_FONT_NAME_2&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_2),""!=ID_RES_COOMBOBOX_FONT_NAME_3&&(g_arrFontName[g_arrFontName.length]=
ID_RES_COOMBOBOX_FONT_NAME_3),""!=ID_RES_COOMBOBOX_FONT_NAME_4&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_4),""!=ID_RES_COOMBOBOX_FONT_NAME_5&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_5),""!=ID_RES_COOMBOBOX_FONT_NAME_6&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_6),""!=ID_RES_COOMBOBOX_FONT_NAME_7&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_7),""!=ID_RES_COOMBOBOX_FONT_NAME_8&&(g_arrFontName[g_arrFontName.length]=
ID_RES_COOMBOBOX_FONT_NAME_8),""!=ID_RES_COOMBOBOX_FONT_NAME_9&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_9),""!=ID_RES_COOMBOBOX_FONT_NAME_10&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_10);g_strPreviewCallFunction=dzeUiConfig.strCustomPreviewCallFunction;g_arrAdditionalEditAreaCSS=dzeUiConfig.arrCustomAdditionalEditAreaCSS;g_strAdditionalHeadContent=dzeUiConfig.strCustomAdditionalHeadContent;g_bEditFocusYN=dzeUiConfig.bCustomEditFocusYN;g_bSourceAreaScriptAllowYN=
dzeUiConfig.bCustomSourceAreaScriptAllowYN;g_bSourceAreaIframeAllowYN=dzeUiConfig.bCustomSourceAreaIframeAllowYN;g_bTableOperationYN=dzeUiConfig.bCustomTableOperationYN;g_bTableResizingYN=dzeUiConfig.bCustomTableResizingYN;g_nFormEditMode=dzeUiConfig.nCustomFormEditMode;g_bLockEditCellMode=dzeUiConfig.nCustomLockEditCellMode;g_bEditSourceMode=dzeUiConfig.bCustomEditSourceMode;g_bAnchorTargetBlankYN=dzeUiConfig.bCustomAnchorTargetBlankYN;g_bContentPTagStyleApply=dzeUiConfig.bCustomContentPTagStyleApply;
g_bContentXHTMLFormatYN=dzeUiConfig.bCustomContentXHTMLFormatYN;g_bContentXHTMLTabSettingYN=dzeUiConfig.bCustomContentXHTMLTabSettingYN;g_strAdditionalStyle=g_strCustomAdditionalStyle;g_bConvertPTagToBrTag=dzeUiConfig.bCustomConvertPTagToBrTag;if(0<dzeUiConfig.arrCustomImgSrcRemoveDomain.length)for(g_arrImgSrcRemoveDomain=[],a=0;a<dzeUiConfig.arrCustomImgSrcRemoveDomain.length;a++)g_arrImgSrcRemoveDomain[a]=dzeUiConfig.arrCustomImgSrcRemoveDomain[a].toLowerCase();if(1==dzeUiConfig.autoAddImgSrcRemoveDomain){null==
g_arrImgSrcRemoveDomain&&(g_arrImgSrcRemoveDomain=[]);var d=document.location.href.match(/^(https*:\/\/[a-z0-9-_\.:]*)[\/\?]/i);g_arrImgSrcRemoveDomain.push(d[1])}g_bAnchorHrefRemoveDomainYN=dzeUiConfig.bCustomAnchorHrefRemoveDomainYN;g_bContextMenuUseYN=dzeUiConfig.bCustomContextMenuUseYN;g_bContextMenuDisplayInEditAreaYN=dzeUiConfig.bCustomContextMenuDisplayInEditAreaYN;g_bEditorWidthPercentageYN=dzeUiConfig.bCustomEditorWidthPercentageYN;g_bEditorHeightIFrameYN=dzeUiConfig.bCustomEditorHeightIFrameYN;
g_strTabModeEventFunction=dzeUiConfig.strCustomTabModeEventFunction;g_bSetTableCellBlank=dzeUiConfig.bCustomSetTableCellBlank;g_strFocusEventFunction=dzeUiConfig.strCustomFocusEventFunction;g_bBottomResizeYN=dzeUiConfig.bCustomBottomResizeYN;g_bTableCellResizingYN=dzeUiConfig.bCustomTableCellResizingYN;g_arrAdjustRemoveAttributeName=dzeUiConfig.arrCustomAdjustRemoveAttributeName;g_arrAdjustRemoveStyleName=dzeUiConfig.arrCustomAdjustRemoveStyleName;g_nAdjustFromPtToPxRatio=dzeUiConfig.nCustomAdjustFromPtToPxRatio;
g_bAutoAdjustHwpWordYN=dzeUiConfig.bCustomAutoAdjustHwpWordYN;g_bCheckImgSrcProperty=dzeUiConfig.bCustomCheckImgSrcProperty;g_arrCheckImgSrcPropertyValue=dzeUiConfig.arrCustomCheckImgSrcPropertyValue;g_bEncodeEndCharacterYN=dzeUiConfig.bCustomEncodeEndCharacterYN;g_strDomainPageName=dzeUiConfig.strCustomDomainPageName;g_bEditorHeightReSettingYN=dzeUiConfig.bCustomEditorHeightReSettingYN;g_bAutoIncludeParentCSS=dzeUiConfig.bCustomAutoIncludeParentCSS;g_nOutdentIndentWidth=dzeUiConfig.nCustomOutdentIndentWidth;
g_bAutoBrConvertPTag=dzeUiConfig.bCustomAutoBrConvertPTag;g_arrRemoveGarbageText=dzeUiConfig.arrCustomRemoveGarbageText;if("object"==typeof dzeUiConfig.arrSkinColorSet){for(a=b=0;a<dzeUiConfig.arrSkinColorSet.length;a++)if(dzeEnvConfig.skinColor==dzeUiConfig.arrSkinColorSet[a][0]){b=a;break}g_arrSkinColor=dzeUiConfig.arrSkinColorSet[b];g_objPropertyUtil.setSkinColorSet()}}catch(e){}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_nLetterOperationType=-1,ID_LETTER_OPERATION_FONT_FAMILY=0,ID_LETTER_OPERATION_FONT_SIZE=1,ID_LETTER_OPERATION_FORE_COLOR=2,ID_LETTER_OPERATION_BACK_COLOR=3,ID_LETTER_OPERATION_LETTER_SPACING=4,ID_LETTER_OPERATION_LINE_HEIGHT=5,ID_LETTER_OPERATION_TEXT_DECORATION=6,ID_LETTER_OPERATION_HEADING_SIZE=6,ID_LETTER_OPERATION_OUTDENT_INDENT=7,g_bFindPos_StartLetterOperation=!1,g_bFindPos_EndLetterOperation=!1,g_objLetterFn=new function(){this.nRemoveStyleTransactionCount=0;this.setLetterOperation=function(a,
b,c,d,e){try{var f=(new Date).getTime(),h="S_"+f,g="E_"+f,l=g_objEditorDocument[d];if(window.attachEvent){var k=g_objEditorDocument[d].selection;if(""==c.text){var n=this.isRemove_LetterOperation(a,b);if(!n){var m="T_"+f,u=this.doLetterOperationCreateElement(d,a,b);u.innerHTML="&nbsp;";u.id=m;c.pasteHTML(u.outerHTML);var t=g_objEditorDocument[d].getElementById(m),r=g_objNodeUtil.getParentElement(this.getTopSpanNode(t));this.removeAllDuplicateStyleByLetterOperation(r,d);t=g_objEditorDocument[d].getElementById(m);
t.removeAttribute("id");var v=k.createRange();v.moveToElementText(t);v.moveStart("character",1);v.select();t.innerHTML=""}}else{var q=c.parentElement(),p='<span id="'+h+'"></span>',x='<span id="'+g+'"></span>',C=c.duplicate();C.collapse(!0);C.pasteHTML(p);var A=c.duplicate();A.collapse(!1);for(A.pasteHTML(x);;){var F=!0,H=!0,D=q.innerHTML;-1==D.indexOf(h)&&(F=!1,q=q.parentElement);D=q.innerHTML;-1==D.indexOf(g)&&(H=!1,q=q.parentElement);if(F&&H)break}(n=this.isRemove_LetterOperation(a,b))?this.processRemove_LetterOperation(d,
q,a,h,g):this.processRangeLetterOperation(d,q,a,b,h,g);this.doRemoveStyleLetterOperation(q,a,b);this.removeAllDuplicateStyleByLetterOperation(g_objEditorDocument[d].body,d);for(q=g_objEditorDocument[d].getElementById(h);H=F=!0,D=q.innerHTML,-1==D.indexOf(h)&&(F=!1,q=q.parentElement),D=q.innerHTML,-1==D.indexOf(g)&&(H=!1,q=q.parentElement),!F||!H;);var E=g_objEditorDocument[d].getElementById(h),B=g_objEditorDocument[d].getElementById(g);if(e){var I=k.createRange();I.moveToElementText(E);var z=k.createRange();
z.moveToElementText(B);m=k.createRange();m.moveToElementText(q);m.setEndPoint("StartToStart",I);m.setEndPoint("EndToStart",z);m.select()}var G=g_objNodeUtil.getParentElement(E);if(null!=G){var J=g_objNodeUtil.getParentElement(B);null!=J&&(G.removeChild(E),J.removeChild(B))}}}else if(k=g_objEditWindow[d].getSelection(),!(1<k.rangeCount)){q=!1;var y=c.commonAncestorContainer;c.collapsed||ID_SELECTION_TEXT_NODE==y.nodeType&&(q=!0);if(c.collapsed||g_bBrowserType_IE&&GetMultiCellSelection()&&"<p><br></p>"==
y.innerHTML){k=null;this.isEmptySpan(y)?(k="span"==y.nodeName.toLowerCase()?y:y.parentElement,k.id=f):(k=l.createElement("span"),k.id=f,k.innerHTML=duzon_dialog.dze_bookmark_last_tag,insertHTMLCodeAtSelection(null,k,d));var w=this.getClosetBlockElement(k);"span"==k.parentNode.tagName.toLowerCase()&&(this.copySpanStyle(k,k),g_objNodeUtil.splitOn(w,k));this.isRemove_LetterOperation(a,b)?this.removeSpanStyle(k,a):this.doLetterOperationStyleApply(k,a,b);this.removeAllDuplicateStyleByLetterOperation(w,
d);w.innerHTML=removeZeroWidthSpace(w.innerHTML);k=l.getElementById(f);k.removeAttribute("id");GetMultiCellSelection()||duzon_dialog.setFocusElement(k,d,"end");duzon_dialog.resetSelection=!0}else if(q)if(n=this.isRemove_LetterOperation(a,b))this.setRemove_LetterOperation(a,c,d,h,g,e);else{var N=this.processOnlyTextLetterOperation(d,c,a,b);if(N){for(h=c=N;;)if(h=g_objNodeUtil.getParentElement(h),null!=h)if("span"==h.nodeName.toLowerCase())if(this.removeEmptyChildTextNode(h),1==h.childNodes.length)if(ID_SELECTION_ELEMENT_NODE==
h.childNodes[0].nodeType)c=h;else break;else break;else break;this.doRemoveStyleLetterOperation(c,a,b);this.removeAllDuplicateStyleByLetterOperation(c,d);k.removeAllRanges();if(e){m=g_objEditorDocument[d].createRange();a=c;for(b=!1;!1===b;)if(!1===b&&(a=a.firstChild,a.nodeType===ID_SELECTION_TEXT_NODE)){b=!0;break}!0===b?(m.setStart(a,0),m.setEnd(a,a.nodeValue.length)):m.selectNode(c);k.addRange(m)}}}else{var O=c.startContainer,V=c.startOffset,P=c.endContainer,M=c.endOffset;E=g_objEditorDocument[d].createElement("span");
B=g_objEditorDocument[d].createElement("span");E.id=h;B.id=g;f=!1;if(g_bBrowserType_FF){var T=g_objEditorDocument[d].createElement("div");T.appendChild(c.cloneContents());if(1==T.childNodes.length){f=!0;if(ID_SELECTION_TEXT_NODE==T.childNodes[0].nodeType){N=this.processOnlyTextLetterOperation(d,c,a,b);if(!N)return;k.removeAllRanges();e&&(m=g_objEditorDocument[d].createRange(),m.selectNode(N),k.addRange(m));return}insertHTMLCodeAtSelection(null,B,d);var X=B.parentNode;X.insertBefore(E,B);X.insertBefore(T.childNodes[0],
B)}}if(!f)if(g_bBrowserType_OP){k.removeAllRanges();if(null!=O){for(var Q="",K=null,L=O;;)if(ID_SELECTION_TEXT_NODE==L.nodeType)K=L,L=L.parentNode,Q=K.nodeValue;else break;if(0==V){var W=this.getPositionOffset_OP(K,O,h,!0);if(-1==W)return;V=W}this.insertSpanNodeBetweenTextValue_OP(d,L,K,E,Q,V)}if(null!=P){Q="";K=null;for(L=P;;)if(ID_SELECTION_TEXT_NODE==L.nodeType)K=L,L=L.parentNode,Q=K.nodeValue;else break;if(0==M){var U=this.getPositionOffset_OP(K,P,g,!0);if(-1==U)return;M=U}else{var R=P.nodeValue;
if(1==R.length&&254<R.charCodeAt(0)){U=this.getPositionOffset_OP(K,P,g,!1);if(-1==U)return;M=U}}this.insertSpanNodeBetweenTextValue_OP(d,L,K,B,Q,M)}}else k.removeAllRanges(),A=g_objEditorDocument[d].createRange(),A.setStartBefore(P),A.setEnd(P,M),A.collapse(!1),k.addRange(A),insertHTMLCodeAtSelection(null,B,d),k.removeAllRanges(),C=g_objEditorDocument[d].createRange(),C.setStart(O,V),C.setEndAfter(O),C.collapse(!0),k.addRange(C),insertHTMLCodeAtSelection(null,E,d);for(;!(ID_SELECTION_ELEMENT_NODE==
y.nodeType&&"body"==y.nodeName.toLowerCase()||(H=F=!0,D=y.innerHTML,-1==D.indexOf(h)&&(F=!1,y=y.parentNode),D=y.innerHTML,-1==D.indexOf(g)&&(H=!1,y=y.parentNode),F&&H)););(n=this.isRemove_LetterOperation(a,b))?this.processRemove_LetterOperation(d,y,a,h,g):this.processRangeLetterOperation(d,y,a,b,h,g);this.doRemoveStyleLetterOperation(y,a,b);this.removeAllDuplicateStyleByLetterOperation(y,d);E=g_objEditorDocument[d].getElementById(h);B=g_objEditorDocument[d].getElementById(g);k.removeAllRanges();if(e){m=
g_objEditorDocument[d].createRange();p=E.nextSibling;x=B.previousSibling;!0===fnObjectCheckNull(x)&&(x=B.parentNode);b=a=!1;if(!1===fnObjectCheckNull(p)&&p.nodeType!==ID_SELECTION_TEXT_NODE&&!1===fnObjectCheckNull(x)&&x.nodeType!==ID_SELECTION_TEXT_NODE){a=p.nodeType===ID_SELECTION_TEXT_NODE;for(b=x.nodeType===ID_SELECTION_TEXT_NODE;!1===a;)if(null===p.firstChild){p=p.parentNode;a=!0;break}else if(p=p.firstChild,p.nodeType===ID_SELECTION_TEXT_NODE){a=!0;break}for(;!1===b;)if(null===x.lastChild){x=
x.parentNode;b=!0;break}else if(x=x.lastChild,x.nodeType===ID_SELECTION_TEXT_NODE){b=!0;break}}!0===a&&!0===b?(m.setStart(p,0),m.setEnd(x,x.nodeType===ID_SELECTION_TEXT_NODE?x.nodeValue.length:x.childNodes.length)):(m.setStartAfter(E),m.setEndBefore(B));k.addRange(m)}G=g_objNodeUtil.getParentElement(E);null!=G&&(J=g_objNodeUtil.getParentElement(B),null!=J&&setTimeout(function(){try{G.removeChild(E),J.removeChild(B)}catch(S){}},0))}}}catch(S){g_objCommonUtil.displayErrorAlert(S,"setLetterOperation")}};
this.isRemove_LetterOperation=function(a,b){return""==b&&a==ID_LETTER_OPERATION_FONT_FAMILY||""==b&&a==ID_LETTER_OPERATION_FONT_SIZE||""==b&&a==ID_LETTER_OPERATION_FORE_COLOR||""==b&&a==ID_LETTER_OPERATION_BACK_COLOR||""==b&&a==ID_LETTER_OPERATION_LETTER_SPACING||"string"==typeof b&&""==b&&a==ID_LETTER_OPERATION_LINE_HEIGHT?!0:!1};this.setRemove_LetterOperation=function(a,b,c,d,e,f){try{if(!window.attachEvent){var h=b.commonAncestorContainer,g=g_objEditWindow[c].getSelection(),l=b.collapsed||g_bBrowserType_IE&&
GetMultiCellSelection()&&"<p><br></p>"==h.innerHTML,k=!b.collapsed&&ID_SELECTION_TEXT_NODE==h.nodeType;if(l||k){var n=g_objEditorDocument[c].createElement("span"),m=g_objEditorDocument[c].createElement("span");n.id=d;m.id=e;n.innerHTML="&nbsp;";m.innerHTML="&nbsp;";var u=g_objEditorDocument[c].createElement("span"),t=b.cloneContents();l&&(u.innerHTML=duzon_dialog.dze_bookmark_last_tag);u.appendChild(t);insertHTMLCodeAtSelection(null,m,c);var r=m.parentNode;r.insertBefore(n,m);r.insertBefore(u,m);
this.processRemove_LetterOperation(c,r,a,d,e);r.removeChild(n);r.removeChild(m);this.doRemoveStyleLetterOperation(r,a,"");g.removeAllRanges();if(f){var v=g_objEditorDocument[c].createRange();v.selectNode(u);g.addRange(v)}l&&duzon_dialog.setFocusElement(u,c,"end")}}}catch(q){g_objCommonUtil.displayErrorAlert(q,"setRemove_LetterOperation")}};this.processRemove_LetterOperation=function(a,b,c,d,e){try{for(;this.nodeProcessRemove_LetterOperation(a,b,c,d,e),b=this.checkLoopParentTarget_Remove_LetterOperation(b,
c),null!=b;);}catch(f){g_objCommonUtil.displayErrorAlert(f,"processRemove_LetterOperation")}};this.nodeProcessRemove_LetterOperation=function(a,b,c,d,e){try{var f=this.checkLetterOperationStyleValue(b,c);null!=f&&this.doRemove_Node_LetterOperation(b,c);for(var h=this.paramReAssignLetterOperation(),g=!1,l=!1,k=0;k<b.childNodes.length;k++){var n=b.childNodes[k];g||l?g&&!l?this.isIncludeLoopTargetNode(n,e)?(l=!0,h.bFindTarget=!1,this.recursive_reAssign_LetterOperation(a,n,e,c,f,!1,h)):(this.doRemove_Node_LetterOperation(n,
c),this.doLoopRemove_LetterOperation(n,c)):(g||!l)&&g&&l&&null!=f&&this.reAssign_LetterOperation(a,b,n,c,f):this.isIncludeLoopTargetNode(n,d)?(g=!0,h.bFindTarget=!1,this.recursive_reAssign_LetterOperation(a,n,d,c,f,!0,h),this.isIncludeLoopTargetNode(n,e)?(l=!0,h.bFindTarget=!1,h.bFindSameDepthStart=!0,this.recursive_reAssign_LetterOperation(a,n,e,c,f,!1,h)):this.doLoopRemove_LetterOperation_After(n,c,d,h)):null!=f&&this.reAssign_LetterOperation(a,b,n,c,f)}}catch(m){g_objCommonUtil.displayErrorAlert(m,
"nodeProcessRemove_LetterOperation")}};this.checkLoopParentTarget_Remove_LetterOperation=function(a,b){try{if("body"==a.nodeName.toLowerCase())return null;var c=g_objNodeUtil.getParentElement(a);if(null==c)return null;var d=c.nodeName.toLowerCase();if("p"!=d&&"span"!=d)return null;a="";if(b==ID_LETTER_OPERATION_FONT_FAMILY){if(a=c.style.fontFamily,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_FONT_SIZE){if(a=c.style.fontSize,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_FORE_COLOR){if(a=
c.style.color,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_BACK_COLOR){if(a=c.style.backgroundColor,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_LETTER_SPACING){if(a=c.style.letterSpacing,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_LINE_HEIGHT){a=c.style.lineHeight;a=a.toLowerCase();if("normal"==a)return null;if(null!=a&&""!=a)return c}}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkLoopParentTarget_Remove_LetterOperation")}return null};this.checkLetterOperationStyleValue=
function(a,b){try{if("body"==a.nodeName.toLowerCase())return null;var c="";if(b==ID_LETTER_OPERATION_FONT_FAMILY)return c=a.style.fontFamily,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_FONT_SIZE)return c=a.style.fontSize,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_FORE_COLOR)return c=a.style.color,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_BACK_COLOR)return c=a.style.backgroundColor,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_LETTER_SPACING)return c=a.style.letterSpacing,null==c||
""==c?null:c;if(b==ID_LETTER_OPERATION_LINE_HEIGHT){c=a.style.lineHeight;if(null==c||""==c)return null;c=c.toLowerCase();return"normal"==c?null:c}}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkLetterOperationStyleValue")}return null};this.doRemove_Node_LetterOperation=function(a,b){try{ID_SELECTION_ELEMENT_NODE==a.nodeType&&(b==ID_LETTER_OPERATION_FONT_FAMILY?(a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&
a.style.removeProperty("fontFamily")):b==ID_LETTER_OPERATION_FONT_SIZE?(a.style.fontSize="",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize")):b==ID_LETTER_OPERATION_FORE_COLOR?(a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color")):b==ID_LETTER_OPERATION_BACK_COLOR?(a.style.backgroundColor="",g_bBrowserType_IE?
a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor")):b==ID_LETTER_OPERATION_LETTER_SPACING?(a.style.letterSpacing="",g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing")):b==ID_LETTER_OPERATION_LINE_HEIGHT&&(a.style.lineHeight="",g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight")))}catch(c){g_objCommonUtil.displayErrorAlert(c,"doRemove_Node_LetterOperation")}};this.isIncludeLoopTargetNode=function(a,b){try{if(ID_SELECTION_TEXT_NODE==a.nodeType)return!1;if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&b==a.id)return!0;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType&&(this.isIncludeLoopTargetNode(d,b)||b==d.id))return!0}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"isIncludeLoopTargetNode")}return!1};this.paramReAssignLetterOperation=function(){return{bFindTarget:!1,bFindSameDepthStart:!1,bFindStart_For_Recursive:!1}};this.recursive_reAssign_LetterOperation=function(a,b,c,d,e,f,h){try{if(1!=h.bFindTarget||!f)if(ID_SELECTION_ELEMENT_NODE==b.nodeType&&c==b.id)h.bFindTarget=!0;else{var g=this.checkLetterOperationStyleValue(b,d);null!=g&&(h.bFindSameDepthStart&&!f||this.doRemove_Node_LetterOperation(b,d),e=g);for(g=0;g<b.childNodes.length;g++){var l=b.childNodes[g];
ID_SELECTION_ELEMENT_NODE==l.nodeType?this.recursive_reAssign_LetterOperation(a,l,c,d,e,f,h):ID_SELECTION_TEXT_NODE!=l.nodeType||h.bFindTarget&&f||(h.bFindTarget&&!f?this.reAssign_LetterOperation(a,b,l,d,e):!h.bFindTarget&&f&&this.reAssign_LetterOperation(a,b,l,d,e))}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"recursive_reAssign_LetterOperation")}};this.reAssign_LetterOperation=function(a,b,c,d,e){try{var f=g_objEditorDocument[a].createElement("span");d==ID_LETTER_OPERATION_FONT_FAMILY?f.style.fontFamily=
e:d==ID_LETTER_OPERATION_FONT_SIZE?f.style.fontSize=e:d==ID_LETTER_OPERATION_FORE_COLOR?f.style.color=e:d==ID_LETTER_OPERATION_BACK_COLOR?f.style.backgroundColor=e:d==ID_LETTER_OPERATION_LETTER_SPACING?f.style.letterSpacing=e:d==ID_LETTER_OPERATION_LINE_HEIGHT&&(f.style.lineHeight=e);if(ID_SELECTION_TEXT_NODE==c.nodeType)b.insertBefore(f,c),f.appendChild(c);else{for(;0!=c.childNodes.length;)f.appendChild(c.childNodes[0]);c.appendChild(f)}}catch(h){g_objCommonUtil.displayErrorAlert(h,"reAssign_LetterOperation")}};
this.doLoopRemove_LetterOperation_After=function(a,b,c,d){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&c==a.id)d.bFindStart_For_Recursive=!0;else for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];ID_SELECTION_ELEMENT_NODE==f.nodeType&&(this.doLoopRemove_LetterOperation_After(f,b,c,d),d.bFindStart_For_Recursive&&this.doRemove_Node_LetterOperation(f,b))}}catch(h){g_objCommonUtil.displayErrorAlert(h,"doLoopRemove_LetterOperation_After")}};this.doLoopRemove_LetterOperation=
function(a,b){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==d.nodeType&&(this.doLoopRemove_LetterOperation(d,b),this.removeSpanStyle(d,b))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"doLoopRemove_LetterOperation")}};this.processRemove_MergeAvailableTag=function(a,b){try{for(;this.checkRemove_MergeAvailableNode(a,b););}catch(c){g_objCommonUtil.displayErrorAlert(c,"processRemove_MergeAvailableTag")}};this.checkRemove_MergeAvailableNode=
function(a,b){try{for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(this.checkRemove_MergeAvailableNode(a,d))return!0;if("span"==d.nodeName.toLowerCase()){var e=this.isIncludeSpanNode(d);if(-1!=e&&0!=e&&this.mergeAvailableSpanNode(a,d,c))return!0}}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"checkRemove_MergeAvailableNode")}return!1};this.isIncludeSpanNode=function(a){try{for(var b=0,c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==
d.nodeType)if("span"==d.nodeName.toLowerCase())b++;else return-1}return b}catch(e){g_objCommonUtil.displayErrorAlert(e,"isIncludeSpanNode")}return-1};this.mergeAvailableSpanNode=function(a,b,c){try{var d=g_objNodeUtil.getParentElement(b),e=d.innerHTML,f=g_objEditorDocument[a].createElement("div");f.innerHTML=e;if(d.childNodes.length!=f.childNodes.length)return!1;this.removeChildNode_ExceptOneNode(f,c);if(1!=f.childNodes.length)return!1;c=0;for(var h=f.childNodes[0].childNodes.length,g=g_objEditorDocument[a].createElement("div");!(c>=
h);){var l=g_objEditorDocument[a].createElement("div");l.innerHTML=f.innerHTML;var k=l.childNodes[0];this.removeChildNode_ExceptOneNode(k,c);if(1!=k.childNodes.length||ID_SELECTION_ELEMENT_NODE==k.childNodes[0].nodeType&&!this.doMergeAvailableSpanNode(k))return!1;g.appendChild(k);c++}for(;0!=g.childNodes.length;)d.insertBefore(g.childNodes[0],b);d.removeChild(b);return!0}catch(n){g_objCommonUtil.displayErrorAlert(n,"mergeAvailableSpanNode")}return!1};this.removeChildNode_ExceptOneNode=function(a,
b){try{for(var c=!1,d=0;d<a.childNodes.length;d++)d==b?c=!0:(a.removeChild(a.childNodes[d]),d--,c||b--)}catch(e){g_objCommonUtil.displayErrorAlert(e,"removeChildNode_ExceptOneNode")}};this.doMergeAvailableSpanNode=function(a){try{var b=a.childNodes[0],c=this.findStyleLetterOperation(b);if(null==c)return!1;this.doMergeAvailableAttribute(a,b,c);this.nRemoveStyleTransactionCount=0;var d=a.innerHTML;d=d.toLowerCase();var e=d.indexOf("<span>"),f=d.indexOf("<span style>"),h=d.indexOf('<span style="">');
if(0==e||0==f||0==h){for(;0!=b.childNodes.length;)a.appendChild(b.childNodes[0]);a.removeChild(b)}else return!1;return!0}catch(g){g_objCommonUtil.displayErrorAlert(g,"doMergeAvailableSpanNode")}return!1};this.processRangeLetterOperation=function(a,b,c,d,e,f){try{g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1,this.checkLetterOperationTree(a,b,c,d,e,f)}catch(h){g_objCommonUtil.displayErrorAlert(h,"processRangeLetterOperation")}};this.checkLetterOperationTree=function(a,b,c,d,e,f){try{if(!g_bFindPos_EndLetterOperation&&
null!=b.childNodes){if(ID_SELECTION_ELEMENT_NODE==b.nodeType)if(!g_bFindPos_StartLetterOperation)e==b.id&&(g_bFindPos_StartLetterOperation=!0);else if(f==b.id){g_bFindPos_EndLetterOperation=!0;return}for(var h=0;h<b.childNodes.length;h++){var g=b.childNodes[h];this.checkLetterOperationTree(a,g,c,d,e,f);try{"p"!=g.nodeName.toLowerCase()||"<br>"!=g.innerHTML&&"<br/>"!=g.innerHTML&&"<br />"!=g.innerHTML&&g.childNodes.length||(g.innerHTML=duzon_dialog.dze_bookmark_last_tag,this.checkLetterOperationTree(a,
g,c,d,e,f))}catch(p){}if(g_bFindPos_EndLetterOperation)break;if(g_bFindPos_StartLetterOperation&&ID_SELECTION_TEXT_NODE==g.nodeType){var l=!0;""==g.nodeValue&&(l=!1);checkTextNodeAllWhiteCode_Plus_Space(g.nodeValue)&&(l=!1);if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var k=g.nodeValue;try{if(g_bBrowserType_FF||g_bBrowserType_WK){if(1==k.length){var n=k.charCodeAt(0);if(10==n||13==n)l=!1}}else g_bBrowserType_OP&&2>=k.length&&(n=k.charCodeAt(0),10==n||13==n)&&(l=!1)}catch(p){}}if(l){var m=
this.doLetterOperationApply(a,g,c,d);if(m){if("span"===b.nodeName.toLowerCase())var u=this.getTextDecorationFromStyle(b);if(!1===fnObjectCheckNull(u)&&(0<=u.indexOf("underline")||0<=u.indexOf("line-through")))for(this.removeSpanStyle(b,ID_LETTER_OPERATION_TEXT_DECORATION),l=0;l<b.childNodes.length;l++){var t=b.childNodes[l];if(t.nodeType===ID_SELECTION_TEXT_NODE){if(0!==t.nodeValue.length)if(t===g)m.style.textDecoration=u,b.insertBefore(m,t),m.appendChild(b.childNodes[l+1]);else{var r=g_objEditorDocument[a].createElement("span");
r.style.textDecoration=u;b.insertBefore(r,t);r.appendChild(b.childNodes[l+1])}}else if("span"!==t.nodeName.toLowerCase()||t.id!==e&&t.id!==f){var v=this.getTextDecorationFromStyle(t);t.style.textDecoration=null!==v&&0<v.length?t.style.textDecoration+(" "+u):u}}else b.insertBefore(m,g),m.appendChild(g);if(c==ID_LETTER_OPERATION_FONT_SIZE||c==ID_LETTER_OPERATION_FORE_COLOR){var q=g_objNodeUtil.getLoopParentElement(m,"li");null!=q&&(c==ID_LETTER_OPERATION_FONT_SIZE&&(q.style.fontSize=d),c==ID_LETTER_OPERATION_FORE_COLOR&&
(q.style.color=d))}}}}}}}catch(p){g_objCommonUtil.displayErrorAlert(p,"checkLetterOperationTree")}};this.doLetterOperationApply=function(a,b,c,d){try{return ID_SELECTION_TEXT_NODE!=b.nodeType?null:this.doLetterOperationCreateElement(a,c,d)}catch(e){g_objCommonUtil.displayErrorAlert(e,"doLetterOperationApply")}return null};this.doLetterOperationCreateElement=function(a,b,c){try{var d=g_objEditorDocument[a].createElement("span");return this.doLetterOperationStyleApply(d,b,c)?d:null}catch(e){g_objCommonUtil.displayErrorAlert(e,
"doLetterOperationCreateElement")}return null};this.doLetterOperationStyleApply=function(a,b,c){try{if(b==ID_LETTER_OPERATION_FONT_FAMILY)a.style.fontFamily=c;else if(b==ID_LETTER_OPERATION_FONT_SIZE)a.style.fontSize=c;else if(b==ID_LETTER_OPERATION_FORE_COLOR)a.style.color=c;else if(b==ID_LETTER_OPERATION_BACK_COLOR)a.style.backgroundColor=c;else if(b==ID_LETTER_OPERATION_LETTER_SPACING)a.style.letterSpacing=c;else if(b==ID_LETTER_OPERATION_LINE_HEIGHT)a.style.lineHeight=c;else return!1;return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,
"doLetterOperationStyleApply")}return!1};this.removeSpanStyle=function(a,b){try{if(b==ID_LETTER_OPERATION_FONT_FAMILY)a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontFamily");else if(b==ID_LETTER_OPERATION_FONT_SIZE)a.style.fontSize="",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize");
else if(b==ID_LETTER_OPERATION_FORE_COLOR)a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color");else if(b==ID_LETTER_OPERATION_BACK_COLOR)a.style.backgroundColor="",g_bBrowserType_IE?a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor");else if(b==ID_LETTER_OPERATION_LETTER_SPACING)a.style.letterSpacing="",
g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing");else if(b==ID_LETTER_OPERATION_LINE_HEIGHT)a.style.lineHeight="",g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight");else if(b===ID_LETTER_OPERATION_TEXT_DECORATION)if(g_bBrowserType_IE)a.style.removeAttribute("text-decoration"),a.style.removeAttribute("text-decoration-line");
else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)a.style.removeProperty("text-decoration"),a.style.removeProperty("text-decoration-line")}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeSpanStyle")}};this.doRemoveStyleLetterOperation=function(a,b,c){try{this.nRemoveStyleTransactionCount=0;var d=this.paramCheckLetterOperation();for(b=!1;g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1,this.doRemoveStyleChildLetterOperationTree(a,0,d),0!=this.nRemoveStyleTransactionCount;)this.nRemoveStyleTransactionCount=
0,d.textValue=null,d.textDepth=0,b=!0;return b}catch(e){g_objCommonUtil.displayErrorAlert(e,"doRemoveStyleLetterOperation")}return!1};this.paramCheckLetterOperation=function(){return{textValue:null,textDepth:0}};this.doRemoveStyleChildLetterOperationTree=function(a,b,c){try{if(null!=a.childNodes)if(b++,null==a.childNodes)c.textValue=null,c.textDepth=0;else if(0==a.childNodes.length&&ID_SELECTION_TEXT_NODE==a.nodeType)c.textValue=a.nodeValue,c.textDepth=b;else{this.removeEmptyChildTextNode(a);for(var d=
0;d<a.childNodes.length;d++){var e=a.childNodes[d];this.doRemoveStyleChildLetterOperationTree(e,b,c);if(null!=c.textValue)if(1==a.childNodes.length&&ID_SELECTION_ELEMENT_NODE==a.nodeType){var f=!1;if("span"==a.nodeName.toLowerCase()){if(b==c.textDepth-2){var h=this.findStyleLetterOperation(e);if(null!=h){this.doMergeAvailableAttribute(a,e,h);var g=a.innerHTML;g=g.toLowerCase();var l=g.indexOf("<span>"),k=g.indexOf("<span style>"),n=g.indexOf('<span style="">');if(0==l||0==k||0==n)f=!0,a.nodeValue=
c.textValue,c.textDepth=b+1}f||(c.textValue=null,c.textDepth=0)}}else c.textValue=null,c.textDepth=0}else c.textValue=null,c.textDepth=0}this.mergeChildAllSpanNode(a)}}catch(m){g_objCommonUtil.displayErrorAlert(m,"doRemoveStyleChildLetterOperationTree")}};this.mergeChildAllSpanNode=function(a){try{if(!(1>=a.childNodes.length)){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE!=d.nodeType||"span"!=d.nodeName.toLowerCase()||1!=d.childNodes.length||ID_SELECTION_TEXT_NODE!=
d.childNodes[0].nodeType)return;b[c]=this.findStyleLetterOperation(d)}if(!(a.childNodes.length!=b.length||1>=b.length)){var e=b[0].strValue_FontFamily,f=b[0].strValue_FontSize,h=b[0].strValue_Color,g=b[0].strValue_BackgroundColor,l=b[0].strValue_LetterSpacing,k=b[0].strValue_LineHeight;for(c=1;c<b.length;c++)if(e!=b[c].strValue_FontFamily||f!=b[c].strValue_FontSize||h!=b[c].strValue_Color||g!=b[c].strValue_BackgroundColor||l!=b[c].strValue_LetterSpacing||k!=b[c].strValue_LineHeight)return;var n=a.innerHTML,
m=g_objEditorDocument[g_nActiveEditNumber].createElement("div");m.innerHTML=n;if(a.childNodes.length==m.childNodes.length){c=!0;var u=g_objEditorDocument[g_nActiveEditNumber].createElement("span");for(u.innerHTML="&nbsp;";0!=m.childNodes.length;){d=m.childNodes[0];var t=g_objEditorDocument[g_nActiveEditNumber].createElement("div");t.appendChild(d);c?(u.childNodes[0].nodeValue=d.childNodes[0].nodeValue,c=!1):u.childNodes[0].nodeValue+=d.childNodes[0].nodeValue;b[0].bFontFamily&&(t.childNodes[0].style.fontFamily=
"",g_bBrowserType_IE&&d.style.removeAttribute("fontFamily"));b[0].bFontSize&&(t.childNodes[0].style.fontSize="",g_bBrowserType_IE&&d.style.removeAttribute("fontSize"));b[0].bColor&&(t.childNodes[0].style.color="",g_bBrowserType_IE&&d.style.removeAttribute("color"));b[0].bBackgroundColor&&(t.childNodes[0].style.backgroundColor="",g_bBrowserType_IE&&d.style.removeAttribute("backgroundColor"));b[0].bLetterSpacing&&(t.childNodes[0].style.letterSpacing="",g_bBrowserType_IE&&d.style.removeAttribute("letterSpacing"));
b[0].bLineHeight&&(t.childNodes[0].style.lineHeight="",g_bBrowserType_IE&&d.style.removeAttribute("lineHeight"));var r=t.innerHTML;r=r.toLowerCase();var v=r.indexOf("<span>"),q=r.indexOf("<span style>"),p=r.indexOf('<span style="">');if(0!=v&&0!=q&&0!=p)return}for(;1!=a.childNodes.length;)a.removeChild(a.childNodes[1]);a.childNodes[0].innerHTML="&nbsp;";a.childNodes[0].replaceChild(u.childNodes[0],a.childNodes[0].childNodes[0])}}}}catch(x){g_objCommonUtil.displayErrorAlert(x,"mergeChildAllSpanNode")}};
this.removeEmptyChildTextNode=function(a){try{if("span"==a.nodeName.toLowerCase())for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];ID_SELECTION_TEXT_NODE==c.nodeType&&""==c.nodeValue&&(a.removeChild(c),b=-1)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"removeEmptyChildTextNode")}};this.removeAllDuplicateStyleByLetterOperation=function(a,b){try{for(this.processRemove_MergeAvailableTag(b,a);this.doRemoveStyleLetterOperation(a,null,null););removeChildNode_AllWhiteCode(a);g_objAdjustDoc.processGarbageEmptyTag(a,
!0,b);removeGabageEmptyTag(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeAllDuplicateStyleByLetterOperation")}};this.findStyleLetterOperation=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&"span"==a.nodeName.toLowerCase()){var b={bFontFamily:!1,bFontSize:!1,bColor:!1,bBackgroundColor:!1,bLetterSpacing:!1,bLineHeight:!1,strValue_FontFamily:"",strValue_FontSize:"",strValue_Color:"",strValue_BackgroundColor:"",strValue_LetterSpacing:"",strValue_LineHeight:""},c=a.style.fontFamily,
d=a.style.fontSize,e=a.style.color,f=a.style.backgroundColor,h=a.style.letterSpacing,g=a.style.lineHeight;null!=c&&""!=c&&(b.bFontFamily=!0,b.strValue_FontFamily=c);null!=d&&""!=d&&(b.bFontSize=!0,b.strValue_FontSize=d);null!=e&&""!=e&&(b.bColor=!0,b.strValue_Color=e);null!=f&&""!=f&&(b.bBackgroundColor=!0,b.strValue_BackgroundColor=f);null!=h&&""!=h&&(b.bLetterSpacing=!0,b.strValue_LetterSpacing=h);null!=g&&""!=g&&(b.bLineHeight=!0,b.strValue_LineHeight=g);return b}}catch(l){g_objCommonUtil.displayErrorAlert(l,
"findStyleLetterOperation")}return null};this.doMergeAvailableAttribute=function(a,b,c){try{c.bFontFamily&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_FONT_FAMILY,b.style.fontFamily),b.style.fontFamily="",g_bBrowserType_IE?b.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("fontFamily"),this.nRemoveStyleTransactionCount++),c.bFontSize&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_FONT_SIZE,b.style.fontSize),
b.style.fontSize="",g_bBrowserType_IE?b.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("fontSize"),this.nRemoveStyleTransactionCount++),c.bColor&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_FORE_COLOR,b.style.color),b.style.color="",g_bBrowserType_IE?b.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("color"),this.nRemoveStyleTransactionCount++),c.bBackgroundColor&&
(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_BACK_COLOR,b.style.backgroundColor),b.style.backgroundColor="",g_bBrowserType_IE?b.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("backgroundColor"),this.nRemoveStyleTransactionCount++),c.bLetterSpacing&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_LETTER_SPACING,b.style.letterSpacing),b.style.letterSpacing="",g_bBrowserType_IE?b.style.removeAttribute("letterSpacing"):
(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("letterSpacing"),this.nRemoveStyleTransactionCount++),c.bLineHeight&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_LINE_HEIGHT,b.style.lineHeight),b.style.lineHeight="",g_bBrowserType_IE?b.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("lineHeight"),this.nRemoveStyleTransactionCount++)}catch(d){g_objCommonUtil.displayErrorAlert(d,"doMergeAvailableAttribute")}};
this.processOnlyTextLetterOperation=function(a,b,c,d){try{if(window.attachEvent)return null;var e=g_objEditorDocument[a].createElement("span"),f=g_objNodeUtil.getLoopParentElement(b.commonAncestorContainer,"span");if(!1===fnObjectCheckNull(f))var h=this.getTextDecorationFromStyle(f);if(!1===fnObjectCheckNull(h)&&(0<=h.indexOf("underline")||0<=h.indexOf("line-through")))if(this.removeSpanStyle(f,ID_LETTER_OPERATION_TEXT_DECORATION),0<b.startOffset||b.endOffset!==b.endContainer.length){g_objNodeUtil.splitTextNodeByOffset(b);
var g=b.commonAncestorContainer;for(b=0;b<f.childNodes.length;b++){var l=f.childNodes[b];var k=g_objEditorDocument[a].createElement("span");k.style.textDecoration=h;l===g&&(e=k);f.insertBefore(k,l);k.appendChild(f.childNodes[b+1])}}else e.style.textDecoration=h,e.appendChild(b.cloneContents());else e.appendChild(b.cloneContents());if(!this.doLetterOperationStyleApply(e,c,d))return null;insertHTMLCodeAtSelection(null,e,a);var n=g_objNodeUtil.getParentElement(e);this.removeEmptyChildTextNode_For_processOnlyTextLetterOperation(n);
return e}catch(m){g_objCommonUtil.displayErrorAlert(m,"processOnlyTextLetterOperation")}return null};this.removeEmptyChildTextNode_For_processOnlyTextLetterOperation=function(a){try{for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];ID_SELECTION_TEXT_NODE==c.nodeType&&""==c.nodeValue&&(a.removeChild(c),b=-1)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"removeEmptyChildTextNode_For_processOnlyTextLetterOperation")}};this.getPositionOffset_OP=function(a,b,c,d){try{var e=b.nodeValue;b.nodeValue=
d?c+e:e+c;var f=a.nodeValue,h=f.indexOf(c);if(-1==h)return b.nodeValue=e,-1;var g=f.substr(0,h),l=f.substr(h+c.length);a.nodeValue=g+l;return h}catch(k){g_objCommonUtil.displayErrorAlert(k,"getPositionOffset_OP")}return-1};this.insertSpanNodeBetweenTextValue_OP=function(a,b,c,d,e,f){try{var h=e.substr(0,f),g=e.substr(f),l=g_objEditorDocument[a].createTextNode(h),k=g_objEditorDocument[a].createTextNode(g);b.insertBefore(l,c);b.insertBefore(d,c);b.insertBefore(k,c);b.removeChild(c)}catch(n){g_objCommonUtil.displayErrorAlert(n,
"insertSpanNodeBetweenTextValue_OP")}};this.setLetterOperation_HeadingSize=function(a,b,c){try{if(0==a){var d=g_objNodeUtil.getAncestorNodeOnCaret(c);if(d){var e=g_objNodeUtil.getLoopParentElement(d,"ol");e||(e=g_objNodeUtil.getLoopParentElement(d,"ul"));if(e){alert(ID_RES_CONST_MSG_ALERT_NO_SUPPORT_IN_LIST);return}}}"object"==typeof b&&(a="firstlineIndent"==b.name?3:2);if(0==a||1==a||2==a||3==a){this.setAlignOperation(ID_COMMAND_JUSTIFY_CENTER,"",!1,c,!0);var f=(new Date).getTime();e="S_"+f;f="E_"+
f;if(window.attachEvent){var h=g_objEditorDocument[c].selection,g=h.createRange();d=g.parentElement();var l=this.getTextRangePos(h,d,g);if(null==l)return;var k=l.nEndRangePos-l.nStartRangePos;d='<span id="'+e+'"></span>';var n='<span id="'+f+'"></span>',m=g.duplicate();m.collapse(!0);m.pasteHTML(d);var u=g.duplicate();u.collapse(!1);u.pasteHTML(n);0==a?this.doLoop_Node_Heading(g_objEditorDocument[c].body,b,c):1==a?this.doLoop_Node_Outdent_Indent(g_objEditorDocument[c].body,b,c):2==a?this.doLoop_Node_Margin(g_objEditorDocument[c].body,
b,c):3==a&&doLoop_Node_FistLineIndent(g_objEditorDocument[c].body,b,c);var t=g_objEditorDocument[c].getElementById(e),r=g_objEditorDocument[c].getElementById(f),v=h.createRange();v.moveToElementText(t);v.collapse(!0);v.moveStart("character",0);v.moveEnd("character",k);v.select();var q=g_objNodeUtil.getParentElement(t);null!=q&&q.removeChild(t);var p=g_objNodeUtil.getParentElement(r)}else{h=g_objEditWindow[c].getSelection();if(1!=h.rangeCount)return;g=h.getRangeAt(0);k=!1;d=g.commonAncestorContainer;
g.collapsed?k=!0:ID_SELECTION_TEXT_NODE==d.nodeType&&(k=!0);if(k){t=g_objEditorDocument[c].createElement("span");r=g_objEditorDocument[c].createElement("span");t.id=e;r.id=f;g_bBrowserType_OP&&(t.innerHTML="&nbsp;",r.innerHTML="&nbsp;");n=g_objEditorDocument[c].createElement("span");n.appendChild(g.cloneContents());var x=g_objEditorDocument[c].createTextNode(n.textContent);insertHTMLCodeAtSelection(null,r,c);var C=r.parentNode;C.insertBefore(t,r);C.insertBefore(x,r)}else{var A=g.startContainer,F=
g.startOffset,H=g.endContainer,D=g.endOffset;t=g_objEditorDocument[c].createElement("span");r=g_objEditorDocument[c].createElement("span");t.id=e;r.id=f;g_bBrowserType_OP&&(t.innerHTML="&nbsp;",r.innerHTML="&nbsp;");h.removeAllRanges();u=g_objEditorDocument[c].createRange();u.setStartBefore(H);u.setEnd(H,D);u.collapse(!1);h.addRange(u);insertHTMLCodeAtSelection(null,r,c);h.removeAllRanges();m=g_objEditorDocument[c].createRange();m.setStart(A,F);m.setEndAfter(A);m.collapse(!0);h.addRange(m);insertHTMLCodeAtSelection(null,
t,c)}0==a?this.doLoop_Node_Heading(g_objEditorDocument[c].body,b,c):1==a?this.doLoop_Node_Outdent_Indent(g_objEditorDocument[c].body,b,c):2==a?this.doLoop_Node_Margin(g_objEditorDocument[c].body,b,c):3==a&&doLoop_Node_FistLineIndent(g_objEditorDocument[c].body,b,c);h.removeAllRanges();v=g_objEditorDocument[c].createRange();v.setStartAfter(t);v.setEndBefore(r);h.addRange(v);q=g_objNodeUtil.getParentElement(t);null!=q&&q.removeChild(t);p=g_objNodeUtil.getParentElement(r)}null!=p&&p.removeChild(r)}}catch(E){g_objCommonUtil.displayErrorAlert(E,
"setLetterOperation_HeadingSize")}};this.doLoop_Node_Heading=function(a,b,c){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];ID_SELECTION_ELEMENT_NODE==e.nodeType&&(this.doLoop_Node_Heading(e,b,c),this.setNodeHeadingValue(e,b,c))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"doLoop_Node_Heading")}};this.setNodeHeadingValue=function(a,b,c){try{if("1"==a.getAttribute("cusHead")){var d=!1;""==b&&(d=!0);var e=a.nodeName.toLowerCase();"h1"==e||"h2"==
e||"h3"==e||"h4"==e||"h5"==e||"h6"==e?d?this.replaceHeadingBlockNode(b,a,c):b==e?a.removeAttribute("cusHead"):(this.doLoopRemove_LetterOperation(a,ID_LETTER_OPERATION_FONT_SIZE),this.replaceHeadingBlockNode(b,a,c)):"p"==e&&(d?a.removeAttribute("cusHead"):(this.doLoopRemove_LetterOperation(a,ID_LETTER_OPERATION_FONT_SIZE),this.replaceHeadingBlockNode(b,a,c)))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setNodeHeadingValue")}};this.replaceHeadingBlockNode=function(a,b,c){try{if(null!=b){var d=a;
""==a&&(d="p");var e=g_objNodeUtil.getParentElement(b),f=g_objEditorDocument[c].createElement(d);for(e.insertBefore(f,b);0!=b.childNodes.length;)f.appendChild(b.childNodes[0]);var h=g_objPropertyUtil.getElement_TextAlign(b);null!=h&&""!=h&&(f.style.textAlign=h);e.removeChild(b)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"replaceHeadingBlockNode")}};this.getTopSpanNode=function(a){try{for(;;){var b=g_objNodeUtil.getParentElement(a);if("span"!=g_objNodeUtil.getElementTagName(b).toLowerCase())break;
a=b}return a}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTopSpanNode")}return null};this.setAlignOperation=function(a,b,c,d,e){try{var f="";if(!c)if(a==ID_COMMAND_JUSTIFY_LEFT)f="left";else if(a==ID_COMMAND_JUSTIFY_CENTER)f="center";else if(a==ID_COMMAND_JUSTIFY_RIGHT)f="right";else if(a==ID_COMMAND_JUSTIFY_JUSTIFY)f="justify";else return;var h=(new Date).getTime();a="S_"+h;h="E_"+h;if(window.attachEvent){var g=g_objEditorDocument[d].selection,l=g.createRange(),k=l.parentElement();if(""==l.text){var n=
null,m=k.nodeName.toLowerCase();if("body"==m)n=k;else if(g_objNodeUtil.checkIsAlignAvailableNode(m))n=k;else{var u=g_objNodeUtil.getLoop_ParentAlignElement(k);if(null==u)return;n=u}var t=this.checkIncludeAlignAvailableNode(n);if(t){l.pasteHTML('<span id="'+a+'">&nbsp;</span>');var r=this.getPosBlockTypeCount(n,a);if(-1==r)return;var v=this.separateAlignBlockNode(n,r,d);if(null==v)return;this.setNodeAlignValue(v,f,e);var q=g_objEditorDocument[d].getElementById(a),p=g.createRange();p.moveToElementText(q);
p.moveStart("character",1);p.select();var x=g_objNodeUtil.getParentElement(q);null!=x&&x.removeChild(q)}else this.setTextOnlyAlignOperation(k,b,f,c,d,e)}else{var C=!1,A={bDoOperation:!1,bSeparateBlock:!1};if(this.checkIncludeAlignAvailableNode(k)){var F=this.getTextRangePos(g,k,l);if(null==F)return;var H=F.nEndRangePos-F.nStartRangePos;var D='<span id="'+a+'"></span>';var E='<span id="'+h+'"></span>',B=l.duplicate();B.collapse(!0);B.pasteHTML(D);var I=l.duplicate();I.collapse(!1);I.pasteHTML(E);A.bSeparateBlock=
!1;this.doLoop_separateAlignBlock(k,A,d);q=g_objEditorDocument[d].getElementById(a);var z=g_objEditorDocument[d].getElementById(h);p=g.createRange();p.moveToElementText(q);p.collapse(!0);p.moveStart("character",0);p.moveEnd("character",H);p.select();x=g_objNodeUtil.getParentElement(q);null!=x&&x.removeChild(q);var G=g_objNodeUtil.getParentElement(z);null!=G&&G.removeChild(z);l=p}for(var J=0,y=0;y<k.childNodes.length;y++){var w=k.childNodes[y];if((ID_SELECTION_ELEMENT_NODE==w.nodeType||ID_SELECTION_TEXT_NODE==
w.nodeType)&&ID_SELECTION_ELEMENT_NODE==w.nodeType){var N=g.createRange();N.moveToElementText(w);N.collapse(!0);var O=g.createRange();O.moveToElementText(w);O.collapse(!1);var V=l.inRange(N),P=l.inRange(O);if(C)if(V)A.bDoOperation=!1,this.doLoop_AlignOperation(w,l,null,f,A,d,e),A.bDoOperation&&J++;else break;else P&&(A.bDoOperation=!1,this.doLoop_AlignOperation(w,l,null,f,A,d,e),A.bDoOperation&&J++,C=!0)}}if(C)0==J&&(m=k.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(m)&&this.setNodeAlignValue(k,
f,e));else{n=null;m=k.nodeName.toLowerCase();if("body"==m)n=k;else if(g_objNodeUtil.checkIsAlignAvailableNode(m))n=k;else{u=g_objNodeUtil.getLoop_ParentAlignElement(k);if(null==u)return;n=u}if(t=this.checkIncludeAlignAvailableNode(n)){F=this.getTextRangePos(g,k,l);if(null==F)return;H=F.nEndRangePos-F.nStartRangePos;D='<span id="'+a+'"></span>';E='<span id="'+h+'"></span>';B=l.duplicate();B.collapse(!0);B.pasteHTML(D);I=l.duplicate();I.collapse(!1);I.pasteHTML(E);for(y=0;y<n.childNodes.length;y++)if(w=
n.childNodes[y],ID_SELECTION_ELEMENT_NODE==w.nodeType){var M=w.nodeName.toLowerCase();if(g_objNodeUtil.checkIsAlignAvailableNode(M)&&this.doLoop_CheckTempSpanNode(w,a)){this.setNodeAlignValue(w,f,e);break}}q=g_objEditorDocument[d].getElementById(a);z=g_objEditorDocument[d].getElementById(h);p=g.createRange();p.moveToElementText(q);p.collapse(!0);p.moveStart("character",0);p.moveEnd("character",H);p.select();x=g_objNodeUtil.getParentElement(q);null!=x&&x.removeChild(q);G=g_objNodeUtil.getParentElement(z);
null!=G&&G.removeChild(z)}else this.setTextOnlyAlignOperation(k,b,f,c,d,e)}}}else{g=g_objEditWindow[d].getSelection();if(1!=g.rangeCount)return;l=g.getRangeAt(0);D=!1;k=l.commonAncestorContainer;l.collapsed?D=!0:ID_SELECTION_TEXT_NODE==k.nodeType&&(D=!0);if(D){if(ID_SELECTION_ELEMENT_NODE==k.nodeType&&(m=k.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(m))){this.setNodeAlignValue(k,f,e);return}u=g_objNodeUtil.getLoop_ParentAlignElement(k);if(null==u)return;n=u;if(t=this.checkIncludeAlignAvailableNode(n)){q=
g_objEditorDocument[d].createElement("span");z=g_objEditorDocument[d].createElement("span");q.id=a;z.id=h;g_bBrowserType_OP&&(q.innerHTML="&nbsp;",z.innerHTML="&nbsp;");var T=g_objEditorDocument[d].createElement("span");T.appendChild(l.cloneContents());var X=g_objEditorDocument[d].createTextNode(T.textContent);insertHTMLCodeAtSelection(null,z,d);var Q=z.parentNode;Q.insertBefore(q,z);Q.insertBefore(X,z);r=this.getPosBlockTypeCount(n,a);if(-1==r)return;v=this.separateAlignBlockNode(n,r,d);if(null==
v)return;this.setNodeAlignValue(v,f,e);g.removeAllRanges();p=g_objEditorDocument[d].createRange();p.setStartAfter(q);p.setEndBefore(z);g.addRange(p);x=g_objNodeUtil.getParentElement(q);null!=x&&x.removeChild(q);G=g_objNodeUtil.getParentElement(z);null!=G&&G.removeChild(z)}else this.setTextOnlyAlignOperation(k,b,f,c,d,e)}else{var K=l.startContainer,L=l.startOffset,W=l.endContainer,U=l.endOffset;z=q=null;if(t=this.checkIncludeAlignAvailableNode(k))q=g_objEditorDocument[d].createElement("span"),z=g_objEditorDocument[d].createElement("span"),
q.id=a,z.id=h,g_bBrowserType_OP&&(q.innerHTML="&nbsp;",z.innerHTML="&nbsp;"),g.removeAllRanges(),I=g_objEditorDocument[d].createRange(),I.setStartBefore(W),I.setEnd(W,U),I.collapse(!1),g.addRange(I),insertHTMLCodeAtSelection(null,z,d),g.removeAllRanges(),B=g_objEditorDocument[d].createRange(),B.setStart(K,L),B.setEndAfter(K),B.collapse(!0),g.addRange(B),insertHTMLCodeAtSelection(null,q,d),g.removeAllRanges(),p=g_objEditorDocument[d].createRange(),p.setStartAfter(q),p.setEndBefore(z),g.addRange(p),
l=g.getRangeAt(0),k=l.commonAncestorContainer;if(g_objNodeUtil.check_is_CM_INLINE(k.nodeName.toLowerCase())){u=g_objNodeUtil.getLoop_ParentAlignElement(k);if(null==u)return;k=u}var R=g_objEditorDocument[d].createRange();C=!1;A={bDoOperation:!1,bSeparateBlock:!1};for(y=r=J=0;y<k.childNodes.length;y++)if(w=k.childNodes[y],ID_SELECTION_ELEMENT_NODE==w.nodeType||ID_SELECTION_TEXT_NODE==w.nodeType)if(b=M=null,ID_SELECTION_ELEMENT_NODE==w.nodeType&&(M=w.nodeName.toLowerCase(),(b=g_objNodeUtil.check_is_CM_INLINE(M))||
r++),R.selectNode(w),C)if(S=l.compareBoundaryPoints(Range.START_TO_END,R),0==S||-1==S)break;else if(ID_SELECTION_ELEMENT_NODE==w.nodeType){if(w.id!=a&&w.id!=h)if(b&&t)v=this.separateAlignBlockNode(k,r,d),null!=v&&(g.removeAllRanges(),p=g_objEditorDocument[d].createRange(),p.setStartAfter(q),p.setEndBefore(z),g.addRange(p),l=g.getRangeAt(0),r=0,C=!1,y=-1);else{if(t&&(A.bSeparateBlock=!1,this.doLoop_separateAlignBlock(w,A,d),A.bSeparateBlock)){q=g_objEditorDocument[d].getElementById(a);z=g_objEditorDocument[d].getElementById(h);
g.removeAllRanges();p=g_objEditorDocument[d].createRange();p.setStartAfter(q);p.setEndBefore(z);g.addRange(p);l=g.getRangeAt(0);r=0;C=!1;y=-1;continue}A.bDoOperation=!1;this.doLoop_AlignOperation(w,l,R,f,A,d,e);A.bDoOperation&&J++}}else ID_SELECTION_TEXT_NODE!=w.nodeType||c||!t||checkTextNodeAllWhiteCode_Plus_Space(w.nodeValue)||(v=this.separateAlignBlockNode(k,r,d),null!=v&&(g.removeAllRanges(),p=g_objEditorDocument[d].createRange(),p.setStartAfter(q),p.setEndBefore(z),g.addRange(p),l=g.getRangeAt(0),
r=0,C=!1,y=-1));else{var S=l.compareBoundaryPoints(Range.END_TO_START,R);if(0==S||-1==S){if(ID_SELECTION_ELEMENT_NODE==w.nodeType){if(w.id==a||w.id==h)continue;if(b&&t){v=this.separateAlignBlockNode(k,r,d);if(null==v)continue;g.removeAllRanges();p=g_objEditorDocument[d].createRange();p.setStartAfter(q);p.setEndBefore(z);g.addRange(p);l=g.getRangeAt(0);r=0;C=!1;y=-1;continue}if(t&&(A.bSeparateBlock=!1,this.doLoop_separateAlignBlock(w,A,d),A.bSeparateBlock)){q=g_objEditorDocument[d].getElementById(a);
z=g_objEditorDocument[d].getElementById(h);g.removeAllRanges();p=g_objEditorDocument[d].createRange();p.setStartAfter(q);p.setEndBefore(z);g.addRange(p);l=g.getRangeAt(0);r=0;C=!1;y=-1;continue}A.bDoOperation=!1;this.doLoop_AlignOperation(w,l,R,f,A,d,e);A.bDoOperation&&J++}else if(ID_SELECTION_TEXT_NODE==w.nodeType){if(c)continue;if(!t)continue;if(!checkTextNodeAllWhiteCode_Plus_Space(w.nodeValue)){v=this.separateAlignBlockNode(k,r,d);if(null==v)continue;g.removeAllRanges();p=g_objEditorDocument[d].createRange();
p.setStartAfter(q);p.setEndBefore(z);g.addRange(p);l=g.getRangeAt(0);r=0;C=!1;y=-1;continue}}C=!0}}t&&(x=g_objNodeUtil.getParentElement(q),null!=x&&x.removeChild(q),G=g_objNodeUtil.getParentElement(z),null!=G&&G.removeChild(z));0==J&&(m=k.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(m)&&this.setNodeAlignValue(k,f,e))}}}catch(Y){g_objCommonUtil.displayErrorAlert(Y,"setAlignOperation")}return null};this.checkIncludeAlignAvailableNode=function(a){try{for(var b=!1,c=0;c<a.childNodes.length;c++){var d=
a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){var e=d.nodeName.toLowerCase();if(!g_objNodeUtil.check_is_CM_INLINE(e)){b=!0;break}}}e=a.nodeName.toLowerCase();if("section"==e||"article"==e||"div"==e||"td"==e)b||(b=!0);return b}catch(f){g_objCommonUtil.displayErrorAlert(f,"checkIncludeAlignAvailableNode")}return!1};this.getPosBlockTypeCount=function(a,b){try{for(var c=0,d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==e.nodeType){if(this.doLoop_CheckTempSpanNode(e,
b))break;var f=e.nodeName.toLowerCase();g_objNodeUtil.check_is_CM_INLINE(f)||c++}}return c}catch(h){g_objCommonUtil.displayErrorAlert(h,"getPosBlockTypeCount")}return-1};this.setNodeAlignValue=function(a,b,c){try{if("body"!=a.nodeName.toLowerCase())if(c){var d=a.nodeName.toLowerCase();"h1"==d||"h2"==d||"h3"==d||"h4"==d||"h5"==d||"h6"==d?a.setAttribute("cusHead","1"):"p"==d?a.setAttribute("cusHead","1"):("ol"==d||"ul"==d)&&a.setAttribute("cusHead","5")}else a.removeAttribute("align"),g_objPropertyUtil.setElement_TextAlign(a,
b)}catch(e){g_objCommonUtil.displayErrorAlert(e,"setNodeAlignValue")}};this.doLoop_CheckTempSpanNode=function(a,b){try{if(ID_SELECTION_TEXT_NODE==a.nodeType)return!1;if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&a.id==b)return!0;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType&&(this.doLoop_CheckTempSpanNode(d,b)||d.id==b))return!0}}catch(e){g_objCommonUtil.displayErrorAlert(e,"doLoop_CheckTempSpanNode")}return!1};this.getTextRangePos=function(a,b,
c){try{var d=0,e=0,f=0,h=0,g=!1,l=a.createRange();l.moveToElementText(b);for(l.collapse(!0);;){var k=c.inRange(l);k&&(g=!0);if(g&&!k)break;f=l.moveStart("character",1);g||(d+=f);h=l.moveEnd("character",1);e+=h;if(0==h)break}return{nStartRangePos:d,nEndRangePos:e}}catch(n){g_objCommonUtil.displayErrorAlert(n,"getTextRangePos")}return null};this.separateAlignBlockNode=function(a,b,c){try{for(var d=g_objEditorDocument[c].createElement("div"),e=null,f=null,h=0;0<a.childNodes.length;){var g=a.childNodes[0];
if(ID_SELECTION_ELEMENT_NODE==g.nodeType){var l=g.nodeName.toLowerCase();g_objNodeUtil.check_is_CM_INLINE(l)?h==b?(null==e&&(e=g_objEditorDocument[c].createElement("p")),e.appendChild(g)):d.appendChild(g):(h==b&&null!=e&&(d.appendChild(e),f=e,e=null),d.appendChild(g),h++)}else ID_SELECTION_TEXT_NODE==g.nodeType&&(checkTextNodeAllWhiteCode(g.nodeValue)?a.removeChild(g):h==b?(null==e&&(e=g_objEditorDocument[c].createElement("p")),e.appendChild(g)):d.appendChild(g))}h==b&&null!=e&&(d.appendChild(e),
f=e);for(;0<d.childNodes.length;)g=d.childNodes[0],a.appendChild(g);return f}catch(k){g_objCommonUtil.displayErrorAlert(k,"separateAlignBlockNode")}return null};this.separateAlignBlockProcess=function(a,b,c){try{var d=a.nodeName.toLowerCase();if("div"==d||"section"==d||"article"==d||"td"==d){d=0;for(var e=!1,f=0;f<a.childNodes.length;f++){var h=a.childNodes[f];if(ID_SELECTION_ELEMENT_NODE==h.nodeType){var g=h.nodeName.toLowerCase();g_objNodeUtil.check_is_CM_INLINE(g)?e=!0:e?(b.bSeparateBlock=!0,this.separateAlignBlockNode(a,
d,c),d=0,e=!1,f=-1):d++}else ID_SELECTION_TEXT_NODE==h.nodeType&&(checkTextNodeAllWhiteCode_Plus_Space(h.nodeValue)||(e=!0))}e&&this.separateAlignBlockNode(a,d,c)}}catch(l){g_objCommonUtil.displayErrorAlert(l,"separateAlignBlockProcess")}};this.setTextOnlyAlignOperation=function(a,b,c,d,e,f){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var h=a.nodeName.toLowerCase();if(g_objNodeUtil.checkIsAlignAvailableNode(h)){this.setNodeAlignValue(a,c,f);return}}var g=g_objNodeUtil.getLoop_ParentAlignElement(a);
null!=g&&"body"!=g.nodeName.toLowerCase()&&this.setNodeAlignValue(g,c,f)}catch(l){g_objCommonUtil.displayErrorAlert(l,"setTextOnlyAlignOperation")}};this.doLoop_separateAlignBlock=function(a,b,c){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];ID_SELECTION_ELEMENT_NODE==e.nodeType&&(this.doLoop_separateAlignBlock(e,b,c),this.separateAlignBlockProcess(e,b,c))}this.separateAlignBlockProcess(a,b,c)}}catch(f){g_objCommonUtil.displayErrorAlert(f,
"doLoop_separateAlignBlock")}};this.doLoop_AlignOperation=function(a,b,c,d,e,f,h){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType){for(var g=!0,l=0;l<a.childNodes.length;l++){var k=a.childNodes[l];if(ID_SELECTION_ELEMENT_NODE==k.nodeType){this.doLoop_AlignOperation(k,b,c,d,e,f,h);var n=k.nodeName.toLowerCase();g_objNodeUtil.checkIsAlignAvailableNode(n)&&(g=!1,this.setAlignNodeProcess(k,b,c,d,e,f,h))}}g&&this.setAlignNodeProcess(a,b,c,d,e,f,h)}}catch(m){g_objCommonUtil.displayErrorAlert(m,"doLoop_AlignOperation")}};
this.setAlignNodeProcess=function(a,b,c,d,e,f,h){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType)if(window.attachEvent){var g=g_objEditorDocument[f].selection,l=g.createRange();l.moveToElementText(a);l.collapse(!0);var k=g.createRange();k.moveToElementText(a);k.collapse(!1);var n=b.inRange(l),m=b.inRange(k);if(!n&&m){var u=a.nodeName.toLowerCase();if(g_objNodeUtil.checkIsAlignAvailableNode(u)){this.setNodeAlignValue(a,d,h);e.bDoOperation=!0;return}}if(n&&m&&(u=a.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(u))){this.setNodeAlignValue(a,
d,h);e.bDoOperation=!0;return}n&&!m&&(u=a.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(u)&&(this.setNodeAlignValue(a,d,h),e.bDoOperation=!0))}else{c.selectNode(a);var t=b.compareBoundaryPoints(Range.END_TO_START,c),r=b.compareBoundaryPoints(Range.START_TO_START,c),v=b.compareBoundaryPoints(Range.END_TO_END,c),q=b.compareBoundaryPoints(Range.START_TO_END,c);if(-1==t&&(1==r||0==r)&&(u=a.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(u))){this.setNodeAlignValue(a,d,
h);e.bDoOperation=!0;return}if(0==r||-1==r)if(1==v||0==v)if(u=a.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(u)){this.setNodeAlignValue(a,d,h);e.bDoOperation=!0;return}1!=q||0!=v&&-1!=v||(u=a.nodeName.toLowerCase(),g_objNodeUtil.checkIsAlignAvailableNode(u)&&(this.setNodeAlignValue(a,d,h),e.bDoOperation=!0))}}catch(p){g_objCommonUtil.displayErrorAlert(p,"setAlignNodeProcess")}};this.getTextOnlyAlignOperation=function(a,b){try{if(window.attachEvent){var c=g_objEditorDocument[b].selection.createRange().parentElement(),
d=c.nodeName.toLowerCase();if(g_objNodeUtil.checkIsAlignAvailableNode(d))return g_objNodeUtil.getNodeAlignCode(c);var e=g_objNodeUtil.getLoop_ParentAlignElement(c);return null==e||"body"==e.nodeName.toLowerCase()?void 0:g_objNodeUtil.getNodeAlignCode(e)}e=g_objNodeUtil.getLoop_ParentAlignElement(a);return null==e||"body"==e.nodeName.toLowerCase()?void 0:g_objNodeUtil.getNodeAlignCode(e)}catch(f){g_objCommonUtil.displayErrorAlert(f,"getTextOnlyAlignOperation")}return null};this.doLoop_GetAlignValue=
function(a,b,c,d,e){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType){for(var f=!0,h=0;h<a.childNodes.length;h++){var g=a.childNodes[h];if(ID_SELECTION_ELEMENT_NODE==g.nodeType){this.doLoop_GetAlignValue(g,b,c,d,e);var l=g.nodeName.toLowerCase();g_objNodeUtil.checkIsAlignAvailableNode(l)&&(f=!1,this.getAlignNodeProcess(g,b,c,d,e))}}f&&this.getAlignNodeProcess(a,b,c,d,e)}}catch(k){g_objCommonUtil.displayErrorAlert(k,"doLoop_GetAlignValue")}};this.getAlignNodeProcess=function(a,b,c,d,e){try{if(ID_SELECTION_ELEMENT_NODE!=
a.nodeType)return null;if(window.attachEvent){var f=g_objEditorDocument[e].selection,h=f.createRange();h.moveToElementText(a);h.collapse(!0);var g=f.createRange();g.moveToElementText(a);g.collapse(!1);var l=b.inRange(h),k=b.inRange(g);if(!l&&k||l&&k||l&&!k)return this.checkNodeAlignCode(a,d)}else{c.selectNode(a);var n=b.compareBoundaryPoints(Range.END_TO_START,c),m=b.compareBoundaryPoints(Range.START_TO_START,c),u=b.compareBoundaryPoints(Range.END_TO_END,c),t=b.compareBoundaryPoints(Range.START_TO_END,
c);if(-1==n&&(1==m||0==m))return this.checkNodeAlignCode(a,d);if(0==m||-1==m)if(1==u||0==u)return this.checkNodeAlignCode(a,d);if(1==t&&(0==u||-1==u))return this.checkNodeAlignCode(a,d)}}catch(r){g_objCommonUtil.displayErrorAlert(r,"getAlignNodeProcess")}};this.checkNodeAlignCode=function(a,b){try{var c=a.nodeName.toLowerCase();if(g_objNodeUtil.checkIsAlignAvailableNode(c)){var d=g_objNodeUtil.getNodeAlignCode(a);-1==b.nAlignCode?b.nAlignCode=d:b.nAlignCode!=d&&(b.bSameValue=!1)}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"checkNodeAlignCode")}};this.doLoop_Node_Outdent_Indent=function(a,b,c){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];ID_SELECTION_ELEMENT_NODE==e.nodeType&&(this.doLoop_Node_Outdent_Indent(e,b,c),this.setNode_Outdent_Indent(e,b,c))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"doLoop_Node_Outdent_Indent")}};this.doLoop_Node_Margin=function(a,b,c){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];
ID_SELECTION_ELEMENT_NODE==e.nodeType&&(this.doLoop_Node_Margin(e,b,c),this.setNode_Margin(e,b,c))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"doLoop_Node_Margin")}};this.setNode_Outdent_Indent=function(a,b,c){try{var d=g_nOutdentIndentWidth,e=a.getAttribute("cusHead");if("1"==e||"5"==e){a.removeAttribute("cusHead");e=0;var f=g_objCommonUtil.extractNumberValueUnit(a.style.textIndent);null!=f&&(e=f.nValue,"pt"==f.strUnit&&(e=g_objCommonUtil.mappingFrom_Pt_To_Px(e)),a.style.removeAttribute?a.style.removeAttribute("text-indent"):
a.style.removeProperty&&a.style.removeProperty("text-indent"));f=0;var h=g_objPropertyUtil.getElementStyleAttributeValue(a,"margin-left",c),g=g_objCommonUtil.extractNumberValueUnit(h);f=null!=g?parseInt(g.nValue)+parseInt(e):parseInt(e);if(b){f=parseInt(f)-parseInt(d);var l=f%d;0!=l&&(f=parseInt(f)+parseInt(l))}else f=parseInt(f)+parseInt(d),l=f%d,0!=l&&(f=parseInt(f)-parseInt(l));0>f&&(f=0);a.style.marginLeft=f+"px"}}catch(k){g_objCommonUtil.displayErrorAlert(k,"setNode_Outdent_Indent")}};this.setNode_Margin=
function(a,b,c){try{var d=a.getAttribute("cusHead");if("1"==d){a.removeAttribute("cusHead");c=0;var e=g_objCommonUtil.extractNumberValueUnit(a.style.textIndent);null!=e&&(c=e.nValue,"pt"==e.strUnit&&g_objCommonUtil.mappingFrom_Pt_To_Px(c),a.style.removeAttribute?a.style.removeAttribute("text-indent"):a.style.removeProperty&&a.style.removeProperty("text-indent"));"marginLeft"==b.name&&(a.style.marginLeft=b.value+"px");"marginTop"==b.name&&(a.style.marginTop=b.value+"px");"marginRight"==b.name&&(a.style.marginRight=
b.value+"px");"marginBottom"==b.name&&(a.style.marginBottom=b.value+"px")}"5"==d&&(a.removeAttribute("cusHead"),"marginTop"==b.name&&(a.style.marginTop=b.value+"px"),"marginBottom"==b.name&&(a.style.marginBottom=b.value+"px"))}catch(f){g_objCommonUtil.displayErrorAlert(f,"setNode_Margin")}};this.copySpanStyle=function(a,b){try{for(var c="";b&&g_objNodeUtil.checkTagName(b,"span");)b.getAttribute("style")&&(c=b.getAttribute("style")+c),b=b.parentNode;c&&a.setAttribute("style",c)}catch(d){g_objCommonUtil.displayErrorAlert(d,
"copySpanStyle")}};this.isEmptySpan=function(a){try{if(null==a)return!1;if(a.nodeType==ID_SELECTION_ELEMENT_NODE&&"span"==a.tagName.toLowerCase()&&1==a.childNodes.length){var b=a.childNodes[0];if(b.nodeType==ID_SELECTION_TEXT_NODE&&!b.nodeValue.replace(/\u200B/g,""))return!0}else if(a.nodeType==ID_SELECTION_TEXT_NODE&&!0===!a.nodeValue.replace(/\u200B/g,""))return!0;return!1}catch(c){g_objCommonUtil.displayErrorAlert(c,"isEmptySpan")}};this.getClosetBlockElement=function(a){try{for(var b=g_objNodeUtil,
c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a)&&!(b.isBlockNode(a)||1==a.nodeType&&"span"===a.tagName.toLowerCase()&&!0===c.element_hasClass(a,"dze_shape_text_span"));)a=a.parentNode;return a}catch(d){dalert(d)}};this.setTextDecoration=function(a,b){try{var c=g_objEditorDocument[b].getSelection();if(!fnObjectCheckNull(c)&&0!==c.rangeCount){var d=c.getRangeAt(0),e=d.commonAncestorContainer,f=!1===c.isCollapsed;if(!1===f){for(;;){var h=g_objNodeUtil.getParentElement(e);if(!1===fnObjectCheckNull(h)&&"body"===
h.nodeName.toLowerCase())break;if(!1===fnObjectCheckNull(e)&&("span"===e.nodeName.toLowerCase()||"p"===e.nodeName.toLowerCase()||"body"===e.nodeName.toLowerCase()))break;e=h}if("span"===e.nodeName.toLowerCase()){var g=e.cloneNode(!1);g.innerHTML=duzon_dialog.dze_bookmark_last_tag;e.innerText.length===d.startOffset?!0===fnObjectCheckNull(e.nextSibling)?h.appendChild(g):h.insertBefore(g,e.nextSibling):(d.insertNode(g),g_objNodeUtil.splitOn(h,g))}else g=g_objEditorDocument[b].createElement("span"),g.innerHTML=
duzon_dialog.dze_bookmark_last_tag,d.insertNode(g);this.setTextDecorationToSpan(a,g)}else{g_objNodeUtil.splitTextNodeByOffset(d);var l=g_objNodeUtil.getTextNodesOnSelection(c),k=g_objEditorDocument[b].createElement("span"),n=g_objEditorDocument[b].createElement("span");k.id="selection_start";n.id="selection_end";for(c=0;c<l.length;c++){var m=l[c];h=g_objNodeUtil.getParentElement(m);g=g_objEditorDocument[b].createElement("span");h.insertBefore(g,m);g.appendChild(m);0===c?(g.appendChild(k),1===l.length&&
g.appendChild(n)):c===l.length-1&&g.appendChild(n);this.setTextDecorationToSpan(a,g);this.arrangeNodePosition(g)}}g_objLetterFn.removeAllDuplicateStyleByLetterOperation(g_objEditorDocument[b].body,b);if(!1===f){var u=g_objEditorDocument[b].createElement("span");u.id=g_objCaretUtil.ID_CURRENT_CARET;g.appendChild(u);g_objCaretUtil.restoreCaret(b,g_objCaretUtil.ID_CURRENT_CARET)}else{var t=g_objNodeUtil.getParentElement(g_objEditorDocument[b].getElementById("selection_start")),r=g_objNodeUtil.getParentElement(g_objEditorDocument[b].getElementById("selection_end"));
null!==t&&null!==r&&(t.removeChild(t.lastElementChild),r.removeChild(r.lastElementChild),d.setStart(t.firstChild,0),d.setEnd(r.lastChild,r.lastChild.length))}}}catch(v){g_objCommonUtil.displayErrorAlert(v,"setTextDecoration")}};this.arrangeNodePosition=function(a){try{var b=g_objNodeUtil.getParentElement(a);if("b"===b.nodeName.toLowerCase()||"i"===b.nodeName.toLowerCase()||"strong"===b.nodeName.toLowerCase()||"em"===b.nodeName.toLowerCase()||"sup"===b.nodeName.toLowerCase()||"sub"===b.nodeName.toLowerCase()){for(var c=
b;"b"===c.nodeName.toLowerCase()||"i"===c.nodeName.toLowerCase()||"strong"===c.nodeName.toLowerCase()||"em"===c.nodeName.toLowerCase()||"sup"===c.nodeName.toLowerCase()||"sub"===c.nodeName.toLowerCase();)c=g_objNodeUtil.getParentElement(c);b=this.splitParentLoop(g_objNodeUtil.getParentElement(c),b,a)}else if("p"!==b.nodeName.toLowerCase()&&"body"!==b.nodeName.toLowerCase())for(var d=0;d<b.childNodes.length;d++)if(c=b.childNodes[d],c!==a&&(c.nodeType!==ID_SELECTION_TEXT_NODE||0!==c.nodeValue.length)){var e=
b.cloneNode(!1),f=g_objNodeUtil.getParentElement(b);b.insertBefore(e,a);e.appendChild(a);g_objNodeUtil.splitOn(f,e);!1===fnObjectCheckNull(e.previousSibling)&&0===e.previousSibling.innerHTML.length&&f.removeChild(e.previousSibling);!1===fnObjectCheckNull(e.nextSibling)&&0===e.nextSibling.innerHTML.length&&f.removeChild(e.nextSibling);b=e;break}var h=this.getTextDecorationFromStyle(a),g=0>h.indexOf("underline")?!1:!0,l=0>h.indexOf("line-through")?!1:!0,k=this.getTextDecorationFromStyle(b);g_objLetterFn.removeSpanStyle(b,
ID_LETTER_OPERATION_TEXT_DECORATION);0<=k.indexOf("underline")&&(h=!0===g?h.replace("underline","").trim():h+" underline",a.style.textDecoration=h);0<=k.indexOf("line-through")&&(!0===l?(h=h.replace("line-through","").trim(),a.style.textDecoration=h):a.style.textDecoration=h+" line-through")}catch(n){g_objCommonUtil.displayErrorAlert(n,"arrangeNodePosition")}};this.splitParentLoop=function(a,b,c){try{var d=function(b,c){var g=g_objNodeUtil.getParentElement(b);if(b!==a&&!0!==fnObjectCheckNull(g)&&
"html"!==g.nodeName.toLowerCase()&&"tr"!==g.nodeName.toLowerCase()&&"tbody"!==g.nodeName.toLowerCase()&&"table"!==g.nodeName.toLowerCase()&&"p"!==b.nodeName.toLowerCase()&&"body"!==b.nodeName.toLowerCase()){var f=b.cloneNode(!1);b.insertBefore(f,c);f.appendChild(c);g_objNodeUtil.splitOn(g,f);!1===fnObjectCheckNull(f.previousSibling)&&0===f.previousSibling.innerHTML.length&&g.removeChild(f.previousSibling);!1===fnObjectCheckNull(f.nextSibling)&&0===f.nextSibling.innerHTML.length&&g.removeChild(f.nextSibling);
e=f;d(g,f)}},e;d(b,c);return e}catch(f){g_objCommonUtil.displayErrorAlert(f,"splitParentLoop")}};this.setTextDecorationToSpan=function(a,b){try{var c=this.getTextDecorationFromStyle(b);"underline"===a.toLowerCase()?0>c.indexOf("underline")?b.style.textDecoration=c+" underline":b.style.textDecoration=c.replace("underline","").trim():"strikethrough"===a.toLowerCase()&&(0>c.indexOf("line-through")?b.style.textDecoration=c+" line-through":b.style.textDecoration=c.replace("line-through","").trim())}catch(d){g_objCommonUtil.displayErrorAlert(d,
"setTextDecorationToSpan")}};this.getTextDecorationFromStyle=function(a){try{var b=a.style.textDecoration.toLowerCase();!0!==fnObjectCheckNull(b)&&0!==b.length||!1!==fnObjectCheckNull(a.style.textDecorationLine)||(b=a.style.textDecorationLine.toLowerCase(),!1===fnObjectCheckNull(b)&&0<b.length&&(this.removeSpanStyle(a,ID_LETTER_OPERATION_TEXT_DECORATION),a.style.textDecoration=b));return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTextDecorationFromStyle")}}};function TextAtt(){}
TextAtt.attName="font-family font-size font-style font-weight color background-color letter-spacing text-decoration-line".split(" ");TextAtt.getPath=function(a,b){try{var c=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isBlockNode(a)&&!d.isCell(a);)c.push(a),a=a.parentNode;else{for(;a;)c.push(a),a=a.firstChild;c.reverse()}return c}catch(e){dalert(e)}};
TextAtt.getAtt=function(a){try{var b=new TextAtt;if(!a)return b;var c=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(c=!1);var d=TextAtt.getPath(a,c);c=0;for(var e=d.length;c<e;c++){a=d[c];var f=a.style;if(f){TextAtt.attName.forEach(function(a){a=camelCase(a);b[a]||f[a]&&(b[a]=f[a])});var h=a.tagName;h=h?h.toLowerCase():"";switch(h){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":b[h]=!0}}}return b}catch(g){dalert(g)}};
TextAtt.setAtt=function(a,b){try{if(!a||!b||3!==a.nodeType&&"BR"!==a.nodeName)return!1;var c=Object.keys(b);if(0>=c.length)return!1;var d=function(a,b){b=a.ownerDocument.createElement(b);a.parentNode.replaceChild(b,a);b.appendChild(a);return b};c.forEach(function(c){switch(c){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":a=d(a,c);return}"SPAN"!==a.nodeName&&(a=d(a,"span"));c=camelCase(c);b[c]&&(a.style[c]=b[c])});return!0}catch(e){dalert(e)}};
function ParaAtt(){}ParaAtt.attName="text-align margin-left margin-right padding-top padding-bottom text-indent line-height color font-family font-size".split(" ");ParaAtt.getPath=function(a,b){try{var c=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isCell(a);){if(d.isBlockNode(a)){c.push(a);break}a=a.parentNode}else for(;a;){if(d.isBlockNode(a)){c.push(a);break}a=a.firstChild}return c}catch(e){dalert(e)}};
ParaAtt.getAtt=function(a){try{var b=new ParaAtt;if(!a)return b;var c=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(c=!1);var d=(a=ParaAtt.getPath(a,c)[0])?a.style:null;if(!d)return b;ParaAtt.attName.forEach(function(a){a=camelCase(a);b[a]||d[a]&&(b[a]=d[a])});return b}catch(e){dalert(e)}};ParaAtt.setAtt=function(a,b){try{if(!a||!b||0>=Object.keys(b).length)return!1;ParaAtt.attName.forEach(function(c){c=camelCase(c);b[c]&&(a.style[c]=b[c])});return!0}catch(c){dalert(c)}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,d,e){return b==a&&"q"==d&&e==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(n){return!1}}function b(){}function d(a){if(!$jscomp.owns(a,f)){var c=new b;$jscomp.defineProperty(a,f,{value:c})}}function e(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof b)return a;d(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0,l=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};l.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};l.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};l.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};l.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return l},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,c){var d=c&&typeof c;"object"==
d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++l,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(c!==c&&f.key!==f.key||c===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},l=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(l){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");
var g_objAdjustDoc=new function(){this.objAdjustWaitStatus=null;this.arrReservedClassName="dze_tb_layout dze_tb_layout_td dze_bookmark_flag dze_caret_marker dze_caret_marker_start dze_caret_marker_end".split(" ");this.objPasteCssStruct_WK=null;this.nPasteType_WK=-1;this.ID_PASTE_TYPE_EXCEL=0;this.ID_PASTE_TYPE_WORD=1;this.arrOversizedContents=[];this.objAdjustTarget=this.strImgUrl=null;this.nEditNumber=0;this.setTarget=function(a,c){try{this.objAdjustTarget=a,"undefined"!=typeof c&&(this.nEditNumber=
c)}catch(b){g_objCommonUtil.displayErrorAlert(b,"g_objAdjustDoc.setTarget")}};this.getTarget=function(a){try{return"undefined"==typeof a&&(a=this.nEditNumber),this.objAdjustTarget?this.objAdjustTarget:g_objEditorDocument[a].body}catch(c){g_objCommonUtil.displayErrorAlert(c,"g_objAdjustDoc.getTarget")}};this.initializeAdjustWaitStatus=function(){try{if(null==this.objAdjustWaitStatus){var a="";a+='<table id="divAdjustWaitStatus" class="divAdjustWaitStatus" style="display:none;position:absolute;z-index:20014;border:0px;" cellSpacing="0" cellPadding="0">';
a+='<tr valign="center">';a+='<td align="center" width="100%" height="100%" style="line-height:normal;border:0px;padding:0px;"><img src="'+dzeEnvConfig.strPath_Image+"/toolbar/"+g_strBrowserLanguage+'/view_adjust_status.gif" alt="status"></td>';g_objInsertUtil.insertLayerHTML(a+"</tr></table>",!1)&&(this.objAdjustWaitStatus=document.getElementById("divAdjustWaitStatus"))}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeAdjustWaitStatus")}};this.showAdjustWaitStatus=function(a,c){try{if(this.initializeAdjustWaitStatus(),
a){var b=g_objPositionUtil.getElementPosition(g_objEditSetContainer[c],!1);this.objAdjustWaitStatus.style.left=b.left+"px";this.objAdjustWaitStatus.style.top=b.top+"px";this.objAdjustWaitStatus.style.width=b.right-b.left+"px";this.objAdjustWaitStatus.style.height=b.bottom-b.top+"px";this.objAdjustWaitStatus.className="adjustWaitStatus";this.objAdjustWaitStatus.style.display=""}else this.objAdjustWaitStatus.style.display="none"}catch(d){g_objCommonUtil.displayErrorAlert(d,"showAdjustWaitStatus")}};
this.adjustDocProcess=function(a){try{if(2!=g_nFormEditMode){this.remove_Br_Node_Inside_P_Node(a);var c=!1;(c=this.isExistRemoveGarbageCommentText(a))||(c=this.isExistRemoveGarbageText(a));c||(c=this.isExistGarbageStyleAttribute(a));g_objEditMode.setZeroSpaceCodeToEmptyTd(a,this.getTarget(a));c||this.addParaToCell(a,this.getTarget(a));c?(this.showAdjustWaitStatus(!0,a),g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(a)},100)):dzeUiConfig.bUsePasteCapture||(g_objUndoRedo.registerUndoRedoStack(0,
a),!0===dzeUiConfig.bLimitTableWidthSize&&g_objAdjustDoc.checkContentsWidthSize(a))}}catch(b){g_objCommonUtil.displayErrorAlert(b,"adjustDocProcess")}};this.deleteDuplicatedImage=function(a,c){try{if(!0!==fnObjectCheckNull(this.strImgUrl)&&0!==this.strImgUrl.length){var b=g_objEditorDocument[a].getSelection();if(!0!==fnObjectCheckNull(b)&&0!==b.rangeCount){var d=b.getRangeAt(0).commonAncestorContainer.getElementsByTagName("img");if(!1===fnObjectCheckNull(d)&&0<d.length)for(a=null,b=0;b<d.length;b++)if(a=
d[b].src,0<a.indexOf(c)){var e=d[b].previousElementSibling;if(!1===fnObjectCheckNull(e)&&e.src===this.strImgUrl){var f=g_objNodeUtil.getParentElement(d[b]);if(!1===fnObjectCheckNull(f)){f.removeChild(e);this.strImgUrl=null;break}}}}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"deleteDuplicatedImage")}};this.checkFocusTxtNodeInLastCell=function(a,c){var b=!1,d=g_objEditWindow[a].getSelection().getRangeAt(0),e=d.commonAncestorContainer;d.collapsed&&(d=[{check:DZE_HTMLOBJ_TD},{check:DZE_HTMLOBJ_TR},
{check:DZE_HTMLOBJ_BODY}],e=g_objNodeUtil.getParentElementForTargetTags(e,d,d.length),getObjNodeType(e,a)==DZE_TAG_TD&&(e=e.offsetParent)&&!e.nextElementSibling&&(b=!0,e=e.nextElementSibling,d=document.createElement("p"),d.setAttribute("id",c),d.innerHTML="<br />",e?this.getTarget(a).insertBefore(d,e):this.getTarget(a).appendChild(d)));return b};this.doAdjustDocProcess=function(a){try{dzeUiConfig.bUsePasteCapture||g_objCaretUtil.saveCaret();g_objTableFlag.ResetTableInfo(!1);updateTableHandlerUI.updateTableUIHandler(0,
0,0,0,a);g_objTagUtil.updateTagAttribute(a);var c=this.adjustGarbageAttribute(a);this.updateHTMLCode(c,a);this.adjustRemoveGarbageText(a);this.adjustGarbageEmptyTag(a,!0);if(g_bBrowserType_IE){this.adjustDuplicateGarbage_P_Node(a);var b=this.getTarget(a).innerHTML;this.getTarget(a).innerHTML=b}this.setOperation_EnterCode_Br_Node_P_Node(a);this.replaceDeprecatedTag(a);this.addParaToCell(a,this.getTarget(a));this.setParaInlineStyle(a,this.getTarget(a));g_objLetterFn.processRemove_MergeAvailableTag(a,
this.getTarget(a));this.adjustStyleUnit(a);this.showAdjustWaitStatus(!1,a);dzeUiConfig.bUsePasteCapture||(g_objCaretUtil.restoreCaret(a),g_objUndoRedo.registerUndoRedoStack(0,a),!0===dzeUiConfig.bLimitTableWidthSize&&this.checkContentsWidthSize(a))}catch(d){this.showAdjustWaitStatus(!1,a),g_objCommonUtil.displayErrorAlert(d,"doAdjustDocProcess")}};this.checkContentsWidthSize=function(a){try{var c=function(b){for(var c=g_objTableUtil.getEditorFrameWidth(),d,e,f=!1,k=0;k<b.length;k++)if(d=b[k],e=d.getAttribute("oversized_content"),
!1!==fnObjectCheckNull(e)||"true"!==e)if(e=g_objCommonUtil.extractNumberValueUnit(d.style.width),!0===fnObjectCheckNull(e)&&(e=g_objCommonUtil.extractNumberValueUnit(d.width)),!e&&g_objNodeUtil.checkTagName(d,"img")&&(d.onload=function(){!f&&g_objCommonUtil.extractNumberValueUnit(d.width).nValue>g_objTableUtil.getEditorFrameWidth()&&!1===confirm(ID_RES_DIALOG_CONFIRM_KEEP_PASTED_CONTENTS)&&(f=!0,g_objUndoRedo.operateUndoRedoStack(!0,!1,a))}),!1===fnObjectCheckNull(e)&&e.nValue>c)return!1===confirm(ID_RES_DIALOG_CONFIRM_KEEP_PASTED_CONTENTS)&&
(f=!0,g_objUndoRedo.operateUndoRedoStack(!0,!1,a)),!0;return!1},b=this.getTarget(a),d=b.getElementsByTagName("table"),e=!1;!1===fnObjectCheckNull(d)&&0<d.length&&(e=c(d));!1===e&&(d=b.getElementsByTagName("img"),!1===fnObjectCheckNull(d)&&0<d.length&&(e=c(d)));!1===e&&(d=b.getElementsByTagName("div"),!1===fnObjectCheckNull(d)&&0<d.length&&c(d))}catch(f){g_objCommonUtil.displayErrorAlert(f,"checkContentsWidthSize")}finally{for(c=0;c<this.arrOversizedContents.length;c++)this.arrOversizedContents[c].removeAttribute("oversized_content");
g_objAdjustDoc.arrOversizedContents=[]}};this.checkOversizedContents=function(a){try{this.arrOversizedContents=[];var c=this.getTarget(a),b=c.getElementsByTagName("table");this.markOversizedContents(b);b=c.getElementsByTagName("img");this.markOversizedContents(b);b=c.getElementsByTagName("div");this.markOversizedContents(b)}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkOversizedContents")}};this.markOversizedContents=function(a){try{if(!(!0===fnObjectCheckNull(a)||1>a.length))for(var c=g_objTableUtil.getEditorFrameWidth(),
b,d,e=0;e<a.length;e++)b=a[e],d=g_objCommonUtil.extractNumberValueUnit(b.style.width),!0===fnObjectCheckNull(d)&&(d=g_objCommonUtil.extractNumberValueUnit(b.width)),!1===fnObjectCheckNull(d)&&d.nValue>c&&(a[e].setAttribute("oversized_content",!0),this.arrOversizedContents.push(a[e]))}catch(f){g_objCommonUtil.displayErrorAlert(f,"markOversizedContents")}};this.isExistRemoveGarbageCommentText=function(a){try{if(-1!=this.getTarget(a).innerHTML.toLowerCase().indexOf("\x3c!--[if"))return!0}catch(c){g_objCommonUtil.displayErrorAlert(c,
"isExistRemoveGarbageCommentText")}return!1};this.isExistRemoveGarbageText=function(a){try{var c=this.getTarget(a).innerHTML.toLowerCase();if(null!=g_arrRemoveGarbageText)for(a=0;a<g_arrRemoveGarbageText.length;a++)if(-1!=c.indexOf(g_arrRemoveGarbageText[a]))return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"isExistRemoveGarbageText")}return!1};this.isExistGarbageStyleAttribute=function(a){try{var c=this.getParserStruct(a);return c?this.checkTree(c.stDocRoot):!1}catch(b){g_objCommonUtil.displayErrorAlert(b,
"isExistGarbageStyleAttribute")}return!1};this.getParserStruct=function(a){try{var c=this.getTarget(a).innerHTML,b=g_objCodeParser.initParserStruct(c);if(!b)return null;g_objCodeParser.parseBody(b.stDocRoot,b);return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"getParserStruct")}return null};this.checkTree=function(a){try{for(var c=a.content;null!=c;c=c.next)if(this.checkTree(c)||"font"==c.tagName||this.checkTreeAttribute(c))return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"checkTree")}return!1};
this.checkTreeAttribute=function(a){try{if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++){var b=a.arrAttribute[c];if(g_objCodeDefine.ID_ATTR_STYLE==b.attributeID&&this.checkTreeAttributeStyle(b))return!0}}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkTreeAttribute")}return!1};this.checkTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null==c)return!1;for(a=0;a<c.length;a++)if(/mso-/gi.test(c[a].styleName))return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"checkTreeAttributeStyle")}return!1};
this.adjustRemoveGarbageText=function(a){try{null!=g_arrRemoveGarbageText&&this.processRemoveGarbageText(this.getTarget(a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"adjustRemoveGarbageText")}};this.processRemoveGarbageText=function(a){try{for(var c=a.innerHTML,b=!1,d=0;d<g_arrRemoveGarbageText.length;d++)null!=g_arrRemoveGarbageText[d]&&""!=g_arrRemoveGarbageText[d]&&-1!=c.indexOf(g_arrRemoveGarbageText[d])&&(c=c.replace(g_arrRemoveGarbageText[d],""),b=!0,d--);b&&(a.innerHTML=c)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"processRemoveGarbageText")}};this.adjustGarbageEmptyTag=function(a,c){try{this.processGarbageEmptyTag(this.getTarget(a),c,a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"adjustGarbageEmptyTag")}};this.processGarbageEmptyTag=function(a,c,b){try{for(var d=0,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];ID_SELECTION_ELEMENT_NODE==f.nodeType?this.processGarbageEmptyTag(f,c,b):ID_SELECTION_TEXT_NODE==f.nodeType&&d++}var g=g_objNodeUtil.getElementTagName(a).toLowerCase();if(("font"==g||"span"==
g)&&d==a.childNodes.length){var l=a.innerHTML;if(0==l.trim().length&&(d=!0,"span"==g&&(""!=a.className?d=!1:""!=a.style.whiteSpace?d=!1:c&&""!=a.id&&(d=!1)),d))if(0<l.length){var m=g_objEditorDocument[b].createTextNode(l),h=g_objNodeUtil.getParentElement(a);h.replaceChild(m,a)}else if(h=g_objNodeUtil.getParentElement(a),h.removeChild(a),"p"===h.nodeName.toLowerCase()&&0===h.childNodes.length){var k=g_objNodeUtil.getParentElement(h);!1===fnObjectCheckNull(k)&&k.removeChild(h)}}}catch(n){g_objCommonUtil.displayErrorAlert(n,
"processGarbageEmptyTag")}};this.adjustDuplicateGarbage_P_Node=function(a){try{if(!g_bBrowserType_IE)return!1;this.processDuplicateGarbage_P_Node(this.getTarget(a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"adjustDuplicateGarbage_P_Node")}};this.processDuplicateGarbage_P_Node=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var c=0;c<a.childNodes.length;c++){var b=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processDuplicateGarbage_P_Node(b)}if("p"==g_objNodeUtil.getElementTagName(a).toLowerCase()){var d=
a.outerHTML,e=d.length;if(4<=e){var f=d.substring(e-4);f=f.toLowerCase();"</p>"!=f&&(a.outerHTML=d+"</p>")}else 3==e&&"<p>"==d.toLowerCase()&&(a.outerHTML=window.attachEvent?d+"</p>":d+"<br></p>")}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"processDuplicateGarbage_P_Node")}};this.setOperation_EnterCode_Br_Node_P_Node=function(a){try{if(window.attachEvent)for(var c=this.getTarget(a).getElementsByTagName("p"),b=0;b<c.length;b++){var d=c[b],e=d.childNodes.length;if(1==e){var f=d.childNodes[0];ID_SELECTION_ELEMENT_NODE==
f.nodeType&&"br"==g_objNodeUtil.getElementTagName(f).toLowerCase()&&d.removeChild(f)}}else if(window.addEventListener)for(c=this.getTarget(a).getElementsByTagName("p"),b=0;b<c.length;b++)if(d=c[b],e=d.childNodes.length,0==e){var g=g_objEditorDocument[a].createElement("br");d.appendChild(g)}}catch(l){g_objCommonUtil.displayErrorAlert(l,"setOperation_EnterCode_Br_Node_P_Node")}};this.adjustGarbageAttribute=function(a){try{var c=this.getParserStruct(a);if(!c)return!1;this.adjustTree(c.stDocRoot,c);return c}catch(b){g_objCommonUtil.displayErrorAlert(b,
"adjustGarbageAttribute")}};this.adjustTree=function(a,c){try{for(var b=a.content;null!=b;b=b.next)this.adjustTree(b,c),g_objCodeLexer.NODE_TYPE_COMMENT==b.type?0==c.stDocStreamIn.htmlCode.substring(b.textStartPos,b.textEndPos+1).indexOf("[if")&&(b.type=g_objCodeLexer.NODE_TYPE_TEXT,b.textEndPos=b.textStartPos-1):(-1!=b.tagName.indexOf(":")&&(b.print=!1,b.arrAttribute=null),this.adjustTreeAttribute(b,c))}catch(d){g_objCommonUtil.displayErrorAlert(d,"adjustTree")}};this.adjustTreeAttribute=function(a,
c){try{if(null!=a.arrAttribute)for(var b=0;b<a.arrAttribute.length;b++){var d=a.arrAttribute[b];if(g_objCodeDefine.ID_ATTR_STYLE==d.attributeID)this.adjustTreeAttributeStyle(d);else{var e=d.attributeName.toLowerCase(),f=this.adjustTreeAttributeValue(a,d,c);this.adjustRemoveAttributeName(e,f)&&(a.arrAttribute[b]=null)}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"adjustTreeAttribute")}};this.adjustTreeAttributeValue=function(a,c,b){try{return b.stDocStreamIn.htmlCode.substring(c.attributeStartPos,
c.attributeEndPos+1)}catch(d){g_objCommonUtil.displayErrorAlert(d,"adjustTreeAttributeValue")}};this.adjustTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null!=c)for(a=0;a<c.length;a++){var b=c[a].styleName.trim(),d=c[a].styleValue.trim();/mso-/gi.test(b)?c[a]=null:"background-color"==b?"transparent"==d&&(c[a]=null):(b=b.toLowerCase(),this.adjustRemoveAttributeStyleName(b)&&(c[a]=null))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"adjustTreeAttributeStyle")}};this.adjustRemoveAttributeName=
function(a,c){try{if(null==g_arrAdjustRemoveAttributeName)return!1;for(var b=0;b<g_arrAdjustRemoveAttributeName.length;b++){var d=g_arrAdjustRemoveAttributeName[b].toLowerCase();if(a==d)if("class"==d||"classname"==d){if(!inArray(c,this.arrReservedClassName))return!0}else return!0}}catch(e){g_objCommonUtil.displayErrorAlert(e,"adjustRemoveAttributeName")}return!1};this.adjustRemoveAttributeStyleName=function(a){try{if(null==g_arrAdjustRemoveStyleName)return!1;for(var c=0;c<g_arrAdjustRemoveStyleName.length;c++){var b=
g_arrAdjustRemoveStyleName[c].toLowerCase();if(a==b)return!0}}catch(d){g_objCommonUtil.displayErrorAlert(d,"adjustRemoveAttributeStyleName")}return!1};this.updateHTMLCode=function(a,c){try{g_objCodePrint.printTree(a.stDocRoot,0,a);0<a.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,a);for(var b="",d=0;d<a.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(a.stDocStreamOut.lineString[d])||(b+=a.stDocStreamOut.lineString[d]+"\r\n");this.getTarget(c).innerHTML=
b}catch(e){g_objCommonUtil.displayErrorAlert(e,"updateHTMLCode")}};this.replaceDeprecatedTag=function(a){try{for(;;){var c=this.getTarget(a).getElementsByTagName("font"),b=c.length;if(0==b)break;var d=c[b-1],e=g_objNodeUtil.getParentElement(d),f=g_objEditorDocument[a].createElement("span");null!=d.face&&""!=d.face&&(f.style.fontFamily=d.face);null!=d.color&&""!=d.color&&(f.style.color=d.color);if(null!=d.size&&""!=d.size){var g="10px";switch(d.size){case "1":g="10px";break;case "2":g="13px";break;
case "3":g="16px";break;case "4":g="18px";break;case "5":g="24px";break;case "6":g="32px";break;case "7":g="48px"}f.style.fontSize=g}for(;0<d.childNodes.length;)f.appendChild(d.childNodes[0]);e.replaceChild(f,d);var l=g_objEditorDocument[a].createElement("div");l.appendChild(d);var m=g_objCodeParser.initParserStruct(l.innerHTML);if(!m)break;g_objCodeParser.parseBody(m.stDocRoot,m);var h=m.stDocRoot.content;if(null!=h&&"font"==h.tagName&&null!=h.arrAttribute)for(g=0;g<h.arrAttribute.length;g++){var k=
h.arrAttribute[g];if(g_objCodeDefine.ID_ATTR_STYLE==k.attributeID)for(var n=0;n<k.arrStyleAttribute.length;n++){var p=k.arrStyleAttribute[n].styleName,r=k.arrStyleAttribute[n].styleValue.trim();g_objPropertyUtil.setElementStyleAttributeValue(f,p,r)}}}}catch(t){g_objCommonUtil.displayErrorAlert(t,"replaceDeprecatedTag")}};this.adjustStyleUnit=function(a){try{this.processStyleUnit(this.getTarget(a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"adjustStyleUnit")}};this.processStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==
a.nodeType){for(var c=0;c<a.childNodes.length;c++){var b=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processStyleUnit(b)}this.doProcessStyleUnit(a)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"processStyleUnit")}};this.doProcessStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if("table"==c||"col"==c||"tr"==c||"td"==c||"div"==c||"p"==c||"h1"==c||"h2"==c||"h3"==c||"h4"==c||"h5"==c||"h6"==c){var b=g_objCommonUtil.extractNumberValueUnit(a.width),
d=g_objCommonUtil.extractNumberValueUnit(a.style.width);this.doProcessStyleUnit_Common(a,c,0,b,d);var e=g_objCommonUtil.extractNumberValueUnit(a.height),f=g_objCommonUtil.extractNumberValueUnit(a.style.height);this.doProcessStyleUnit_Common(a,c,1,e,f);var g=g_objCommonUtil.extractNumberValueUnit(a.style.marginLeft);this.doProcessStyleUnit_Common(a,c,2,null,g);var l=g_objCommonUtil.extractNumberValueUnit(a.style.marginTop);this.doProcessStyleUnit_Common(a,c,3,null,l);var m=g_objCommonUtil.extractNumberValueUnit(a.style.marginRight);
this.doProcessStyleUnit_Common(a,c,4,null,m);var h=g_objCommonUtil.extractNumberValueUnit(a.style.marginBottom);this.doProcessStyleUnit_Common(a,c,5,null,h);var k=g_objCommonUtil.extractNumberValueUnit(a.style.paddingLeft);this.doProcessStyleUnit_Common(a,c,6,null,k);var n=g_objCommonUtil.extractNumberValueUnit(a.style.paddingTop);this.doProcessStyleUnit_Common(a,c,7,null,n);var p=g_objCommonUtil.extractNumberValueUnit(a.style.paddingRight);this.doProcessStyleUnit_Common(a,c,8,null,p);var r=g_objCommonUtil.extractNumberValueUnit(a.style.paddingBottom);
this.doProcessStyleUnit_Common(a,c,9,null,r);if("table"==c||"td"==c||"div"==c){var t=g_objCommonUtil.extractNumberValueUnit(a.style.borderLeftWidth);this.doProcessStyleUnit_Common(a,c,10,null,t);var q=g_objCommonUtil.extractNumberValueUnit(a.style.borderTopWidth);this.doProcessStyleUnit_Common(a,c,11,null,q);var u=g_objCommonUtil.extractNumberValueUnit(a.style.borderRightWidth);this.doProcessStyleUnit_Common(a,c,12,null,u);var v=g_objCommonUtil.extractNumberValueUnit(a.style.borderBottomWidth);this.doProcessStyleUnit_Common(a,
c,13,null,v);this.doProcessStyleUnit_Color(a,0,a.style.borderLeftColor);this.doProcessStyleUnit_Color(a,1,a.style.borderTopColor);this.doProcessStyleUnit_Color(a,2,a.style.borderRightColor);this.doProcessStyleUnit_Color(a,3,a.style.borderBottomColor)}}}}catch(w){g_objCommonUtil.displayErrorAlert(w,"doProcessStyleUnit")}};this.doProcessStyleUnit_Common=function(a,c,b,d,e){try{if(null!=d||null!=e)if(null==d&&null!=e)if("pt"==e.strUnit)if(0==b)a.style.width=a.offsetWidth;else if(1==b)a.style.height=
a.offsetHeight;else if(2==b||3==b||4==b||5==b){var f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue);null!=f&&(2==b?a.style.marginLeft=f+"px":3==b?a.style.marginTop=f+"px":4==b?a.style.marginRight=f+"px":5==b&&(a.style.marginBottom=f+"px"))}else if(6==b||7==b||8==b||9==b)f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=f&&(6==b?a.style.paddingLeft=f+"px":7==b?a.style.paddingTop=f+"px":8==b?a.style.paddingRight=f+"px":9==b&&(a.style.paddingBottom=f+"px"));else{if(10==b||11==b||12==b||13==b)f=
g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=f&&(10==b?a.style.borderLeftWidth=f+"px":11==b?a.style.borderTopWidth=f+"px":12==b?a.style.borderRightWidth=f+"px":13==b&&(a.style.borderBottomWidth=f+"px"))}else 2==b||3==b||4==b||5==b?0==e.nValue&&(2==b?a.style.marginLeft=0:3==b?a.style.marginTop=0:4==b?a.style.marginRight=0:5==b&&(a.style.marginBottom=0)):6!=b&&7!=b&&8!=b&&9!=b||0!=e.nValue||(6==b?a.style.paddingLeft=0:7==b?a.style.paddingTop=0:8==b?a.style.paddingRight=0:9==b&&(a.style.paddingBottom=
0));else null!=d&&null==e||null==d||null==e||""!=d.strUnit||"pt"!=e.strUnit||(0==b?a.style.width="":1==b&&"tr"!=c&&(a.style.height=a.offsetHeight))}catch(g){g_objCommonUtil.displayErrorAlert(g,"doProcessStyleUnit_Common")}};this.doProcessStyleUnit_Color=function(a,c,b){try{if(null!=b&&""!=b){var d=g_objCommonUtil.getHexColorCodeByNickName(b);d!=b&&(0==c?a.style.borderLeftColor=d:1==c?a.style.borderTopColor=d:2==c?a.style.borderRightColor=d:3==c&&(a.style.borderBottomColor=d))}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"doProcessStyleUnit_Color")}};this.checkPasteCode_Excel_WK=function(a){try{var c=a.clipboardData.getData("text/html"),b=g_objCodeParser.initParserStruct(c);if(!b)return!1;g_objCodeParser.parseBody(b.stDocRoot,b);var d=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_HTML);if(null==d)return!1;this.nPasteType_WK=-1;var e=this.findNodeAttributeValue(b,d,"xmlns:x");null!=e&&"urn:schemas-microsoft-com:office:excel"==e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_EXCEL);-1==this.nPasteType_WK&&(e=this.findNodeAttributeValue(b,
d,"xmlns:w"),null!=e&&"urn:schemas-microsoft-com:office:word"==e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_WORD));if(-1==this.nPasteType_WK)return!1;var f=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_STYLE);if(null==f)return!1;var g=this.getNodeContent(b,f);if(null==g||""==g)return!1;this.objPasteCssStruct_WK=null;this.objPasteCssStruct_WK=g_objCssParser.initCssParserStruct(g);if(!this.objPasteCssStruct_WK)return!1;g_objCssParser.parseCss(this.objPasteCssStruct_WK.stDocRoot,this.objPasteCssStruct_WK);
return!0}catch(l){g_objCommonUtil.displayErrorAlert(l,"checkPasteCode_Excel_WK")}this.objPasteCssStruct_WK=null;return!1};this.findTagNode=function(a,c){try{if(null==a)return null;for(var b=a.content;null!=b;b=b.next)if(g_objCodeDefine.ID_TAG_UNKNOWN!=b.tagID){if(c==b.tagID)return b;var d=this.findTagNode(b,c);if(null!=d)return d}}catch(e){g_objCommonUtil.displayErrorAlert(e,"findTagNode")}return null};this.findNodeAttributeValue=function(a,c,b){try{if(g_objCodeDefine.ID_TAG_UNKNOWN==c.tagID)return null;
if(null!=c.arrAttribute)for(var d=0;d<c.arrAttribute.length;d++){var e=c.arrAttribute[d];if(b==e.attributeName)return a.stDocStreamIn.htmlCode.substring(e.attributeStartPos,e.attributeEndPos+1).toLowerCase()}}catch(f){g_objCommonUtil.displayErrorAlert(f,"findNodeAttributeValue")}return null};this.getNodeContent=function(a,c){try{if(null==c)return null;for(var b="",d=c.content;null!=d;d=d.next)b+=a.stDocStreamIn.htmlCode.substring(d.textStartPos,d.textEndPos+1);return b}catch(e){g_objCommonUtil.displayErrorAlert(e,
"getNodeContent")}return null};this.adjustPasteCode_WK=function(a){try{if(g_bBrowserType_WK&&-1!=this.nPasteType_WK){for(var c=new Set,b=this.objPasteCssStruct_WK.stDocRoot.content;null!=b;b=b.next)if(null!=b.arrCssClassName)for(var d=0;d<b.arrCssClassName.length;d++){var e=b.arrCssClassName[d];if(null!=e&&""!=e)if(-1!=e.indexOf(".")){var f=e.split(".");if(2==f.length){e=f[1];var g=g_objEditorDocument[a].getElementsByClassName(e);if(null!=g&&0!=g.length){var l=this.makeStyleString_WK(b);if(null!=
l&&""!=l){for(var m=0;m<g.length;m++){var h=g[m];"undefined"==typeof h.paste_style&&(h.paste_style="");h.paste_style+=l;c.add(h)}for(;;)if(g=g_objEditorDocument[a].getElementsByClassName(e),0<g.length)g[0].removeAttribute("class");else break}}}}else{var k=g_objCodeLexer.findTagDefineID(e);if(g_objCodeDefine.ID_TAG_UNKNOWN!=k&&g_objCodeDefine.ID_TAG_TD==k&&(g=this.getTarget(a).getElementsByTagName(e),null!=g&&0!=g.length)){var n=this.makeStyleString_WK_Filter(b);if(null!=n&&""!=n)for(m=0;m<g.length;m++)h=
g[m],"undefined"==typeof h.paste_style&&(h.paste_style=""),h.paste_style+=n,c.add(h)}}}c.forEach(function(a){var b=a.getAttribute("style");a.setAttribute("style",a.paste_style+b);a.paste_style=null;a.removeAttribute("paste_style")});g_objAdjustDoc.showAdjustWaitStatus(!0,a);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(a)},100)}}catch(p){g_objCommonUtil.displayErrorAlert(p,"adjustPasteCode_WK")}};this.makeStyleString_WK=function(a){try{if(!g_bBrowserType_WK||null==
a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];if(!/mso-/gi.test(d.styleName)){var e=d.styleValue;-1!=d.styleName.indexOf("border")&&(e=e.replace(/dot-dot-dash/gi,"dotted"),e=e.replace(/dot-dash-slanted/gi,"dotted"),e=e.replace(/dot-dash/gi,"dotted"),e=e.replace(/hairline/gi,"dotted"));c+=d.styleName+":"+e+";"}}return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"makeStyleString_WK")}return null};this.makeStyleString_WK_Filter=function(a){try{if(!g_bBrowserType_WK||
null==a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b],e=!1;switch(d.styleName){case "font-family":case "white-space":e=!1;break;default:e=!0}e||(c+=d.styleName+":"+d.styleValue+";")}return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"makeStyleString_WK_Filter")}return null};this.setStyleString_With_Compare_WK=function(a,c){try{if(g_bBrowserType_WK&&null!=a)for(var b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];"font-family"==
d.styleName?this.setStyleString_With_Compare_Process_WK("font-family",d.styleValue,c):"white-space"==d.styleName&&this.setStyleString_With_Compare_Process_WK("white-space",d.styleValue,c)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"setStyleString_With_Compare_WK")}};this.setStyleString_With_Compare_Process_WK=function(a,c,b){try{if(!g_bBrowserType_WK)return null;for(var d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("style");null==f&&(f="");for(var g=!1,l=f.split(";"),m=0;m<l.length;m++)-1!=l[m].trim().indexOf(a)&&
(g=!0);g||e.setAttribute("style",f+";"+a+":"+c+";")}}catch(h){g_objCommonUtil.displayErrorAlert(h,"setStyleString_With_Compare_Process_WK")}};this.addParaToCell=function(a,c){try{if(!c||!dzeUiConfig.bUsePasteCapture)return!1;var b=g_objEditorDocument[a],d=g_objEditWindow[a];if(!b||!d)return!1;var e=g_objNodeUtil,f=null,g=[camelCase("font-family"),camelCase("font-size"),camelCase("color"),camelCase("text-align")],l=[null,g_objPropertyUtil.checkStyleFontSize,null,null],m=[].slice.call(c.getElementsByTagName("td")),
h=[].slice.call(c.getElementsByTagName("th"));m.concat(h).forEach(function(a){if(a.firstChild&&g_objNodeUtil.isAllTextInlineChildNode(a)){var c=b.createElement("p");f=null;for(var h=0;h<g.length;h++){var m=g[h];var k=m;var q=a.style[k];k=q?q:(k=(f=f||d.getComputedStyle(a,null))?f[k]:null)?k:null;k&&(l[h]&&(k=l[h](k)),k&&(c.style[m]=k))}e.moveNodesTo(c,a.firstChild);a.appendChild(c)}})}catch(k){g_objCommonUtil.displayErrorAlert(k,"g_objAdjustDoc.addParaToCell")}};this.setParaInlineStyle=function(a,
c){try{if(!c||!dzeUiConfig.bUsePasteCapture)return!1;var b=g_objEditWindow[a];if(!g_objEditorDocument[a]||!b)return!1;var d=[camelCase("font-family"),camelCase("font-size"),camelCase("color"),camelCase("line-height"),camelCase("margin-top"),camelCase("margin-bottom")],e=[null,g_objPropertyUtil.checkStyleFontSize,null,g_objPropertyUtil.checkStyleLineHeightValue,null,null],f=c.getElementsByTagName("p");f=[].slice.call(f);f.forEach(function(a){for(var c=null,f=0;f<d.length;f++){var g=d[f],k=a.style[g];
!k&&(c=c||b.getComputedStyle(a,null),k=c[g])&&(e[f]&&(k=e[f](k)),k&&(a.style[g]=k))}})}catch(g){g_objCommonUtil.displayErrorAlert(g,"g_objAdjustDoc.setParaInlineStyle")}};this.remove_Br_Node_Inside_P_Node=function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("p");for(a=0;a<c.length;a++){var b=c[a],d=b.childNodes.length;if(!(1>=d)){var e=b.childNodes[d-1];"br"==e.nodeName.toLowerCase()&&this.isAllTextNodeExceptLastOne(b)&&b.removeChild(e)}}}}catch(f){g_objCommonUtil.displayErrorAlert(f,
"remove_Br_Node_Inside_P_Node")}};this.isAllTextNodeExceptLastOne=function(a){try{for(var c=0;c<a.childNodes.length-1;c++)if(ID_SELECTION_ELEMENT_NODE==a.childNodes[c].nodeType)return!1;return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"isAllTextNodeExceptLastOne")}return!1};this.changeTableAlignToMarginStyle=function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("table");for(a=0;a<c.length;a++){var b=c[a],d=b.getAttribute("align");""!=d&&null!=d&&(d=d.toLowerCase(),
"left"==d?(b.removeAttribute("align"),b.style.marginLeft="0px",b.style.marginRight="auto"):"right"==d&&(b.removeAttribute("align"),b.style.marginLeft="auto",b.style.marginRight="0px"))}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"changeTableAlignToMarginStyle")}}};

function setInitEnterCode(a,d){try{g_bAutoBrConvertPTag&&(setInitEnterCode_Loop(a,d),window.addEventListener&&g_objEditWindow[d].getSelection().removeAllRanges())}catch(e){}}
function setInitEnterCode_Loop(a,d){try{for(var e=0;e<a.childNodes.length;e++){var b=a.childNodes[e];if(ID_SELECTION_ELEMENT_NODE==b.nodeType){setInitEnterCode_Loop(b,d);var g=b.nodeName.toLowerCase();"p"!=g&&isAvailableTarget_EnterCode_Convert(g)&&setInitEnterCode_Logic(b,d)}}var c=a.nodeName.toLowerCase();isAvailableTarget_EnterCode_Convert(c)&&setInitEnterCode_Logic(a,d)}catch(f){}}
function isAvailableTarget_EnterCode_Convert(a){return"body"==a||"td"==a||"th"==a||"div"==a||"article"==a||"section"==a?!0:!1}
function setInitEnterCode_Logic(a,d){try{var e=!1;if(0<a.childNodes.length){if(1==a.childNodes.length){var b=a.childNodes[0];if(ID_SELECTION_TEXT_NODE==b.nodeType){var g=b.nodeValue;checkTextNodeAllWhiteCode_Plus_Space(g)&&(e=!0)}}if(!e){for(var c=g_objEditorDocument[d].createElement("p"),f=!1,h=0;h<a.childNodes.length;h++)if(b=a.childNodes[h],ID_SELECTION_ELEMENT_NODE==b.nodeType){var l=b.nodeName.toLowerCase();"br"==l?(f?(f=!1,a.insertBefore(c,b),a.removeChild(b)):(a.insertBefore(c,b),c.appendChild(b)),
c=null,c=g_objEditorDocument[d].createElement("p")):checkIsInLineNode(l)?(f=!0,c.appendChild(b),h--):f&&(f=!1,a.insertBefore(c,b),h++,c=null,c=g_objEditorDocument[d].createElement("p"))}else if(ID_SELECTION_TEXT_NODE==b.nodeType){g=b.nodeValue;var k=checkTextNodeValue(g);k&&k.bEveryWhiteSpace&&!k.bSomeZeroWidthSpace||(k&&k.bEveryWhiteSpace&&k.bSomeZeroWidthSpace&&g_objNodeUtil.checkTagName(b.parentNode,"body")?b.nodeValue=removeZeroWidthSpaceFromString(g):(f=!0,c.appendChild(b),h--))}f&&a.appendChild(c)}}else e=
!0;e&&(c=make_P_Include_Br_Element(d))&&a.appendChild(c)}catch(m){}}
function checkIsInLineNode(a){return"a"==a||"abbr"==a||"acronym"==a||"b"==a||"basefont"==a||"bdo"==a||"big"==a||"button"==a||"cite"==a||"code"==a||"dfn"==a||"em"==a||"font"==a||"i"==a||"img"==a||"input"==a||"kbd"==a||"label"==a||"legend"==a||"map"==a||"param"==a||"q"==a||"rb"==a||"rbc"==a||"rp"==a||"rt"==a||"rtc"==a||"ruby"==a||"s"==a||"samp"==a||"select"==a||"small"==a||"span"==a||"strike"==a||"strong"==a||"sub"==a||"sup"==a||"textarea"==a||"tt"==a||"u"==a||"var"==a?!0:!1}
function make_P_Include_Br_Element(a){try{var d=g_objEditorDocument[a].createElement("p"),e=g_objEditorDocument[a].createElement("br");d.appendChild(e);return d}catch(b){}return null};

var g_objCodeDefine=new function(){this.arrTagDefine=null;this.ID_TAG_A=0;this.ID_TAG_ABBR=1;this.ID_TAG_ACRONYM=2;this.ID_TAG_ADDRESS=3;this.ID_TAG_APPLET=4;this.ID_TAG_AREA=5;this.ID_TAG_B=6;this.ID_TAG_BASE=7;this.ID_TAG_BASEFONT=8;this.ID_TAG_BDO=9;this.ID_TAG_BIG=10;this.ID_TAG_BLOCKQUOTE=11;this.ID_TAG_BODY=12;this.ID_TAG_BR=13;this.ID_TAG_BUTTON=14;this.ID_TAG_CAPTION=15;this.ID_TAG_CENTER=16;this.ID_TAG_CITE=17;this.ID_TAG_CODE=18;this.ID_TAG_COL=19;this.ID_TAG_COLGROUP=20;this.ID_TAG_DD=
21;this.ID_TAG_DEL=22;this.ID_TAG_DFN=23;this.ID_TAG_DIR=24;this.ID_TAG_DIV=25;this.ID_TAG_DL=26;this.ID_TAG_DT=27;this.ID_TAG_EM=28;this.ID_TAG_FIELDSET=29;this.ID_TAG_FONT=30;this.ID_TAG_FORM=31;this.ID_TAG_FRAME=32;this.ID_TAG_FRAMESET=33;this.ID_TAG_H1=34;this.ID_TAG_H2=35;this.ID_TAG_H3=36;this.ID_TAG_H4=37;this.ID_TAG_H5=38;this.ID_TAG_H6=39;this.ID_TAG_HEAD=40;this.ID_TAG_HR=41;this.ID_TAG_HTML=42;this.ID_TAG_I=43;this.ID_TAG_IFRAME=44;this.ID_TAG_IMG=45;this.ID_TAG_INPUT=46;this.ID_TAG_INS=
47;this.ID_TAG_ISINDEX=48;this.ID_TAG_KBD=49;this.ID_TAG_LABEL=50;this.ID_TAG_LEGEND=51;this.ID_TAG_LI=52;this.ID_TAG_LINK=53;this.ID_TAG_LISTING=54;this.ID_TAG_MAP=55;this.ID_TAG_MENU=56;this.ID_TAG_META=57;this.ID_TAG_NEXTID=58;this.ID_TAG_NOFRAMES=59;this.ID_TAG_NOSCRIPT=60;this.ID_TAG_OBJECT=61;this.ID_TAG_OL=62;this.ID_TAG_OPTGROUP=63;this.ID_TAG_OPTION=64;this.ID_TAG_P=65;this.ID_TAG_PARAM=66;this.ID_TAG_PLAINTEXT=67;this.ID_TAG_PRE=68;this.ID_TAG_Q=69;this.ID_TAG_RB=70;this.ID_TAG_RBC=71;this.ID_TAG_RP=
72;this.ID_TAG_RT=73;this.ID_TAG_RTC=74;this.ID_TAG_RUBY=75;this.ID_TAG_S=76;this.ID_TAG_SAMP=77;this.ID_TAG_SCRIPT=78;this.ID_TAG_SELECT=79;this.ID_TAG_SMALL=80;this.ID_TAG_SPAN=81;this.ID_TAG_STRIKE=82;this.ID_TAG_STRONG=83;this.ID_TAG_STYLE=84;this.ID_TAG_SUB=85;this.ID_TAG_SUP=86;this.ID_TAG_TABLE=87;this.ID_TAG_TBODY=88;this.ID_TAG_TD=89;this.ID_TAG_TEXTAREA=90;this.ID_TAG_TFOOT=91;this.ID_TAG_TH=92;this.ID_TAG_THEAD=93;this.ID_TAG_TITLE=94;this.ID_TAG_TR=95;this.ID_TAG_TT=96;this.ID_TAG_U=97;
this.ID_TAG_UL=98;this.ID_TAG_VAR=99;this.ID_TAG_XMP=100;this.ID_TAG_UNKNOWN=101;this.CM_EMPTY=1;this.CM_HTML=2;this.CM_HEAD=4;this.CM_BLOCK=8;this.CM_INLINE=16;this.CM_LIST=32;this.CM_DEFLIST=64;this.CM_TABLE=128;this.CM_ROWGRP=256;this.CM_ROW=512;this.CM_FIELD=1024;this.CM_OBJECT=2048;this.CM_PARAM=4096;this.CM_FRAMES=8192;this.CM_HEADING=16384;this.CM_OPT=32768;this.CM_IMG=65536;this.CM_MIXED=131072;this.CM_NO_INDENT=262144;this.CM_OBSOLETE=524288;this.CM_NEW=1048576;this.CM_OMITST=2097152;this.arrAttrDefine=
null;this.ID_ATTR_ABBR=0;this.ID_ATTR_ACCEPT=1;this.ID_ATTR_ACCEPT_CHARSET=2;this.ID_ATTR_ACCESSKEY=3;this.ID_ATTR_ACTION=4;this.ID_ATTR_ALIGN=5;this.ID_ATTR_ALINK=6;this.ID_ATTR_ALT=7;this.ID_ATTR_ARCHIVE=8;this.ID_ATTR_AXIS=9;this.ID_ATTR_BACKGROUND=10;this.ID_ATTR_BGCOLOR=11;this.ID_ATTR_BORDER=12;this.ID_ATTR_CELLPADDING=13;this.ID_ATTR_CELLSPACING=14;this.ID_ATTR_CHAR=15;this.ID_ATTR_CHAROFF=16;this.ID_ATTR_CHARSET=17;this.ID_ATTR_CHECKED=18;this.ID_ATTR_CITE=19;this.ID_ATTR_CLASS=20;this.ID_ATTR_CLASSID=
21;this.ID_ATTR_CLEAR=22;this.ID_ATTR_CODE=23;this.ID_ATTR_CODEBASE=24;this.ID_ATTR_CODETYPE=25;this.ID_ATTR_COLOR=26;this.ID_ATTR_COLS=27;this.ID_ATTR_COLSPAN=28;this.ID_ATTR_COMPACT=29;this.ID_ATTR_CONTENT=30;this.ID_ATTR_COORDS=31;this.ID_ATTR_DATA=32;this.ID_ATTR_DATETIME=33;this.ID_ATTR_DECLARE=34;this.ID_ATTR_DEFER=35;this.ID_ATTR_DIR=36;this.ID_ATTR_DISABLED=37;this.ID_ATTR_ENCODING=38;this.ID_ATTR_ENCTYPE=39;this.ID_ATTR_EVENT=40;this.ID_ATTR_FACE=41;this.ID_ATTR_FOR=42;this.ID_ATTR_FRAME=
43;this.ID_ATTR_FRAMEBORDER=44;this.ID_ATTR_HEADERS=45;this.ID_ATTR_HEIGHT=46;this.ID_ATTR_HREF=47;this.ID_ATTR_HREFLANG=48;this.ID_ATTR_HSPACE=49;this.ID_ATTR_HTTP_EQUIV=50;this.ID_ATTR_ID=51;this.ID_ATTR_ISMAP=52;this.ID_ATTR_LABEL=53;this.ID_ATTR_LANG=54;this.ID_ATTR_LANGUAGE=55;this.ID_ATTR_LINK=56;this.ID_ATTR_LONGDESC=57;this.ID_ATTR_MARGINHEIGHT=58;this.ID_ATTR_MARGINWIDTH=59;this.ID_ATTR_MAXLENGTH=60;this.ID_ATTR_MEDIA=61;this.ID_ATTR_METHOD=62;this.ID_ATTR_METHODS=63;this.ID_ATTR_MULTIPLE=
64;this.ID_ATTR_N=65;this.ID_ATTR_NAME=66;this.ID_ATTR_NOHREF=67;this.ID_ATTR_NORESIZE=68;this.ID_ATTR_NOSHADE=69;this.ID_ATTR_NOWRAP=70;this.ID_ATTR_OBJECT=71;this.ID_ATTR_ONBLUR=72;this.ID_ATTR_ONCHANGE=73;this.ID_ATTR_ONCLICK=74;this.ID_ATTR_ONDBLCLICK=75;this.ID_ATTR_ONFOCUS=76;this.ID_ATTR_ONKEYDOWN=77;this.ID_ATTR_ONKEYPRESS=78;this.ID_ATTR_ONKEYUP=79;this.ID_ATTR_ONLOAD=80;this.ID_ATTR_ONMOUSEDOWN=81;this.ID_ATTR_ONMOUSEMOVE=82;this.ID_ATTR_ONMOUSEOUT=83;this.ID_ATTR_ONMOUSEOVER=84;this.ID_ATTR_ONMOUSEUP=
85;this.ID_ATTR_ONRESET=86;this.ID_ATTR_ONSELECT=87;this.ID_ATTR_ONSUBMIT=88;this.ID_ATTR_ONUNLOAD=89;this.ID_ATTR_PROFILE=90;this.ID_ATTR_PROMPT=91;this.ID_ATTR_RBSPAN=92;this.ID_ATTR_READONLY=93;this.ID_ATTR_REL=94;this.ID_ATTR_REV=95;this.ID_ATTR_ROWS=96;this.ID_ATTR_ROWSPAN=97;this.ID_ATTR_RULES=98;this.ID_ATTR_SCHEME=99;this.ID_ATTR_SCOPE=100;this.ID_ATTR_SCROLLING=101;this.ID_ATTR_SDAFORM=102;this.ID_ATTR_SDAPREF=103;this.ID_ATTR_SDASUFF=104;this.ID_ATTR_SELECTED=105;this.ID_ATTR_SHAPE=106;
this.ID_ATTR_SIZE=107;this.ID_ATTR_SPAN=108;this.ID_ATTR_SRC=109;this.ID_ATTR_STANDBY=110;this.ID_ATTR_START=111;this.ID_ATTR_STYLE=112;this.ID_ATTR_SUMMARY=113;this.ID_ATTR_TABINDEX=114;this.ID_ATTR_TARGET=115;this.ID_ATTR_TEXT=116;this.ID_ATTR_TITLE=117;this.ID_ATTR_TYPE=118;this.ID_ATTR_URN=119;this.ID_ATTR_USEMAP=120;this.ID_ATTR_VALIGN=121;this.ID_ATTR_VALUE=122;this.ID_ATTR_VALUETYPE=123;this.ID_ATTR_VERSION=124;this.ID_ATTR_VLINK=125;this.ID_ATTR_VSPACE=126;this.ID_ATTR_WIDTH=127;this.ID_ATTR_XML_LANG=
128;this.ID_ATTR_XML_SPACE=129;this.ID_ATTR_XMLNS=130;this.ID_ATTR_UNKNOWN=131;this.initTagDefine=function(){try{this.arrTagDefine||(this.arrTagDefine=[],this.arrTagDefine[this.ID_TAG_A]=["a",16,0],this.arrTagDefine[this.ID_TAG_ABBR]=["abbr",16,0],this.arrTagDefine[this.ID_TAG_ACRONYM]=["acronym",16,0],this.arrTagDefine[this.ID_TAG_ADDRESS]=["address",8,0],this.arrTagDefine[this.ID_TAG_APPLET]=["applet",71696,0],this.arrTagDefine[this.ID_TAG_AREA]=["area",9,1],this.arrTagDefine[this.ID_TAG_B]=["b",
16,0],this.arrTagDefine[this.ID_TAG_BASE]=["base",5,0],this.arrTagDefine[this.ID_TAG_BASEFONT]=["basefont",17,1],this.arrTagDefine[this.ID_TAG_BDO]=["bdo",16,0],this.arrTagDefine[this.ID_TAG_BIG]=["big",16,0],this.arrTagDefine[this.ID_TAG_BLOCKQUOTE]=["blockquote",8,0],this.arrTagDefine[this.ID_TAG_BODY]=["body",2129922,0],this.arrTagDefine[this.ID_TAG_BR]=["br",17,0],this.arrTagDefine[this.ID_TAG_BUTTON]=["button",16,0],this.arrTagDefine[this.ID_TAG_CAPTION]=["caption",128,0],this.arrTagDefine[this.ID_TAG_CENTER]=
["center",8,0],this.arrTagDefine[this.ID_TAG_CITE]=["cite",16,0],this.arrTagDefine[this.ID_TAG_CODE]=["code",16,0],this.arrTagDefine[this.ID_TAG_COL]=["col",129,0],this.arrTagDefine[this.ID_TAG_COLGROUP]=["colgroup",32896,0],this.arrTagDefine[this.ID_TAG_DD]=["dd",294976,0],this.arrTagDefine[this.ID_TAG_DEL]=["del",131096,0],this.arrTagDefine[this.ID_TAG_DFN]=["dfn",16,0],this.arrTagDefine[this.ID_TAG_DIR]=["dir",524296,0],this.arrTagDefine[this.ID_TAG_DIV]=["div",8,0],this.arrTagDefine[this.ID_TAG_DL]=
["dl",8,0],this.arrTagDefine[this.ID_TAG_DT]=["dt",294976,0],this.arrTagDefine[this.ID_TAG_EM]=["em",16,0],this.arrTagDefine[this.ID_TAG_FIELDSET]=["fieldset",8,0],this.arrTagDefine[this.ID_TAG_FONT]=["font",16,0],this.arrTagDefine[this.ID_TAG_FORM]=["form",8,1],this.arrTagDefine[this.ID_TAG_FRAME]=["frame",8193,0],this.arrTagDefine[this.ID_TAG_FRAMESET]=["frameset",8194,0],this.arrTagDefine[this.ID_TAG_H1]=["h1",16392,0],this.arrTagDefine[this.ID_TAG_H2]=["h2",16392,0],this.arrTagDefine[this.ID_TAG_H3]=
["h3",16392,0],this.arrTagDefine[this.ID_TAG_H4]=["h4",16392,0],this.arrTagDefine[this.ID_TAG_H5]=["h5",16392,0],this.arrTagDefine[this.ID_TAG_H6]=["h6",16392,0],this.arrTagDefine[this.ID_TAG_HEAD]=["head",2129922,0],this.arrTagDefine[this.ID_TAG_HR]=["hr",9,0],this.arrTagDefine[this.ID_TAG_HTML]=["html",2129922,0],this.arrTagDefine[this.ID_TAG_I]=["i",16,0],this.arrTagDefine[this.ID_TAG_IFRAME]=["iframe",16,0],this.arrTagDefine[this.ID_TAG_IMG]=["img",65553,1],this.arrTagDefine[this.ID_TAG_INPUT]=
["input",65553,0],this.arrTagDefine[this.ID_TAG_INS]=["ins",131096,0],this.arrTagDefine[this.ID_TAG_ISINDEX]=["isindex",9,0],this.arrTagDefine[this.ID_TAG_KBD]=["kbd",16,0],this.arrTagDefine[this.ID_TAG_LABEL]=["label",16,0],this.arrTagDefine[this.ID_TAG_LEGEND]=["legend",16,0],this.arrTagDefine[this.ID_TAG_LI]=["li",294944,0],this.arrTagDefine[this.ID_TAG_LINK]=["link",5,1],this.arrTagDefine[this.ID_TAG_LISTING]=["listing",524296,0],this.arrTagDefine[this.ID_TAG_MAP]=["map",16,1],this.arrTagDefine[this.ID_TAG_MENU]=
["menu",524296,0],this.arrTagDefine[this.ID_TAG_META]=["meta",5,1],this.arrTagDefine[this.ID_TAG_NEXTID]=["nextid",5,0],this.arrTagDefine[this.ID_TAG_NOFRAMES]=["noframes",8200,0],this.arrTagDefine[this.ID_TAG_NOSCRIPT]=["noscript",131096,0],this.arrTagDefine[this.ID_TAG_OBJECT]=["object",71700,0],this.arrTagDefine[this.ID_TAG_OL]=["ol",8,0],this.arrTagDefine[this.ID_TAG_OPTGROUP]=["optgroup",33792,0],this.arrTagDefine[this.ID_TAG_OPTION]=["option",33792,0],this.arrTagDefine[this.ID_TAG_P]=["p",32776,
0],this.arrTagDefine[this.ID_TAG_PARAM]=["param",17,1],this.arrTagDefine[this.ID_TAG_PLAINTEXT]=["plaintext",524296,0],this.arrTagDefine[this.ID_TAG_PRE]=["pre",8,0],this.arrTagDefine[this.ID_TAG_Q]=["q",16,0],this.arrTagDefine[this.ID_TAG_RB]=["rb",16,0],this.arrTagDefine[this.ID_TAG_RBC]=["rbc",16,0],this.arrTagDefine[this.ID_TAG_RP]=["rp",16,0],this.arrTagDefine[this.ID_TAG_RT]=["rt",16,0],this.arrTagDefine[this.ID_TAG_RTC]=["rtc",16,0],this.arrTagDefine[this.ID_TAG_RUBY]=["ruby",16,0],this.arrTagDefine[this.ID_TAG_S]=
["s",16,0],this.arrTagDefine[this.ID_TAG_SAMP]=["samp",16,0],this.arrTagDefine[this.ID_TAG_SCRIPT]=["script",131100,1],this.arrTagDefine[this.ID_TAG_SELECT]=["select",1040,0],this.arrTagDefine[this.ID_TAG_SMALL]=["small",16,0],this.arrTagDefine[this.ID_TAG_SPAN]=["span",16,0],this.arrTagDefine[this.ID_TAG_STRIKE]=["strike",16,0],this.arrTagDefine[this.ID_TAG_STRONG]=["strong",16,0],this.arrTagDefine[this.ID_TAG_STYLE]=["style",4,1],this.arrTagDefine[this.ID_TAG_SUB]=["sub",16,0],this.arrTagDefine[this.ID_TAG_SUP]=
["sup",16,0],this.arrTagDefine[this.ID_TAG_TABLE]=["table",8,1],this.arrTagDefine[this.ID_TAG_TBODY]=["tbody",33152,0],this.arrTagDefine[this.ID_TAG_TD]=["td",295424,0],this.arrTagDefine[this.ID_TAG_TEXTAREA]=["textarea",1040,0],this.arrTagDefine[this.ID_TAG_TFOOT]=["tfoot",33152,0],this.arrTagDefine[this.ID_TAG_TH]=["th",295424,0],this.arrTagDefine[this.ID_TAG_THEAD]=["thead",33152,0],this.arrTagDefine[this.ID_TAG_TITLE]=["title",4,0],this.arrTagDefine[this.ID_TAG_TR]=["tr",32896,0],this.arrTagDefine[this.ID_TAG_TT]=
["tt",16,0],this.arrTagDefine[this.ID_TAG_U]=["u",16,0],this.arrTagDefine[this.ID_TAG_UL]=["ul",8,0],this.arrTagDefine[this.ID_TAG_VAR]=["var",16,0],this.arrTagDefine[this.ID_TAG_XMP]=["xmp",524296,0])}catch(b){g_objCommonUtil.displayErrorAlert(b,"initTagDefine")}};this.getTagDefineID=function(b,a){try{for(var c=this.ID_TAG_UNKNOWN;a<c;a++)if(this.arrTagDefine[a][0]==b)return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getTagDefineID")}return this.ID_TAG_UNKNOWN};this.nodeHasCM=function(b,a){try{return this.ID_TAG_UNKNOWN==
b.tagID?!1:0!=(this.arrTagDefine[b.tagID][1]&a)?!0:!1}catch(c){g_objCommonUtil.displayErrorAlert(c,"nodeHasCM")}return!1};this.initAttrDefine=function(){try{this.arrAttrDefine||(this.arrAttrDefine=[],this.arrAttrDefine[this.ID_ATTR_ABBR]=["abbr",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT]=["accept",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT_CHARSET]=["accept-charset",0],this.arrAttrDefine[this.ID_ATTR_ACCESSKEY]=["accesskey",0],this.arrAttrDefine[this.ID_ATTR_ACTION]=["action",0],this.arrAttrDefine[this.ID_ATTR_ALIGN]=
["align",1],this.arrAttrDefine[this.ID_ATTR_ALINK]=["alink",1],this.arrAttrDefine[this.ID_ATTR_ALT]=["alt",0],this.arrAttrDefine[this.ID_ATTR_ARCHIVE]=["archive",0],this.arrAttrDefine[this.ID_ATTR_AXIS]=["axis",0],this.arrAttrDefine[this.ID_ATTR_BACKGROUND]=["background",0],this.arrAttrDefine[this.ID_ATTR_BGCOLOR]=["bgcolor",1],this.arrAttrDefine[this.ID_ATTR_BORDER]=["border",1],this.arrAttrDefine[this.ID_ATTR_CELLPADDING]=["cellpadding",0],this.arrAttrDefine[this.ID_ATTR_CELLSPACING]=["cellspacing",
0],this.arrAttrDefine[this.ID_ATTR_CHAR]=["char",0],this.arrAttrDefine[this.ID_ATTR_CHAROFF]=["charoff",0],this.arrAttrDefine[this.ID_ATTR_CHARSET]=["charset",1],this.arrAttrDefine[this.ID_ATTR_CHECKED]=["checked",1],this.arrAttrDefine[this.ID_ATTR_CITE]=["cite",0],this.arrAttrDefine[this.ID_ATTR_CLASS]=["class",0],this.arrAttrDefine[this.ID_ATTR_CLASSID]=["classid",0],this.arrAttrDefine[this.ID_ATTR_CLEAR]=["clear",1],this.arrAttrDefine[this.ID_ATTR_CODE]=["code",0],this.arrAttrDefine[this.ID_ATTR_CODEBASE]=
["codebase",0],this.arrAttrDefine[this.ID_ATTR_CODETYPE]=["codetype",0],this.arrAttrDefine[this.ID_ATTR_COLOR]=["color",1],this.arrAttrDefine[this.ID_ATTR_COLS]=["cols",0],this.arrAttrDefine[this.ID_ATTR_COLSPAN]=["colspan",0],this.arrAttrDefine[this.ID_ATTR_COMPACT]=["compact",1],this.arrAttrDefine[this.ID_ATTR_CONTENT]=["content",0],this.arrAttrDefine[this.ID_ATTR_COORDS]=["coords",0],this.arrAttrDefine[this.ID_ATTR_DATA]=["data",0],this.arrAttrDefine[this.ID_ATTR_DATETIME]=["datetime",0],this.arrAttrDefine[this.ID_ATTR_DECLARE]=
["declare",1],this.arrAttrDefine[this.ID_ATTR_DEFER]=["defer",1],this.arrAttrDefine[this.ID_ATTR_DIR]=["dir",1],this.arrAttrDefine[this.ID_ATTR_DISABLED]=["disabled",1],this.arrAttrDefine[this.ID_ATTR_ENCODING]=["encoding",0],this.arrAttrDefine[this.ID_ATTR_ENCTYPE]=["enctype",1],this.arrAttrDefine[this.ID_ATTR_EVENT]=["event",0],this.arrAttrDefine[this.ID_ATTR_FACE]=["face",1],this.arrAttrDefine[this.ID_ATTR_FOR]=["for",0],this.arrAttrDefine[this.ID_ATTR_FRAME]=["frame",1],this.arrAttrDefine[this.ID_ATTR_FRAMEBORDER]=
["frameborder",0],this.arrAttrDefine[this.ID_ATTR_HEADERS]=["headers",0],this.arrAttrDefine[this.ID_ATTR_HEIGHT]=["height",0],this.arrAttrDefine[this.ID_ATTR_HREF]=["href",0],this.arrAttrDefine[this.ID_ATTR_HREFLANG]=["hreflang",0],this.arrAttrDefine[this.ID_ATTR_HSPACE]=["hspace",0],this.arrAttrDefine[this.ID_ATTR_HTTP_EQUIV]=["http-equiv",0],this.arrAttrDefine[this.ID_ATTR_ID]=["id",0],this.arrAttrDefine[this.ID_ATTR_ISMAP]=["ismap",1],this.arrAttrDefine[this.ID_ATTR_LABEL]=["label",0],this.arrAttrDefine[this.ID_ATTR_LANG]=
["lang",1],this.arrAttrDefine[this.ID_ATTR_LANGUAGE]=["language",1],this.arrAttrDefine[this.ID_ATTR_LINK]=["link",0],this.arrAttrDefine[this.ID_ATTR_LONGDESC]=["longdesc",0],this.arrAttrDefine[this.ID_ATTR_MARGINHEIGHT]=["marginheight",0],this.arrAttrDefine[this.ID_ATTR_MARGINWIDTH]=["marginwidth",0],this.arrAttrDefine[this.ID_ATTR_MAXLENGTH]=["maxlength",0],this.arrAttrDefine[this.ID_ATTR_MEDIA]=["media",0],this.arrAttrDefine[this.ID_ATTR_METHOD]=["method",1],this.arrAttrDefine[this.ID_ATTR_METHODS]=
["methods",0],this.arrAttrDefine[this.ID_ATTR_MULTIPLE]=["multiple",1],this.arrAttrDefine[this.ID_ATTR_N]=["n",0],this.arrAttrDefine[this.ID_ATTR_NAME]=["name",0],this.arrAttrDefine[this.ID_ATTR_NOHREF]=["nohref",1],this.arrAttrDefine[this.ID_ATTR_NORESIZE]=["noresize",1],this.arrAttrDefine[this.ID_ATTR_NOSHADE]=["noshade",1],this.arrAttrDefine[this.ID_ATTR_NOWRAP]=["nowrap",1],this.arrAttrDefine[this.ID_ATTR_OBJECT]=["object",0],this.arrAttrDefine[this.ID_ATTR_ONBLUR]=["onblur",0],this.arrAttrDefine[this.ID_ATTR_ONCHANGE]=
["onchange",0],this.arrAttrDefine[this.ID_ATTR_ONCLICK]=["onclick",0],this.arrAttrDefine[this.ID_ATTR_ONDBLCLICK]=["ondblclick",0],this.arrAttrDefine[this.ID_ATTR_ONFOCUS]=["onfocus",0],this.arrAttrDefine[this.ID_ATTR_ONKEYDOWN]=["onkeydown",0],this.arrAttrDefine[this.ID_ATTR_ONKEYPRESS]=["onkeypress",0],this.arrAttrDefine[this.ID_ATTR_ONKEYUP]=["onkeyup",0],this.arrAttrDefine[this.ID_ATTR_ONLOAD]=["onload",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEDOWN]=["onmousedown",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEMOVE]=
["onmousemove",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOUT]=["onmouseout",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOVER]=["onmouseover",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEUP]=["onmouseup",0],this.arrAttrDefine[this.ID_ATTR_ONRESET]=["onreset",0],this.arrAttrDefine[this.ID_ATTR_ONSELECT]=["onselect",0],this.arrAttrDefine[this.ID_ATTR_ONSUBMIT]=["onsubmit",0],this.arrAttrDefine[this.ID_ATTR_ONUNLOAD]=["onunload",0],this.arrAttrDefine[this.ID_ATTR_PROFILE]=["profile",0],this.arrAttrDefine[this.ID_ATTR_PROMPT]=
["prompt",0],this.arrAttrDefine[this.ID_ATTR_RBSPAN]=["rbspan",0],this.arrAttrDefine[this.ID_ATTR_READONLY]=["readonly",1],this.arrAttrDefine[this.ID_ATTR_REL]=["rel",0],this.arrAttrDefine[this.ID_ATTR_REV]=["rev",0],this.arrAttrDefine[this.ID_ATTR_ROWS]=["rows",0],this.arrAttrDefine[this.ID_ATTR_ROWSPAN]=["rowspan",0],this.arrAttrDefine[this.ID_ATTR_RULES]=["rules",0],this.arrAttrDefine[this.ID_ATTR_SCHEME]=["scheme",0],this.arrAttrDefine[this.ID_ATTR_SCOPE]=["scope",1],this.arrAttrDefine[this.ID_ATTR_SCROLLING]=
["scrolling",1],this.arrAttrDefine[this.ID_ATTR_SDAFORM]=["sdaform",0],this.arrAttrDefine[this.ID_ATTR_SDAPREF]=["sdapref",0],this.arrAttrDefine[this.ID_ATTR_SDASUFF]=["sdasuff",0],this.arrAttrDefine[this.ID_ATTR_SELECTED]=["selected",1],this.arrAttrDefine[this.ID_ATTR_SHAPE]=["shape",1],this.arrAttrDefine[this.ID_ATTR_SIZE]=["size",0],this.arrAttrDefine[this.ID_ATTR_SPAN]=["span",0],this.arrAttrDefine[this.ID_ATTR_SRC]=["src",0],this.arrAttrDefine[this.ID_ATTR_STANDBY]=["standby",0],this.arrAttrDefine[this.ID_ATTR_START]=
["start",0],this.arrAttrDefine[this.ID_ATTR_STYLE]=["style",1],this.arrAttrDefine[this.ID_ATTR_SUMMARY]=["summary",0],this.arrAttrDefine[this.ID_ATTR_TABINDEX]=["tabindex",0],this.arrAttrDefine[this.ID_ATTR_TARGET]=["target",1],this.arrAttrDefine[this.ID_ATTR_TEXT]=["text",0],this.arrAttrDefine[this.ID_ATTR_TITLE]=["title",0],this.arrAttrDefine[this.ID_ATTR_TYPE]=["type",0],this.arrAttrDefine[this.ID_ATTR_URN]=["urn",0],this.arrAttrDefine[this.ID_ATTR_USEMAP]=["usemap",0],this.arrAttrDefine[this.ID_ATTR_VALIGN]=
["valign",1],this.arrAttrDefine[this.ID_ATTR_VALUE]=["value",0],this.arrAttrDefine[this.ID_ATTR_VALUETYPE]=["valuetype",1],this.arrAttrDefine[this.ID_ATTR_VERSION]=["version",0],this.arrAttrDefine[this.ID_ATTR_VLINK]=["vlink",0],this.arrAttrDefine[this.ID_ATTR_VSPACE]=["vspace",0],this.arrAttrDefine[this.ID_ATTR_WIDTH]=["width",0],this.arrAttrDefine[this.ID_ATTR_XML_LANG]=["xml:lang",0],this.arrAttrDefine[this.ID_ATTR_XML_SPACE]=["xml:space",0],this.arrAttrDefine[this.ID_ATTR_XMLNS]=["xmlns",0])}catch(b){g_objCommonUtil.displayErrorAlert(b,
"initAttrDefine")}};this.getAttrDefineID=function(b,a){try{for(var c=this.ID_ATTR_UNKNOWN;a<c;a++)if(this.arrAttrDefine[a][0]==b)return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getAttrDefineID")}return this.ID_ATTR_UNKNOWN};this.getAttrDefineOption=function(b){try{return this.arrAttrDefine[b][1]}catch(a){g_objCommonUtil.displayErrorAlert(a,"getAttrDefineOption")}return 0}};

var g_objCodeStream=new function(){this.initStreamIn=function(a){try{var b={};b.htmlCode=a;b.next=0;b.size=a.length;return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"initStreamIn")}return null};this.initStreamOut=function(){return{lineString:[],lineBuffer:"",tabApply:!0,convertPTagToBrTag:!1,imgSrcRemoveDomain:null,anchorHrefRemoveDomainYN:!1}};this.endOfStreamIn=function(a){try{return a.stDocStreamIn.next>=a.stDocStreamIn.size}catch(b){g_objCommonUtil.displayErrorAlert(b,"endOfStreamIn")}return!0};
this.readChar=function(a){try{if(!g_objCodeStream.endOfStreamIn(a))return a.stDocStreamIn.htmlCode.charAt(a.stDocStreamIn.next++)}catch(b){g_objCommonUtil.displayErrorAlert(b,"readChar")}return null};this.ungetChar=function(a){try{0<a.stDocStreamIn.next?a.stDocStreamIn.next--:a.stDocStreamIn.next=0}catch(b){g_objCommonUtil.displayErrorAlert(b,"ungetChar")}};this.getCharPos=function(a){try{return a.stDocStreamIn.next}catch(b){g_objCommonUtil.displayErrorAlert(b,"getCharPos")}};this.setCharPos=function(a,
b){try{b.stDocStreamIn.next=a}catch(c){g_objCommonUtil.displayErrorAlert(c,"setCharPos")}}};

var g_objCodeLexer=new function(){this.LEX_CONTENT=0;this.LEX_GT=1;this.LEX_STARTTAG=2;this.LEX_ENDTAG=3;this.LEX_COMMENT=4;this.LEX_SECTION=5;this.LEX_CDATA=6;this.LEX_XML_DECLARE_START=7;this.NODE_TYPE_ROOT=0;this.NODE_TYPE_TEXT=1;this.NODE_TYPE_START=2;this.NODE_TYPE_START_END=3;this.NODE_TYPE_END=4;this.NODE_TYPE_COMMENT=5;this.NODE_TYPE_XML_DECLARE_START=6;this.NODE_TYPE_XML_DECLARE_START_END=7;this.NODE_TYPE_XML_DECLARE_END=8;this.ID_COMMENT_END_TAG="--\x3e";this.ID_SCRIPT_END_TAG="\x3c/script>";
this.ID_STYLE_END_TAG="</style>";this.ID_LOWER_CASE_LETTER_A=97;this.ID_LOWER_CASE_LETTER_B=98;this.ID_LOWER_CASE_LETTER_C=99;this.ID_LOWER_CASE_LETTER_D=100;this.ID_LOWER_CASE_LETTER_E=101;this.ID_LOWER_CASE_LETTER_F=102;this.ID_LOWER_CASE_LETTER_G=103;this.ID_LOWER_CASE_LETTER_H=104;this.ID_LOWER_CASE_LETTER_I=105;this.ID_LOWER_CASE_LETTER_J=106;this.ID_LOWER_CASE_LETTER_K=107;this.ID_LOWER_CASE_LETTER_L=108;this.ID_LOWER_CASE_LETTER_M=109;this.ID_LOWER_CASE_LETTER_N=110;this.ID_LOWER_CASE_LETTER_O=
111;this.ID_LOWER_CASE_LETTER_P=112;this.ID_LOWER_CASE_LETTER_Q=113;this.ID_LOWER_CASE_LETTER_R=114;this.ID_LOWER_CASE_LETTER_S=115;this.ID_LOWER_CASE_LETTER_T=116;this.ID_LOWER_CASE_LETTER_U=117;this.ID_LOWER_CASE_LETTER_V=118;this.ID_LOWER_CASE_LETTER_W=119;this.ID_LOWER_CASE_LETTER_X=120;this.ID_LOWER_CASE_LETTER_Y=121;this.ID_LOWER_CASE_LETTER_Z=122;this.initLexer=function(){try{var a={};a.state=this.LEX_CONTENT;a.sequence=-1;a.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;a.tagName="";a.textStartPos=
-1;a.textEndPos=-1;a.attributeDelimiter=null;a.attributeStartPos=-1;a.attributeEndPos=-1;a.pushed=!1;a.emptyClosed=!1;a.compareEndTag="";a.token=null;return a}catch(b){g_objCommonUtil.displayErrorAlert(b,"initLexer")}return null};this.newNode=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.type=this.NODE_TYPE_TEXT;b.closed=!1;b.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;b.tagName="";b.textStartPos=-1;b.textEndPos=-1;b.parent=null;b.next=null;b.content=null;b.last=null;b.arrAttribute=null;
b.print=!0;return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"newNode")}return null};this.newAttribute=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.attributeID=g_objCodeDefine.ID_ATTR_UNKNOWN;b.attributeName=null;b.delimiter=null;b.attributeStartPos=-1;b.attributeEndPos=-1;b.arrStyleAttribute=null;return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"newAttribute")}return null};this.newStyleAttribute=function(){return{styleName:"",styleValue:""}};this.isWhite=function(a){try{var b=
a.charCodeAt(0);if(10==b||13==b||32==b)return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,"isWhite")}return!1};this.isSpace=function(a){try{if(32==a.charCodeAt(0))return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"isSpace")}return!1};this.isLetter=function(a){try{var b=a.charCodeAt(0);if(65<=b&&90>=b||97<=b&&122>=b)return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,"isLetter")}return!1};this.isDigit=function(a){try{var b=a.charCodeAt(0);if(48<=b&&57>=b)return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,
"isDigit")}return!1};this.isNamechar=function(a){try{if(this.isLetter(a)||this.isDigit(a))return!0;var b=a.charCodeAt(0);if(45==b||46==b||58==b||95==b)return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,"isNamechar")}return!1};this.getToken=function(a){try{if(a.stDocLexer.pushed)return a.stDocLexer.pushed=!1,a.stDocLexer.token;a.stDocLexer.textStartPos=-1;a.stDocLexer.textEndPos=-1;a.stDocLexer.emptyClosed=!1;a.stDocLexer.compareEndTag="";for(var b=null;null!=(b=g_objCodeStream.readChar(a));)switch(a.stDocLexer.state){case this.LEX_CONTENT:if(this.isWhite(b)){32==
b.charCodeAt(0)&&(-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1);continue}if(ID_KEYCODE_TAB==b.charCodeAt(0)&&a.stDocLexer.tagID!=g_objCodeDefine.ID_TAG_SPAN)continue;if("<"==b){a.stDocLexer.state=this.LEX_GT;continue}-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):
a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1;continue;case this.LEX_GT:if("/"==b){if(null==(b=g_objCodeStream.readChar(a))){g_objCodeStream.ungetChar(a);continue}if(this.isLetter(b)){a.stDocLexer.state=this.LEX_ENDTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,
a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue}if("!"==b){if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a);else if("-"==b)if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);else if("-"==b){if(-1!=a.stDocLexer.textStartPos)return g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=
a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;a.stDocLexer.state=this.LEX_COMMENT;continue}else g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);else if("["==b){a.stDocLexer.state=this.LEX_SECTION;continue}else g_objCodeStream.ungetChar(a);g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_CONTENT;continue}if("?"==b){g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_XML_DECLARE_START;if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=
this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}if(this.isLetter(b)){a.stDocLexer.state=this.LEX_STARTTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=
a.stDocLexer.textEndPos,a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue;case this.LEX_XML_DECLARE_START:var d=null;b=this.parseTagName(!1,a);">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=this.parseAttribute(!1,a));a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;a.stDocLexer.token.type=a.stDocLexer.emptyClosed?this.NODE_TYPE_XML_DECLARE_START_END:this.NODE_TYPE_XML_DECLARE_START;a.stDocLexer.token.arrAttribute=
d;a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;case this.LEX_STARTTAG:return d=null,b=this.parseTagName(!0,a),">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=this.parseAttribute(!0,a)),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.tagID=a.stDocLexer.tagID,a.stDocLexer.token.tagName=a.stDocLexer.tagName,a.stDocLexer.token.type=g_objCodeDefine.ID_TAG_UNKNOWN==a.stDocLexer.tagID?"embed"==a.stDocLexer.tagName?this.NODE_TYPE_START_END:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:
this.NODE_TYPE_START:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:this.NODE_TYPE_START,a.stDocLexer.token.arrAttribute=d,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;case this.LEX_ENDTAG:b=this.parseTagName(!0,a);a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;for(a.stDocLexer.token.type=this.NODE_TYPE_END;">"!=b&&null!=b;)b=g_objCodeStream.readChar(a);a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;
case this.LEX_COMMENT:this.replaceCommentEndTag(b,a);if(this.ID_COMMENT_END_TAG==a.stDocLexer.compareEndTag)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos-2,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):
a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1}if(this.LEX_CONTENT==a.stDocLexer.state){if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token}else if(this.LEX_COMMENT==a.stDocLexer.state&&-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,
a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token}catch(e){g_objCommonUtil.displayErrorAlert(e,"getToken")}return null};this.getCDATAToken=function(a,b){try{if(g_objCodeDefine.ID_TAG_SCRIPT!=a&&g_objCodeDefine.ID_TAG_STYLE!=a)return;b.stDocLexer.compareEndTag="";for(var d=null;null!=(d=g_objCodeStream.readChar(b));){this.replaceScriptStyleEndTag(d,a,b);if(g_objCodeDefine.ID_TAG_SCRIPT==
a){if(this.ID_SCRIPT_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-8,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token}else if(g_objCodeDefine.ID_TAG_STYLE==a&&this.ID_STYLE_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=
b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-7,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token;-1==b.stDocLexer.textStartPos?(b.stDocLexer.textStartPos=g_objCodeStream.getCharPos(b)-1,b.stDocLexer.textEndPos=b.stDocLexer.textStartPos):b.stDocLexer.textEndPos=g_objCodeStream.getCharPos(b)-1}}catch(e){g_objCommonUtil.displayErrorAlert(e,"getCDATAToken")}return null};this.replaceCommentEndTag=function(a,b){try{3>b.stDocLexer.compareEndTag.length||(b.stDocLexer.compareEndTag=
b.stDocLexer.compareEndTag.substring(1,3)),b.stDocLexer.compareEndTag+=a}catch(d){g_objCommonUtil.displayErrorAlert(d,"replaceCommentEndTag")}};this.replaceScriptStyleEndTag=function(a,b,d){try{if(g_objCodeDefine.ID_TAG_SCRIPT==b||g_objCodeDefine.ID_TAG_STYLE==b){var e=0,f=d.stDocLexer.compareEndTag.length;g_objCodeDefine.ID_TAG_SCRIPT==b?e=9:g_objCodeDefine.ID_TAG_STYLE==b&&(e=8);f<e||(d.stDocLexer.compareEndTag=d.stDocLexer.compareEndTag.substring(1,e));d.stDocLexer.compareEndTag+=a.toLowerCase()}}catch(g){g_objCommonUtil.displayErrorAlert(g,
"replaceScriptStyleEndTag")}};this.ungetToken=function(a){try{a.stDocLexer.pushed=!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"ungetToken")}};this.parseTagName=function(a,b){try{b.stDocLexer.tagName="";for(var d=null;null!=(d=g_objCodeStream.readChar(b))&&this.isNamechar(d);)b.stDocLexer.tagName+=d.toLowerCase();b.stDocLexer.tagID=a?this.findTagDefineID(b.stDocLexer.tagName):g_objCodeDefine.ID_TAG_UNKNOWN;return d}catch(e){g_objCommonUtil.displayErrorAlert(e,"parseTagName")}return null};this.parseAttribute=
function(a,b){try{for(var d=null;!g_objCodeStream.endOfStreamIn(b);){b.stDocLexer.attributeDelimiter=null;b.stDocLexer.attributeStartPos=-1;b.stDocLexer.attributeEndPos=-1;var e=this.parseAttributeName(b);if(null==e)break;null==d&&(d=[]);var f=d.length;d[f]=this.newAttribute(b);d[f].attributeName=e;d[f].attributeID=a?this.findAttrDefineID(e):g_objCodeDefine.ID_ATTR_UNKNOWN;this.parseAttributeValue(b);d[f].delimiter=b.stDocLexer.attributeDelimiter;d[f].attributeStartPos=b.stDocLexer.attributeStartPos;
d[f].attributeEndPos=b.stDocLexer.attributeEndPos;g_objCodeDefine.ID_ATTR_STYLE==d[f].attributeID&&b.bStyleAttribute&&this.parseStyleAttribute(b,d[f])}return d}catch(g){g_objCommonUtil.displayErrorAlert(g,"parseAttribute")}return null};this.parseAttributeName=function(a){try{for(var b="",d=null;;){d=g_objCodeStream.readChar(a);if(null==d)return g_objCodeStream.ungetChar(a),null;if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d)return a.stDocLexer.emptyClosed=!0,null;g_objCodeStream.ungetChar(a);
d="/";break}if(">"==d)return null;if(!this.isWhite(d))break}for(;;){if(null==d){g_objCodeStream.ungetChar(a);break}if("="==d||">"==d){g_objCodeStream.ungetChar(a);break}if(this.isWhite(d))break;b+=d.toLowerCase();d=g_objCodeStream.readChar(a)}return""==b?null:b}catch(e){g_objCommonUtil.displayErrorAlert(e,"parseAttributeName")}return null};this.parseAttributeValue=function(a){try{for(var b=null,d=null;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}if("="!=
d&&'"'!=d&&"'"!=d)g_objCodeStream.ungetChar(a);else{for(;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}for('"'==d||"'"==d?b=d:g_objCodeStream.ungetChar(a);;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(null==b){if(">"==d){g_objCodeStream.ungetChar(a);break}if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d){a.stDocLexer.emptyClosed=!0;g_objCodeStream.ungetChar(a);break}g_objCodeStream.ungetChar(a);c="/"}}else if(d==
b)break;if(this.isWhite(d)&&null==b)break;-1==a.stDocLexer.attributeStartPos?(a.stDocLexer.attributeStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.attributeEndPos=a.stDocLexer.attributeStartPos):a.stDocLexer.attributeEndPos=g_objCodeStream.getCharPos(a)-1}a.stDocLexer.attributeDelimiter=b}}catch(e){g_objCommonUtil.displayErrorAlert(e,"parseAttributeValue")}};this.parseStyleAttribute=function(a,b){try{var d=g_objCodeStream.getCharPos(a),e=b.attributeStartPos,f=b.attributeEndPos;g_objCodeStream.setCharPos(e,
a);for(var g=null,k=!1,l="",h="";e<=f;e++){ch=g_objCodeStream.readChar(a);if(null==ch)break;if(this.isWhite(ch)){if(!k)continue;if(!this.isSpace(ch))continue}":"==ch?k?"background-image"==l.toLowerCase()||"background"==l.toLowerCase()?h+=ch:-1!=h.toLowerCase().indexOf("url(")&&(h+=ch):k=!0:";"==ch?-1!=h.indexOf("&quot")?h=h.replace("&quot","'"):(k=!1,null==g&&(g=[]),g[g.length]=this.addStyleAttribute(a,l,h),h=l=""):k?h+=ch:l+=ch}k&&(null==g&&(g=[]),g[g.length]=this.addStyleAttribute(a,l,h));b.arrStyleAttribute=
g;g_objCodeStream.setCharPos(d,a)}catch(m){g_objCommonUtil.displayErrorAlert(m,"parseStyleAttribute")}};this.addStyleAttribute=function(a,b,d){try{var e=this.newStyleAttribute();e.styleName=b.toLowerCase();e.styleValue=d;return e}catch(f){g_objCommonUtil.displayErrorAlert(f,"addStyleAttribute")}};this.findTagDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_A);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_B);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_CAPTION);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_DD);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_EM);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_FIELDSET);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_H1);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_I);case this.ID_LOWER_CASE_LETTER_K:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_KBD);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_MAP);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_NEXTID);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_P);case this.ID_LOWER_CASE_LETTER_Q:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_Q);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_RB);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_S);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_TABLE);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_U);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_VAR);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_XMP)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"findTagDefineID")}return g_objCodeDefine.ID_TAG_UNKNOWN};
this.findAttrDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ABBR);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_BACKGROUND);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_CELLPADDING);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_DATA);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_ENCODING);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_FACE);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_HEADERS);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ID);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_MARGINHEIGHT);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_N);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_PROFILE);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_RBSPAN);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_SCHEME);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_TABINDEX);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_URN);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_VALIGN);case this.ID_LOWER_CASE_LETTER_W:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_WIDTH);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_XML_LANG)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"findAttrDefineID")}return g_objCodeDefine.ID_ATTR_UNKNOWN}};

var g_objCodeParser=new function(){this.convertXHTMLCode=function(c){try{var b=this.initParserStruct(c);if(!b)return c;this.parseBody(b.stDocRoot,b);g_objCodePrint.printTree(b.stDocRoot,0,b);0<b.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,b);for(var a="",d=0;d<b.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(b.stDocStreamOut.lineString[d])||(a+=b.stDocStreamOut.lineString[d]+"\r\n");return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"initParserStruct")}return c};
this.initParserStruct=function(c){try{var b={stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null,bStyleAttribute:!0};g_objCodeDefine.initTagDefine();g_objCodeDefine.initAttrDefine();b.stDocStreamIn=g_objCodeStream.initStreamIn(c);if(!b.stDocStreamIn)return null;b.stDocStreamOut=g_objCodeStream.initStreamOut();if(b.stDocStreamOut)b.stDocStreamOut.tabApply=g_bContentXHTMLTabSettingYN,b.stDocStreamOut.convertPTagToBrTag=g_bConvertPTagToBrTag,null!=g_arrImgSrcRemoveDomain&&0<g_arrImgSrcRemoveDomain.length&&
(b.stDocStreamOut.imgSrcRemoveDomain=g_arrImgSrcRemoveDomain,b.stDocStreamOut.anchorHrefRemoveDomainYN=g_bAnchorHrefRemoveDomainYN);else return null;b.stDocLexer=g_objCodeLexer.initLexer();if(!b.stDocLexer)return null;b.stDocRoot=g_objCodeLexer.newNode(b);b.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;return b}catch(a){g_objCommonUtil.displayErrorAlert(a,"initParserStruct")}return null};this.parseBody=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));)g_objCodeLexer.NODE_TYPE_START==
a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,
a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"parseBody")}};this.parseTag=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=
!0;break}if(g_objCodeLexer.NODE_TYPE_END==a.type)for(var d=c.parent;null!=d;d=d.parent)if(a.tagID==d.tagID){g_objCodeLexer.ungetToken(b);return}g_objCodeLexer.NODE_TYPE_START==a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==
a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"parseTag")}};
this.parseEmpty=function(c,b){try{var a=g_objCodeLexer.getToken(b);a&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){g_objCommonUtil.displayErrorAlert(d,"parseEmpty")}};this.parseScriptStyle=function(c,b){try{var a=g_objCodeLexer.getCDATAToken(c.tagID,b);a&&(this.insertNodeAtEnd(c,a),a=g_objCodeLexer.getToken(b))&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){g_objCommonUtil.displayErrorAlert(d,
"parseScriptStyle")}};this.parseColGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type&&(g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type))if(g_objCodeDefine.ID_TAG_COL==a.tagID)this.insertNodeAtEnd(c,
a);else{g_objCodeLexer.ungetToken(b);break}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"parseColGroup")}};this.parseRowGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID){if(g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}g_objCodeLexer.ungetToken(b);break}if(g_objCodeDefine.ID_TAG_TABLE==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){g_objCodeLexer.ungetToken(b);break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==
a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type){if((g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type)&&g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_ROWGRP)){g_objCodeLexer.ungetToken(b);break}this.insertNodeAtEnd(c,a);this.parseTag(a,b)}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"parseRowGroup")}};this.insertNodeAtEnd=function(c,b){try{b.parent=c,null!=c.last?c.last.next=b:c.content=b,c.last=b}catch(a){g_objCommonUtil.displayErrorAlert(a,
"insertNodeAtEnd")}}};

var g_objCodePrint=new function(){this.printTree=function(a,b,c){try{if(null!=a)if(g_objCodeLexer.NODE_TYPE_ROOT==a.type)for(var d=a.content;null!=d;d=d.next)this.printTree(d,b,c);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.printText(a,c);else if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.printComment(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type)this.printXMLDeclareStartTag(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type)this.printXMLDeclareStartEndTag(a,
c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY))g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)||this.addLineString(b-1,c),this.printStartEndTag(a,c),null!=a.next&&(g_objCodeDefine.ID_TAG_PARAM==a.tagID||g_objCodeDefine.ID_TAG_AREA==a.tagID?this.addLineString(b,c):(g_objCodeDefine.ID_TAG_BR==a.tagID||g_objCodeDefine.ID_TAG_HR==a.tagID)&&this.addLineString(b,c));else if(g_objCodeDefine.ID_TAG_LISTING==a.tagID||g_objCodeDefine.ID_TAG_PLAINTEXT==a.tagID||g_objCodeDefine.ID_TAG_PRE==
a.tagID||g_objCodeDefine.ID_TAG_XMP==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_UNKNOWN==
a.tagID&&"embed"==a.tagName)this.printStartEndTag(a,c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)){this.printStartTag(a,c);if(g_objCodeDefine.ID_TAG_OBJECT==a.tagID){var e=[];for(d=a.content;null!=d;d=d.next)if(g_objCodeDefine.ID_TAG_PARAM==d.tagID){var f=this.getParamAttributeNameValue(d,c);this.addArrayParamAttributeNameValue(e,f)||this.printTree(d,b,c)}else this.printTree(d,b,c)}else for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c)}else{e=b;this.checkTabApply(a,
c)&&e++;this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,e,c);this.checkTabApply(a,c)&&this.addLineString(b,c);this.printEndTag(a,c);this.addLineString(b,c)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"printTree")}};this.printText=function(a,b){try{b.stDocStreamOut.lineBuffer+=b.stDocStreamIn.htmlCode.substring(a.textStartPos,a.textEndPos+1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"printText")}};this.printComment=function(a,b){try{b.stDocStreamOut.lineBuffer+=
"\x3c!--",b.stDocStreamOut.lineBuffer+=b.stDocStreamIn.htmlCode.substring(a.textStartPos,a.textEndPos+1),b.stDocStreamOut.lineBuffer+="--\x3e"}catch(c){g_objCommonUtil.displayErrorAlert(c,"printComment")}};this.printStartTag=function(a,b){try{if(a.print&&(g_objCodeDefine.ID_TAG_P!=a.tagID||!b.stDocStreamOut.convertPTagToBrTag||null!=a.arrAttribute)){b.stDocStreamOut.lineBuffer+="<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);
b.stDocStreamOut.lineBuffer+=">"}}catch(d){g_objCommonUtil.displayErrorAlert(d,"printStartTag")}};this.getParamAttributeNameValue=function(a,b){try{if(g_objCodeDefine.ID_TAG_PARAM!=a.tagID||null==a.arrAttribute)return null;for(var c=0;c<a.arrAttribute.length;c++){var d=a.arrAttribute[c];if(g_objCodeDefine.ID_ATTR_NAME==d.attributeID){var e=b.stDocStreamIn.htmlCode.substring(d.attributeStartPos,d.attributeEndPos+1);return e=e.toLowerCase()}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getParamAttributeNameValue")}return null};
this.addArrayParamAttributeNameValue=function(a,b){try{for(var c=0;c<a.length;c++)if(a[c]==b)return!0;a[a.length]=b}catch(d){g_objCommonUtil.displayErrorAlert(d,"addArrayParamAttributeNameValue")}return!1};this.printStartEndTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){g_objCommonUtil.displayErrorAlert(d,"printStartEndTag")}};
this.printEndTag=function(a,b){try{a.print&&(g_objCodeDefine.ID_TAG_P==a.tagID&&b.stDocStreamOut.convertPTagToBrTag&&null==a.arrAttribute?-1==b.stDocStreamOut.lineBuffer.indexOf("<br />")&&(b.stDocStreamOut.lineBuffer+="<br",b.stDocStreamOut.lineBuffer+=" />"):b.stDocStreamOut.lineBuffer+="</"+a.tagName+">")}catch(c){g_objCommonUtil.displayErrorAlert(c,"printEndTag")}};this.printAttribute=function(a,b,c){try{if(null!=b){var d=null==b.delimiter?'"':b.delimiter,e="";-1!=b.attributeStartPos&&(g_objCodeDefine.ID_ATTR_UNKNOWN==
b.attributeID?e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1):g_objCodeDefine.ID_TAG_IMG==a.tagID&&g_objCodeDefine.ID_ATTR_SRC==b.attributeID&&null!=c.stDocStreamOut.imgSrcRemoveDomain?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_A==a.tagID&&g_objCodeDefine.ID_ATTR_HREF==b.attributeID&&null!=c.stDocStreamOut.imgSrcRemoveDomain&&1==c.stDocStreamOut.anchorHrefRemoveDomainYN?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_TD==a.tagID&&
g_objCodeDefine.ID_ATTR_VALIGN==b.attributeID?(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase(),"center"==e&&(e="middle")):g_objCodeDefine.ID_ATTR_STYLE==b.attributeID?c.bStyleAttribute?e=this.printStyleAttribute(b.arrStyleAttribute):(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase(),-1!=e.indexOf("background")&&(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1))):e=g_objCodeDefine.getAttrDefineOption(b.attributeID)?
c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase():c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1));c.stDocStreamOut.lineBuffer+=" "+b.attributeName+"="+d+e+d}}catch(f){g_objCommonUtil.displayErrorAlert(f,"printAttribute")}};this.printStyleAttribute=function(a){try{if(null==a)return"";for(var b="",c=0;c<a.length;c++){var d=a[c];if(null!=d){var e=d.styleValue.trim();if(0>d.styleName.indexOf("background-image")&&(e=e.toLowerCase(),"border-image"==
d.styleName&&"none"==e))continue;b+=d.styleName+":"+e+";"}}return b}catch(f){g_objCommonUtil.displayErrorAlert(f,"printStyleAttribute")}return""};this.printXMLDeclareStartTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" ?>"}}catch(d){g_objCommonUtil.displayErrorAlert(d,"printXMLDeclareStartTag")}};this.printXMLDeclareStartEndTag=function(a,
b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){g_objCommonUtil.displayErrorAlert(d,"printXMLDeclareStartEndTag")}};this.addLineString=function(a,b){try{0<b.stDocStreamOut.lineBuffer.length&&(b.stDocStreamOut.lineString[b.stDocStreamOut.lineString.length]=this.getTabString(a)+b.stDocStreamOut.lineBuffer,b.stDocStreamOut.lineBuffer="")}catch(c){g_objCommonUtil.displayErrorAlert(c,
"addLineString")}};this.checkTabApply=function(a,b){try{if(!b.stDocStreamOut.tabApply||g_objCodeDefine.ID_TAG_UNKNOWN==a.tagID||g_objCodeDefine.ID_TAG_HTML==a.tagID||g_objCodeDefine.ID_TAG_TITLE==a.tagID||g_objCodeDefine.ID_TAG_P==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID||g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_HEADING))return!1;if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_FIELD|g_objCodeDefine.CM_OBJECT)||g_objCodeDefine.ID_TAG_MAP==a.tagID)return!0;if(null!=a.content&&g_objCodeDefine.nodeHasCM(a,
g_objCodeDefine.CM_NO_INDENT)){for(a=a.content;null!=a;a=a.next)if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_BLOCK))return!0;return!1}return!g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)&&null!=a.content}catch(c){g_objCommonUtil.displayErrorAlert(c,"checkTabApply")}return!1};this.getTabString=function(a){try{if(0>=a)return"";for(var b="",c=0;c<a;c++)b+="\t";return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"getTabString")}return""};this.getAttributeValueByRemoveDomain=function(a,
b){try{var c=a.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1),d=c.toLowerCase();for(b=0;b<a.stDocStreamOut.imgSrcRemoveDomain.length;b++)if(0==d.indexOf(a.stDocStreamOut.imgSrcRemoveDomain[b])){var e=d.length,f=a.stDocStreamOut.imgSrcRemoveDomain[b].length;if(f<=e&&"/"==d.charAt(f)){c=c.substring(f,e);break}}return c}catch(g){g_objCommonUtil.displayErrorAlert(g,"getAttributeValueByRemoveDomain")}return""}};

var g_objCssParser=new function(){this.LEX_START_CSS=11;this.LEX_CSS_COMMENT=12;this.initCssParserStruct=function(b){try{var a={stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null};a.stDocStreamIn=g_objCodeStream.initStreamIn(b);if(!a.stDocStreamIn)return null;a.stDocStreamOut=g_objCodeStream.initStreamOut();if(!a.stDocStreamOut)return null;a.stDocLexer=this.initCssLexer();if(!a.stDocLexer)return null;a.stDocRoot=this.newCssNode(a);a.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;
return a}catch(c){g_objCommonUtil.displayErrorAlert(c,"initCssParserStruct")}return null};this.initCssLexer=function(){try{var b={};b.state=g_objCodeLexer.LEX_CONTENT;b.sequence=-1;b.rowCssClassName="";b.rowCssClassContent="";b.token=null;return b}catch(a){g_objCommonUtil.displayErrorAlert(a,"initCssLexer")}return null};this.newCssNode=function(b){try{var a={};a.sequence=b.stDocLexer.sequence++;a.type=g_objCodeLexer.NODE_TYPE_TEXT;a.arrCssClassName=null;a.arrCssClassAttribute=null;a.parent=null;a.next=
null;a.content=null;a.last=null;return a}catch(c){g_objCommonUtil.displayErrorAlert(c,"newCssNode")}return null};this.parseCss=function(b,a){try{for(var c;null!=(c=this.getCssToken(a));)g_objCodeLexer.NODE_TYPE_TEXT==c.type&&g_objCodeParser.insertNodeAtEnd(b,c)}catch(e){g_objCommonUtil.displayErrorAlert(e,"parseCss")}};this.getCssToken=function(b){try{b.stDocLexer.rowCssClassName="";b.stDocLexer.rowCssClassContent="";for(var a=null;null!=(a=g_objCodeStream.readChar(b));)switch(b.stDocLexer.state){case g_objCodeLexer.LEX_CONTENT:if(this.isCheckWhite_Plus_Space(a))continue;
if("<"==a){null!=(a=g_objCodeStream.readChar(b))&&("!"==a?null!=(a=g_objCodeStream.readChar(b))&&("-"==a?null!=(a=g_objCodeStream.readChar(b))&&"-"!=a&&g_objCodeStream.ungetChar(b):g_objCodeStream.ungetChar(b)):g_objCodeStream.ungetChar(b));continue}if("/"==a){null!=(a=g_objCodeStream.readChar(b))&&("*"==a?null!=(a=g_objCodeStream.readChar(b))&&(b.stDocLexer.state=this.LEX_CSS_COMMENT):g_objCodeStream.ungetChar(b));continue}if("{"==a){b.stDocLexer.state=this.LEX_START_CSS;continue}else b.stDocLexer.rowCssClassName+=
a;continue;case this.LEX_START_CSS:if("}"!=a)b.stDocLexer.rowCssClassContent+=a;else return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=g_objCodeLexer.NODE_TYPE_TEXT,b.stDocLexer.token.arrCssClassName=this.getCssClassName(b.stDocLexer.rowCssClassName),b.stDocLexer.token.arrCssClassAttribute=this.getCssClassAttribute(b.stDocLexer.rowCssClassContent),b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;continue;case this.LEX_CSS_COMMENT:if("*"==a&&null!=(a=g_objCodeStream.readChar(b))){if("/"==
a)return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=g_objCodeLexer.NODE_TYPE_COMMENT,b.stDocLexer.token.arrCssClassName=null,b.stDocLexer.token.arrCssClassAttribute=null,b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;g_objCodeStream.ungetChar(b)}}}catch(c){g_objCommonUtil.displayErrorAlert(c,"getCssToken")}return null};this.getCssClassName=function(b){try{for(var a=[],c="",e=0;e<b.length;e++){var f=b.charAt(e);this.isCheckWhite_Plus_Space(f)||(","==f?(a.push(c),
c=""):c+=f)}""!=c&&a.push(c);return a}catch(g){g_objCommonUtil.displayErrorAlert(g,"getCssClassName")}return""};this.getCssClassAttribute=function(b){try{for(var a=[],c=!1,e="",f="",g=!1,h=0;h<b.length;h++){var d=b.charAt(h);if(null==d)break;if(c){if(this.isCheckWhite(d))continue}else if(this.isCheckWhite_Plus_Space(d))continue;if('"'==d||"'"==d)g=g?!1:!0;":"==d?g?c?f+=d:e+=d:c=!0:";"==d?g?c?f+=d:e+=d:(c=!1,a[a.length]=g_objCodeLexer.addStyleAttribute(null,e,f),f=e=""):c?f+=d:e+=d}c&&(a[a.length]=
g_objCodeLexer.addStyleAttribute(null,e,f));return a}catch(k){g_objCommonUtil.displayErrorAlert(k,"getCssClassAttribute")}return null};this.isCheckWhite=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a)return!0}catch(c){g_objCommonUtil.displayErrorAlert(c,"isCheckWhite")}return!1};this.isCheckWhite_Plus_Space=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a||32==a)return!0}catch(c){g_objCommonUtil.displayErrorAlert(c,"isCheckWhite_Plus_Space")}return!1}};

var g_strEditObjectName="dzeditor",g_strEditObjectSourceName="dzeditorSource",g_strEditContainerName="dzeditorContainer",g_strEditSourceContainerName="dzeditorSourceContainer",g_bInitWebEditor=!1,g_objEditObject=[],g_objEditWindow=[],g_objEditorDocument=[],g_objParent_EditObject=[],g_nActiveEditNumber=0,g_bLoadContentHTMLCode=!0,g_nLoadContentEditNumber=[],g_bLoadContentEncode=[],g_strLoadContentHTMLCode=[];function returnTrue(){return!0}function returnFalse(){return!1}
var g_nDomainAccessViolationCount=0;g_browserCHK.ie?document.attachEvent?document.attachEvent("onreadystatechange",fnLoadingEventFired):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0);
function fnLoadingEventFired(){try{g_bBrowserType_IE?document.attachEvent?"complete"==document.readyState&&fnLoadEditor():"complete"==document.readyState?fnLoadEditor():window.setTimeout("fnLoadingEventFired()",100):fnLoadEditor()}catch(a){}}function fnLoadEditor(){try{g_bInitWebEditor||(g_bInitWebEditor=!0,initWebEditor(),window_onload())}catch(a){}}function window_onload(){g_bBrowserType_IE||(window.setTimeout("fnSubInitializeLayer()",100),window.setTimeout("initializeLastSetting()",500))}
function initWebEditor(){try{setBuildEditorArea();setInitConst();getDocumentType();setCustomVariable();setCustomDisplay();setSkinToolBar();g_objObjectSelectionInfo=new initSelectionObjectInfo;if(g_bBrowserType_IE){var a=!1,b;for(b in g_arrEditorAreaContainer)initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),b);for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(c){a=!0}if(a){window.setTimeout("initWebEditor_Domain()",500);return}}else for(b in g_arrEditorAreaContainer)if(initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),
b),!fnSetEditObject(b))return;for(b in g_arrEditorAreaContainer){if(!fnSetEditorMode(b))return;try{var d=parseInt(b)+parseInt(DZE_IFRAME_TMP_NO);fnSetEditorMode(d)}catch(c){}}fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],g_nLoadContentEditNumber[b]);g_bBrowserType_IE&&(window.setTimeout("fnSubInitializeLayer()",100),window.setTimeout("initializeLastSetting()",500));duzon_menubar.rebuildHiddenToolbar()}catch(c){}}
function initWebEditor_Domain(){try{if(g_bBrowserType_IE&&!(5<g_nDomainAccessViolationCount)){var a=!1,b;for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(d){a=!0}if(a)g_nDomainAccessViolationCount++,window.setTimeout("initWebEditor_Domain()",1E3);else{for(b in g_arrEditorAreaContainer)if(!fnSetEditorMode(b))return;fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],
g_nLoadContentEditNumber[b]);window.setTimeout("fnSubInitializeLayer()",100);window.setTimeout("initializeLastSetting()",500);duzon_menubar.rebuildHiddenToolbar()}}}catch(d){}}
function setBuildEditorArea(){for(var a=document.getElementsByTagName("div"),b=0,d=-1,c=0;c<a.length;c++)a[c].getAttribute("dzeditor")&&"true"==a[c].getAttribute("dzeditor")&&(d++,dzeEnvConfig.iFrameLayer?(null!=window.frameElement.getAttribute("dzeditor_no")?b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10):window.frameElement.setAttribute("dzeditor_no",b),a[c].id="DZEDITOR_CONTAINER_"+b,a[c].setAttribute("dzeload","true"),g_arrEditorAreaContainer[b]=a[c].id):(a[c].getAttribute("id")||
(a[c].id="DZEDITOR_CONTAINER_"+d),a[c].setAttribute("dzeload","true"),g_arrEditorAreaContainer.push(a[c].id)));g_objCommonUtil.log(g_arrEditorAreaContainer)}function setCustomVariable(){for(var a in g_arrEditorAreaContainer)g_arrEditorWidth[a]=dzeUiConfig.nEditorWidth,g_arrEditorHeight[a]=dzeUiConfig.nEditorHeight}
function fnSetEditObject(a){var b=parseInt(a,10)+DZE_IFRAME_TMP_NO;return g_bBrowserType_IE?(eval("g_objEditWindow["+a+"] = "+g_strEditObjectName+"_"+a),g_objEditorDocument[a]=g_objEditWindow[a].document,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),eval("g_objEditWindow["+b+"] = "+g_strEditObjectName+"_"+b),g_objEditorDocument[b]=g_objEditWindow[b].document,g_objEditObject[b]=document.getElementById(g_strEditObjectName+
"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP?(g_objEditWindow[a]=document.getElementById(g_strEditObjectName+"_"+a).contentWindow,g_objEditorDocument[a]=document.getElementById(g_strEditObjectName+"_"+a).contentDocument,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),g_objEditWindow[b]=document.getElementById(g_strEditObjectName+
"_"+b).contentWindow,g_objEditorDocument[b]=document.getElementById(g_strEditObjectName+"_"+b).contentDocument,g_objEditObject[b]=document.getElementById(g_strEditObjectName+"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):!1}
function fnSetEditorMode(a){var b="",d="";g_bEnableEditHorizontalScroll||(b+="overflow-x:hidden;word-wrap:break-word;");!0===dzeUiConfig.bSetCustomEditorBodyMargin&&"undefined"!=typeof dzeUiConfig.nCustomEditorBodyMarginValues&&4==dzeUiConfig.nCustomEditorBodyMarginValues.length&&(b+="margin-top:"+dzeUiConfig.nCustomEditorBodyMarginValues[0]+"px;",b+="margin-bottom:"+dzeUiConfig.nCustomEditorBodyMarginValues[1]+"px;",b+="margin-left:"+dzeUiConfig.nCustomEditorBodyMarginValues[2]+"px;",b+="margin-right:"+
dzeUiConfig.nCustomEditorBodyMarginValues[3]+"px;");"undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&""!=dzeUiConfig.nEditModeAreaWidth&&(b+="background-color:#ffffff;");if(g_bBrowserType_IE){var c="";c=3==g_nFormEditMode?c+"<!DOCTYPE html>":c+"<html>";c=c+"<head>"+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"customer_editwin.css'>");g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(var e=0;e<g_arrAdditionalEditAreaCSS.length;e++)c+="<link rel='stylesheet' href='"+
g_arrAdditionalEditAreaCSS[e]+"'>";""!=g_strAdditionalHeadContent&&(c+=g_strAdditionalHeadContent);d=g_bAutoIncludeParentCSS?dzeEnvConfig.strPath_CSS+"editor_style_inherit.css":dzeEnvConfig.strPath_CSS+"editor_style.css";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style>html {overflow: auto}";""!=g_strBodyFontFamily&&(c+="body, td {font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(c+="body, td {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(c+="body, td {color:"+g_strBodyFontColor+
"}");""!=g_strBodyLineHeight&&(c+="body, td {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(c+="body, td {letter-spacing:"+g_strBodyLetterSpacing+"}");c=c+"</style></head>"+("<body style='"+b+"'>");c=window.attachEvent?c+"<p></p>":c+"<p><br/></p>";c+="</body></html>";g_objEditorDocument[a].open();g_objEditorDocument[a].write(c);g_objEditorDocument[a].close();if(0==g_nFormEditMode||1==g_nFormEditMode)g_objEditorDocument[a].body.contentEditable=!0}else if(g_bBrowserType_FF||g_bBrowserType_WK||
g_bBrowserType_OP){c="";c=3==g_nFormEditMode?c+"<!DOCTYPE html>":c+"<html>";c=c+"<head>"+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"customer_editwin.css'>");g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(e=0;e<g_arrAdditionalEditAreaCSS.length;e++)c+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[e]+"'>";""!=g_strAdditionalHeadContent&&(c+=g_strAdditionalHeadContent);d=g_bAutoIncludeParentCSS?dzeEnvConfig.strPath_CSS+"editor_style_inherit.css":dzeEnvConfig.strPath_CSS+
"editor_style.css";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style>html {overflow: auto}";""!=g_strBodyFontFamily&&(c+="body, td {font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(c+="body, td {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(c+="body, td {color:"+g_strBodyFontColor+"}");""!=g_strBodyLineHeight&&(c+="body, td {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(c+="body, td {letter-spacing:"+g_strBodyLetterSpacing+"}");c=c+"</style></head>"+
("<body style='"+b+"'>")+"<p><br/></p>";c+="</body>";c+="</html>";g_objEditorDocument[a].open();g_objEditorDocument[a].write(c);g_objEditorDocument[a].close();0==g_nFormEditMode||1==g_nFormEditMode?(g_objEditorDocument[a].body.contentEditable=!0,setStop_DefaultDocumentEditOption_FF(a)):3==g_nFormEditMode&&setStop_DefaultDocumentEditOption_FF(a)}else return!1;d&&("break-all"==dzeUiConfig.strEditorStyleBodyWordBreak||"keep-all"==dzeUiConfig.strEditorStyleBodyWordBreak)&&(b=g_objEditorDocument[a].querySelector("link[href='"+
d+"']"))&&(b.onload=function(){changeCss("body","word-break",dzeUiConfig.strEditorStyleBodyWordBreak,g_objEditorDocument[a],d)});return!0}
function initToolbar(a){try{g_arrForceCancelBubbleMouseDown[a]=!1}catch(b){}TBInitContainer(document.getElementById("TB_CONTAINER_"+a));g_bTabBar_Display&&TBInitContainer(document.getElementById("TB_TABMODE_CONTAINER_"+a));g_bMenuBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_MENU_"+a));g_bToolBar1_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_1_"+a));g_bToolBar2_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_2_"+a));g_bToolBar3_Display&&
TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_3_"+a));g_bTabBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TABMODE_"+a));g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_FILE_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_EDIT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_VIEW_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_INSERT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_BASIC_"+
a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_TABLE_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_HELP_"+a),a);g_bToolBar1_Display&&TBSetToolButton(g_arrToolbar1,a);g_bToolBar2_Display&&TBSetToolButton(g_arrToolbar2,a);g_bToolBar3_Display&&TBSetToolButton(g_arrToolbar3,a);g_bTabBar_Display&&(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_PREVIEW_"+a),ID_TB_TABMODE_PREVIEW,ID_STRING_NAME_UNCHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&
TBInitTabModeButton(document.getElementById("TB_TABMODE_EDIT_"+a),ID_TB_TABMODE_EDIT,ID_STRING_NAME_CHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_SOURCE_"+a),ID_TB_TABMODE_SOURCE,ID_STRING_NAME_UNCHECKED,a));g_bBottomResizeYN&&TBInitContainerBottomResize(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+a),a);dzeUiConfig.bCustomBottomResizeBtnYN&&TBInitContainerBottomResizeBtn(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+
a),a)}function initBranchEvent(a){updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a);initEditorEvent(a)}
function fnInitialize(){try{for(var a in g_arrEditorAreaContainer)setInitUpdateVariable(a),initEditSetContainer(document.getElementById("EDIT_SET_CONTAINER_"+a),a),initToolbar(a),initBranchEvent(a),setEditorContainerOutline(a),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,dzeUiConfig.nEditorHeight),!0===dzeUiConfig.bUseUiMode&&dze_menu_control.initialize(a),attachMouseDragDropEvent(a);initGlobalEvent();window.setTimeout("initializeAnotherOption()",300)}catch(b){}}
function fnSubInitializeLayer(){try{window.setTimeout("g_objTableResize.initializeResizeLineLayer()",300);g_objCodeDefine.initTagDefine();if(0==g_nFormEditMode||1==g_nFormEditMode||3==g_nFormEditMode){if(g_bBrowserType_FF)for(var a in g_arrEditorAreaContainer);if(g_bEditFocusYN){var b=0,d=-1;for(a in g_arrEditorAreaContainer)0==b&&(d=a),0<a&&window.setTimeout("editor_ondeactivate("+a+")",100),b++;0==d&&(g_bBrowserType_WK||g_bBrowserType_OP?(g_arrOnFocus_FF_WK[0]=!0,window.setTimeout("setEditModeFocus(0)",
100)):(g_bBrowserType_FF&&(g_arrOnFocus_FF_WK[0]=!0,editor_onselectionchange(0)),setFirstEditWindowFocus(),g_bBrowserType_IE&&editor_onselectionchange(0)))}else for(a in g_arrEditorAreaContainer)window.setTimeout("editor_ondeactivate("+a+")",500)}else if(2==g_nFormEditMode)for(a in g_arrEditorAreaContainer)(function(){var b=a;window.setTimeout(function(){editor_ondeactivate(b)},100)})();window.setTimeout(function(){g_objWrapperOutlineUtil.initializeExtOutline(!1)},200);if(2!=g_nFormEditMode)for(a in g_arrEditorAreaContainer)g_objUndoRedo.registerInitialContentStack(a)}catch(c){}}
function setFirstEditWindowFocus(){try{window.attachEvent?g_objEditWindow[0].focus():g_objEditorDocument[0].body.focus()}catch(a){}}
function initializeAnotherOption(){try{if(!g_bEditSourceMode)for(var a in g_arrEditorAreaContainer)fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a);for(a in g_arrEditorAreaContainer){var b=document.getElementById("TB_SETFORECOLOR_"+a+"_SUB");""!=g_strBodyFontColor?duzon_dialog.selectColorCode(g_strBodyFontColor,b,a):duzon_dialog.selectColorCode("#000000",b,a);var d=document.getElementById("TB_SETBACKCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#FFFFFF",d,a);var c=document.getElementById("TB_SETCELLBACKCOLOR_"+
a+"_SUB");duzon_dialog.selectColorCode("",c,a);var e=document.getElementById("TB_SETIMAGEBORDERCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",e,a);var f=document.getElementById("TB_SETTABLEBORDERCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",f,a)}}catch(g){}}
function initializeLastSetting(){try{if(g_bBrowserType_IE&&9>=g_bBrowserVerInfo)for(var a in g_arrEditorAreaContainer)0!=g_objParent_EditObject[a].clientHeight&&(g_objEditorDocument[a].body.style.height=g_objParent_EditObject[a].clientHeight-10+"px");if(dzeEnvConfig.iFrameLayer){var b=g_objLayerKit.getLayerDocument();g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"menuwin.css",function(){g_objPropertyUtil.setSkinColorSet(b)});g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+
"proplayer.css");g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"webeditor.css");g_objInsertUtil.dynamicLoad_JS(b,dzeEnvConfig.strPath_JS+"dze_iframe_function.js")}addParentScrollEvent();if(""!=dzeUiConfig.strLoadingDoneFunction)for(a in g_arrEditorAreaContainer)eval(dzeUiConfig.strLoadingDoneFunction+"("+a+");");if(g_bBrowserType_IE)for(a in g_arrEditorAreaContainer)g_objTagUtil.force_formTagSwitch(a);if("undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&
""!=dzeUiConfig.nEditModeAreaWidth){var d=Number(dzeUiConfig.nEditModeAreaWidth);for(a in g_arrEditorAreaContainer)g_objEditMode.setEditModeAreaWidth(d,a)}initializeDocFocus(0)}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeLastSetting")}}
function getParentCSS(){try{for(var a="",b=document.getElementsByTagName("link"),d=0;d<b.length;d++)if("stylesheet"==b[d].rel.toLowerCase()){var c=!0,e=b[d].href;-1!=e.indexOf(dzeEnvConfig.strPath_CSS)&&(c=!1);c&&getParentCSS_is_arrAdditionalEditAreaCSS(e)&&(c=!1);c&&(a+='<link rel="stylesheet" type="text/css" href="'+e+'" />')}return a}catch(f){}return""}
function getParentCSS_is_arrAdditionalEditAreaCSS(a){try{for(var b=0;b<g_arrAdditionalEditAreaCSS.length;b++)if(-1!=a.indexOf(g_arrAdditionalEditAreaCSS[b]))return!0}catch(d){}return!1};

var shortcutsMenuList=[];shortcutsMenuList[ID_COMMAND_FILE_NEW]="Alt+N";shortcutsMenuList[ID_COMMAND_FILE_OPEN]="Alt+O";shortcutsMenuList[ID_COMMAND_SAVEAS]="Alt+S";shortcutsMenuList[ID_COMMAND_PRINT]="Alt+P";shortcutsMenuList[ID_COMMAND_UNDO]="Ctrl+Z";shortcutsMenuList[ID_COMMAND_REDO]="Ctrl+Shift+Z";shortcutsMenuList[ID_COMMAND_CUT]="Ctrl+X";shortcutsMenuList[ID_COMMAND_COPY]="Ctrl+C";shortcutsMenuList[ID_COMMAND_PASTE]="Ctrl+V";shortcutsMenuList[ID_COMMAND_EDIT_PASTESPECIAL]="Ctrl+Alt+V";
shortcutsMenuList[ID_COMMAND_DELETE]="Ctrl+E";shortcutsMenuList[ID_COMMAND_SELECT_ALL]="Ctrl+A";shortcutsMenuList[ID_COMMAND_EDIT_SEARCH]="Ctrl+F";shortcutsMenuList[ID_COMMAND_EDIT_REPLACE]="Ctrl+H";shortcutsMenuList[ID_COMMAND_INSERT_SPECIALCHARS]="Ctrl+F10";shortcutsMenuList[ID_COMMAND_INSERT_BOOKMARK]="Ctrl+K,B";shortcutsMenuList[ID_COMMAND_HYPERLINK_INSERT]="Ctrl+K,H";shortcutsMenuList[ID_COMMAND_STYLE_FONT]="Alt+L";shortcutsMenuList[ID_COMMAND_STYLE_PARAGRAPH]="Alt+W";
shortcutsMenuList[ID_COMMAND_STYLE_ORDEREDLIST]="Ctrl+Shift+[";shortcutsMenuList[ID_COMMAND_STYLE_UNORDEREDLIST]="Ctrl+Shift+]";shortcutsMenuList[ID_COMMAND_STYLE_INCREASE_FONTSIZE]="Alt+Shift+E";shortcutsMenuList[ID_COMMAND_STYLE_DECREASE_FONTSIZE]="Alt+Shift+R";shortcutsMenuList[ID_COMMAND_STYLE_INCREASEORDER]="Ctrl+Shift+\u2190";shortcutsMenuList[ID_COMMAND_STYLE_DECREASEORDER]="Ctrl+Shift+\u2192";shortcutsMenuList[ID_COMMAND_TABLE_ADD_ROW_COL]="Alt+Insert";
shortcutsMenuList[ID_COMMAND_TABLE_DELETE_ROW]="Ctrl+BackSpace";shortcutsMenuList[ID_COMMAND_TABLE_DELETE_COL]="Alt+Shift+Delete";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_SUM]="Ctrl+Shift+H";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_SUM]="Ctrl+Shift+V";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_AVERAGE]="Ctrl+Shift+J";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_AVERAGE]="Ctrl+Shift+B";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY]="Ctrl+Shift+K";
shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_MULTIPLY]="Ctrl+Shift+G";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_HEIGHT]="Ctrl+Alt+H";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_WIDTH]="Ctrl+Alt+W";shortcutsMenuList[ID_COMMAND_TABLE_MERGE_CELL]="Ctrl+Alt+M";shortcutsMenuList[ID_COMMAND_TABLE_SPLIT_CELL]="Ctrl+Alt+S";
var DZESHORTCUT={nEditNumber:-1,evnt:null,keyCodeArray:[],isPressedKeyMapForOS:function(a,b){try{var c=g_browserCHK.isMacPC();if(!c)switch(b){case ID_KEYCODE_CTRL:if(a.ctrlKey)return!0;case ID_KEYCODE_ALT:if(a.altKey)return!0}else if(c)switch(b){case ID_KEYCODE_CTRL:if(a.ctrlKey)return!0;case ID_KEYCODE_ALT:if(a.altKey)return!0;default:if(a.metaKey)return!0}return!1}catch(d){g_objCommonUtil.displayErrorAlert(d,"DZESHORTCUT.isPressedKeyMapForOS")}},setKeyCodeArray:function(a){inArray(a,this.keyCodeArray)||
this.keyCodeArray.push(a)},clearKeyCodeArray:function(){this.keyCodeArray=[]},checkMatchMultiAlphaKeyCode:function(a){for(var b=0,c=0;c<this.keyCodeArray.length;c++)for(var d=0;d<a.length;d++)a[d]==this.keyCodeArray[c]&&d==c&&b++;return b==a.length?!0:!1},construct:function(a,b){this.nEditNumber=b;this.evnt=a},setDzeShortCutEvent:function(a,b){this.construct(a,b);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||
this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_E||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_H||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_DELETE&&TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||
this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_S||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_O&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=ID_KEYCODE_W&&this.evnt.keyCode!=ID_KEYCODE_Q||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_E&&TBCancelBubbleEvent(this.evnt);
this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_W||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_L||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_N||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_U&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=
ID_KEYCODE_B||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F7||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);!GetMultiCellSelection()||this.evnt.keyCode!=ID_KEYCODE_M&&this.evnt.keyCode!=ID_KEYCODE_H&&this.evnt.keyCode!=ID_KEYCODE_W||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey&&!this.evnt.altKey&&this.evnt.shiftKey&&
this.evnt.keyCode==ID_KEYCODE_G&&TBCancelBubbleEvent(this.evnt);!a.ctrlKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&a.keyCode!=ID_KEYCODE_F&&a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_B&&a.keyCode!=ID_KEYCODE_H||(this.setKeyCodeArray("ctrl"),this.setKeyCodeArray(a.keyCode),setTimeout(function(){0<DZESHORTCUT.keyCodeArray.length&&DZESHORTCUT.clearKeyCodeArray()},1E3));this.setNewFile();this.setOpenFile();this.setSaveAs();this.setPrint();this.setRedo();this.setPastespecial();this.setDelete();
!a.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_F||this.setFindText();!a.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&a.keyCode!=ID_KEYCODE_H||this.setReplaceText();this.setSpecialChars();!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_B||this.setInsertBookmark();!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K&&
a.keyCode!=ID_KEYCODE_H||this.setHyperLinkInsert();this.setStyleFont();this.setStyleParagraph();this.setInsertOrderedList();this.setInsertUnOrderedList();this.setIncreaseFontSize();this.setIncreaseLetterSpacing();this.setFontProperty();this.setParagraphAlign();this.setIndentParagraph();this.setLeftMargin();this.setRightMargin();this.setLineHeight();this.setAutoListStyle();this.setApplyListStyleDepth();this.tableAddRowCol();this.tableHorizontalSum();this.tableVerticalSum();this.tableHorizontalAverage();
this.tableVerticalAverage();this.tableHorizontalMultiply();this.tableVerticalMultiply();this.tableMergeCell();this.tableSplitCell();this.tableCellSameHeight();this.tableCellSameWidth();this.tableAddRow();this.tableDeleteRow();this.tableDeleteCol();this.tableSelectOneCell();this.copyMuticellEntireRows();this.pasteMuticellEntireRows();this.setTabKeyAction();this.applyEscKeyAction();this.destruct(a)},setNewFile:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==
ID_KEYCODE_N){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_NewFile(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setNewFile")}},setOpenFile:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_O){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_OpenFile(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,
"setOpenFile")}},setSaveAs:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_S||!this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_S){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_SaveAs(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setSaveAs")}},setPrint:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&
!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_P){var a=document.getElementById(g_arrConst[ID_COMMAND_PRINT][2]+"_"+this.nEditNumber);fnHandler_Print(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setPrint")}},setRedo:function(){try{!this.evnt.altKey&&this.evnt.ctrlKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_Z&&(g_objUndoRedo.operateUndoRedoStack(!1,!1,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"setRedo")}},setPastespecial:function(){try{if(this.evnt.ctrlKey&&this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_V){var a=document.getElementById(g_arrConst[ID_COMMAND_EDIT_PASTESPECIAL][2]+"_"+this.nEditNumber);fnHandler_Pastespecial(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setPastespecial")}},setDelete:function(){try{if(this.evnt.ctrlKey&&!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_E){var a=
document.getElementById(g_arrConst[ID_COMMAND_DELETE][2]+"_"+this.nEditNumber);fnHandler_SupportCommand(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setDelete")}},setFindText:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_Q,ID_KEYCODE_F])||this.evnt.ctrlKey&&!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_F){var a=document.getElementById(g_arrConst[ID_COMMAND_EDIT_SEARCH][2]+"_"+this.nEditNumber);
fnHandler_FindReplaceText(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setFindText")}},setReplaceText:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_Q,ID_KEYCODE_A])||this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_H])){var a=document.getElementById(g_arrConst[ID_COMMAND_EDIT_REPLACE][2]+"_"+this.nEditNumber);fnHandler_FindReplaceText(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();
TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setReplaceText")}},setSpecialChars:function(){try{if(this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_F10){var a=document.getElementById(g_arrConst[ID_COMMAND_INSERT_SPECIALCHARS][2]+"_"+this.nEditNumber);fnHandler_SpecialChars(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setSpecialChars")}},setInsertBookmark:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",
ID_KEYCODE_K,ID_KEYCODE_B])){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_InsertBookmark(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setInsertBookmark")}},setHyperLinkInsert:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_K,ID_KEYCODE_H])){var a=document.getElementById(g_arrConst[ID_COMMAND_HYPERLINK_INSERT][2]+"_"+this.nEditNumber);fnHandler_HyperLinkInsert(null,
a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setHyperLinkInsert")}},setStyleFont:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_L){var a=document.getElementById(g_arrConst[ID_COMMAND_FONT_NAME][2]+"_"+this.nEditNumber);fnHandler_StyleFont(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setStyleFont")}},
setStyleParagraph:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_W){var a=document.getElementById(g_arrConst[ID_COMMAND_LINE_HEIGHT][2]+"_"+this.nEditNumber);fnHandler_StyleParagraph(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setStyleParagraph")}},setInsertOrderedList:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET){var a=
document.getElementById(g_arrConst[ID_COMMAND_INSERT_ORDERED_LIST][2]+"_"+this.nEditNumber);fnHandler_SupportCommand(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setInsertOrderedList")}},setInsertUnOrderedList:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_CLOSESQUAREBRACKET){var a=document.getElementById(g_arrConst[ID_COMMAND_INSERT_UNORDERED_LIST][2]+"_"+this.nEditNumber);fnHandler_SupportCommand(null,
a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setInsertUnOrderedList")}},setIncreaseFontSize:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_E||this.evnt.keyCode==ID_KEYCODE_R)||!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET||this.evnt.keyCode==ID_KEYCODE_CLOSESQUAREBRACKET)){g_objCommonUtil.log("setIncreaseFontSize start");var a=
!0;if(this.evnt.keyCode==ID_KEYCODE_R||this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET){var b=document.getElementById(g_arrConst[ID_COMMAND_STYLE_DECREASE_FONTSIZE][2]+"_"+this.nEditNumber);fnHandler_StyleDecreaseFontSize(this.evnt,b,this.nEditNumber);a=!1}else b=document.getElementById(g_arrConst[ID_COMMAND_STYLE_INCREASE_FONTSIZE][2]+"_"+this.nEditNumber),fnHandler_StyleIncreaseFontSize(this.evnt,b,this.nEditNumber);g_objCommonUtil.log("increaseType:"+a);TBCancelBubbleEvent(this.evnt)}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"setIncreaseFontSize")}},setIncreaseLetterSpacing:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_W||this.evnt.keyCode==ID_KEYCODE_N)&&(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(g_objTable,!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){g_objCommonUtil.log("setIncreaseLetterSpacing start");var a=!0;this.evnt.keyCode==ID_KEYCODE_N&&(a=!1);strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:
getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)g_objCommonUtil.log("select type is not support -> strSelectionType : "+strSelectionType);else{var b=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);duzon_dialog.initSelectionFontStyleList(b);g_objCommonUtil.log(duzon_dialog.selectionFontStyleList);""==duzon_dialog.selectionFontStyleList.letterSpacing&&(duzon_dialog.selectionFontStyleList.letterSpacing=
"0pt");var c=parseInt(duzon_dialog.selectionFontStyleList.letterSpacing.replace(/pt/,""),10);g_objCommonUtil.log("org letterSpacing:"+c);a=!0===a?c+1:c-1;a<duzon_dialog.min_letterspacing||a>duzon_dialog.max_letterspacing?g_objCommonUtil.log("increaseSpacing exception - increaseSpacing : "+a):(g_objCommonUtil.log("increaseSpacing:"+a),g_objLetterSpacingWin.fnLetterSpacingCellClick(a+"pt"),TBCancelBubbleEvent(this.evnt))}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"setIncreaseLetterSpacing")}},setFontProperty:function(){try{if(this.evnt.altKey&&
this.evnt.shiftKey&&!this.evnt.ctrlKey){if(dzeUiConfig.bUseLockEditCellFunction&&(1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||0==g_objEditMode.checkSelectionContentEditable(this.nEditNumber)))return;var a="";if(this.evnt.keyCode==ID_KEYCODE_U)a=g_arrConst[ID_COMMAND_UNDERLINE][0];else if(this.evnt.keyCode==ID_KEYCODE_B)a=g_arrConst[ID_COMMAND_BOLD][0];else if(this.evnt.keyCode==ID_KEYCODE_I)a=g_arrConst[ID_COMMAND_ITALIC][0];else if(this.evnt.keyCode==ID_KEYCODE_P)a=g_arrConst[ID_COMMAND_SUPERSCRIPT][0];
else if(this.evnt.keyCode==ID_KEYCODE_S)a=g_arrConst[ID_COMMAND_SUBSCRIPT][0];else return;g_objCommonUtil.log("strCommand:"+a);fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);TBCancelBubbleEvent(this.evnt)}if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_A&&(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||
ID_STRING_NAME_NONE==strSelectionType)){var b=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],ID_COMMAND_SUPERSCRIPT,g_arrConst[ID_COMMAND_SUPERSCRIPT][0],this.nEditNumber,-1,strSelectionType),c=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],ID_COMMAND_SUBSCRIPT,g_arrConst[ID_COMMAND_SUBSCRIPT][0],this.nEditNumber,-1,strSelectionType);g_objCommonUtil.log("strStateSuper:"+b);g_objCommonUtil.log("strStateSub:"+c);b==ID_STRING_NAME_CHECKED?(a=g_arrConst[ID_COMMAND_SUPERSCRIPT][0],
fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a),a=g_arrConst[ID_COMMAND_SUBSCRIPT][0]):a=c==ID_STRING_NAME_CHECKED?g_arrConst[ID_COMMAND_SUBSCRIPT][0]:g_arrConst[ID_COMMAND_SUPERSCRIPT][0];g_objCommonUtil.log("strCommand:"+a);fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);TBCancelBubbleEvent(this.evnt)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"setFontProperty")}},setParagraphAlign:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey){var a="";if(this.evnt.keyCode==
ID_KEYCODE_M)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_JUSTIFY][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_L)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_LEFT][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_R)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_RIGHT][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_C)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_CENTER][2]+"_"+this.nEditNumber);else return;fnHandler_Align(this.evnt,
a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setParagraphAlign")}},indent_unit_val:13,setIndentParagraph:function(){try{if(!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_F5||this.evnt.keyCode==ID_KEYCODE_F6)||!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_O||this.evnt.keyCode==ID_KEYCODE_I)){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);g_objCommonUtil.log("======setIndentParagraph======");
g_objCommonUtil.log(a);var b=document.getElementById(g_arrConst[this.evnt.keyCode==ID_KEYCODE_F5||this.evnt.keyCode==ID_KEYCODE_O?ID_COMMAND_OUTDENT:ID_COMMAND_INDENT][2]+"_"+this.nEditNumber);fnHandler_Outdent_Indent(this.evnt,b,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setIndentParagraph")}},margin_unit_val:5,setLeftMargin:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_5||this.evnt.keyCode==
ID_KEYCODE_6)&&(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(g_objTable,!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);g_objCommonUtil.log("======setIndentParagraph======");g_objCommonUtil.log(a);var b=a[6];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,""),10);this.evnt.keyCode==ID_KEYCODE_5?b>duzon_dialog.marginLeftMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_6&&
b<duzon_dialog.marginLeftMax&&(a+=this.margin_unit_val);a<duzon_dialog.marginLeftMin&&(a=duzon_dialog.marginLeftMin);a>duzon_dialog.marginLeftMax&&(a=duzon_dialog.marginLeftMax);do_handler_Outdent_Indent({name:"marginLeft",value:a},this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setLeftMargin")}},setRightMargin:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_7||this.evnt.keyCode==ID_KEYCODE_8)&&
(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(g_objTable,!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);g_objCommonUtil.log("======setIndentParagraph======");g_objCommonUtil.log(a);var b=a[8];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,""),10);this.evnt.keyCode==ID_KEYCODE_8?a>duzon_dialog.marginRightMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_7&&a<duzon_dialog.marginRightMax&&
(a+=this.margin_unit_val);a<duzon_dialog.marginRightMin&&(a=duzon_dialog.marginRightMin);a>duzon_dialog.marginRightMax&&(a=duzon_dialog.marginRightMax);do_handler_Outdent_Indent({name:"marginRight",value:a},this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setRightMargin")}},lineheight_unit_val:.1,setLineHeight:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Z)||
!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_Q||this.evnt.keyCode==ID_KEYCODE_W))if(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(g_objTable,!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber)){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);g_objCommonUtil.log("======setIndentParagraph======");g_objCommonUtil.log(a);var b=a[5];""==b&&(b="1.2");b=parseFloat(b,10);g_objCommonUtil.log("lineHeight:"+
b);a=b;if(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Q)a>duzon_dialog.lineHeightMin&&(a-=this.lineheight_unit_val);else if(this.evnt.keyCode==ID_KEYCODE_Z||this.evnt.keyCode==ID_KEYCODE_W)a<duzon_dialog.lineHeightMax&&(a+=this.lineheight_unit_val);else return;g_objCommonUtil.log("newLineHeight:"+a);a<duzon_dialog.lineHeightMin&&(a=duzon_dialog.lineHeightMin);a>duzon_dialog.lineHeightMax&&(a=duzon_dialog.lineHeightMax);g_objCommonUtil.log("newLineHeight2:"+a);g_objLineHeightWin.fnLineHeightCellClick(a);
TBCancelBubbleEvent(this.evnt)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setLineHeight")}},setAutoListStyle:function(){try{this.evnt.keyCode==ID_KEYCODE_SPACE&&applyAutoListStyle(this.evnt,this.nEditNumber),this.evnt.keyCode==ID_KEYCODE_BACKSPACE&&applyListStyleBackSpace(this.evnt,this.nEditNumber)}catch(a){g_objCommonUtil.displayErrorAlert(a,"setAutoListStyle")}},setApplyListStyleDepth:function(){try{if(!this.evnt.altKey&&this.evnt.ctrlKey&&this.evnt.shiftKey&&(this.evnt.keyCode==ID_KEYCODE_ARROW_RIGHT||
this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)){if(this.evnt.keyCode==ID_KEYCODE_ARROW_RIGHT)var a="decrease";else if(this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)a="increase";else return;applyListStyleDepth(a,this.nEditNumber,this.evnt)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setApplyListStyleDepth")}},tableAddRowCol:function(){try{!this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_INSERT||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),null!=g_objTable&&
fnHandler_TableAddRowCol(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"tableAddRowCol")}},tableHorizontalSum:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_H||dzeUiConfig.bUseLockEditCellFunction&&1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),fnHandler_TableHorizontalSum(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"tableHorizontalSum")}},tableVerticalSum:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_V||dzeUiConfig.bUseLockEditCellFunction&&1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),fnHandler_TableVerticalSum(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"tableVerticalSum")}},tableHorizontalAverage:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||
!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_J||dzeUiConfig.bUseLockEditCellFunction&&1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),fnHandler_TableHorizontalAverage(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"tableHorizontalAverage")}},tableVerticalAverage:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_B||dzeUiConfig.bUseLockEditCellFunction&&
1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),fnHandler_TableVerticalAverage(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"tableVerticalAverage")}},tableHorizontalMultiply:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_K||dzeUiConfig.bUseLockEditCellFunction&&1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),
fnHandler_TableHorizontalMultiply(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"tableHorizontalMultiply")}},tableVerticalMultiply:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_G||dzeUiConfig.bUseLockEditCellFunction&&1==g_objTableFunction.hasLockedEditCell(g_objTable,!1)||(g_objTableSelection.setTableObjectOnCaret(this.nEditNumber),fnHandler_TableVerticalMultiply(this.evnt,{},this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"tableVerticalMultiply")}},tableCellSameHeight:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_H&&GetMultiCellSelection()){var a=document.getElementById("TB_TABLE_CELL_SAME_HEIGHT_"+this.nEditNumber);fnHandler_TableCellSameHeight(this.evnt,a,this.nEditNumber)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"tableCellSameHeight")}},tableCellSameWidth:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==
ID_KEYCODE_W&&GetMultiCellSelection()){var a=document.getElementById("TB_TABLE_CELL_SAME_WIDTH_"+this.nEditNumber);fnHandler_TableCellSameWidth(this.evnt,a,this.nEditNumber)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"tableCellSameWidth")}},tableMergeCell:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_M&&GetMultiCellSelection()){var a=document.getElementById("TB_TABLE_MERGE_CELL_"+this.nEditNumber);fnHandler_TableMergeCell(this.evnt,a,
this.nEditNumber)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"tableMergeCell")}},tableSplitCell:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_S){g_objTableSelection.setTableObjectOnCaret(this.nEditNumber);var a=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[this.nEditNumber],this.nEditNumber);null!=a&&updateTableHandlerUI.updateTableUIHandler(a[0],a[1],a[2],a[3],this.nEditNumber);var b=document.getElementById("TB_TABLE_SPLIT_CELL_"+
this.nEditNumber);fnHandler_TableSplitCell(this.evnt,b,this.nEditNumber)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"tableSplitCell")}},tableAddRow:function(){try{if(!this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_ENTER){g_objTableSelection.setTableObjectOnCaret(this.nEditNumber);var a=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[this.nEditNumber],this.nEditNumber);null!=a&&updateTableHandlerUI.updateTableUIHandler(a[0],a[1],a[2],a[3],
this.nEditNumber);var b=document.getElementById("TB_TABLE_ADD_ROW_DOWN_"+this.nEditNumber);fnHandler_TableAddRow(this.evnt,b,this.nEditNumber)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"tableAddRow")}},tableDeleteRow:function(){try{if(!this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_BACKSPACE){g_objTableSelection.setTableObjectOnCaret(this.nEditNumber);var a=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[this.nEditNumber],this.nEditNumber);
null!=a&&updateTableHandlerUI.updateTableUIHandler(a[0],a[1],a[2],a[3],this.nEditNumber);var b=document.getElementById("TB_TABLE_DELETE_ROW_"+this.nEditNumber);fnHandler_TableDeleteRow(this.evnt,b,this.nEditNumber)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"tableDeleteRow")}},tableDeleteCol:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_DELETE){g_objTableSelection.setTableObjectOnCaret(this.nEditNumber);var a=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[this.nEditNumber],
this.nEditNumber);null!=a&&updateTableHandlerUI.updateTableUIHandler(a[0],a[1],a[2],a[3],this.nEditNumber);var b=document.getElementById("TB_TABLE_DELETE_COL_"+this.nEditNumber);fnHandler_TableDeleteCol(this.evnt,b,this.nEditNumber)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"tableDeleteCol")}},tableSelectOneCell:function(){try{this.evnt.altKey||this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||g_objTableSelection.table_SelectionCaretCell(this.nEditNumber)}catch(a){g_objCommonUtil.displayErrorAlert(a,
"tableSelectOneCell")}},unsetPasteStyleMode:function(){try{!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(this.nEditNumber),dzeCopyPasteStyleInfo.unsetPasteStyleMode(this.nEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:unsetPasteStyleMode")}},copyMuticellEntireRows:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_C||(dzeClipBoard.initialize(),GetMultiCellSelection()&&(dzeClipBoard.copySelectedMultiCells(this.nEditNumber),
TBCancelBubbleEvent(this.evnt)))}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:copyMuticellEntireRows")}},pasteMuticellEntireRows:function(){try{this.evnt.altKey||!this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_V||!0===dzeClipBoard.paste(this.nEditNumber)&&TBCancelBubbleEvent(this.evnt)}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:pasteMuticellEntireRows")}},setTabKeyAction:function(){try{if(!this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_TAB){var a=
g_objTableFunction.getCurrentCell(this.nEditNumber);null!=a&&null!=a.table||g_objTable||(this.evnt.shiftKey?this.evnt.shiftKey&&applyTabKeyAction(!1,this.nEditNumber,this.evnt):applyTabKeyAction(!0,this.nEditNumber,this.evnt),TBCancelBubbleEvent(this.evnt))}}catch(b){dalert(b)}},applyEscKeyAction:function(){try{this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_ESCAPE||(this.unsetPasteStyleMode(),dzeClipBoard.initialize())}catch(a){g_objCommonUtil.displayErrorAlert(a,
"error:applyEscKeyAction")}},destruct:function(a){}};

var g_objWrapperOutlineResize=new function(){this.objExtDragPosInfo=this.objExtSelectedInfo=null;this.resetExtOutlineInfo=function(){try{g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objTableMiniMenu.showTableMiniMenu(!1,null,-1),this.resetExtOutlineInfo_call(),g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT_BOTTOM]=!0,g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT]=!0}catch(a){g_objCommonUtil.displayErrorAlert(a,"resetExtOutlineInfo")}};this.resetExtOutlineInfo_call=
function(){try{this.objExtDragPosInfo=this.objExtSelectedInfo=null,g_objWrapperOutlineUtil.nExtOutlineRectangleMouseDown=-1,g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"resetExtOutlineInfo_call")}};this.newExtSelectedInfo=function(a,b,f,c,d,k){try{this.objExtSelectedInfo={};this.objExtSelectedInfo.nSelectedType=a;this.objExtSelectedInfo.objElement=b;this.objExtSelectedInfo.objTable=f;this.objExtSelectedInfo.nStartClick_Row=c;this.objExtSelectedInfo.nStartClick_Col=
d;this.objExtSelectedInfo.objTableCell=k;this.objExtSelectedInfo.bFirstSetupWidth=!1;this.objExtSelectedInfo.bFirstSetupHeight=!1;this.objExtSelectedInfo.arrResizeRow=null;this.objExtSelectedInfo.arrResizeCol=null;return}catch(g){g_objCommonUtil.displayErrorAlert(g,"newExtSelectedInfo")}this.objExtSelectedInfo=null};this.newExtDragPosInfo=function(a,b,f){try{if(null==a)return null;this.objExtDragPosInfo={};this.objExtDragPosInfo.startPosXY=g_objPositionUtil.GetDocumentClientPos_XY(b);var c=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(a,
f);this.objExtDragPosInfo.rcArea=c;var d=a.style.width,k=a.style.height,g=a.offsetWidth,e=a.offsetHeight;a.style.width=c.right-c.left+"px";a.style.height=c.bottom-c.top+"px";var h=a.offsetWidth-g,l=a.offsetHeight-e;a.style.width=d;a.style.height=k;this.objExtDragPosInfo.nDiff_X=h;this.objExtDragPosInfo.nDiff_Y=l;return}catch(m){g_objCommonUtil.displayErrorAlert(m,"newExtDragPosInfo")}this.objExtDragPosInfo=null};this.resizePositionByDragForExtMode=function(a,b,f,c,d){try{if(DZE_CTRL_PT_NONE!=c&&null!=
this.objExtDragPosInfo&&null!=b){var k=g_objPositionUtil.GetDocumentClientPos_XY(f),g=k.nPos_X-this.objExtDragPosInfo.startPosXY.nPos_X,e=k.nPos_Y-this.objExtDragPosInfo.startPosXY.nPos_Y;if(DZE_CTRL_PT_RIGHT_BOTTOM==c||DZE_CTRL_PT_LEFT_TOP==c||DZE_CTRL_PT_RIGHT_TOP==c||DZE_CTRL_PT_LEFT_BOTTOM==c){switch(c){case DZE_CTRL_PT_RIGHT_BOTTOM:var h=parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left+g);var l=parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top+
e);break;case DZE_CTRL_PT_LEFT_TOP:h=parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left-g);l=parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top-e);break;case DZE_CTRL_PT_RIGHT_TOP:h=parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left+g);l=parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top-e);break;case DZE_CTRL_PT_LEFT_BOTTOM:h=parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left-
g),l=parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top+e)}var m=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(b,d);if(event.shiftKey&&1==a)a=1,a=Math.abs(g)>Math.abs(e)?h/b.width:l/b.height,this.resizeStyleWidthHeight(b,!0,b.width*a,!0,b.height*a);else{if(0<h)if(1==a)this.resizeStyleWidthHeight(b,!0,h,!1,0);else if(2==a){var n=parseInt(h)-(parseInt(m.right)-parseInt(m.left));this.movePositionTableCellWidthByResizeCol(b,n,d)}0<l&&(1==a?this.resizeStyleWidthHeight(b,
!1,0,!0,l):2==a&&(n=parseInt(l)-(parseInt(m.bottom)-parseInt(m.top)),this.movePositionTableCellHeightByResizeRow(b,n,d)))}}else if(DZE_CTRL_PT_RIGHT==c||DZE_CTRL_PT_LEFT==c)h=DZE_CTRL_PT_RIGHT==c?parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left+g):parseInt(this.objExtDragPosInfo.rcArea.right-this.objExtDragPosInfo.rcArea.left-g),0<h&&(1==a?this.resizeStyleWidthHeight(b,!0,h,!1,0):2==a&&(m=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(b,d),n=parseInt(h)-(parseInt(m.right)-
parseInt(m.left)),this.movePositionTableCellWidthByResizeCol(b,n,d)));else if(DZE_CTRL_PT_BOTTOM==c||DZE_CTRL_PT_TOP==c)l=DZE_CTRL_PT_BOTTOM==c?parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top+e):parseInt(this.objExtDragPosInfo.rcArea.bottom-this.objExtDragPosInfo.rcArea.top-e),0<l&&(1==a?this.resizeStyleWidthHeight(b,!1,0,!0,l):2==a&&(m=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(b,d),n=parseInt(l)-(parseInt(m.bottom)-parseInt(m.top)),this.movePositionTableCellHeightByResizeRow(b,
n,d)));else return;g_objWrapperOutlineUtil.showExtOutline(b,!0,!0,!1,d)}}catch(p){g_objCommonUtil.displayErrorAlert(p,"resizePositionByDragForExtMode")}};this.movePositionTableCellWidthByResizeCol=function(a,b,f){try{if(null!=this.objExtSelectedInfo){var c=this.objExtSelectedInfo.objTable;if(!this.objExtSelectedInfo.bFirstSetupWidth){var d=g_objNodeUtil.getNodeWidthHeight(c,!0);if(""!=d.strUnit&&"px"!=d.strUnit)if("%"==d.strUnit)""!=d.nValue&&null!=d.nValue&&g_objTableResize.resetTableCellPixelWidth(c);
else return;this.objExtSelectedInfo.bFirstSetupWidth=!0;if(null==this.checkTableCellForMovePositionWidth(a))return}var k=this.movePositionTableCellWidth(a,b,!0,f);if(null!=k&&!k&&null!=this.objExtSelectedInfo.arrResizeCol){for(a=0;a<this.objExtSelectedInfo.arrResizeCol.length;a++){var g=this.objExtSelectedInfo.arrResizeCol[a][0],e=this.objExtSelectedInfo.arrResizeCol[a][1];if(g==g_nStartClick_Row&&e==g_nStartClick_Col)this.objExtSelectedInfo.arrResizeCol[a][2]=!0;else if(!this.objExtSelectedInfo.arrResizeCol[a][2]){this.objExtSelectedInfo.arrResizeCol[a][2]=
!0;var h=g_objTableUtil.getTableCellElement(c,g,e);if(null==this.checkTableCellForMovePositionWidth(h))return}}d=[];for(a=0;a<this.objExtSelectedInfo.arrResizeCol.length;a++)g=this.objExtSelectedInfo.arrResizeCol[a][0],e=this.objExtSelectedInfo.arrResizeCol[a][1],h=g_objTableUtil.getTableCellElement(c,g,e),d[a]=this.movePositionTableCellWidth(h,b,!1,f);k=!1;for(a=0;a<this.objExtSelectedInfo.arrResizeCol.length;a++)if(d[a]){k=!0;break}if(!k)for(a=0;a<this.objExtSelectedInfo.arrResizeCol.length;a++)g=
this.objExtSelectedInfo.arrResizeCol[a][0],e=this.objExtSelectedInfo.arrResizeCol[a][1],h=g_objTableUtil.getTableCellElement(c,g,e),this.movePositionTableCellWidth(h,-1*b,!1,f)}}}catch(l){g_objCommonUtil.displayErrorAlert(l,"movePositionTableCellWidthByResizeCol")}};this.movePositionTableCellHeightByResizeRow=function(a,b,f){try{if(null!=this.objExtSelectedInfo){var c=this.objExtSelectedInfo.objTable;if(!this.objExtSelectedInfo.bFirstSetupHeight&&(this.objExtSelectedInfo.bFirstSetupHeight=!0,null==
this.checkTableCellForMovePositionHeight(a)))return;var d=this.movePositionTableCellHeight(a,b,!0,f);if(null!=d&&!d&&null!=this.objExtSelectedInfo.arrResizeRow){for(a=0;a<this.objExtSelectedInfo.arrResizeRow.length;a++){var k=this.objExtSelectedInfo.arrResizeRow[a][0],g=this.objExtSelectedInfo.arrResizeRow[a][1];if(k==g_nStartClick_Row&&g==g_nStartClick_Col)this.objExtSelectedInfo.arrResizeRow[a][2]=!0;else if(!this.objExtSelectedInfo.arrResizeRow[a][2]){this.objExtSelectedInfo.arrResizeRow[a][2]=
!0;var e=g_objTableUtil.getTableCellElement(c,k,g);if(null==this.checkTableCellForMovePositionHeight(e))return}}d=[];for(a=0;a<this.objExtSelectedInfo.arrResizeRow.length;a++)k=this.objExtSelectedInfo.arrResizeRow[a][0],g=this.objExtSelectedInfo.arrResizeRow[a][1],e=g_objTableUtil.getTableCellElement(c,k,g),d[a]=this.movePositionTableCellHeight(e,b,!1,f);var h=!1;for(a=0;a<this.objExtSelectedInfo.arrResizeRow.length;a++)if(d[a]){h=!0;break}if(!h)for(a=0;a<this.objExtSelectedInfo.arrResizeRow.length;a++)k=
this.objExtSelectedInfo.arrResizeRow[a][0],g=this.objExtSelectedInfo.arrResizeRow[a][1],e=g_objTableUtil.getTableCellElement(c,k,g),this.movePositionTableCellHeight(e,-1*b,!1,f)}}}catch(l){g_objCommonUtil.displayErrorAlert(l,"movePositionTableCellHeightByResizeRow")}};this.checkTableCellForMovePositionWidth=function(a){try{var b=a.offsetWidth,f=b;a.style.width=b+1+"px";var c=a.offsetWidth;if(b<c)return f=b-(c-b-1),a.style.width=f+"px",a.width=f+"px",f}catch(d){g_objCommonUtil.displayErrorAlert(d,
"checkTableCellForMovePositionWidth")}return null};this.checkTableCellForMovePositionHeight=function(a){try{var b=a.offsetHeight,f=b;a.style.height=b+1+"px";var c=a.offsetHeight;if(b<c)return f=b-(c-b-1),a.style.height=f+"px",a.height=f+"px",f}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkTableCellForMovePositionHeight")}return null};this.movePositionTableCellWidth=function(a,b,f,c){try{c=!0;var d=0,k=a.offsetWidth,g=g_objCommonUtil.extractNumberValueUnit(a.style.width);if(null==g)return null;
d=parseInt(g.nValue);if(0>parseInt(d)+parseInt(b))return null;a.style.width=parseInt(d)+parseInt(b)+"px";a.width=parseInt(d)+parseInt(b)+"px";k==a.offsetWidth&&(c=!1,f&&(a.style.width=d+"px",a.width=d+"px"));return c}catch(e){g_objCommonUtil.displayErrorAlert(e,"movePositionTableCellWidth")}return null};this.movePositionTableCellHeight=function(a,b,f,c){try{c=!0;var d=0,k=a.offsetHeight,g=g_objCommonUtil.extractNumberValueUnit(a.style.height);if(null==g)return null;d=parseInt(g.nValue);if(0>parseInt(d)+
parseInt(b))return null;a.style.height=parseInt(d)+parseInt(b)+"px";a.height=parseInt(d)+parseInt(b)+"px";k==a.offsetHeight&&(c=!1,f&&(a.style.height=d+"px",a.height=d+"px"));return c}catch(e){g_objCommonUtil.displayErrorAlert(e,"movePositionTableCellHeight")}return null};this.resizeStyleWidthHeight=function(a,b,f,c,d){try{if(b&&0<=f){var k=a.height,g=a.style.height;if(""==k&&""==g){var e=a.offsetHeight;a.style.height=e}else""!=k&&""==g?(a.style.height=k,this.removeAttributeWidthHeight(a,!1,!0)):
""==k&&""!=g||""==k||""==g||this.removeAttributeWidthHeight(a,!1,!0);var h=a.style.width,l=a.offsetWidth;a.style.width=f+"px";l==a.offsetWidth&&""!=h&&(a.style.width=h)}if(c&&0<=d){var m=a.width;h=a.style.width;""==m&&""==h?(l=a.offsetWidth,a.style.width=l):""!=m&&""==h?(a.style.width=m,this.removeAttributeWidthHeight(a,!0,!1)):""==m&&""!=h||""==m||""==h||this.removeAttributeWidthHeight(a,!0,!1);g=a.style.height;e=a.offsetHeight;a.style.height=d+"px";e==a.offsetHeight&&""!=g&&(a.style.height=g)}this.removeAttributeWidthHeight(a,
b,c)}catch(n){g_objCommonUtil.displayErrorAlert(n,"resizeStyleWidthHeight")}};this.removeAttributeWidthHeight=function(a,b,f){try{b&&a.removeAttribute("width"),f&&a.removeAttribute("height")}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeAttributeWidthHeight")}};this.afterResizeTargetElement=function(a,b){try{if(null!=this.objExtSelectedInfo){if(DZE_CTRL_PT_RIGHT_BOTTOM==a)this.afterCheckResize_Cell_ForExtMode(this.objExtSelectedInfo,!0,b),this.afterCheckResize_Cell_ForExtMode(this.objExtSelectedInfo,
!1,b);else if(DZE_CTRL_PT_RIGHT==a)this.afterCheckResize_Cell_ForExtMode(this.objExtSelectedInfo,!1,b);else if(DZE_CTRL_PT_BOTTOM==a)this.afterCheckResize_Cell_ForExtMode(this.objExtSelectedInfo,!0,b);else return;var f=g_objNodeUtil.getNodeWidthHeight(this.objExtSelectedInfo.objTable,!0);""!=f.strUnit&&"px"!=f.strUnit&&"%"!=f.strUnit||g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"afterResizeTargetElement")}};this.afterCheckResize_Cell_ForExtMode=function(a,
b,f){try{if(null!=a){var c=this.objExtSelectedInfo.objTable,d=a.objTableCell,k=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(d,a.objTable,a.nStartClick_Row,f);if(b){var g=d.style.height;if(null!=a.arrResizeRow)for(var e=0;e<a.arrResizeRow.length;e++){var h=a.arrResizeRow[e][0],l=a.arrResizeRow[e][1];if(h!=a.nStartClick_Row||l!=a.nStartClick_Col){var m=g_objTableUtil.getTableCellElement(c,h,l),n=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(m,c,h,f);k.top==n.top&&(m.style.height=
g,m.height=g)}}}else{var p=d.style.width;if(null!=a.arrResizeCol)for(e=0;e<a.arrResizeCol.length;e++)if(h=a.arrResizeCol[e][0],l=a.arrResizeCol[e][1],h!=a.nStartClick_Row||l!=a.nStartClick_Col)m=g_objTableUtil.getTableCellElement(c,h,l),n=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(m,c,h,f),k.left==n.left&&(m.style.width=p,m.width=p)}}}catch(q){g_objCommonUtil.displayErrorAlert(q,"afterCheckResize_Cell_ForExtMode")}};this.prepareResizeTargetElement=function(a){try{if(g_bTableCellResizingYN&&
null!=this.objExtSelectedInfo){var b=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(this.objExtSelectedInfo.objTableCell,this.objExtSelectedInfo.objTable,this.objExtSelectedInfo.nStartClick_Row,a);this.objExtSelectedInfo.arrResizeRow=[];this.objExtSelectedInfo.arrResizeCol=[];this.checkResize_Cell_ForExtMode(b.bottom,!0,this.objExtSelectedInfo.arrResizeRow,this.objExtSelectedInfo.arrResizeCol,a);this.checkResize_Cell_ForExtMode(b.right,!1,this.objExtSelectedInfo.arrResizeRow,this.objExtSelectedInfo.arrResizeCol,
a)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"prepareResizeTargetElement")}};this.checkResize_Cell_ForExtMode=function(a,b,f,c,d){try{if(null!=this.objExtSelectedInfo)for(var k=this.objExtSelectedInfo.objTable,g=k.rows.length,e=0;e<g;e++)for(var h=g_objTableUtil.getTableCellsLength(k,e),l=0;l<h;l++){var m=g_objTableUtil.getTableCellElement(k,e,l),n=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(m,k,e,d),p=n.right,q=n.bottom;b?a==q&&(f[f.length]=[e,l,!1]):a==p&&(c[c.length]=[e,l,!1])}}catch(r){g_objCommonUtil.displayErrorAlert(r,
"checkResize_Cell_ForExtMode")}}};

var g_objUndoRedo=new function(){this.arrUndoRedoStruct=[];this.newUndoRedoStack=function(){try{var c={bKeyCodeContinue:!1};c.nLastKeyCode=ID_KEYCODE_NONE;c.nUndoRedoStackPos=-1;c.nUndoRedoStack_LastEventPos=-1;c.arrUndoRedoStack=[];return c}catch(b){g_objCommonUtil.displayErrorAlert(b,"newUndoRedoStack")}return null};this.newUndoRedoSelection=function(){return{nCaseID:0,arrStartContainerPos:null,posStartOffset:null,arrEndContainerPos:null,posEndOffset:null,strBackgroundColor:"",strBackgroundImageURL:"",
strBackgroundImageRepeat:""}};this.initUndoRedoStack=function(c){try{var b=this.newUndoRedoStack();return b?this.arrUndoRedoStruct[c]=b:null}catch(a){g_objCommonUtil.displayErrorAlert(a,"initUndoRedoStack")}return null};this.registerInitialContentStack=function(c){try{var b=this.initUndoRedoStack(c);b.nUndoRedoStackPos++;b.nUndoRedoStack_LastEventPos=b.nUndoRedoStackPos;var a=this.getContentStack(c),d=this.getUndoRedoSelection(0,c);b.arrUndoRedoStack[b.nUndoRedoStackPos]=[a,d]}catch(e){g_objCommonUtil.displayErrorAlert(e,
"registerInitialContentStack")}};this.registerUndoRedoStack=function(c,b){try{this.registerUndoRedoContent(c,b)}catch(a){g_objCommonUtil.displayErrorAlert(a,"registerUndoRedoStack")}};this.registerUndoRedoContent=function(c,b){try{var a=this.arrUndoRedoStruct[b];if(null!=a){a.nUndoRedoStackPos++;a.nUndoRedoStack_LastEventPos=a.nUndoRedoStackPos;a.bKeyCodeContinue=!1;a.nLastKeyCode=ID_KEYCODE_NONE;var d=this.getContentStack(b),e=this.getUndoRedoSelection(c,b);a.arrUndoRedoStack[a.nUndoRedoStackPos]=
[d,e]}}catch(f){g_objCommonUtil.displayErrorAlert(f,"registerUndoRedoContent")}};this.getUndoRedoSelection=function(c,b){try{var a=this.newUndoRedoSelection();a.nCaseID=c;a.strBackgroundColor=getBodyBackgroundColor(b);a.strBackgroundImageURL=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[b].body);a.strBackgroundImageRepeat=getBodyBackgroundRepeat(b);if(window.attachEvent){var d=g_objEditorDocument[b].selection,e=d.type;e=e.toLowerCase();if(ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==
e){var f=d.createRange(),g=f.parentElement(),h=this.getNodePosition(g),k=this.getSelectionPos_IE(f,g,d);a.arrStartContainerPos=h;a.arrEndContainerPos=null;a.posStartOffset=k.nStartRangePos;a.posEndOffset=k.nEndRangePos}}else{d=g_objEditWindow[b].getSelection();if(null==d)return a;if(1==d.rangeCount){var l=d.getRangeAt(0).startContainer,n=d.getRangeAt(0).startOffset,p=d.getRangeAt(0).endContainer,m=d.getRangeAt(0).endOffset;h=this.getNodePosition(l);var q=this.getNodePosition(p);a.arrStartContainerPos=
h;a.arrEndContainerPos=q;a.posStartOffset=n;a.posEndOffset=m;g_objCaretUtil.isComposing()&&(n==m&&g_bBrowserType_CR&&!g_bBrowserType_EDGE?(a.posStartOffset=n+1,a.posEndOffset=m+1):1==Math.abs(n-m)&&g_bBrowserType_IE&&(a.posStartOffset=m,a.posEndOffset=m))}}return a}catch(r){g_objCommonUtil.displayErrorAlert(r,"getUndoRedoSelection")}};this.getContentStack=function(c){try{var b=null;if(null!=g_objTable){b=[];for(var a=0;a<g_objTable.rows.length;a++)for(var d=g_objTableUtil.getTableCellsLength(g_objTable,
a),e=0;e<d;e++){var f=g_objTableUtil.getTableCellElement(g_objTable,a,e);if("1"==f.getAttribute("cusSelYN")){var g=f.getAttribute("cusBGStyleYN"),h=f.getAttribute("cusOriBGColor"),k=f.getAttribute("cusFlag"),l=h;"transparent"==l&&(l="");"1"==g?f.style.backgroundColor=l:"0"==g&&(f.bgColor=l);f.removeAttribute("cusSelYN");f.removeAttribute("cusBGStyleYN");f.removeAttribute("cusOriBGColor");f.removeAttribute("cusFlag");b[b.length]=[a,e,g,h,k]}}}var n=g_objEditorDocument[c].body.innerHTML;if(null!=g_objTable&&
null!=b)for(a=0;a<b.length;a++){var p=b[a][0],m=b[a][1];g=b[a][2];h=b[a][3];k=b[a][4];f=g_objTableUtil.getTableCellElement(g_objTable,p,m);f.setAttribute("cusSelYN","1");fnObjectCheckNull(g)||f.setAttribute("cusBGStyleYN",g);fnObjectCheckNull(h)||f.setAttribute("cusOriBGColor",h);fnObjectCheckNull(k)||f.setAttribute("cusFlag",k);"1"==g?f.style.backgroundColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR:"0"==g&&(f.bgColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR)}return n}catch(q){g_objCommonUtil.displayErrorAlert(q,
"getContentStack")}return""};this.operateUndoRedoStack=function(c,b,a){try{var d=this.arrUndoRedoStruct[a];if(!(null==d||-1>=d.nUndoRedoStackPos)){g_objWrapperOutlineResize.resetExtOutlineInfo();if(c){if(0==d.nUndoRedoStackPos)return;d.nUndoRedoStackPos--;this.assignContentStack(d,a);b&&(d.nUndoRedoStack_LastEventPos=d.nUndoRedoStackPos)}else{if(d.nUndoRedoStack_LastEventPos<=d.nUndoRedoStackPos)return;d.nUndoRedoStackPos++;this.assignContentStack(d,a)}editor_onselectionchange(a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"operateUndoRedoStack")}};this.assignContentStack=function(c,b){try{if(!(0>c.nUndoRedoStackPos)){var a=c.arrUndoRedoStack[c.nUndoRedoStackPos][1],d=getBodyBackgroundColor(b);a.strBackgroundColor!=d&&setBodyBackgroundColor(a.strBackgroundColor,b);var e=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[b].body);a.strBackgroundImageURL!=e&&setBodyBackgroundImage(a.strBackgroundImageURL,b);var f=getBodyBackgroundRepeat(b);a.strBackgroundImageRepeat!=f&&setBodyBackgroundRepeat(a.strBackgroundImageRepeat,
b);g_objEditorDocument[b].body.innerHTML=c.arrUndoRedoStack[c.nUndoRedoStackPos][0];this.restoreSelection(a,b)}}catch(g){window.attachEvent?g_objEditorDocument[b].selection.empty():g_objEditWindow[b].getSelection().removeAllRanges(),g_objCommonUtil.displayErrorAlert(g,"assignContentStack")}};this.restoreSelection=function(c,b){try{if(null==c.arrStartContainerPos){if(!window.attachEvent){var a=g_objEditWindow[b].getSelection();a.removeAllRanges()}}else if(window.attachEvent){a=g_objEditorDocument[b].selection;
var d=this.setNodePosition(c.arrStartContainerPos,g_objEditorDocument[b].body),e=a.createRange();e.moveToElementText(d);e.collapse(!0);e.moveStart("character",c.posStartOffset);e.moveEnd("character",c.posEndOffset-c.posStartOffset);e.select()}else{a=g_objEditWindow[b].getSelection();a.removeAllRanges();e=g_objEditorDocument[b].createRange();var f=this.setNodePosition(c.arrStartContainerPos,g_objEditorDocument[b].body);if(null!=f){var g=this.setNodePosition(c.arrEndContainerPos,g_objEditorDocument[b].body);
null!=g&&(e.setStart(f,c.posStartOffset),e.setEnd(g,c.posEndOffset),a.addRange(e))}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"restoreSelection")}};this.getNodePosition=function(c){try{for(var b=[],a=-1;;){a++;if("body"==c.nodeName.toLowerCase())break;if(0==a&&c.nodeType==ID_SELECTION_TEXT_NODE&&0==c.nodeValue.length)c=g_objNodeUtil.getParentElement(c);else{var d=this.getNodePosition_previousSibling_By_textNode_Check(c);b[b.length]=d;c=g_objNodeUtil.getParentElement(c);if(null==c)return null}}return b}catch(e){g_objCommonUtil.displayErrorAlert(e,
"getNodePosition")}};this.getNodePosition_previousSibling_By_textNode_Check=function(c){try{for(var b=0,a=c.nodeType;null!=c.previousSibling;)if(c=c.previousSibling,a!=c.nodeType||ID_SELECTION_TEXT_NODE!=c.nodeType)b++,a=c.nodeType;return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"getNodePosition_previousSibling_By_textNode_Check")}};this.setNodePosition=function(c,b){try{if(null==c||0==c.length)return b;for(var a=b,d=c.length;0<d;d--){a=a.childNodes[0];if(null==a)return b;for(var e=0;e<c[d-
1];)e++,a=a.nextSibling}return a}catch(f){g_objCommonUtil.displayErrorAlert(f,"setNodePosition")}};this.getSelectionPos_IE=function(c,b,a){try{var d=a.createRange();d.moveToElementText(b);if(!d.inRange(c))return{nStartRangePos:0,nEndRangePos:0};b=!0;""==c.text&&(b=!1);var e=c=0,f=!1,g=a.createRange();g.collapse(!0);g.moveEnd("character",1);var h=a.createRange();h.collapse(!1);h.moveStart("character",-1);var k=a=0;d.collapse(!0);k=d.moveEnd("character",1);e+=k;if(0==k)return{nStartRangePos:0,nEndRangePos:0};
for(;;){if(!f){var l=d.inRange(g),n=g.inRange(d);if(l||n)if(f=!0,!b)return{nStartRangePos:c,nEndRangePos:c}}if(f){l=d.inRange(h);var p=h.inRange(d);if(l||p)break}a=d.moveStart("character",1);f||(c+=a);k=d.moveEnd("character",1);e+=k;if(0==k)break}return{nStartRangePos:c,nEndRangePos:e}}catch(m){g_objCommonUtil.displayErrorAlert(m,"getSelectionPos_IE")}return{nStartRangePos:0,nEndRangePos:0}};this.checkKeyCodeInput=function(c,b){try{var a=this.arrUndoRedoStruct[b];if(null!=a){a.nLastKeyCode==c||c!=
ID_KEYCODE_ENTER&&c!=ID_KEYCODE_SPACE||(a.bKeyCodeContinue=!1);if(a.bKeyCodeContinue){var d=this.getContentStack(b),e=this.getUndoRedoSelection(0,b);a.arrUndoRedoStack[a.nUndoRedoStackPos]=[d,e]}else g_objUndoRedo.getContentStack(b)!=a.arrUndoRedoStack[a.nUndoRedoStackPos][0]&&(g_objUndoRedo.registerUndoRedoContent(0,b,null),a.bKeyCodeContinue=!0);a.nLastKeyCode=c}}catch(f){g_objCommonUtil.displayErrorAlert(f,"checkKeyCodeInput")}};this.setKeyCodeContinue=function(c,b){try{var a=this.arrUndoRedoStruct[b];
null!=a&&(a.bKeyCodeContinue=c)}catch(d){g_objCommonUtil.displayErrorAlert(d,"g_objUndoRedo.setKeyCodeContinue")}}};

var g_strBlankImageName="blank.gif",ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT=1,ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT=2,ID_KEYCODE_NONE=0,ID_KEYCODE_BACKSPACE=8,ID_KEYCODE_TAB=9,ID_KEYCODE_ENTER=13,ID_KEYCODE_SHIFT=16,ID_KEYCODE_CTRL=17,ID_KEYCODE_ALT=18,ID_KEYCODE_CAPSLOCK=20,ID_KEYCODE_ESCAPE=27,ID_KEYCODE_SPACE=32,ID_KEYCODE_PAGE_UP=33,ID_KEYCODE_PAGE_DOWN=34,ID_KEYCODE_END=35,ID_KEYCODE_HOME=36,ID_KEYCODE_ARROW_LEFT=37,ID_KEYCODE_ARROW_TOP=38,ID_KEYCODE_ARROW_RIGHT=39,ID_KEYCODE_ARROW_BOTTOM=40,ID_KEYCODE_A=
65,ID_KEYCODE_B=66,ID_KEYCODE_C=67,ID_KEYCODE_D=68,ID_KEYCODE_E=69,ID_KEYCODE_F=70,ID_KEYCODE_G=71,ID_KEYCODE_H=72,ID_KEYCODE_I=73,ID_KEYCODE_J=74,ID_KEYCODE_K=75,ID_KEYCODE_L=76,ID_KEYCODE_M=77,ID_KEYCODE_N=78,ID_KEYCODE_O=79,ID_KEYCODE_P=80,ID_KEYCODE_Q=81,ID_KEYCODE_R=82,ID_KEYCODE_S=83,ID_KEYCODE_T=84,ID_KEYCODE_U=85,ID_KEYCODE_V=86,ID_KEYCODE_W=87,ID_KEYCODE_X=88,ID_KEYCODE_Y=89,ID_KEYCODE_Z=90,ID_KEYCODE_MAC_COMMAND=91,ID_KEYCODE_LEFT_WINDOW=91,ID_KEYCODE_RIGHT_WINDOW=92,ID_KEYCODE_MENU=93,
ID_KEYCODE_INSERT=45,ID_KEYCODE_DELETE=46,ID_KEYCODE_PLUS=107,ID_KEYCODE_MINUS=109,ID_KEYCODE_F5=116,ID_KEYCODE_F6=117,ID_KEYCODE_F7=118,ID_KEYCODE_F8=119,ID_KEYCODE_F10=121,ID_KEYCODE_NUM_LOCK=144,ID_KEYCODE_5=53,ID_KEYCODE_6=54,ID_KEYCODE_7=55,ID_KEYCODE_8=56,ID_KEYCODE_OPENSQUAREBRACKET=219,ID_KEYCODE_CLOSESQUAREBRACKET=221;
function isArrowKeyCode(a){switch(a){case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_PAGE_UP:case ID_KEYCODE_PAGE_DOWN:case ID_KEYCODE_END:case ID_KEYCODE_HOME:return!0}return!1}
function isModifierKeyCode(a){switch(a){case ID_KEYCODE_SHIFT:case ID_KEYCODE_CTRL:case ID_KEYCODE_ALT:case ID_KEYCODE_MAC_COMMAND:case ID_KEYCODE_LEFT_WINDOW:case ID_KEYCODE_RIGHT_WINDOW:case ID_KEYCODE_CAPSLOCK:case ID_KEYCODE_NUM_LOCK:return!0}return!1}
function fnColorCellApply(a,d){try{var c=!0;"undefined"!=typeof d&&(c=d);if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,a,g_nActiveEditNumber);else if(window.attachEvent){SetActiveEditorArea(g_nActiveEditNumber);var b=g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(b))return null;var e=b.type;e=e.toLowerCase();if(ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==e){var f=b.createRange();if(fnObjectCheckNull(f))return;g_objLetterFn.setLetterOperation(g_nLetterOperationType,
a,f,g_nActiveEditNumber,!0)}}else if(e=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==e)try{b=g_objEditWindow[g_nActiveEditNumber].getSelection(),f=b.getRangeAt(0),g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,f,g_nActiveEditNumber,!0)}catch(g){}tranAllAnchorHrefSharp(g_nActiveEditNumber);!1!==c&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber);editor_onmousedown(null,-1)}catch(g){}}
function checkObjectElemetMouseUp(a,d){try{if(!window.attachEvent){var c=g_objNodeUtil.getEventSrcElement(g_objEditorDocument[d],a);if(!fnObjectCheckNull(c)){var b=g_objNodeUtil.getElementTagName(c).toLowerCase();a=!0;if(dzeUiConfig.bUseLockEditCellFunction){var e=g_objNodeUtil.getLoopParentElement(c,"td");e&&e.contentEditable&&"false"==e.contentEditable.toLowerCase()&&(a=!1)}if("img"==b){setSelectionObjectInfo(!0,b,c);showExtOutline_ObjectElement(c,a,!1,d);var f=g_objEditWindow[d].getSelection();
f.removeAllRanges();var g=g_objEditorDocument[d].createRange();g.selectNode(c);f.addRange(g);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.setTBImageSizeInfo(d);return}if("embed"==b||"object"==b){setSelectionObjectInfo(!0,b,c);(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(c,a,!1,d);return}if("div"==b){if(g_bBrowserType_IE&&!g_objEditorDocument[d].queryCommandEnabled("Bold")){setSelectionObjectInfo(!0,b,c);return}}else{if("iframe"==
b){setSelectionObjectInfo(!0,b,c);(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(c,a,!1,d);return}if("hr"==b){setSelectionObjectInfo(!0,b,c);(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(c,a,!1,d);return}if("input"==b){"checkbox"==c.getAttribute("type").toLowerCase()&&setSelectionObjectInfo(!0,b,c);return}if("select"==b){setSelectionObjectInfo(!0,b,c);return}}}setSelectionObjectInfo(!1,null,null)}}catch(h){}}
function setSelectionObjectElemet(a,d){try{var c=g_objEditWindow[d].getSelection();c.removeAllRanges();var b=g_objEditorDocument[d].createRange();b.selectNode(a);c.addRange(b)}catch(e){}}function showExtOutline_ObjectElement(a,d,c,b){try{g_objWrapperOutlineResize.newExtSelectedInfo(1,a,null,-1,-1,null),g_objWrapperOutlineUtil.showExtOutline(a,!0,d,c,b)}catch(e){}}
function getSelectionElementNode(a){try{if(window.attachEvent)return null;var d=null;if(g_objObjectSelectionInfo.bSelectObject)d=g_objObjectSelectionInfo.objSelectionObject;else{var c=g_objEditWindow[a].getSelection(),b=c.getRangeAt(0).startContainer,e=c.getRangeAt(0).startOffset;d=b.childNodes[e]}return d}catch(f){}return null}var ID_USER_WARNING_MSG_SCRIPT=1,ID_USER_WARNING_MSG_NO_IFRAME=3,ID_USER_WARNING_MSG_NO_SOURCE_EDIT=4;
function fnUserMessage(a){"cut"==a?alert(ID_RES_USER_MSG_STRING_ALERT_CUT):"copy"==a?alert(ID_RES_USER_MSG_STRING_ALERT_COPY):"paste"==a&&alert(ID_RES_USER_MSG_STRING_ALERT_PASTE)}function fnUserWarningMessage(a){ID_USER_WARNING_MSG_SCRIPT==a?alert(ID_RES_USER_MSG_STRING_WARNING_SCRIPT):ID_USER_WARNING_MSG_NO_IFRAME==a?alert(ID_RES_USER_MSG_STRING_WARNING_NO_IFRAME):ID_USER_WARNING_MSG_NO_SOURCE_EDIT==a&&alert(ID_RES_USER_MSG_STRING_WARNING_NO_SOURCE_EDIT)};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");
var g_bBrowserType_IE=!1,g_bBrowserType_FF=!1,g_bBrowserType_WK=!1,g_bBrowserType_CR=!1,g_bBrowserType_OP=!1,g_bBrowserType_EDGE=!1,g_bBrowserVerInfo=0,g_bDocType_XHTML=!1,ID_SELECTION_DUPLICATE=0,ID_SELECTION_ELEMENT_NODE=1,ID_SELECTION_ATTRIBUTE_NODE=2,ID_SELECTION_TEXT_NODE=3,ID_SELECTION_CDATA_SECTION_NODE=4,ID_SELECTION_ENTITY_REFERENCE_NODE=5,ID_SELECTION_ENTITY_NODE=6,ID_SELECTION_PROCESSING_INSTRUCTION_NODE=7,ID_SELECTION_COMMENT_NODE=8,ID_SELECTION_DOCUMENT_NODE=9,ID_SELECTION_DOCUMENT_TYPE_NODE=
10,ID_SELECTION_DOCUMENT_FRAGMENT_NODE=11,ID_SELECTION_NOTATION_NODE=12,ID_EVENT_MOUSE_CLICK_LEFT=-1,ID_EVENT_MOUSE_CLICK_LEFT_STANDARD=0,ID_EVENT_MOUSE_CLICK_RIGHT=2,g_strBrowserLanguage=null,ID_LANGUAGE_TYPE_EN="en",ID_LANGUAGE_TYPE_KO="ko",ID_LANGUAGE_TYPE_JA="ja",ID_LANGUAGE_TYPE_ZH="zh",ID_LANGUAGE_TYPE_ZH_CN="zh-cn",g_objFindTextRange=null,g_nFindTextCount=0,g_strBodyBackgroundColor_Retry=[],g_strBodyBackgroundImage_Retry=[],g_strBodyBackgroundRepeat_Retry=[],ID_CONST_ALIGN_LEFT="left",ID_CONST_ALIGN_CENTER=
"center",ID_CONST_ALIGN_RIGHT="right";g_browserCHK.ie?(g_bBrowserType_IE=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.ff?(g_bBrowserType_FF=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.wk?(g_bBrowserType_WK=!0,g_browserCHK.cr&&(g_bBrowserType_CR=!0),g_browserCHK.edge&&(g_bBrowserType_EDGE=!0)):g_browserCHK.op&&(g_bBrowserType_OP=!0);function fnObjectCheckNull(a){return null==a||ID_STRING_NAME_UNDEFINED==typeof a?!0:!1}
function GetTable_AlignCommand(a){try{var b="";a==g_arrConst[ID_COMMAND_JUSTIFY_LEFT][0]?b=ID_CONST_ALIGN_LEFT:a==g_arrConst[ID_COMMAND_JUSTIFY_CENTER][0]?b=ID_CONST_ALIGN_CENTER:a==g_arrConst[ID_COMMAND_JUSTIFY_RIGHT][0]&&(b=ID_CONST_ALIGN_RIGHT);return b}catch(c){}return""}
function GetControl_AlignCommand(a){try{var b="";a==g_arrConst[ID_COMMAND_JUSTIFY_LEFT][0]?b=ID_CONST_ALIGN_LEFT:a==g_arrConst[ID_COMMAND_JUSTIFY_CENTER][0]?b=ID_CONST_ALIGN_CENTER:a==g_arrConst[ID_COMMAND_JUSTIFY_RIGHT][0]&&(b=ID_CONST_ALIGN_RIGHT);return b}catch(c){}return""}function HTMLEncode(a){a=a.replace(/&/gi,"&amp;");a=a.replace(/</gi,"&lt;");g_bEncodeEndCharacterYN&&(a=a.replace(/>/gi,"&gt;"));return a}
function HTMLDecode(a){g_bEncodeEndCharacterYN&&(a=a.replace(/&gt;/gi,">"));a=a.replace(/&lt;/gi,"<");return a=a.replace(/&amp;/gi,"&")}function TBCancelBubbleEvent(a){try{window.attachEvent?null==event?a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault&&a.preventDefault()):(event.returnValue=!1,event.cancelBubble=!0,event.preventDefault&&event.preventDefault()):null!=a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault())}catch(b){}}
function TBCancelBubbleEvent_iFrameLayer(a){try{window.attachEvent?null!=window.parent.event&&(window.parent.event.returnValue=!1,window.parent.event.cancelBubble=!0):null!=a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault())}catch(b){}}function getDocumentType(){try{g_bDocType_XHTML=!(null==document.compatMode||"CSS1Compat"!=document.compatMode),ID_EVENT_MOUSE_CLICK_LEFT=window.attachEvent?1:0}catch(a){}}
function getSelectionType(){try{if(!window.attachEvent){for(var a=0,b="",c=!0,d=g_objEditWindow[g_nActiveEditNumber].getSelection(),e=d.rangeCount,f=0;f<e;f++){var g=d.getRangeAt(f).startContainer;if(c)c=!1,a=g.nodeType,b=g.nodeName;else if(a!=g.nodeType&&b!=g.nodeName)return{nodeType:ID_SELECTION_DUPLICATE,nodeName:"",length:e}}1==e&&g_objObjectSelectionInfo.bSelectObject&&(a=ID_SELECTION_ELEMENT_NODE,b=g_objObjectSelectionInfo.strNodeName);return{nodeType:a,nodeName:b,length:e}}}catch(h){}}
function getSelectionTypeForUpdateUI(){try{if(window.attachEvent)return;var a=ID_STRING_NAME_NONE,b=getSelectionType();if(ID_SELECTION_ELEMENT_NODE==b.nodeType){if(g_objObjectSelectionInfo.bSelectObject)return ID_STRING_NAME_CONTROL}else ID_SELECTION_TEXT_NODE==b.nodeType&&(a=ID_STRING_NAME_TEXT);return a}catch(c){}return ID_STRING_NAME_NONE}
function getSelectionTextValue(a){var b="";try{if(window.attachEvent)ID_STRING_NAME_TEXT==g_objEditorDocument[a].selection.type.toLowerCase()&&(b=g_objEditorDocument[a].selection.createRange().text);else{var c=g_objEditWindow[a].getSelection().getRangeAt(0);c.startContainer.nodeType==ID_SELECTION_TEXT_NODE&&(b=c.toString())}return b}catch(d){}return""}
function getSelectionElement(a,b,c){try{if(window.addEventListener){var d=g_objEditWindow[c].getSelection(),e=d.getRangeAt(0);c=null;for(var f=e.startContainer;f;){if(a==f.nodeName.toUpperCase()){c=f;break}f=f.parentNode}if(!c)return null;b&&(g_bBrowserType_FF?e.selectNode(c):(g_bBrowserType_IE||g_bBrowserType_WK||g_bBrowserType_OP)&&d.selectAllChildren(c));return c}}catch(g){}return null}
function insertHTMLCodeAtSelection(a,b,c){try{if(window.attachEvent){var d=g_objEditorDocument[c].selection.createRange();fnObjectCheckNull(d)||d.pasteHTML(a)}else{var e=g_objEditWindow[c].getSelection(),f=g_objEditorDocument[c].createRange();d=null;if(null!=a){var g=g_objEditorDocument[c].createElement("div"),h=g_objEditorDocument[c].createElement("div");h.innerHTML=a;insertHTMLCodeAtSelection_SubDetail(g,c);for(var k=g.parentNode;0!=h.childNodes.length;)d=k.insertBefore(h.childNodes[0],g);k.removeChild(g)}else{if(null==
b)return;insertHTMLCodeAtSelection_SubDetail(b,c);d=b}f.setStartAfter(d);f.setEndAfter(d);"hr"!=d.nodeName.toLowerCase()&&e.addRange(f)}}catch(l){}}
function insertHTMLCodeAtSelection_SubDetail(a,b){try{if(!window.attachEvent){var c=g_objEditWindow[b].getSelection(),d=c.getRangeAt(0);c.removeAllRanges();d.deleteContents();var e=g_objEditorDocument[b].getElementById("select_custom_inputbox");if(!1===fnObjectCheckNull(e)){d=g_objEditorDocument[b].createRange();c.removeAllRanges();d.setStartBefore(e);d.collapse(!0);c.addRange(d);var f=e.nextSibling;if(!1===fnObjectCheckNull(f)&&"input"===f.nodeName.toLowerCase()&&"text"===f.type.toLowerCase()&&!0===
g_objPropertyUtil.element_hasClass(f,"external_inputbox_area")){var g=g_objNodeUtil.getParentElement(f);!1===fnObjectCheckNull(g)&&g.removeChild(f);g_objCaretUtil.restoreCaret(b,"select_custom_inputbox")}}var h=d.startContainer,k=d.startOffset;if(h.nodeType==ID_SELECTION_TEXT_NODE){c=h;var l=c.parentNode,m=c.nodeValue;if(g_bBrowserType_OP)for(;;)if(ID_SELECTION_TEXT_NODE==l.nodeType)c=l,l=l.parentNode,m=c.nodeValue;else break;var q=m.substr(0,k),n=m.substr(k),r=g_objEditorDocument[b].createTextNode(q),
p=g_objEditorDocument[b].createTextNode(n);l.insertBefore(p,c);if(null==a){var t=g_objEditorDocument[b].createTextNode("&nbsp;");l.insertBefore(t,p);l.insertBefore(r,t)}else l.insertBefore(a,p),l.insertBefore(r,a);l.removeChild(c)}else p=h.childNodes[k],fnObjectCheckNull(p)?"br"==g_objNodeUtil.getElementTagName(h).toLowerCase()?(l=g_objNodeUtil.getParentElement(h),l.insertBefore(a,h)):h.appendChild(a):h.insertBefore(a,p)}}catch(u){}}
function fnReturnFalsePropagation(a){try{if(window.attachEvent)return!1;TBCancelBubbleEvent(a);a.stopPropagation()}catch(b){}}
function doCommonRestoreEditWinFF(a){try{g_bBrowserType_FF&&(g_objEditContainer[a].style.visibility="hidden",g_objEditContainer[a].style.display="none",0!=g_nFormEditMode&&1!=g_nFormEditMode||setEditModeConversion_FF(a,!1),g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",g_objEditSourceContainer[a].style.height="",g_objEditSourceContainer[a].style.visibility="visible",
g_objEditSourceContainer[a].style.display="",g_objEditObjectSource[a].focus(),g_objEditContainer[a].style.visibility="visible",g_objEditContainer[a].style.display="",0!=g_nFormEditMode&&1!=g_nFormEditMode||setEditModeConversion_FF(a,!0),g_objEditSourceContainer[a].style.position="absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility=
"hidden")}catch(b){}}function setRestoreEditWinFF(a){try{g_bBrowserType_FF&&(doCommonRestoreEditWinFF(a),window.setTimeout("setEditModeFocus("+a+")",100))}catch(b){}}function setInitRestoreEditWinFF(a){}function setStop_DefaultDocumentEditOption_FF(a){try{g_bBrowserType_FF&&(g_objEditorDocument[a].body.spellcheck=!1,g_objEditorDocument[a].execCommand("enableInlineTableEditing",!1,!1))}catch(b){}}
function getSelectionControl(a){try{var b=null,c=null;if(window.attachEvent){var d=g_objEditorDocument[a].selection.createRange();c=d.length;1==c&&(b=9<=g_bBrowserVerInfo?d.item(0):d(0))}else{var e=g_objEditWindow[a].getSelection();c=e.rangeCount;if(1==c)if(g_objObjectSelectionInfo.bSelectObject)b=g_objObjectSelectionInfo.objSelectionObject;else{var f=e.getRangeAt(0).startContainer,g=e.getRangeAt(0).startOffset;b=f.childNodes[g]}}return{rangeLength:c,controlObject:b}}catch(h){}return{rangeLength:0,
controlObject:null}}function getObjNodeType(a,b){try{if(fnObjectCheckNull(a))return DZE_TAG_NONE;var c=g_objNodeUtil.getCheckElementTagName(a);a=DZE_TAG_NONE;"img"==c?a=DZE_TAG_IMG:"table"==c?a=DZE_TAG_TABLE:"tr"==c?a=DZE_TAG_TR:"td"==c?a=DZE_TAG_TD:"text"==c&&(a=DZE_TAG_TEXT);return a}catch(d){}return{rangeLength:0,controlObject:null}}function getBodyBackgroundColor(a){try{return g_objEditorDocument[a].body.style.backgroundColor}catch(b){}}
function setBodyBackgroundColor(a,b){try{g_objEditorDocument[b].body.style.backgroundColor=""!=a?a:""}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundColor_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundColor("+b+")",500))}}function retry_setBodyBackgroundColor(a){try{var b=g_strBodyBackgroundColor_Retry[a];g_objEditorDocument[a].body.style.backgroundColor=""!=b?b:""}catch(c){}}
function setBodyBackgroundImage(a,b){try{"none"==a.toLowerCase()?g_objEditorDocument[b].body.style.backgroundImage=a:g_objEditorDocument[b].body.style.backgroundImage="url("+a+")"}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundImage_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundImage("+b+")",500))}}
function retry_setBodyBackgroundImage(a){try{var b=g_strBodyBackgroundImage_Retry[a];"none"==b.toLowerCase()?g_objEditorDocument[a].body.style.backgroundImage=b:g_objEditorDocument[a].body.style.backgroundImage="url("+b+")"}catch(c){}}function getBodyBackgroundRepeat(a){try{return g_objEditorDocument[a].body.style.backgroundRepeat}catch(b){}}
function setBodyBackgroundRepeat(a,b){try{g_objEditorDocument[b].body.style.backgroundRepeat=a}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundRepeat_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundRepeat("+b+")",500))}}function retry_setBodyBackgroundRepeat(a){try{g_objEditorDocument[a].body.style.backgroundRepeat=g_strBodyBackgroundRepeat_Retry[a]}catch(b){}}
function addHTMLCode(a,b){try{if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&g_objInsertUtil.insertTableCodeAtSelection(a,b);else{var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||g_objInsertUtil.insertTableCodeAtSelection(a,b)}}catch(d){}}
function getEditorHTMLCode(a,b){try{g_bSourceAreaIframeAllowYN&&(g_bEditMode[b]||syncEditorHTMLCodeFromSouceTab(b));g_objTagUtil.updateTagAttribute(b);var c=parseInt(b,10)+DZE_IFRAME_TMP_NO,d="",e=!1;g_objTable&&(""==g_objTable.id?g_objTable.id="dze_temp_tb_"+c:e=!0,d=g_objTable.id);g_objEditorDocument[c].body.innerHTML=g_objEditorDocument[b].body.innerHTML;if(g_objTable){e||g_objTable.getAttribute("id")&&g_objTable.removeAttribute("id");var f=g_objEditorDocument[c].getElementById(d);g_objTableFlag.removeFlagInfo(f);
e||f.removeAttribute("id")}g_objEditMode.showAllWriteAreaSet(c,!1);g_objEditMode.showAllContentEditableArea(c,!1);g_objEditMode.showBGImageForLockedCell(!1,c);g_bAnchorTargetBlankYN&&setAnchorTargetBlank(c);g_bContentPTagStyleApply&&g_objAdjustDoc.setParaInlineStyle(c,g_objEditorDocument[c].body);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(c);g_objAdjustDoc.adjustRemoveGarbageText(c);g_objAdjustDoc.adjustGarbageEmptyTag(c,!1);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(c);g_objAdjustDoc.remove_Br_Node_Inside_P_Node(c);
g_objLetterFn.removeAllDuplicateStyleByLetterOperation(g_objEditorDocument[c].body,c);g_objEditMode.restoreFormCodeString(c);b="";if(a){var g=getHTMLContentCodeByXHTMLFormat(c);b=HTMLEncode(g)}else b=getHTMLContentCodeByXHTMLFormat(c);b=removeZeroWidthSpace(b);!0===dzeUiConfig.bRemoveXSS&&(b=removeXSS(b));return b}catch(h){}return""}function getEditorHTMLCodeFromId(a,b){b=getnEditNumberFromEditId(b);return null==b?"":getEditorHTMLCode(a,b)}
function syncEditorHTMLCodeFromSouceTab(a){try{var b=g_objEditorDocument[a].body.innerHTML,c=g_objEditObjectSource[a].value;c.toLowerCase();var d=!0;if(!g_bSourceAreaScriptAllowYN){var e=c.indexOf("<script",0);-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT))}g_bSourceAreaIframeAllowYN||(e=c.indexOf("<iframe>",0),-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME)));d&&(g_objEditorDocument[a].body.innerHTML=
g_objEditObjectSource[a].value);if(g_bBrowserType_IE){!g_bSourceAreaScriptAllowYN&&3!=g_nFormEditMode&&0<g_objEditorDocument[a].scripts.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b);if(!g_bSourceAreaIframeAllowYN){var f=g_objEditorDocument[a].getElementsByTagName("iframe");0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)}g_objEditWindow[a].focus();g_objTagUtil.force_formTagSwitch(a)}else if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].getElementsByTagName("script").length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(f=g_objEditorDocument[a].getElementsByTagName("iframe"),0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_bBrowserType_FF?3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[a].body,a):g_bBrowserType_WK&&
3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[a].body,a);tranAllAnchorHrefSharp(a);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);g_objUndoRedo.registerInitialContentStack(a)}catch(g){}}function checkImgSrcPropertyValueAndForceRemove(a){try{var b=g_objEditorDocument[a].getElementsByTagName("img");for(a=0;a<b.length;a++)validateImgSrcPropertyValue(b[a].src)&&(b[a].src="")}catch(c){}}
function validateImgSrcPropertyValue(a){try{var b=a.toLowerCase();a=!1;var c=-1,d=b.length;c=b.indexOf(".jpg");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".gif");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".png");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".bmp");if(-1!=c){if(d!=c+4)return!0;a=!0}if(!a)return!0;for(d=0;d<g_arrCheckImgSrcPropertyValue.length;d++)if(-1!=b.indexOf(g_arrCheckImgSrcPropertyValue[d]))return!0;return!1}catch(e){}return!0}
function setEditorHTMLCode(a,b,c){try{g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a,3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[c].body,c)}catch(f){g_bLoadContentHTMLCode=!1;g_nLoadContentEditNumber[g_nLoadContentEditNumber.length]=c;g_bLoadContentEncode[g_bLoadContentEncode.length]=b;g_strLoadContentHTMLCode[g_strLoadContentHTMLCode.length]=a;return}try{tranAllAnchorHrefSharp(c);if(1==dzeUiConfig.bUseDisableCell)try{0<dzeUiConfig.arrApplyStringToDisableCell.length&&g_objEditMode.initApplyStringToDisableCell(dzeUiConfig.arrApplyStringToDisableCell,
c)}catch(f){}g_objEditMode.showAllWriteAreaSet(c,!0);g_objEditMode.showAllDisableCellSet(c,!0);g_objEditMode.showBGImageForLockedCell(!0,c);!0===g_bBrowserType_FF&&g_objEditMode.setInputFormClickable(c);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(c);g_objAdjustDoc.changeTableAlignToMarginStyle(c);2==g_nFormEditMode?g_objEditMode.initShowEditableArea(c):g_objUndoRedo.registerInitialContentStack(c);g_objEditMode.setZeroSpaceCodeToEmptyTd(c);g_objEditMode.convertFormCodeString(c,!1);g_bBrowserType_IE&&
(checkResetSpanContainsP(c,0),g_objTagUtil.force_formTagSwitch(c));if(dzeUiConfig.bLimitTableWidthSize){var d=g_objEditorDocument[c].body.getElementsByTagName("table"),e=g_objTableUtil.hasOverSizedTable(d);null!=e&&setTimeout(function(){alert(ID_RES_DIALOG_ALERT_MAX_VALUE+e)},0)}}catch(f){}}function setEditorHTMLCodeFromId(a,b,c){c=getnEditNumberFromEditId(c);return null==c?"":setEditorHTMLCode(a,b,c)}
function retrySetEditorHTMLCode(a,b,c){try{g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a;3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[c].body,c),g_bBrowserType_IE&&""==a.trim()&&(g_objEditorDocument[c].body.innerHTML=window.attachEvent?"<p></p>":"<p><br/></p>"));tranAllAnchorHrefSharp(c);if(1==dzeUiConfig.bUseDisableCell)try{0<dzeUiConfig.arrApplyStringToDisableCell.length&&g_objEditMode.initApplyStringToDisableCell(dzeUiConfig.arrApplyStringToDisableCell,c)}catch(d){}g_objEditMode.showAllWriteAreaSet(c,
!0);g_objEditMode.showAllDisableCellSet(c,!0);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(c);g_objAdjustDoc.changeTableAlignToMarginStyle(c);2==g_nFormEditMode?g_objEditMode.initShowEditableArea(c):g_objUndoRedo.registerInitialContentStack(c);g_objEditMode.setZeroSpaceCodeToEmptyTd(c);g_objEditMode.convertFormCodeString(c,!1);g_bBrowserType_IE&&(checkResetSpanContainsP(c,0),g_objTagUtil.force_formTagSwitch(c))}catch(d){}}
function tranAllAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<c.length;a++){var d=c[a].href;d=d.toLowerCase();if(0==d.indexOf(b))if(b==d)c[a].href="#";else{var e=c[a].href,f=e.substring(b.length-1,e.length);c[a].href=f}}}catch(g){}}
function checkAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=a.toLowerCase();if(0==c.indexOf(b))return b==c?"#":a.substring(b.length-1,a.length)}catch(d){}return null}function SetActiveEditorArea(a){g_objEditorDocument[a].body.setActive()}
function insertHTMLContent(a,b){try{if(window.attachEvent)g_objEditWindow[b].focus(),ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&insertHTMLCodeAtSelection(a,null,b);else{g_objEditorDocument[b].body.focus();var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,null,b)}}catch(d){}}
function addHTMLContent(a,b,c,d){try{if(0==c)if(window.attachEvent)if(null!=g_objLastRange[d]){if(""==g_objLastRange[d].htmlText)if(g_bActivate[d]){var e=g_objEditorDocument[d].selection.createRange();fnObjectCheckNull(e)||(g_strBookmark_IE=e.getBookmark(),insertHTMLCodeAtSelection(a,null,d))}else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);g_objLastRange[d]=null}else if(g_bActivate[d])e=g_objEditorDocument[d].selection.createRange(),
fnObjectCheckNull(e)||(g_strBookmark_IE=e.getBookmark(),insertHTMLCodeAtSelection(a,null,d));else{var f=g_objEditorDocument[d].body.innerHTML+a;g_objEditorDocument[d].body.innerHTML=f}else{if(g_bBrowserType_IE&&null!=g_objLastRange[d]){var g=g_objEditWindow[d].getSelection();g.removeAllRanges();g.addRange(g_objLastRange[d])}var h=getSelectionType();h.nodeType!=ID_SELECTION_ELEMENT_NODE&&h.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,b,d)}else 1==c?(f="",f=a+g_objEditorDocument[d].body.innerHTML,
g_objEditorDocument[d].body.innerHTML=f):2==c&&(f="",f=g_objEditorDocument[d].body.innerHTML+a,g_objEditorDocument[d].body.innerHTML=f);g_objEditMode.setZeroSpaceCodeToEmptyTd(d);g_objEditMode.convertFormCodeString(d,!0)}catch(k){}}function replaceHTMLContent(a,b){try{g_objEditorDocument[b].body.innerHTML=a}catch(c){}}function getEditorText(a){try{return g_objPropertyUtil.getTextContent(g_objEditorDocument[a].body)}catch(b){}return""}
function setEditModeConversion_FF(a,b){try{!g_bBrowserType_FF||0!=g_nFormEditMode&&1!=g_nFormEditMode||(g_objEditorDocument[a].body.contentEditable=b)}catch(c){}}
function getEditorSelectionText(a){try{var b="";if(window.attachEvent){var c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return"";var d=c.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=c.createRange();if(fnObjectCheckNull(e))return"";b=e.text}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d)c=g_objEditWindow[g_nActiveEditNumber].getSelection(),b=c.getRangeAt(0).toString();return b}catch(f){}return""}
function findCountEditorText(a,b){try{if(""==b)return;var c=!0,d=0,e=fnGetEditorDocument(a);if(g_bBrowserType_IE)for(var f=e.body.createTextRange();c;){if(c=f.findText(b))d++,f.collapse(!1)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a),h=e.body.scrollLeft,k=e.body.scrollTop,l=g.getSelection();for(l.removeAllRanges();c;)(c=g.find(b))&&d++;l=g.getSelection();l.removeAllRanges();g.scrollTo(h,k)}return d}catch(m){}return 0}
function findEditorText(a,b){try{if(""==b)return 0;var c=-1;if(g_bBrowserType_IE){var d=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=d.body.createTextRange());var e=g_objFindTextRange.findText(b);e?(c=1,g_nFindTextCount++,g_objFindTextRange.select(),g_objFindTextRange.collapse(!1)):(c=0==g_nFindTextCount?2:3,g_nFindTextCount=0,g_objFindTextRange=d.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var f=fnGetEditorWindow(a);(e=f.find(b))?
c=1:(c=3,f.getSelection().removeAllRanges())}return c}catch(g){}return-1}
function findEditorTextDetail(a,b,c,d,e,f){try{if(""==b)return 0;f=-1;if(g_bBrowserType_IE){var g=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=g.body.createTextRange());a=0;var h=1E5;1==c&&(a+=1,h=-1E5);1==e&&(a+=2);1==d&&(a+=4);var k=0<a?g_objFindTextRange.findText(b,h,a):g_objFindTextRange.findText(b,h);k?(f=1,g_nFindTextCount++,g_objFindTextRange.select(),0==c?g_objFindTextRange.collapse(!1):g_objFindTextRange.collapse(!0)):(f=0==g_nFindTextCount?2:3,g_nFindTextCount=0,
g_objFindTextRange=g.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)h=fnGetEditorWindow(a),(k=h.find(b,d,c,!1,e))?f=1:(f=3,h.getSelection().removeAllRanges());return f}catch(l){}return-1}
function replaceTextCommon(a,b,c){try{var d=a.getRangeAt(0);a.removeAllRanges();d.deleteContents();var e=d.startContainer,f=d.startOffset;d=b.createRange();if(3==e.nodeType)e.insertData(f,c),d.setEnd(e,f+c.length),d.setStart(e,f+c.length);else{var g=e.childNodes[f],h=b.createTextNode(c);e.insertBefore(h,g);d.setEnd(g,0);d.setStart(g,0)}a.addRange(d);return!0}catch(k){}return!1}
function replaceEditorText(a,b,c){try{if(""==b)return 0;var d=-1;if(g_bBrowserType_IE){var e=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=e.body.createTextRange());var f=g_objFindTextRange.findText(b);f?(d=1,g_objFindTextRange.select(),g_objFindTextRange.text=c,g_objFindTextRange.findText(c,-c.length,1),g_objFindTextRange.select()):(d=3,g_objFindTextRange=e.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a);if(f=
g.find(b)){d=1;var h=g.getSelection();if(1!=h.rangeCount)return-1;e=fnGetEditorDocument(a);if(!replaceTextCommon(h,e,c))return-1;g.find(c,!1,!0)}else d=3,h=g.getSelection(),h.removeAllRanges()}return d}catch(k){}return-1}
function replaceEditorTextDetail(a,b,c,d,e,f,g){try{if(""==b)return 0;g_objCommonUtil.log("strFindText: "+b);g_objCommonUtil.log("strReplaceText: "+c);g_objCommonUtil.log("direction: "+d);g_objCommonUtil.log("casesensitive: "+e);g_objCommonUtil.log("completeword: "+f);g_objCommonUtil.log("ignorespace: "+g);g=-1;if(g_bBrowserType_IE){var h=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=h.body.createTextRange());var k=0,l=1E5;1==d&&(k+=1,l=-1E5);1==f&&(k+=2);1==e&&(k+=4);var m=
0<k?g_objFindTextRange.findText(b,l,k):g_objFindTextRange.findText(b,l);m?(g=1,g_objFindTextRange.select(),g_objEditMode.checkSelectionContentEditable(a)?(g_objFindTextRange.text=c,g_objFindTextRange.findText(c,-c.length,1),g_objFindTextRange.select()):g=4,0==d?g_objFindTextRange.collapse(!1):g_objFindTextRange.collapse(!0)):(g=3,g_objFindTextRange=h.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)if(k=fnGetEditorWindow(a),m=k.find(b,e,d,!1,f)){g=1;l=k.getSelection();
if(1!=l.rangeCount)return-1;h=fnGetEditorDocument(a);if(!g_objEditMode.checkSelectionContentEditable(a))return 4;if(!replaceTextCommon(l,h,c))return-1;k.find(c,!1,!0)}else g=3,l=k.getSelection(),l.removeAllRanges();return g}catch(q){}return-1}
function replaceAllEditorText(a,b,c,d,e,f,g){try{if(""==b)return-1;g=0;if(g_bBrowserType_IE){var h=fnGetEditorDocument(a),k=h.body.createTextRange();h=0;var l=1E5;1==d&&(h+=1,l=-1E5);1==f&&(h+=2);1==e&&(h+=4);for(var m=!0;m;)if(m=0<h?k.findText(b,l,h):k.findText(b,l))k.select(),g_objEditMode.checkSelectionContentEditable(a)&&(k.text=c,g++),0==d?k.collapse(!1):k.collapse(!0)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){l=fnGetEditorWindow(a);l.getSelection().removeAllRanges();for(m=
!0;m;)if(m=l.find(b,e,d,!1,f)){var q=l.getSelection();if(1!=q.rangeCount)return-1;h=fnGetEditorDocument(a);if(g_objEditMode.checkSelectionContentEditable(a)){if(!replaceTextCommon(q,h,c))return-1;g++}}l.getSelection().removeAllRanges()}return g}catch(n){}return-1}
function resizeEditor(a,b,c){try{g_arrEditorWidth[a]=b,g_arrEditorHeight[a]=c,g_nEditAreaSetHeight=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight,g_objEditSetContainer[a].style.width=g_arrEditorWidth[a]+"px",g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px",g_objMainEditAreaContainer[a].style.height=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight+"px",g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_arrEditorHeight[a]-
g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-22+"px"),document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px"}catch(d){}}
function resizeEditor_Height(a,b){try{200>b&&(b=200);"undefined"==typeof b?b=document.documentElement.clientHeight:dzeEnvConfig.iFrameLayer&&g_bEditorHeightIFrameYN&&("100%"!=window.frameElement.getAttribute("height")&&(window.frameElement.style.height=b+"px"),window.frameElement.parentNode.style.height=b+"px",b=document.documentElement.clientHeight);g_nTabBarSetHeight=0;if(g_bTabBar_Display){var c=document.getElementById("TB_TABMODE_TR_CONTAINER_"+a);null!=c&&(g_nTabBarSetHeight=c.offsetHeight)}g_nToolbarSetHeight=
0;var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(g_nToolbarSetHeight=d.offsetHeight);g_arrEditorHeight[a]=b;g_nEditAreaSetHeight=b-g_nToolbarSetHeight-g_nTabBarSetHeight;if(!(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display)){var e=document.getElementById("dzeditor_Parent_"+a),f=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,"border-top-width",a).replace(/px/,""),10)+parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,
"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=f}else if(!g_bTabBar_Display){var g=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a),h=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(g,"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=h}isShowedRulerBar()&&dze_rulerbar_mgr.updateGuideLineHeight(g_nEditAreaSetHeight);g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px";g_objEditSetContainer[a].setAttribute("height",g_arrEditorHeight[a]);
document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).style.height=g_nEditAreaSetHeight+"px";document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).setAttribute("height",g_nEditAreaSetHeight);document.getElementById("dzeditor_Parent_"+a).style.height=g_nEditAreaSetHeight-1+"px";document.getElementById("dzeditor_"+a).style.height=g_nEditAreaSetHeight-2+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px";document.getElementById("TB_CONTAINER_"+
a).parentNode.setAttribute("height",document.getElementById("TB_CONTAINER_"+a).offsetHeight);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_nEditAreaSetHeight-22+"px")}catch(k){g_objCommonUtil.displayErrorAlert(k,"e:resizeEditor_Height")}}function setAnchorTargetBlank(a){try{var b=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<b.length;a++)b[a].target="_blank"}catch(c){}}
function getImageList(a){try{var b=[],c=g_objEditorDocument[a].getElementsByTagName("IMG");for(a=0;a<c.length;a++)b[a]=getImageSrcValue(c[a].src);return b}catch(d){}}
function getImageSrcValue(a){try{var b=document.location.href;if(g_bBrowserType_IE){var c=b.lastIndexOf("/");if(b.substring(0,c+1)==a)return""}else if(b==a)return"";if(null!=g_arrImgSrcRemoveDomain){var d=a.toLowerCase();for(b=0;b<g_arrImgSrcRemoveDomain.length;b++)if(0==d.indexOf(g_arrImgSrcRemoveDomain[b])){var e=d.length,f=g_arrImgSrcRemoveDomain[b].length;if(f<=e&&"/"==d.charAt(f))return a.substring(f,e)}}return a}catch(g){}}
function setContentPTagStyleApply(a,b,c){try{b=b||g_objEditorDocument[a];c=c||!1;for(var d=null,e=function(b,e){var f=g_objNodeUtil;if(c&&f.checkTagName(b.parentNode,"td")){var g=b.parentNode;switch(e){case "font-family":if(g=g.style.fontFamily)return g;break;case "font-size":if(g=g.style.fontSize)return g;break;case "color":if(g=g.style.color)return g;break;case "line-height":if(g=g.style.lineHeight)return g;break;case "letter-spacing":if(g=g.style.letterSpacing)return g}}if(c&&!f.checkTagName(b.parentNode,
"body")&&(b=(d=d||g_objEditWindow[a].getComputedStyle(b,null))?d.getPropertyValue(e):""))return b;switch(e){case "font-family":return g_strBodyFontFamily;case "font-size":return g_strBodyFontSize;case "color":return g_strBodyFontColor;case "line-height":return g_strBodyLineHeight;case "letter-spacing":return g_strBodyLetterSpacing}},f=b.getElementsByTagName("P"),g=0;g<f.length;g++){var h=f[g];d=null;var k=f[g].style.marginTop;if(""==k||null==k)f[g].style.marginTop=g_strPTagMarginTop;var l=f[g].style.marginBottom;
if(""==l||null==l)f[g].style.marginBottom=g_strPTagMarginBottom;var m=h.style.fontFamily;if(""==m||null==m)h.style.fontFamily=e(h,"font-family");var q=h.style.fontSize;if(""==q||null==q)h.style.fontSize=e(h,"font-size");var n=h.style.color;if(""==n||null==n)h.style.color=e(h,"color");var r=h.style.lineHeight;if(""==r||null==r)h.style.lineHeight=e(h,"line-height");var p=h.style.letterSpacing;if(""==p||null==p)h.style.letterSpacing=e(h,"letter-spacing")}var t=b.getElementsByTagName("BLOCKQUOTE");for(g=
0;g<t.length;g++){k=t[g].style.marginTop;if(""==k||null==k)t[g].style.marginTop=g_strPTagMarginTop;l=t[g].style.marginBottom;if(""==l||null==l)t[g].style.marginBottom=g_strPTagMarginBottom;m=t[g].style.fontFamily;if(""==m||null==m)t[g].style.fontFamily=g_strBodyFontFamily;q=t[g].style.fontSize;if(""==q||null==q)t[g].style.fontSize=g_strBodyFontSize;n=t[g].style.color;if(""==n||null==n)t[g].style.color=g_strBodyFontColor;r=t[g].style.lineHeight;if(""==r||null==r)t[g].style.lineHeight=g_strBodyLineHeight;
p=t[g].style.letterSpacing;if(""==p||null==p)t[g].style.letterSpacing=g_strBodyLetterSpacing}var u=b.getElementsByTagName("td");for(g=0;g<u.length;g++){m=u[g].style.fontFamily;if(""==m||null==m)u[g].style.fontFamily=g_strBodyFontFamily;q=u[g].style.fontSize;if(""==q||null==q)u[g].style.fontSize=g_strBodyFontSize;n=u[g].style.color;if(""==n||null==n)u[g].style.color=g_strBodyFontColor;r=u[g].style.lineHeight;if(""==r||null==r)u[g].style.lineHeight=g_strBodyLineHeight;p=u[g].style.letterSpacing;if(""==
p||null==p)u[g].style.letterSpacing=g_strBodyLetterSpacing}}catch(v){g_objCommonUtil.displayErrorAlert(v,"htmlutil2.js setContentPTagStyleApply")}}function getHTMLContentCodeByXHTMLFormat(a){try{return g_bContentXHTMLFormatYN?g_objCodeParser.convertXHTMLCode(g_objEditorDocument[a].body.innerHTML):g_objEditorDocument[a].body.innerHTML}catch(b){}}function setContentXHTMLFormat(a,b){try{g_bContentXHTMLFormatYN=a,g_bContentXHTMLTabSettingYN=b}catch(c){}}
function setIFrameSrcBlankForTabMode(a){try{var b=g_objEditorDocument[a].getElementsByTagName("iframe");for(a=0;a<b.length;a++)b[a].src="about:blank"}catch(c){}}
function checkSetIFrameSrcBlankForDelete(a){try{if(!window.addEventListener){var b=g_objEditorDocument[a].getElementsByTagName("iframe");if(0!=b.length){for(var c=[],d=[],e=(new Date).getTime(),f=0;f<b.length;f++)if(null==b[f].id||""==b[f].id){var g="i_"+e+"_"+f;c[f]=g;b[f].id=g;d[f]=!1}else c[f]=b[f].id.toLowerCase(),d[f]=!0;var h=g_objEditorDocument[a].selection.createRange().htmlText.toLowerCase();for(f=0;f<c.length;f++)-1!=h.indexOf(c[f])?b[f].src="about:blank":d[f]||(b[f].id="")}}}catch(k){}}
function checkResetSpanContainsP(a,b){try{setTimeout(function(){for(var b=g_objEditorDocument[a].getElementsByTagName("span"),d=0;d<b.length;d++)if(0<b[d].getElementsByTagName("p").length){for(var e=null,f=b[d].childNodes,g=0;g<f.length;g++)f[g].outerHTML&&(e=null==e?f[g].outerHTML:e.concat(f[g].outerHTML));b[d].outerHTML=e;b=g_objEditorDocument[a].getElementsByTagName("span");d--}},b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"checkResetSpanContainsP error")}}
function removeChildNode_AllWhiteCode(a){try{if(!g_objNodeUtil.checkTagName(a,"span")||""==a.className&&""==a.style.whiteSpace)for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];ID_SELECTION_ELEMENT_NODE==c.nodeType?removeChildNode_AllWhiteCode(c):ID_SELECTION_TEXT_NODE==c.nodeType&&checkTextNodeAllWhiteCode(c.nodeValue)&&(a.removeChild(c),b--)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"htmlutil2.removeChildNode_AllWhiteCode")}}
function checkTextNodeAllWhiteCode(a){try{for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(9!=c&&10!=c&&13!=c)return!1}return!0}catch(d){}return!1}function checkTextNodeAllWhiteCode_Plus_Space(a){try{for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(9!=c&&10!=c&&13!=c&&32!=c)return!1}return!0}catch(d){}return!1}
function checkTextNodeValue(a){try{if(!a||0==a.length)return null;for(var b={bEveryWhiteSpace:!0,bSomeZeroWidthSpace:!1},c=0,d=a.length;c<d;c++)switch(a.charCodeAt(c)){case 9:case 10:case 13:case 32:break;case 8203:case 8204:case 8205:case 65279:b.bSomeZeroWidthSpace=!0;break;default:b.bEveryWhiteSpace=!1}return b}catch(e){return g_objCommonUtil.displayErrorAlert(e,"htmlutil2.js checkTextNodeValue"),null}}
var DZE_UPLOAD_EVENT={uploaded_file_list:[],initUploadedFileList:function(a){"undefined"==typeof this.uploaded_file_list[a]&&(this.uploaded_file_list[a]=[])},addUploadedFileList:function(a,b){this.initUploadedFileList(a);this.uploaded_file_list[a].push(b)},removeUploadedFileList:function(a,b){this.initUploadedFileList(a);for(var c=[],d=0;d<this.uploaded_file_list[a].length;d++)b!=this.uploaded_file_list[a][d].url&&c.push(this.uploaded_file_list[a][d]);this.uploaded_file_list[a]=c},getUploadedFileList:function(a){this.initUploadedFileList(a);
return this.uploaded_file_list[a]},emptyUploadedFileList:function(a){this.initUploadedFileList(a);this.uploaded_file_list[a]=[]},setComplete:function(a,b){try{g_objCommonUtil.log(" DZE_UPLOAD_EVENT. onComplete ========================== ");g_objCommonUtil.log("nEditNumber:"+a);this.initUploadedFileList(a);var c={type:b.type,filename:b.filename,url:b.url};this.addUploadedFileList(a,c);this.onComplete(a,c)}catch(d){g_objCommonUtil.displayErrorAlert(d,"setComplete error")}},onComplete:function(a,b){},
pasteInsertImageFromClipboard:function(a,b){try{if(g_objCommonUtil.log("---pasteInsertImageFromClipboard start-----"),!1!==dzeUiConfig.bUseServerUpload){if(window.addEventListener)if(g_bBrowserType_IE||g_bBrowserType_FF)g_objCommonUtil.log("---IE-FF----"),g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),c=0;c<a.length;c++)if(/^data:image\/png;base64,/i.test(a[c].src)){g_objCommonUtil.log(a[c].src);var d=new XMLHttpRequest;d.open("POST",
dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){var d=this.responseText;g_objCommonUtil.log("file upload result: "+d);d=duzon_http.parseJSON(d);g_objCommonUtil.log(d);"success"==d.result&&(a[c].src=d.url,DZE_UPLOAD_EVENT.setComplete(b,d));g_objCopyPaste.resume()};d.onerror=function(){alert("Error");g_objCopyPaste.resume()};var e=new FormData;e.append("dze_upimage_data",a[c].src);d.send(e);g_objCopyPaste.pause();break}},0);else if(g_bBrowserType_WK||g_bBrowserType_OP){var c="";a.clipboardData&&
a.clipboardData.getData&&(c=a.clipboardData.getData("text/plain"));g_objCommonUtil.log("---pastedText-----");g_objCommonUtil.log(c);if(""!==c){g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),b=0;b<a.length;b++)/^file:\/\//i.test(a[b].src)&&a[b].parentNode.removeChild(a[b])},0);return}var d=new XMLHttpRequest;d.open("POST",dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){var a=this.responseText;g_objCommonUtil.log("file upload result: "+
a);a=duzon_http.parseJSON(a);g_objCommonUtil.log(a);"success"==a.result?(addHTMLContent("<img src='"+a.url+"' />",null,0,b),DZE_UPLOAD_EVENT.setComplete(b,a),g_objAdjustDoc.deleteDuplicatedImage(b,a.filename),dzeUiConfig.bUsePasteCapture||(g_objUndoRedo.registerUndoRedoStack(0,b),!0===dzeUiConfig.bLimitTableWidthSize&&setTimeout(function(){g_objAdjustDoc.checkContentsWidthSize(b)},100))):dzeUiConfig.bUsePasteCapture||(a=g_objEditorDocument[b].getSelection(),!1===fnObjectCheckNull(a)&&0<a.rangeCount&&
(a=a.getRangeAt(0).commonAncestorContainer.getElementsByTagName("img"),!1===fnObjectCheckNull(a)&&0<a.length&&a[0].src===g_objAdjustDoc.strImgUrl&&(g_objUndoRedo.registerUndoRedoStack(0,b),!0===dzeUiConfig.bLimitTableWidthSize&&setTimeout(function(){g_objAdjustDoc.checkContentsWidthSize(b)},100))));g_objCopyPaste.resume()};d.onerror=function(){alert("Error");g_objCopyPaste.resume()};var e=(a.clipboardData||a.originalEvent.clipboardData).items;c=null;g_objAdjustDoc.strImgUrl=null;for(var f=0;f<e.length;f++)if(0===
e[f].type.indexOf("image"))c=e[f].getAsFile();else if(0===e[f].type.indexOf("text/html")){var g=a.clipboardData.getData("text/html");g=g.substring(g.indexOf("<img"),g.length);g=g.substring(0,g.indexOf("/>")+2);var h=g_objEditorDocument[b].createElement("div");h.innerHTML=g;g_objAdjustDoc.strImgUrl=h.firstChild.src}if(null!==c){g_objCommonUtil.log("blob isgood");TBCancelBubbleEvent(a);var k=new FileReader;k.onload=function(a){var b=new FormData;b.append("dze_upimage_data",a.target.result);d.send(b);
g_objCopyPaste.pause()};k.onerror=function(a){g_objCopyPaste.resume()};k.readAsDataURL(c);g_objCopyPaste.pause()}}g_objCommonUtil.log("---pasteInsertImageFromClipboard End-----")}}catch(l){g_objCommonUtil.displayErrorAlert(l,"pasteInsertImageFromClipboard error"),g_objCopyPaste.resume()}},allow_dnd_file_ext:["gif","jpg","jpeg","png","bmp"],dnd_upload_list:[],dragNdropInsertImage:function(a,b){try{if(g_objCommonUtil.log("dragNdropInsertImage======================= CAll"),a&&a.length){for(var c=0;c<
a.length;c++)this.dnd_upload_list.push(a[c]);!0===dzeUiConfig.bUseImageExtUpload?g_objExtUploader.initWithUploadList(b,this.dnd_upload_list):this.dragNdropUpload(b)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"dragNdropInsertImage error")}},dragNdropUpload:function(a){try{if(g_objCommonUtil.log("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc218 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length),0<DZE_UPLOAD_EVENT.dnd_upload_list.length){var b=new XMLHttpRequest;b.open("POST",dzeEnvConfig.strUploadImageURL,
!0);var c=setTimeout(function(){try{b.abort(),g_objCommonUtil.log("xhr timeout")}catch(g){}},6E4);b.onload=function(){clearTimeout(c);var b=this.responseText;g_objCommonUtil.log("file upload result: "+b);b=duzon_http.parseJSON(b);"success"!=b.result?alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR):(dragDropInsertHTML("<img src='"+b.url+"' />",a),DZE_UPLOAD_EVENT.setComplete(a,b),g_objUndoRedo.registerUndoRedoStack(0,a),DZE_UPLOAD_EVENT.dragNdropUpload(a))};b.onerror=function(){clearTimeout(c);g_objCommonUtil.log("xhr Error")};
g_objCommonUtil.log("type:"+typeof DZE_UPLOAD_EVENT.dnd_upload_list);var d=DZE_UPLOAD_EVENT.dnd_upload_list.shift();g_objCommonUtil.log("destFile------------");g_objCommonUtil.log("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc2182 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length);var e=d.name.split(".").pop().toLowerCase();if(!inArray(e,DZE_UPLOAD_EVENT.allow_dnd_file_ext))try{clearTimeout(c);b.abort();alert('"'+d.name+'" '+ID_RES_CONST_STRING_CANNOT_UPLOAD_FILE_TYPE+" "+DZE_UPLOAD_EVENT.allow_dnd_file_ext.join(", "));
return}catch(g){return}var f=new FormData;f.append("dze_upimage_file",d);f.append("type","dnd_upload_image");b.send(f)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"dragNdropUpload error")}}};g_getSelectionAttribute_Absolute=!1;
function increaseFontSize(a,b){try{if("undefined"==typeof a||0!=a)a=!0;strSelectionType=window.attachEvent?g_objEditorDocument[b].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)g_objCommonUtil.log("select type is not support -> strSelectionType : "+strSelectionType);else{g_getSelectionAttribute_Absolute=!0;var c=g_objPropertyUtil.getSelectionAttributeValue(b);g_getSelectionAttribute_Absolute=
!1;duzon_dialog.initSelectionFontStyleList(c);g_objCommonUtil.log("fontSize:"+duzon_dialog.selectionFontStyleList.fontSize);if(""!=duzon_dialog.selectionFontStyleList.fontSize){g_objCommonUtil.log("curr font size : "+duzon_dialog.selectionFontStyleList.fontSize);var d=updateHandlerUI.getMappingIndex_FontSize(duzon_dialog.selectionFontStyleList.fontSize,b);g_objCommonUtil.log("fontSizeIdx:"+d);a=!0===a?d+1:d-1;g_objCommonUtil.log("increaseIdx:"+a);if("undefined"!=typeof g_objComboBoxWin.arrFontSize[a]&&
""!=g_objComboBoxWin.arrFontSize[a])g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a]);else{a=-1;for(b=0;b<g_objComboBoxWin.arrFontSize.length;b++)if(parseInt(duzon_dialog.selectionFontStyleList.fontSize.replace(/pt/,""),10)<=parseInt(g_objComboBoxWin.arrFontSize[b].replace(/pt/,""),10)){a=b;break}0<=a&&g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a])}}}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"increaseFontSize error")}}
function removeEditorTempTagsFromStrHtml(a){try{var b=document.createElement("div");b.innerHTML=a;var c=b.getElementsByTagName("table");for(a=0;a<c.length;a++)if("dze_tb_layout"==c[a].className){c[a].removeAttribute("class");for(var d=c[a].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td"!=d[e].className||d[e].removeAttribute("class")}var f=b.getElementsByTagName("a");for(a=0;a<f.length;a++)"dze_bookmark_flag"==f[a].className&&
f[a].removeAttribute("class");var g=b.getElementsByTagName("div");for(a=0;a<g.length;a++)"dze_printpagebreak_guide"==g[a].className&&(g[a].style.display="none");return b.innerHTML}catch(h){g_objCommonUtil.displayErrorAlert(h,"removeEditorTempTagsFromStrHtml error")}}
function replaceEditorTempTagsFromEditor(a){try{for(var b=g_objEditorDocument[a].getElementsByTagName("table"),c=0;c<b.length;c++)if("dze_tb_layout"==b[c].className){b[c].className="dze_tb_layout_dummy";for(var d=b[c].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td"!=d[e].className||(d[e].className="dze_tb_layout_td_dummy")}var f=g_objEditorDocument[a].getElementsByTagName("a");for(c=0;c<f.length;c++)"dze_bookmark_flag"==
f[c].className&&(f[c].className="dze_bookmark_flag_dummy");var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++)"dze_printpagebreak_guide"==g[c].className&&(g[c].className="dze_printpagebreak_guide_dummy")}catch(h){g_objCommonUtil.displayErrorAlert(h,"replaceEditorTempTagsFromEditor error")}}
function recoverEditorTempTagsFromEditor(a){try{for(var b=g_objEditorDocument[a].getElementsByTagName("table"),c=0;c<b.length;c++)if("dze_tb_layout_dummy"==b[c].className){b[c].className="dze_tb_layout";for(var d=b[c].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td_dummy"!=d[e].className||(d[e].className="dze_tb_layout_td")}var f=g_objEditorDocument[a].getElementsByTagName("a");for(c=0;c<f.length;c++)"dze_bookmark_flag_dummy"==
f[c].className&&(f[c].className="dze_bookmark_flag");var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++)"dze_printpagebreak_guide_dummy"==g[c].className&&(g[c].className="dze_printpagebreak_guide")}catch(h){g_objCommonUtil.displayErrorAlert(h,"recoverEditorTempTagsFromEditor error")}}
function removeGabageEmptyTag(a){try{var b=g_objEditorDocument[a].getElementsByTagName("*"),c=b.length;if(c)for(a=c-1;0<=a;a--)"ol"!=b[a].nodeName.toLowerCase()&&"ul"!=b[a].nodeName.toLowerCase()||""!=b[a].innerHTML.trim()||(g_objCommonUtil.log("::::::::::::::::::::::::::::::::::::removeGabageEmptyTag OL/UL remove ok cnt : "+a),b[a].parentNode.removeChild(b[a]))}catch(d){g_objCommonUtil.displayErrorAlert(d,"removeGabageEmptyTag error")}}
function getCurrentPostionNode(a){try{var b=g_objEditWindow[a].getSelection();return fnObjectCheckNull(b)||1!=b.rangeCount?null:b.getRangeAt(0).commonAncestorContainer}catch(c){g_objCommonUtil.displayErrorAlert(c,"getCurrentPostionNode error")}}
function removeEmptySpaceCharacter(a){try{var b=getCurrentPostionNode(a);g_objCaretUtil.saveCaret(a);removeZeroWidthSpaceFromElement(b);g_objCaretUtil.restoreCaret(a);!0!==g_bBrowserType_IE&&(b=getCurrentPostionNode(a),b.normalize())}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeEmptySpaceCharacter error")}}
function removeZeroWidthSpace(a){try{return a=a.replace(/([^>])\u200B/g,"$1"),a=a.replace(/\u200B([^<])/g,"$1")}catch(b){g_objCommonUtil.displayErrorAlert(b,"removeZeroWidthSpace error")}}function removeZeroWidthSpaceFromString(a){try{return a?a.replace(/[\u200B-\u200D\uFEFF]/g,""):""}catch(b){g_objCommonUtil.displayErrorAlert(b,"removeZeroWidthSpaceFromString error")}}
function removeZeroWidthSpaceFromElement(a){try{if("undefined"==typeof a||null==a)return a;if(g_objTable)if(GetMultiCellSelection())for(var b=a.getElementsByTagName("span"),c=0;c<b.length;c++)b[c].innerHTML=b[c].innerHTML.replace(/\u200B/g,"");else{var d=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col);if(d)return d.innerHTML=d.innerHTML.replace(/\u200B/g,""),d}else{for(b=0;;){b++;if(10<b)break;if(a.parentNode)if(c=a.parentNode.nodeName.toLowerCase(),"body"==a.nodeName.toLowerCase()||
"undefined"==typeof c||null==c||"body"==c||"td"==c)break;else a=a.parentNode;else break}3==a.nodeType?a.nodeValue=removeZeroWidthSpace(a.nodeValue):a.innerHTML=removeZeroWidthSpace(a.innerHTML)}return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"removeZeroWidthSpaceFromElement error")}}
function removeXSS(a){try{if(!0!==dzeUiConfig.bRemoveXSS)return g_objCommonUtil.log("removeXSS N/A"),a;if(""==a.trim()||"<br>"==a.trim()||"<br />"==a.trim()||"<p><br></p>"==a.trim()||"<p><br /></p>"==a.trim()||"<p>&nbsp;</p>"==a.trim())return g_objCommonUtil.log("empty data N/A"),a;g_objCommonUtil.log("------------------------ removeXSS START ------------------------");g_objCommonUtil.log("org data");g_objCommonUtil.log(a);a=a.replace(/\bon[a-zA-Z]+=["]*[^\(]+\([^\)]+\)["]/gi,"");g_objCommonUtil.log("-----------------------------------------");
g_objCommonUtil.log("step 1 result");g_objCommonUtil.log(a);a=a.replace(/(<[^>]*)\bon[a-zA-Z]+="[^"]+"*/gi,"$1");g_objCommonUtil.log("-----------------------------------------");g_objCommonUtil.log("step 2 result");g_objCommonUtil.log(a);var b=/<[^>]*(o:gfxdata=|data-sheets-value=)[^>]*(&#[x]*\d+|[\t\\]+[a-zA-Z0-9]+)[^>]+>/gi,c=a.match(b);null!=c&&c.length&&(a=a.replace(b,"__DZE_MATCH_PATTERNS__"));a=a.replace(/&#[x]*\d+;?/gi,"");a=a.replace(/<[^>]*(javascript:)[^>]+>/gi,"");if(null!=c&&c.length)for(b=
0;b<c.length;b++)a=a.replace(/__DZE_MATCH_PATTERNS__/,c[b]);g_objCommonUtil.log("-----------------------------------------");g_objCommonUtil.log("step 3 result");g_objCommonUtil.log(a);a=a.replace(/<[^>]*marquee[^>]*>/gi,"");g_objCommonUtil.log("-----------------------------------------");g_objCommonUtil.log("step 4 result");g_objCommonUtil.log(a);g_objCommonUtil.log("------------------------ removeXSS END ------------------------");return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"removeXSS error")}}
function dragDropInsertHTML(a,b){try{g_bBrowserType_IE&&g_objInsertUtil.activeSaveRangeFocus(1,b);if(window.attachEvent){var c=g_objEditorDocument[b].selection;if(!c)return;var d=c.createRange();if(!d)return;if("endContainer"in d)var e=d.endContainer;else{var f=d.parentElement().childNodes.length;e=0==f?d.parentElement():d.parentElement().childNodes[f-1]}if(e&&"nodeType"in e)var g=e.nodeType;else return}else g=getSelectionType().nodeType;if(g==ID_SELECTION_ELEMENT_NODE||g==ID_SELECTION_TEXT_NODE)window.attachEvent?
setTimeout(function(){insertHTMLCodeAtSelection(a,null,b)},100):insertHTMLCodeAtSelection(a,null,b);else if(!window.attachEvent&&g_bBrowserType_IE&&(c=g_objEditWindow[b].getSelection(),0==c.rangeCount)){var h=g_objEditorDocument[b].body;d=g_objEditorDocument[b].createRange();d.selectNode(h);d.collapse(!0);c.addRange(d);insertHTMLCodeAtSelection(a,null,b)}}catch(k){g_objCommonUtil.displayErrorAlert(k,"dragDropInsertHTML error")}}
function getnEditNumberFromEditId(a){for(var b in g_arrEditorAreaContainer)if(g_arrEditorAreaContainer[b]==a)return b;return null}function isApplyListStyleDepth(){return!0!==dzeUiConfig.bApplyListStyleDepth?(g_objCommonUtil.log("dzeUiConfig.bApplyListStyleDepth is not true -> N/A"),!1):"undefined"!=typeof dzeUiConfig.applyListStyleDepthItems&&dzeUiConfig.applyListStyleDepthItems.length?!0:(g_objCommonUtil.log("dzeUiConfig.applyListStyleDepthItems is not set -> N/A"),!1)}
function applyListStyleDepth(a,b,c){try{if(g_objCommonUtil.log("applyListStyleDepth START"),!isApplyListStyleDepth())if(GetMultiCellSelection())g_objCommonUtil.log("GetMultiCellSelection -> N/A");else{if(window.attachEvent){var d=g_objEditorDocument[b].selection;if(!d)return;var e=d.createRange();if(!e)return;if("endContainer"in e)var f=e.endContainer;else{var g=e.parentElement().childNodes.length;f=0==g?e.parentElement():e.parentElement().childNodes[g-1]}}else{d=g_objEditWindow[b].getSelection();
if(!d)return;e=d.getRangeAt(0);if(!e)return;f=e.endContainer}if(f)if(null!=g_objNodeUtil.getLoopParentElement(f,"ul"))g_objCommonUtil.log("UL style not support -> N/A");else{var h=g_objNodeUtil.getLoopParentElement(f,"ol"),k="";null!=h&&(k=""==h.style.listStyleType?"decimal":h.style.listStyleType.toLowerCase());if("decrease"==a){g_objCommonUtil.log("=== decrease ===");if(""==k){fnHandler_SupportCommand_Main(b,"InsertOrderedList");cleanPtagForOrderedList(b);if(window.attachEvent){d=g_objEditorDocument[b].selection;
if(!d)return;e=d.createRange();if(!e)return;"endContainer"in e?f=e.endContainer:(g=e.parentElement().childNodes.length,f=0==g?e.parentElement():e.parentElement().childNodes[g-1])}else{d=g_objEditWindow[b].getSelection();if(!d)return;e=d.getRangeAt(0);if(!e)return;f=e.endContainer}if(!f)return;h=g_objNodeUtil.getLoopParentElement(f,"ol");h.style.listStyleType=dzeUiConfig.applyListStyleDepthItems[0];g_objUndoRedo.registerUndoRedoStack(0,b);TBCancelBubbleEvent(c);return}if(!inArray(k,dzeUiConfig.applyListStyleDepthItems))return;
a=-1;for(var l=0;l<dzeUiConfig.applyListStyleDepthItems.length;l++)k==dzeUiConfig.applyListStyleDepthItems[l]&&(a=l);if(0>a)return;var m=dzeUiConfig.applyListStyleDepthItems[a+1];if("undefined"==typeof m){g_objCommonUtil.log("no more list type -> N/A");return}if(window.attachEvent){d=g_objEditorDocument[b].selection;if(!d)return;e=d.createRange();if(!e)return;"endContainer"in e?f=e.endContainer:(g=e.parentElement().childNodes.length,f=0==g?e.parentElement():e.parentElement().childNodes[g-1])}else{d=
g_objEditWindow[b].getSelection();if(!d)return;e=d.getRangeAt(0);if(!e)return;f=e.endContainer}if(!f)return;var q=g_objNodeUtil.getLoopParentElement(f,"li"),n=document.createElement("ol");n.style.listStyleType=m;var r=document.createElement("li");r.innerHTML=q.innerHTML;n.appendChild(r);h.insertBefore(n,q);h.removeChild(q);"<br>"==r.innerHTML||"<br><br>"==r.innerHTML||""==r.innerHTML?duzon_dialog.setFocusElement(r,b,"first"):duzon_dialog.setFocusElement(r,b,"end");g_objUndoRedo.registerUndoRedoStack(0,
b)}else if("increase"==a){g_objCommonUtil.log("=== increase ===");if(window.attachEvent){d=g_objEditorDocument[b].selection;if(!d)return;e=d.createRange();if(!e)return;"endContainer"in e?f=e.endContainer:(g=e.parentElement().childNodes.length,f=0==g?e.parentElement():e.parentElement().childNodes[g-1])}else{d=g_objEditWindow[b].getSelection();if(!d)return;e=d.getRangeAt(0);if(!e)return;f=e.endContainer}if(!f)return;q=g_objNodeUtil.getLoopParentElement(f,"li");if(null==q)return;fnHandler_SupportCommand_Main(b,
"InsertOrderedList");if(window.attachEvent){d=g_objEditorDocument[b].selection;if(!d)return;e=d.createRange();if(!e)return;"endContainer"in e?f=e.endContainer:(g=e.parentElement().childNodes.length,f=0==g?e.parentElement():e.parentElement().childNodes[g-1])}else{d=g_objEditWindow[b].getSelection();if(!d)return;e=d.getRangeAt(0);if(!e)return;f=e.endContainer}if(!f)return;q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q?"<br>"!=q.innerHTML&&"<br><br>"!=q.innerHTML&&""!=q.innerHTML&&duzon_dialog.setFocusElement(q,
b,"end"):3==f.nodeType?"body"!=f.parentNode.nodeName.toLowerCase()&&duzon_dialog.setFocusElement(f.parentNode,b,"end"):duzon_dialog.setFocusElement(f,b,"end");g_objUndoRedo.registerUndoRedoStack(0,b)}TBCancelBubbleEvent(c)}}}catch(p){g_objCommonUtil.displayErrorAlert(p,"applyListStyleDepth error")}}
function applyAutoListStyle(a,b){try{if(g_objCommonUtil.log("applyAutoListStyle START"),!0!==dzeUiConfig.bAutoSetListStyleType)g_objCommonUtil.log("dzeUiConfig.bAutoSetListStyleType is not true -> N/A");else{var c=!1;if(window.getSelection){var d=g_objEditWindow[b].getSelection();if(d&&1==d.rangeCount){var e=d.getRangeAt(0);c=e.collapsed}else return}else{d=g_objEditorDocument[b].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;""==e.htmlText&&(c=!0)}if(c){var f=
"commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(f)if(3!=f.nodeType)g_objCommonUtil.log("nodeType != 3 -> N/A!");else{c="";var g=/^(1|01|A|I)\.\s*/i;if(/^(\-|\*)\s*/i.test(f.nodeValue.replace(/\u200B/g,"")))g_objCommonUtil.log("match pattern -> ul"),c="ul";else if(g.test(f.nodeValue.replace(/\u200B/g,"")))g_objCommonUtil.log("match pattern -> ol"),c="ol";else{g_objCommonUtil.log("no match pattern -> N/A! : value:"+f.nodeValue);return}if("ol"==c){if("li"==
f.parentNode.nodeName.toLowerCase()){g_objCommonUtil.log("inner ol/ul list -> N/A!");return}var h=/^1\.\s*/,k=/^01\.\s*/,l=/^A\.\s*/;g=/^a\.\s*/;var m=/^I\.\s*/,q=/^i\.\s*/;c="";var n=null;if(h.test(f.nodeValue))n=h,c="decimal";else if(k.test(f.nodeValue))n=k,c="decimal-leading-zero";else if(l.test(f.nodeValue))n=l,c="upper-alpha";else if(g.test(f.nodeValue))n=g,c="lower-alpha";else if(m.test(f.nodeValue))n=m,c="upper-roman";else if(q.test(f.nodeValue))n=q,c="lower-roman";else{g_objCommonUtil.log("OL list type unknown -> N/A!");
return}g_objCommonUtil.log("autoListType -> "+c);f.nodeValue=f.nodeValue.replace(n,"\u200b");fnHandler_SupportCommand_Main(b,"InsertOrderedList");cleanPtagForOrderedList(b);if(window.attachEvent){d=g_objEditorDocument[b].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(!f)return;var r=g_objNodeUtil.getLoopParentElement(f,"OL");if(!r)return;r.style.listStyleType=
c;var p=g_objNodeUtil.getLoopParentElement(f,"li");null!=p&&(p.innerHTML=p.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(p,b,"first"))}}else{d=g_objEditWindow[b].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;r=g_objNodeUtil.getLoopParentElement(f,"ol");if(!r)return;r.style.listStyleType=c;p=g_objNodeUtil.getLoopParentElement(f,"li");null!=p&&(p.innerHTML=p.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(p,
b,"first"))}}}else if("ul"==c){r=/^\*\s*/;g=/^\-\s*/;c="";n=null;if(r.test(f.nodeValue.replace(/\u200B/g,"")))n=r,c="disc";else if(g.test(f.nodeValue.replace(/\u200B/g,"")))n=g,c="hypon";else{g_objCommonUtil.log("UL list type unknown -> N/A!");return}if("hypon"==c&&!0!==dzeUiConfig.useExtUnorderedListStyleType){g_objCommonUtil.log("useExtUnorderedListStyleType : "+dzeUiConfig.useExtUnorderedListStyleType+" -> N/A!");return}if("li"==f.parentNode.nodeName.toLowerCase()){if(""==f.parentNode.innerText.replace(n,
"\u200b").replace(/\u200B/g,"").trim()){duzon_dialog.setFocusElement(f.parentNode,b,"end");g_objCommonUtil.log("no li content -> N/A!");return}if(!f.previousSibling||1<f.nodeValue.replace(/\u200B/g,"").length){g_objCommonUtil.log("li content ok-> N/A!");return}}f.nodeValue=f.nodeValue.replace(/\u200B/g,"");f.nodeValue=f.nodeValue.replace(n,"\u200b");if("li"==f.parentNode.nodeName.toLowerCase()){h=document.createElement("ul");if("disc"==c)h.style.listStyleType=c;else if("hypon"==c)h.className="dzeExtListStyleHypon";
else return;f.parentNode.nextSibling?f.parentNode.parentNode.insertBefore(h,f.parentNode.nextSibling):f.parentNode.parentNode.appendChild(h);f.parentNode.innerHTML=f.parentNode.innerHTML.replace(/\u200B/g,"").replace(/<br>$/,"");k=document.createElement("li");k.className="dzeExtListStyleHyponLi";k.innerHTML=duzon_dialog.dze_bookmark_last_tag;h.appendChild(k);"disc"==c&&k.getAttribute("class")&&k.removeAttribute("class");duzon_dialog.setFocusElement(k,b,"end")}else if(fnHandler_SupportCommand_Main(b,
"InsertUnOrderedList"),cleanPtagForOrderedList(b),window.attachEvent){d=g_objEditorDocument[b].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(!f)return;l=g_objNodeUtil.getLoopParentElement(f,"ul");if(!l)return;if("disc"==c)l.style.listStyleType=c;else if("hypon"==c)l.className="dzeExtListStyleHypon";else return;p=g_objNodeUtil.getLoopParentElement(f,
"li");null!=p&&(p.innerHTML=p.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(p,b,"first"))}}else{d=g_objEditWindow[b].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;l=g_objNodeUtil.getLoopParentElement(f,"ul");if(!l)return;if("disc"==c)l.style.listStyleType=c;else if("hypon"==c)l.className="dzeExtListStyleHypon";else return;p=g_objNodeUtil.getLoopParentElement(f,"li");p.className="dzeExtListStyleHyponLi";null!=
p&&(p.innerHTML=p.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(p,b,"first"))}}}else{g_objCommonUtil.log("autoListType none -> N/A!");return}g_objUndoRedo.registerUndoRedoStack(0,b);g_objCommonUtil.log("TBCancelBubbleEvent");TBCancelBubbleEvent(a)}}else g_objCommonUtil.log("collapsed = false -> N/A!")}}catch(t){g_objCommonUtil.displayErrorAlert(t,"applyAutoListStyle error")}}
function applyListStyleBackSpace(a,b){try{if(g_objCommonUtil.log("-------------------------------------------------------------applyListStyleBackSpace START"),!0!==dzeUiConfig.bAutoSetListStyleType)g_objCommonUtil.log("dzeUiConfig.bAutoSetListStyleType is not true -> N/A");else{var c=!1;if(window.getSelection){var d=g_objEditWindow[b].getSelection();if(d&&1==d.rangeCount){var e=d.getRangeAt(0);c=e.collapsed}else return}else{d=g_objEditorDocument[b].selection;if(fnObjectCheckNull(d))return;e=d.createRange();
if(fnObjectCheckNull(e))return;""==e.htmlText&&(c=!0)}if(c){var f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(f)if(c=f,3==f.nodeType&&(f=f.parentNode),1!=f.nodeType)g_objCommonUtil.log("nodeType != 1 -> N/A!");else if("li"!=f.nodeName.toLowerCase())g_objCommonUtil.log("no li -> N/A!");else{if("<br>"!=f.innerHTML&&"<br><br>"!=f.innerHTML&&""!=f.innerHTML)if(window.getSelection){if(0!=e.endOffset){g_objCommonUtil.log("caret position -> N/A!");return}if(c.previousSibling){g_objCommonUtil.log("in text -> N/A!");
return}}else{g_objCommonUtil.log("in Content -> N/A!");return}if(f.previousSibling)if("li"!=f.previousSibling.nodeName.toLowerCase())g_objCommonUtil.log("no previous li -> N/A!");else{if(""==f.innerHTML)f.previousSibling.innerHTML=f.previousSibling.innerHTML.replace(/\u200B/g,"").replace(/<br>$/g,"")+"<br>"+duzon_dialog.dze_bookmark_last_tag,duzon_dialog.setFocusElement(f.previousSibling,b,"end");else{var g="S_"+(new Date).getTime();e='<span id="'+g+'">&nbsp;</span>';f.previousSibling.innerHTML=f.previousSibling.innerHTML.replace(/\u200B/g,
"").replace(/<br>$/g,"")+"<br>"+e+f.innerHTML;var h=g_objEditorDocument[b].getElementById(g);h&&(duzon_dialog.setFocusElement(h,b,"end"),h.parentNode.removeChild(h))}f.parentNode.removeChild(f);g_objUndoRedo.registerUndoRedoStack(0,b);TBCancelBubbleEvent(a);g_objCommonUtil.log("applyListStyleBackSpace Finish")}else g_objCommonUtil.log("no previous elem -> N/A!")}else g_objCommonUtil.log("no objAncestorNode -> N/A!")}else g_objCommonUtil.log("collapsed = false -> N/A!")}}catch(k){g_objCommonUtil.displayErrorAlert(k,
"applyListStyleBackSpace error")}}
function applyListStyleEnter(a,b){try{if(!0!==dzeUiConfig.bAutoSetListStyleType||!0!==dzeUiConfig.useExtUnorderedListStyleType)g_objCommonUtil.log("dzeUiConfig.bAutoSetListStyleType is not true -> N/A");else if(a.ctrlKey||a.altKey||a.shiftKey||a.keyCode!=ID_KEYCODE_ENTER)g_objCommonUtil.log("applyListStyleEnter not allow key event.... -> N/A");else{a=!1;if(window.getSelection){var c=g_objEditWindow[b].getSelection();if(c&&1==c.rangeCount){var d=c.getRangeAt(0);a=d.collapsed}else return}else{c=g_objEditorDocument[b].selection;
if(fnObjectCheckNull(c))return;d=c.createRange();if(fnObjectCheckNull(d))return;""==d.htmlText&&(a=!0)}if(a){var e="commonAncestorContainer"in d?d.commonAncestorContainer:d.parentElement().childNodes[0];if(e)if(1!=e.nodeType)g_objCommonUtil.log("nodeType != 1 -> N/A!");else if("li"!=e.nodeName.toLowerCase())g_objCommonUtil.log("no li -> N/A!");else if(e.getAttribute("class"))e.parentNode.getAttribute("class")||e.removeAttribute("class"),g_objUndoRedo.registerUndoRedoStack(0,b);else{if("ul"==e.parentNode.nodeName.toLowerCase()&&
e.parentNode.getAttribute("class")&&0<=e.parentNode.getAttribute("class").indexOf("dzeExtListStyle")&&(e.setAttribute("class",e.parentNode.getAttribute("class")+"Li"),g_objUndoRedo.registerUndoRedoStack(0,b)),"<br></br>"==e.innerHTML||"<br>"==e.innerHTML)e.innerHTML=""}else g_objCommonUtil.log("no objAncestorNode -> N/A!")}else g_objCommonUtil.log("collapsed = false -> N/A!")}}catch(f){g_objCommonUtil.displayErrorAlert(f,"error:applyListStyleEnter")}}
function applyParagraphStyleEnter(a,b){try{a=!1;if(window.getSelection){var c=g_objEditWindow[b].getSelection();if(c&&1==c.rangeCount){var d=c.getRangeAt(0);a=d.collapsed}else return}else{c=g_objEditorDocument[b].selection;if(fnObjectCheckNull(c))return;d=c.createRange();if(fnObjectCheckNull(d))return;""==d.htmlText&&(a=!0)}if(a){var e="commonAncestorContainer"in d?d.commonAncestorContainer:d.parentElement().childNodes[0];if(e&&1==e.nodeType&&"div"==e.nodeName.toLowerCase()&&(""==e.innerHTML||"<br>"==
e.innerHTML)){var f=document.createElement("p");f.innerHTML=window.attachEvent?"&nbsp;":"<br />";e.parentNode.insertBefore(f,e);e.parentNode.removeChild(e);duzon_dialog.setFocusElement(f,b,"start")}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"error:applyParagraphStyleEnter")}}
function setEditorContainerOutline(a){try{if(!(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)){var b=document.getElementById("dzeditor_Parent_"+a),c=document.getElementById("dze_editor_source_frame_main_"+a);g_bTabBar_Display?(null!=b&&(b.style.borderWidth="1px 1px 0px 1px",b.style.borderStyle="solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="1px")):(null!=b&&(b.style.borderWidth="1px 1px 1px 1px",b.style.borderStyle=
"solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="`0px"))}if(!0===dzeUiConfig.bSetCustomEditorContainerOutLine&&"undefined"!=typeof dzeUiConfig.nCustomEditorContainerOutLineValues&&4==dzeUiConfig.nCustomEditorContainerOutLineValues.length){g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display||null==b||(b.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",b.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px");var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(d.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",d.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",d.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");b=document.getElementById("dzeditor_Parent_"+a);null!=b&&(b.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",b.style.borderRightWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");c=document.getElementById("dze_editor_source_frame_main_"+a);null!=c&&(c.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",c.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");var e=document.getElementById("TB_TABMODE_CONTAINER_"+a);if(null!=e){var f=document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_"+a);null!=f?(f.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+
"px",f.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",f.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px"):(e.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px",e.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",e.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px")}else{var g=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a);null!=g&&(g.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px")}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"setEditorContainerOutline error")}}
function insertSourceSelectionSyncChars(a){try{if(!0===dzeUiConfig.bSyncSourceSelection)if(GetMultiCellSelection())g_objCommonUtil.log("Not Support MultiCellSelection!");else if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(!fnObjectCheckNull(b)){var c=b.createRange();if(!fnObjectCheckNull(c))if(""==c.htmlText)c.pasteHTML("\b\b");else{var d=c.duplicate();d.collapse(!0);d.pasteHTML("\b\b");var e=c.duplicate();e.collapse(!1);e.pasteHTML("\b\b")}}}else if(b=g_objEditWindow[a].getSelection(),
1==b.rangeCount){var f=b.getRangeAt(0);if(f.collapsed)insertHTMLCodeAtSelection("\b\b",null,a);else if(c=!1,ID_SELECTION_TEXT_NODE==f.commonAncestorContainer.nodeType&&(c=!0),c){var g=g_objEditorDocument[a].createElement("span");g.appendChild(f.cloneContents());var h=g_objEditorDocument[a].createTextNode("\b\b"+g.textContent+"\b\b");insertHTMLCodeAtSelection(null,h,a)}else{var k=f.startContainer,l=f.startOffset,m=f.endContainer,q=f.endOffset,n=g_objEditorDocument[a].createTextNode("\b\b"),r=g_objEditorDocument[a].createTextNode("\b\b");
b.removeAllRanges();e=g_objEditorDocument[a].createRange();e.setStartBefore(m);e.setEnd(m,q);e.collapse(!1);b.addRange(e);insertHTMLCodeAtSelection(null,r,a);b.removeAllRanges();d=g_objEditorDocument[a].createRange();d.setStart(k,l);d.setEndAfter(k);d.collapse(!0);b.addRange(d);insertHTMLCodeAtSelection(null,n,a)}}}catch(p){g_objCommonUtil.displayErrorAlert(p,"insertSourceSelectionSyncChars error")}}
function syncSourceSelection(a){try{if(!0===dzeUiConfig.bSyncSourceSelection){var b=g_objEditObjectSource[a].value;"selectionStart"in g_objEditObjectSource[a]||(b=b.replace(/\r/g,""));var c=b.indexOf("\b\b");if(!(0>c)){var d=b.substring(0,c),e=b.indexOf("\b\b",c+2);e=0>e?c:e-2;g_objEditObjectSource[a].value=b.replace(/\b\b/g,"");g_objEditorDocument[a].body.innerHTML=g_objEditorDocument[a].body.innerHTML.replace(/\b\b/g,"");if("selectionStart"in g_objEditObjectSource[a])g_objEditObjectSource[a].selectionStart=
c,g_objEditObjectSource[a].selectionEnd=e,g_objEditObjectSource[a].focus();else{var f=g_objEditObjectSource[a].createTextRange();f.moveStart("character",c);f.collapse();f.moveEnd("character",e-c);f.select()}var g=(d.match(/\n/g)||[]).length;g_objEditObjectSource[a].scrollTop=16*g+8}}}catch(h){g_objCommonUtil.displayErrorAlert(h,"syncSourceSelection error")}}
var dzeFullScreen={dzeOrgParentStyleInfo:null,dzeOrgIframeStyleInfo:null,dzeOrgTblContainerStyleInfo:null,nEditNumber:-1,view:function(a){this.nEditNumber=a;-1==this.nEditNumber&&(this.nEditNumber=g_nActiveEditNumber);try{if(dzeEnvConfig.iFrameLayer){var b=window.frameElement;!1===g_bFullScreenMode?(b.getAttribute("style")&&(this.dzeOrgIframeStyleInfo=b.getAttribute("style"),b.removeAttribute("style")),b.style.position="absolute",b.style.zIndex=20009,g_objLayerKit.getLayerDocument().body.getAttribute("style")&&
(this.dzeOrgParentStyleInfo=g_objLayerKit.getLayerDocument().body.getAttribute("style"),g_objLayerKit.getLayerDocument().body.removeAttribute("style")),g_objLayerKit.getLayerDocument().body.style.overflow="hidden",g_objLayerKit.getLayerDocument().body.style.margin=0,g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display="none"),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display=
"none"),this.evtResizeFrame(),this.addResizeIframeEvent(this.nEditNumber),g_bFullScreenMode=!0):(b.removeAttribute("style"),g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display=""),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display=""),null!=this.dzeOrgIframeStyleInfo&&(b.setAttribute("style",this.dzeOrgIframeStyleInfo),this.dzeOrgIframeStyleInfo=
null),g_objLayerKit.getLayerDocument().body.removeAttribute("style"),null!=this.dzeOrgParentStyleInfo&&(g_objLayerKit.getLayerDocument().body.setAttribute("style",this.dzeOrgParentStyleInfo),this.dzeOrgParentStyleInfo=null),isCreatedRulerBar()&&("100%"!=b.style.width?dze_rulerbar_mgr.createRulerbar(a,parseFloat(b.style.width,10)-2,3):dze_rulerbar_mgr.createRulerbar(a,b.style.pixelWidth-2,3),dze_rulerbar_mgr.changeRulerbarDisplay(a,dze_rulerbar_mgr.m_bShow)),this.removeResizeIframeEvent(this.nEditNumber),
g_bFullScreenMode=!1)}else{var c=document.getElementById("EDIT_SET_CONTAINER_"+this.nEditNumber);if(!1===g_bFullScreenMode)this.dzeOrgTblContainerStyleInfo=null,c.getAttribute("style")&&(this.dzeOrgTblContainerStyleInfo=c.getAttribute("style"),c.removeAttribute("style")),c.style.position="absolute",c.style.zIndex=20009,this.dzeOrgParentStyleInfo=null,g_objLayerKit.getLayerDocument().body.getAttribute("style")&&(this.dzeOrgParentStyleInfo=g_objLayerKit.getLayerDocument().body.getAttribute("style"),
g_objLayerKit.getLayerDocument().body.removeAttribute("style")),g_objLayerKit.getLayerDocument().body.style.overflow="hidden",g_objLayerKit.getLayerDocument().body.style.margin="0px",g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display="none"),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display="none"),isCreatedRulerBar()&&(dze_rulerbar_mgr.createRulerbar(a,
b.style.clientWidth-2,3),dze_rulerbar_mgr.changeRulerbarDisplay(a,dze_rulerbar_mgr.m_bShow)),this.evtResizeTblContainer(),this.addResizeTblContainerEvent(this.nEditNumber),g_bFullScreenMode=!0;else{g_objLayerKit.getLayerDocument().body.removeAttribute("style");g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display="");dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display=
"");null!=this.dzeOrgParentStyleInfo&&(g_objLayerKit.getLayerDocument().body.setAttribute("style",this.dzeOrgParentStyleInfo),this.dzeOrgParentStyleInfo=null);c.removeAttribute("style");isCreatedRulerBar()&&(b=window.frameElement,"100%"!=b.style.width?dze_rulerbar_mgr.createRulerbar(a,parseFloat(b.style.width,10)-2,3):dze_rulerbar_mgr.createRulerbar(a,b.style.pixelWidth-2,3),dze_rulerbar_mgr.changeRulerbarDisplay(a,dze_rulerbar_mgr.m_bShow));if(null!=this.dzeOrgTblContainerStyleInfo){c.setAttribute("style",
this.dzeOrgTblContainerStyleInfo);var d=parseInt(c.style.height.replace(/px/,""),10);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(this.nEditNumber,d):resizeEditor_Height(this.nEditNumber,d);this.dzeOrgTblContainerStyleInfo=null}this.removeResizeTblContainerEvent(this.nEditNumber);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtResizeShowHideTb();g_bFullScreenMode=!1}}editor_onselectionchange(this.nEditNumber)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"error:dzeFullScreen.view")}},addResizeIframeEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.attachEvent("onresize",dzeFullScreen.evtResizeFrame):b.addEventListener("resize",dzeFullScreen.evtResizeFrame,!1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"addResizeIframeEvent")}},removeResizeIframeEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.detachEvent("onresize",dzeFullScreen.evtResizeFrame):b.removeEventListener("resize",
dzeFullScreen.evtResizeFrame,!1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeResizeIframeEvent")}},addResizeTblContainerEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.attachEvent("onresize",dzeFullScreen.evtResizeTblContainer):b.addEventListener("resize",dzeFullScreen.evtResizeTblContainer,!1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"addResizeTblContainerEvent")}},removeResizeTblContainerEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();
b.attachEvent?b.detachEvent("onresize",dzeFullScreen.evtResizeTblContainer):b.removeEventListener("resize",dzeFullScreen.evtResizeTblContainer,!1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeResizeTblContainerEvent")}},evtResizeFrame:function(){try{if(dzeEnvConfig.iFrameLayer){var a=window.frameElement;a.style.left=0;a.style.top=0;var b=g_objPositionUtil.getElementPosition(a,dzeEnvConfig.iFrameLayer),c=duzon_dialog.getActiveDialogWindowSize();a.style.left=c.scrollX-b.left+"px";a.style.top=
c.scrollY-b.top+"px";a.style.height=c.view_window_height+"px";a.style.width=c.view_window_width+"px";isCreatedRulerBar()&&(g_bFullScreenMode||dze_rulerbar_mgr.m_nEditorWidth<c.view_window_width)&&(dze_rulerbar_mgr.createRulerbar(g_nActiveEditNumber,c.view_window_width-2,3),dze_rulerbar_mgr.changeRulerbarDisplay(g_nActiveEditNumber,dze_rulerbar_mgr.m_bShow))}}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:evtResizeFrame")}},evtResizeTblContainer:function(){try{if(!dzeEnvConfig.iFrameLayer){var a=
document.getElementById("EDIT_SET_CONTAINER_"+dzeFullScreen.nEditNumber);a.style.top=0;a.style.left=0;var b=g_objPositionUtil.getElementPosition(a,dzeEnvConfig.iFrameLayer),c=duzon_dialog.getActiveDialogWindowSize();a.style.top=-b.top+"px";a.style.left=-b.left+"px";!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(this.nEditNumber,c.view_window_height):resizeEditor_Height(this.nEditNumber,c.view_window_height);a.style.width=c.view_window_width+"px";
!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtResizeShowHideTb()}}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:evtResizeTblContainer")}}};
function insertPrintPageBreak(a){try{if(!g_objTable){var b=document.createElement("div");b.className="dze_printpagebreak";b.setAttribute("contenteditable","false");b.innerHTML='<div class="dze_printpagebreak_guide" contenteditable="false" title="'+ID_RES_CONST_STRING_PRINT_PAGE_BREAK+'"></div>';var c=document.createElement("p");c.innerHTML=window.attachEvent?"&nbsp;":"<br />";var d=g_objNodeUtil.getAncestorNodeOnCaret(a);if(d){if(3==d.nodeType&&(d=d.parentNode,!d))return;if("body"==d.nodeName.toLowerCase())insertHTMLCodeAtSelection(b.outerHTML+
c.outerHTML,null,a);else{for(var e=0;;){e++;if(30<e)break;if(!d.parentNode)break;if("body"==d.parentNode.nodeName.toLowerCase())break;d=d.parentNode}if(!d||"body"!=d.parentNode.nodeName.toLowerCase())return;d.nextSibling?d.parentNode.insertBefore(b,d.nextSibling):d.parentNode.appendChild(b);""!=d.innerHTML&&"<br>"!=d.innerHTML&&"<br />"!=d.innerHTML&&"&nbsp;"!=d.innerHTML||d.parentNode.removeChild(d);b.nextSibling||(b.parentNode.appendChild(c),duzon_dialog.setFocusElement(c,a,"start"))}g_objUndoRedo.registerUndoRedoStack(0,
a)}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"error:insertPrintPageBreak")}}
function cleanPtagForOrderedList(a){try{var b=getSelectionParentElement(a,"OL");if(b){var c=b.parentNode;if(c&&"p"==c.nodeName.toLowerCase()&&(c.parentNode.insertBefore(b,c),""==c.innerHTML&&c.parentNode.removeChild(c),b.childNodes.length)){var d=b.childNodes.length-1;duzon_dialog.setFocusElement(b.childNodes[d],a,"end")}}else{var e=getSelectionParentElement(a,"UL");e&&(c=e.parentNode)&&"p"==c.nodeName.toLowerCase()&&(c.parentNode.insertBefore(e,c),""==c.innerHTML&&c.parentNode.removeChild(c),e.childNodes.length&&
(d=e.childNodes.length-1,duzon_dialog.setFocusElement(e.childNodes[d],a,"end")))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"error:cleanPtagForOrderedList")}}
function setCascadeOrderList(a,b){try{if("undefined"!=typeof a&&a.length){dzeUiConfig.applyListStyleDepthItems=a;var c=g_objNodeUtil.getAncestorNodeOnCaret(b);if(c&&c.nodeName)if(c.nodeType!=ID_SELECTION_TEXT_NODE&&"p"!=c.nodeName.toLowerCase()&&"body"!=c.nodeName.toLowerCase()||null!=g_objNodeUtil.getLoopParentElement(c,"ol")){if("ol"!=c.nodeName.toLowerCase()&&(c=g_objNodeUtil.getLoopParentElement(c,"ol")),c)for(b=c,setOlListStyle(b,a[0]),c=1;c<a.length;c++){b=g_objNodeUtil.getLoopChildNodeByTagName(b,
"ol");if(!b)break;setOlListStyle(b,a[c])}}else applyListStyleDepth("decrease",b,null)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:setCascadeOrderList")}}
function setOlListStyle(a,b){try{if("ol"==a.nodeName.toLowerCase())for(a.style.listStyleType=b,a.getAttribute("class")&&a.removeAttribute("class"),b=0;b<a.childNodes.length;b++)"li"==a.childNodes[b].nodeName.toLowerCase()&&a.childNodes[b].getAttribute("class")&&a.childNodes[b].removeAttribute("class")}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setOlListStyle")}}
var dzeCopyPasteStyleInfo={nEditNumber:-1,pasteStyleMode:!1,isEmpty:!0,styleInfo:{},initStyleInfo:function(){try{this.styleInfo={fontFamily:"",fontSize:"",color:"",backgroundColor:"",letterSpacing:"",lineHeight:"",bold:!1,italic:!1,underline:!1,strike:!1,superScript:!1,subScript:!1,textAlign:-1,listType:[],listStyleType:[],listClassName:[],listChildClassName:[],listChildStyle:[],heading:"-1"},this.isEmpty=!0}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:initStyleInfo")}},copy:function(a){try{if(!0===
dzeUiConfig.bApplyPasteStyleMode&&(this.initStyleInfo(),!GetMultiCellSelection())){var b=g_objPropertyUtil.getSelectionAttributeValue(a,!0);b&&(b[0]?(this.styleInfo.fontFamily=b[0],this.isEmpty=!1):1==b[11]&&"undefined"!=typeof b[22][0]&&(this.styleInfo.fontFamily=b[22][0],this.isEmpty=!1),b[1]?(this.styleInfo.fontSize=b[1],this.isEmpty=!1):1==b[12]&&"undefined"!=typeof b[23][0]&&(this.styleInfo.fontSize=b[23][0],this.isEmpty=!1),b[2]?(this.styleInfo.color=b[2],this.isEmpty=!1):1==b[13]&&"undefined"!=
typeof b[24][0]&&(this.styleInfo.color=b[24][0],this.isEmpty=!1),b[3]?(this.styleInfo.backgroundColor=b[3],this.isEmpty=!1):1==b[14]&&"undefined"!=typeof b[25][0]&&(this.styleInfo.backgroundColor=b[25][0],this.isEmpty=!1),b[4]?(this.styleInfo.letterSpacing=b[4],this.isEmpty=!1):1==b[15]&&"undefined"!=typeof b[26][0]&&(this.styleInfo.letterSpacing=b[26][0],this.isEmpty=!1),b[5]?(this.styleInfo.lineHeight=b[5],this.isEmpty=!1):1==b[16]&&"undefined"!=typeof b[27][0]&&(this.styleInfo.lineHeight=b[27][0],
this.isEmpty=!1));strSelectionType=window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){b="";for(var c=0,d=0;d<duzon_dialog.dze_font_propertys.length-1;d++)if("normal"!=duzon_dialog.dze_font_propertys[d]){b=duzon_dialog.dze_font_propertys[d].toUpperCase();c=eval("ID_COMMAND_"+b);"STRIKE"==b&&(b="StrikeThrough");var e=handlerUI.queryCommandStatus(g_objEditorDocument[a],
c,b,a,-1,strSelectionType);if(ID_STRING_NAME_CHECKED==e)switch(b){case "StrikeThrough":this.styleInfo.strike=!0;this.isEmpty=!1;break;case "BOLD":this.styleInfo.bold=!0;this.isEmpty=!1;break;case "ITALIC":this.styleInfo.italic=!0;this.isEmpty=!1;break;case "UNDERLINE":this.styleInfo.underline=!0;this.isEmpty=!1;break;case "SUPERSCRIPT":this.styleInfo.superScript=!0;this.isEmpty=!1;break;case "SUBSCRIPT":this.styleInfo.subScript=!0,this.isEmpty=!1}}this.styleInfo.textAlign=getAlignValueForSelectionArea(a);
this.styleInfo.heading=updateHandlerUI.getMappingIndex_Heading(a);0<parseInt(this.styleInfo.heading,10)&&(this.isEmpty=!1);var f=g_objNodeUtil.getAncestorNodeOnCaret(a);if(f&&(f.nodeType==ID_SELECTION_TEXT_NODE&&(f=f.parentNode),"li"==f.nodeName.toLowerCase()&&(f=f.parentNode),"ol"==f.nodeName.toLowerCase()||"ul"==f.nodeName.toLowerCase())){for(e=0;e++,this.styleInfo.listType.push(f.nodeName.toUpperCase()),this.styleInfo.listStyleType.push(f.style.listStyleType),this.styleInfo.listClassName.push(f.className),
0<f.childNodes.length&&"li"==f.childNodes[0].nodeName.toLowerCase()&&(f.childNodes[0].className?this.styleInfo.listChildClassName.push(f.childNodes[0].className):this.styleInfo.listChildClassName.push(""),f.childNodes[0].getAttribute("style")?this.styleInfo.listChildStyle.push(f.childNodes[0].getAttribute("style")):this.styleInfo.listChildStyle.push(null)),f=g_objNodeUtil.getLoopChildNodeByTagNames(f,["ol","ul"]),f&&!(10<e););this.isEmpty=!1}!1===this.isEmpty&&this.setPasteStyleMode(a)}}}catch(g){g_objCommonUtil.displayErrorAlert(g,
"error:dzeCopyPasteStyleInfo.copy")}},paste:function(a){try{if(!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&!0!==this.isEmpty){this.unsetPasteStyleModeEditArea(a);if(!GetMultiCellSelection()){this.nEditNumber=a;var b=window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();b=b.toLowerCase();if(ID_STRING_NAME_TEXT==b||ID_STRING_NAME_NONE==b){var c=g_objNodeUtil.getAncestorNodeOnCaret(a);if(0<parseInt(this.styleInfo.heading,10))g_nLetterOperationType=
ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.heading,!1);else{if(this.styleInfo.listType.length){var d=g_objNodeUtil.getLoopParentElement(c,this.styleInfo.listType[0].toLowerCase());null==d&&("UL"==this.styleInfo.listType[0]?fnHandler_SupportCommand_Main(a,"InsertUnOrderedList"):fnHandler_SupportCommand_Main(a,"InsertOrderedList"),c=g_objNodeUtil.getAncestorNodeOnCaret(a),d=g_objNodeUtil.getLoopParentElement(c,
this.styleInfo.listType[0].toLowerCase()));if(d)for(c=0;c<this.styleInfo.listType.length&&d.nodeName.toUpperCase()==this.styleInfo.listType[c];c++){this.styleInfo.listStyleType[c]?d.style.listStyleType=this.styleInfo.listStyleType[c]:d.getAttribute("style")&&d.removeAttribute("style");this.styleInfo.listClassName?d.className=this.styleInfo.listClassName[c]:d.getAttribute("class")&&d.removeAttribute("class");for(var e=0;e<d.childNodes.length;e++)"li"==d.childNodes[e].nodeName.toLowerCase()&&(this.styleInfo.listChildClassName[c]?
d.childNodes[e].className=this.styleInfo.listChildClassName[c]:d.childNodes[e].getAttribute("class")&&d.childNodes[e].removeAttribute("class"),this.styleInfo.listChildStyle[c]?d.childNodes[e].setAttribute("style",this.styleInfo.listChildStyle[c]):d.childNodes[e].getAttribute("style")&&d.childNodes[e].removeAttribute("style"));d=g_objNodeUtil.getLoopChildNodeByTagNames(d,["ol","ul"]);if(!d)break}}this.styleInfo.fontFamily&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=
g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontFamily,!1));this.styleInfo.fontSize&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontSize,!1));this.styleInfo.color&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(this.styleInfo.color,!1),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a));g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;
fnColorCellApply(this.styleInfo.backgroundColor,!1);-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a);""!=this.styleInfo.letterSpacing&&g_objLetterSpacingWin.fnLetterSpacingCellClick(this.styleInfo.letterSpacing,!1);""!=this.styleInfo.lineHeight&&g_objLineHeightWin.fnLineHeightCellClick(this.styleInfo.lineHeight,!1);if(0<=this.styleInfo.textAlign){d=!1;0==this.styleInfo.textAlign&&(d=!0);var f=1==this.styleInfo.textAlign?"Left":2==this.styleInfo.textAlign?"Center":3==this.styleInfo.textAlign?"Right":
4==this.styleInfo.textAlign?"Justify":"Left",g=eval("ID_COMMAND_JUSTIFY_"+f.toUpperCase());fnHandler_Align_Main(a,"Justify"+f,d,g)}f="";g=-1;g=ID_COMMAND_BOLD;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.bold?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"bold"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"bold");g=ID_COMMAND_ITALIC;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==
this.styleInfo.italic?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Italic"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Italic");g=ID_COMMAND_UNDERLINE;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.underline?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Underline"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Underline");g=ID_COMMAND_STRIKE;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],
g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.strike?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"StrikeThrough"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"StrikeThrough");g=ID_COMMAND_SUPERSCRIPT;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.superScript?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"superscript"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"superscript");g=ID_COMMAND_SUBSCRIPT;
f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.subScript?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"subscript"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"subscript")}g_objUndoRedo.registerUndoRedoStack(0,a)}}this.unsetPasteStyleMode(a)}}catch(h){this.unsetPasteStyleMode(a),g_objCommonUtil.displayErrorAlert(h,"error:dzeCopyPasteStyleInfo.paste")}},setPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&
(this.setPasteStyleModeEditArea(a),this.pasteStyleMode=!0,editor_ondeactivate(a))}catch(b){this.pasteStyleMode=!1,g_objCommonUtil.displayErrorAlert(b,"error:setPasteStyleMode")}},unsetPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&(this.pasteStyleMode=!1,this.orgContentEditable=!0,this.initStyleInfo(),editor_onactivate(null,a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0)}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:unsetPasteStyleMode")}},
orgContentEditable:!0,setPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0!==this.pasteStyleMode&&(null==g_objEditorDocument[a].body.getAttribute("contentEditable")||""==g_objEditorDocument[a].body.getAttribute("contentEditable")?this.orgContentEditable=null:this.orgContentEditable=g_objEditorDocument[a].body.getAttribute("contentEditable"),g_objEditorDocument[a].body.contentEditable=!1,g_objEditorDocument[a].body.style.cursor="pointer")}catch(b){g_objCommonUtil.displayErrorAlert(b,
"error:setPasteStyleModeEditArea")}},unsetPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&(null==this.orgContentEditable?g_objEditorDocument[a].body.removeAttribute("contentEditable"):g_objEditorDocument[a].body.contentEditable=this.orgContentEditable,g_objEditorDocument[a].body.style.cursor="")}catch(b){g_objEditorDocument[a].body.contentEditable=!0,g_objEditorDocument[a].body.style.cursor="",g_objCommonUtil.displayErrorAlert(b,"error:unsetPasteStyleModeEditArea")}}},
dzeClipBoard={dzeClipMode:!0,copyData:[],copyType:"",copyTableWidth:"100%",initialize:function(){this.copyData=[];this.copyType="";this.dzeClipMode=dzeUiConfig.bCopyPasteTableCell},copySelectedMultiCells:function(a){try{this.initialize(),!0===this.dzeClipMode&&!fnObjectCheckNull(g_objTable)&&GetMultiCellSelection()&&(this.copyTableWidth="100%",this.checkCopyType(a),"table_row"==this.copyType?this.copyEntireRow(a):"table_all"==this.copyType?this.copyEntireTable(a):(this.copyType="table_cell",this.copyMultiCell(a)))}catch(b){g_objCommonUtil.displayErrorAlert(b,
"error:copySelectedMultiCells")}},checkCopyType:function(a){try{if(GetMultiCellSelection()){var b=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[a],a)[0];this.copyType=b==UI_TABLE_SELECT_TYPE_ENTIRE_ROW?"table_row":b==UI_TABLE_SELECT_TYPE_ENTIRE_TABLE?"table_all":"table_cell"}else this.copyType=""}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:checkCopyType")}},copyEntireRow:function(a){try{if(!fnObjectCheckNull(g_objTable)&&GetMultiCellSelection()){this.copyData=[];for(var b=
[],c=0;c<g_objTable.rows.length;c++){var d=g_objTableFlag.GetCellAttribute_Flag(g_objTable,c,0);2!=d&&3!=d&&4!=d||b.push(c)}g_objTagUtil.updateTagAttribute(a);g_objTableFlag.removeFlagInfo(g_objTable);d=null;for(c=0;c<b.length;c++)d=g_objTableUtil.getTableRowElement(g_objTable,b[c]),this.copyData.push(d.outerHTML);this.copyToNativeClipboard(a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"error:copyEntireRow")}},copyEntireTable:function(a){try{!fnObjectCheckNull(g_objTable)&&GetMultiCellSelection()&&
"table_all"==this.copyType&&(this.copyData=[],g_objTableFlag.removeFlagInfo(g_objTable),g_objTagUtil.updateTagAttribute(a),this.copyData.push(g_objTable.outerHTML),this.copyToNativeClipboard(a))}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:copyEntireTable")}},copyMultiCell:function(a){try{if(!fnObjectCheckNull(g_objTable)&&GetMultiCellSelection()){this.copyData=[];var b=[],c=[];this.copyTableWidth=0;for(var d=!1,e=0;e<g_objTable.rows.length;e++){c=[];for(var f=0;f<g_objTable.rows[e].cells.length;f++){var g=
g_objTableFlag.GetCellAttribute_Flag(g_objTable,e,f);if(2==g||3==g||4==g)c.push(f),0==d&&(this.copyTableWidth+=g_objTable.rows[e].cells[f].offsetWidth)}c.length&&(d=!0);b.push(c)}g_objTagUtil.updateTagAttribute(a);g_objTableFlag.removeFlagInfo(g_objTable);c="";d=null;for(e=0;e<b.length;e++)if(0!=b[e].length){d=g_objTableUtil.getTableRowElement(g_objTable,e);c=d.getAttribute("height")?"<tr height='"+d.getAttribute("height")+"'>":"<tr height='"+d.offsetHeight+"'>";for(f=0;f<b[e].length;f++)g_objTableUtil.getTableCellElement(g_objTable,
e,b[e][f]),c+=g_objTableUtil.getTableCellElement(g_objTable,e,b[e][f]).outerHTML;c+="</tr>";this.copyData.push(c)}this.copyToNativeClipboard(a)}}catch(h){g_objCommonUtil.displayErrorAlert(h,"error:copyMultiCell")}},copyToNativeClipboard:function(a){try{if(!(null===this.copyData||1>this.copyData.length)){var b=g_objEditWindow[a].getSelection();if(!fnObjectCheckNull(b)){b.removeAllRanges();var c=document.createElement("div");c.id="dze_string_compare_dummy";c.style.position="absolute";c.style.left="-1000px";
c.style.top="-1000px";c.style.height="auto";g_objEditorDocument[a].body.appendChild(c);var d="";if("table_row"==this.copyType||"table_cell"==this.copyType){var e=g_objTable.outerHTML;d=e.substring(0,e.indexOf(">")+1);for(e=0;e<this.copyData.length;e++)d+=this.copyData[e];d+="</table>"}else"table_all"==this.copyType&&(d=dzeClipBoard.copyData[0]);c.innerHTML=d;var f=c.firstChild;f.width=this.copyTableWidth;for(d=0;d<f.rows.length;d++)for(e=0;e<f.rows[d].cells.length;e++){var g=g_objTableUtil.getTableCellElement(f,
d,e);g.removeAttribute("cusselyn");g.removeAttribute("bgcolor");g.removeAttribute("cusbgstyleyn");g.removeAttribute("cusflag");var h=g.getAttribute("cusoribgcolor");!1===fnObjectCheckNull(h)&&"transparent"!==h&&(g.style.backgroundColor=h);g.removeAttribute("cusoribgcolor")}b.selectAllChildren(c);g_objEditorDocument[a].execCommand("copy",!1,null);g_objEditorDocument[a].body.removeChild(c)}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"error:copyToNativeClipboard")}},paste:function(a){try{if(!0!==
this.dzeClipMode||!dzeClipBoard.copyData.length||""==dzeClipBoard.copyType)return!1;g_objTableFlag.ResetTableInfo(!1);g_objTableSelection.setTableObjectOnCaret(a);if("table_row"==dzeClipBoard.copyType||"table_cell"==dzeClipBoard.copyType){for(var b='<table width="'+this.copyTableWidth+'" cellspacing="0" cellpadding="1" style="border-collapse:collapse;">',c=0;c<dzeClipBoard.copyData.length;c++)b+=dzeClipBoard.copyData[c];b+="</table>"}else"table_all"==dzeClipBoard.copyType&&(b=dzeClipBoard.copyData[0]);
var d=document.createElement("div");d.innerHTML=b;var e=d.childNodes[0];if(!g_objTable)return insertHTMLCodeAtSelection(null,e,a),g_objUndoRedo.registerUndoRedoStack(0,a),!0;var f=g_objTableUtil.getTableCellsLength(e,0);d=null;for(c=b=0;c<f;c++)d=g_objTableUtil.getTableCellElement(e,0,c),b+=d.colSpan;var g=g_objTableUtil.getTableRowElement(g_objTable,0);f=0;d=null;for(c=0;c<g.cells.length;c++)d=g.cells[c],f+=d.colSpan;if(f!=b)return!1;var h=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,
g_nStartClick_Col),k=g_nStartClick_Row+(h.rowSpan-1);g_objTableUtil.getTableRowElement(g_objTable,k);var l=g_objTableUtil.getTableRowElement(g_objTable,k+1);for(g=0;l;){g++;if(1E3<g)break;l=g_objTableUtil.getTableRowElement(g_objTable,k+1);h=0;f=null;for(c=0;c<l.cells.length;c++)f=l.cells[c],h+=f.colSpan;if(h==b)break;k++;l=g_objTableUtil.getTableRowElement(g_objTable,k+1)}var m=g_objTableUtil.getTableRowElement(g_objTable,k);for(g=0;0<e.rows.length;){g++;if(100<g)break;m.nextSibling?m.parentNode.insertBefore(e.rows[0],
m.nextSibling):m.parentNode.appendChild(e.rows[0]);m=m.nextSibling}g_objUndoRedo.registerUndoRedoStack(0,a);return!0}catch(q){g_objCommonUtil.displayErrorAlert(q,"error:paste")}}};
function checkMoveCellForce(a,b){var c=!1,d=!1;try{var e=b.keyCode;switch(e){case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:if(!0===g_bBrowserType_WK||!0===g_bBrowserType_FF)c=!0;break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_TAB:c=!0;break;default:return!1}if(GetMultiCellSelection()||2==g_nFormEditMode)return!1;var f=g_objNodeUtil.getAncestorNodeOnCaret(a),g=g_objNodeUtil.getLoopParentElement(f,"td");if(!g)return!1;dzeUiConfig.bUseLockEditCellFunction&&g_objTableFunction.isNeighborCellLocked(g,
e)&&(g_bBrowserType_IE||g_bBrowserType_FF?d=c=!0:g_bBrowserType_WK&&ID_KEYCODE_TAB==e&&(d=c=!0));c&&e==ID_KEYCODE_ARROW_BOTTOM&&(c=checkNextMoveElementInTd(f));c&&e==ID_KEYCODE_ARROW_TOP&&(c=checkPrevMoveElementInTd(f));if(c&&e==ID_KEYCODE_ARROW_LEFT&&g_objEditWindow[a].getSelection){var h=g_objEditWindow[a].getSelection(),k=h.getRangeAt(0).cloneRange();k.setStart(g,0);var l=k.toString();if(!d&&0==l.length)return!1;l=l.replace(/\u200B/g,"");0<l.length&&0==!l&&(c=!1)}if(c&&e==ID_KEYCODE_ARROW_RIGHT&&
g_objEditWindow[a].getSelection){h=g_objEditWindow[a].getSelection();k=h.getRangeAt(0).cloneRange();k.setEnd(g,g.childNodes.length);l=k.toString();if(!d&&0==l.length)return!1;l=l.replace(/\u200B/g,"");0<l.length&&0==!l&&(c=!1)}return c}catch(m){return g_objCommonUtil.displayErrorAlert(m,"error:checkMoveCellForce"),c}}var nextMoveCnt=0;
function checkNextMoveElementInTd(a){var b=!0;try{nextMoveCnt++;if(100<nextMoveCnt)return nextMoveCnt=0,b;if("td"!=a.nodeName.toLowerCase())if(a.nextSibling){for(;a.nextSibling;)if(a.nextSibling.nodeType==ID_SELECTION_ELEMENT_NODE&&"b"!=a.nextSibling.nodeName.toLowerCase()&&"i"!=a.nextSibling.nodeName.toLowerCase()&&"u"!=a.nextSibling.nodeName.toLowerCase()&&"sub"!=a.nextSibling.nodeName.toLowerCase()&&"sup"!=a.nextSibling.nodeName.toLowerCase()&&"span"!=a.nextSibling.nodeName.toLowerCase()&&"strong"!=
a.nextSibling.nodeName.toLowerCase()&&"br"!=a.nextSibling.nodeName.toLowerCase()||a.nextSibling.nodeType==ID_SELECTION_TEXT_NODE&&""!=a.nextSibling.nodeValue.trim()){b=!1;break}else a=a.nextSibling;if(1==b)return checkNextMoveElementInTd(a.parentNode)}else return checkNextMoveElementInTd(a.parentNode);nextMoveCnt=0;return b}catch(c){return g_objCommonUtil.displayErrorAlert(c,"error:checkNextMoveElementInTd"),b}}
function checkPrevMoveElementInTd(a){var b=!0;try{nextMoveCnt++;if(100<nextMoveCnt)return nextMoveCnt=0,b;if("td"!=a.nodeName.toLowerCase())if(a.previousSibling){for(;a.previousSibling;)if(a.previousSibling.nodeType==ID_SELECTION_ELEMENT_NODE&&"b"!=a.previousSibling.nodeName.toLowerCase()&&"i"!=a.previousSibling.nodeName.toLowerCase()&&"u"!=a.previousSibling.nodeName.toLowerCase()&&"sub"!=a.previousSibling.nodeName.toLowerCase()&&"sup"!=a.previousSibling.nodeName.toLowerCase()&&"span"!=a.previousSibling.nodeName.toLowerCase()&&
"strong"!=a.previousSibling.nodeName.toLowerCase()&&"br"!=a.previousSibling.nodeName.toLowerCase()||a.previousSibling.nodeType==ID_SELECTION_TEXT_NODE&&""!=a.previousSibling.nodeValue.trim()){b=!1;break}else a=a.previousSibling;if(1==b)return checkPrevMoveElementInTd(a.parentNode)}else return checkPrevMoveElementInTd(a.parentNode);nextMoveCnt=0;return b}catch(c){return g_objCommonUtil.displayErrorAlert(c,"error:checkPrevMoveElementInTd"),b}}
function initializeDocFocus(a){try{var b=g_objEditorDocument[a].body;g_objEditorDocument[a].body.childNodes.length&&(b=g_objEditorDocument[a].body.childNodes[0]);duzon_dialog.setFocusElement(b,a,"start")}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:initializeDocFocus")}}
function applyTabKeyAction(a,b,c){try{var d=g_objNodeUtil.getAncestorNodeOnCaret(b);if(d){if(isApplyListStyleDepth()&&g_objNodeUtil.getLoopParentElement(d,"li"))!0===a?applyListStyleDepth("decrease",b,c):applyListStyleDepth("increase",b,c);else{var e=document.createElement("span");e.style.whiteSpace="pre";e.innerHTML="\t";insertHTMLCodeAtSelection(null,e,b)}g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(f){dalert(f)}}
function pasteOnefficeLink(a,b){try{if(!0===dzeUiConfig.bApplyPasteOnefficeLink){var c="";c=(a.clipboardData||window.clipboardData).getData("Text");if(""!=c&&/^http[s]*:\/\/(.*)\/oneffice\/oneffice\.do\?/i.test(c)){TBCancelBubbleEvent(a);var d=c;parseOpenGraphData(d,function(a){var c="ONEFFICE \ubb38\uc11c\uc785\ub2c8\ub2e4.";a&&a.title&&(c=a.title);a=document.createElement("div");a.style.width="250px";a.style.height="auto";a.style.backgroundColor="#ffffff";a.style.border="#d9d9d9 1px solid";a.style.borderRadius=
"7px";a.style.padding="0";a.setAttribute("contenteditable","false");var e=getFullUrlFromPath(dzeEnvConfig.strPath_Image+"oneffice/bi_oneffice_130.png"),h=getFullUrlFromPath(dzeEnvConfig.strPath_Image+"oneffice/ico_cloud_file.png");a.innerHTML="<div style='width:250px;padding: 30px 0;text-align:center;border-bottom-width:1px;border-bottom-color:#d9d9d9;border-bottom-style:solid;background-color:#f2f2f2;border-radius: 7px 7px 0 0' contenteditable='false' contenteditable='false'><a href=\""+d+"\" target=\"_blank\"><span style='padding:30px 50px;'><img src='"+
e+"' width='130' style='border:0;'/></span></a></div>";a.innerHTML+="<div style='width:auto;padding:10px;font-size:10pt;text-align:left;overflow:hidden;text-overflow: ellipsis;white-space:nowrap;line-height:1.5;font-weight:bold;'><img src='"+h+"' width='16' height='16' /> <a href=\""+d+'" target="_blank" title=\''+c+"' style='color:#1C90FB;font-weight:bold;'><span>"+c+"</span></a></div>";insertHTMLCodeAtSelection(a.outerHTML+"<p><br /></p>",null,b);g_objUndoRedo.registerUndoRedoStack(0,b)})}}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"pasteInsertImageFromClipboard error")}}
function parseOpenGraphData(a,b){if(a&&b)try{duzon_http.ajax({type:"post",url:dzeEnvConfig.strGetWebContentURL,async:!0,data:{remoteUrl:a},timeout:3E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){var c={title:"",description:"",image:"",type:""};if(""!=a&&(a=a.match(/[\s]*[\t]*<meta[\s]+[^>]*>[\s]*[\t]*/gi),null!=a&&a.length)){var e=document.createElement("head");e.innerHTML=a.join("");a=e.getElementsByTagName("meta");for(e=0;e<a.length;e++)if(a[e].getAttribute("property")&&
0==a[e].getAttribute("property").indexOf("og:")&&a[e].getAttribute("content")){var f=a[e].getAttribute("property").replace(/^og:/,"");c[f]=a[e].getAttribute("content")}}b(c)},error:function(a){g_objCommonUtil.displayErrorAlert(a,"error:parseOgData");b(null)}})}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:parseOpenGraphData"),b(null)}}
function checkDzeCellLocked(a,b){try{if(!0!==dzeUiConfig.bUseLockEditCellFunction||a.keyCode==ID_KEYCODE_ARROW_LEFT||a.keyCode==ID_KEYCODE_ARROW_TOP||a.keyCode==ID_KEYCODE_ARROW_RIGHT||a.keyCode==ID_KEYCODE_ARROW_BOTTOM||a.keyCode==ID_KEYCODE_TAB||a.ctrlKey&&!a.altKey&&!a.shiftKey&&(a.keyCode==ID_KEYCODE_Z||a.keyCode==ID_KEYCODE_Y))return!1;var c=g_objNodeUtil.getAncestorNodeOnCaret(b);if(!c)return!1;var d=g_objNodeUtil.getLoopParentElement(c,"td");return d?g_objTableFunction.isCellLocked(d):!1}catch(e){return g_objCommonUtil.displayErrorAlert(e,
"error:checkDzeCellLocked"),!1}}
function viewCellProtectStatus(a,b){try{if(!0===dzeUiConfig.bUseCellProtection){var c=a.srcElement?a.srcElement:a.target;if(c){var d=g_objNodeUtil.getLoopParentElement(c,"td");d?d.getAttribute("cellprotect")&&"true"==d.getAttribute("cellprotect")?(g_objEditorDocument[b].body.contentEditable=!1,g_objEditorDocument[b].body.style.cursor="not-allowed"):(g_objEditorDocument[b].body.contentEditable=!0,g_objEditorDocument[b].body.style.cursor=""):(g_objEditorDocument[b].body.contentEditable=!0,g_objEditorDocument[b].body.style.cursor=
"")}else g_objEditorDocument[b].body.contentEditable=!0,g_objEditorDocument[b].body.style.cursor=""}}catch(e){return g_objEditorDocument[b].body.contentEditable=!0,g_objEditorDocument[b].body.style.cursor="",g_objCommonUtil.displayErrorAlert(e,"error:viewCellProtectStatus"),!1}}
function setHyperlinkAuto(a,b){try{var c=!1;if(!0===b)var d=g_objCopyPaste.getPasteDiv(a);else{g_objCaretUtil.saveCaret();var e=g_objEditorDocument[a].getElementById(g_objCaretUtil.ID_CURRENT_CARET);d=e.previousSibling}checkHyperlinkableText=function(a){if(!(!0===fnObjectCheckNull(a)||"a"===a.nodeName.toLowerCase()||1>a.childNodes.length))for(var b,c=0;c<a.childNodes.length;c++)b=a.childNodes[c],"a"!==b.nodeName.toLowerCase()&&(b.nodeType===ID_SELECTION_TEXT_NODE?(setHyperlink(1,b),setHyperlink(2,
b),setHyperlink(3,b)):checkHyperlinkableText(b))};setHyperlink=function(d,e){try{switch(d){case 1:var f=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gi;break;case 2:f=/(www\.[\S]+(\b|$))/gi;break;case 3:f=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi}var g=e.nodeValue.match(f);if(!1===b){if(!0===fnObjectCheckNull(g)||1>g.length)d=2,f=/(www\.[\S]+(\b|$))/gi,g=e.nodeValue.match(f);if(!0===fnObjectCheckNull(g)||1>g.length)d=3,f=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi,g=e.nodeValue.match(f)}if(!(!0===
fnObjectCheckNull(g)||1>g.length))for(var h,q,n,r,p=g.length-1;0<=p;p--){q=g[p].trim();h=e.nodeValue;if(!1===b&&(h.length!==h.lastIndexOf(q)+q.length||p!==g.length-1))break;var t=h.lastIndexOf(q);if(0!==t){var u=h.charAt(t-1);if(!0===/^\s+$/.test(u))e.splitText(t),n=e.nextSibling;else continue}else n=e;1===d?h=n.nodeValue.replace(f,'<a href="$&" target="_self">$&</a>'):2===d?h=n.nodeValue.replace(f,'<a href="http://$&" target="_self">$&</a>'):3===d&&(h=n.nodeValue.replace(f,'<a href="mailto:$&">$&</a>'));
var v=g_objEditorDocument[a].createElement("a");r=g_objNodeUtil.getParentElement(n);r.insertBefore(v,n);r.removeChild(n);v.outerHTML=h;c=!0}}catch(w){g_objCommonUtil.displayErrorAlert(w,"setHyperlink")}};if(!1===fnObjectCheckNull(d))if(!0===b)checkHyperlinkableText(d);else if(d.nodeType===ID_SELECTION_TEXT_NODE){var f=d.nodeValue.charAt(d.nodeValue.length-1);!1===/^\s+$/.test(f)&&setHyperlink(1,d)}else checkHyperlinkableText(d)}catch(g){g_objCommonUtil.displayErrorAlert(g,"setHyperlinkAuto")}finally{!1===
b&&g_objCaretUtil.restoreCaret(),!1===c&&!1===fnObjectCheckNull(d)&&(d.nodeType===ID_SELECTION_TEXT_NODE?(d=g_objNodeUtil.getParentElement(d),!1===fnObjectCheckNull(d)&&d.normalize()):d.normalize())}}
function removeHyperlink(a){try{var b=g_objEditorDocument[a].getSelection();if(!(!0===fnObjectCheckNull(b)||0>=b.rangeCount)){var c=b.getRangeAt(0).cloneRange(),d=g_objNodeUtil.getSelectionElement_Anchor("A",!0,a);if(!0===fnObjectCheckNull(d))return!1;var e=d.firstChild;if(e.nodeType===ID_SELECTION_TEXT_NODE&&c.startOffset!==e.nodeValue.length)return b.removeAllRanges(),b.addRange(c),!1;fnHandler_SupportCommand_Main(a,ID_STRING_COMMAND_UNLINK);var f=g_objEditorDocument[a].createRange();e.nodeType===
ID_SELECTION_TEXT_NODE?(f.setStart(e,e.nodeValue.length),f.setEnd(e,e.nodeValue.length)):f=c;b.removeAllRanges();b.addRange(f);g_objUndoRedo.registerUndoRedoStack(0,a);return!0}}catch(g){g_objCommonUtil.displayErrorAlert(g,"removeHyperlink")}}function doBindExternalData(a,b){try{!0!==fnObjectCheckNull(b)&&doBind(a,b,null)}catch(c){g_objCommonUtil.displayErrorAlert(c,"doBindExternalData")}finally{duzon_http.hideLoading()}}
function doBind(a,b,c){try{var d=g_objEditorDocument[a],e=d.getElementsByClassName("dze_external_data_area"),f=null,g=null,h=null,k=null,l=null,m=null,q=0;if(!1===fnObjectCheckNull(b.ITEMS)){l=b.ITEMS;if(null!==c){m=Object.keys(c);for(var n=0;n<m.length;n++)l[m[n]]=c[m[n]]}m=Object.keys(l);for(var r=n=null,p=null,t=null,u=null,v=0;v<e.length;v++)if(f=e[v],k=f.getAttribute("mapping_key"),!1===fnObjectCheckNull(k)&&0!==k.length)for(var w=0;w<m.length;w++)if(m[w]===k){null!==c&&(n=g_objNodeUtil.getLoopParentElement(f,
DZE_HTMLOBJ_TD),null===p&&(p=g_objNodeUtil.getLoopParentElement(n,DZE_HTMLOBJ_TABLE),t=new TableMatrix(p)),r=t.getMatrixIndex(n),q=Math.max(q,r[r.length-1].row));h=f.parentNode;"_cardName_"===k||"_slipPop_"===k||"_attach_"===k||"_mngPop_"===k||"_slipCardName_"===k?(g=d.createElement("a"),u=!1===l[k].startsWith("http")?"http://"+l[k]:l[k],g.href=u,g.textContent=getTitleText(k)):(g=d.createElement("span"),g.style.fontFamily=f.style.fontFamily,g.style.fontSize=f.style.fontSize,g.textContent=l[k]);h.insertBefore(g,
f);h.removeChild(f);v--;break}}if(!1===fnObjectCheckNull(b.GROUP)){var x=b.GROUP;c=m=b=null;if(1<x.length&&(m=Object.keys(x[0].ITEMS),c=getCloneInfo(m,e),null===c))return;for(e=0;e<x.length;e++){b=x[e];if(!1===fnObjectCheckNull(b.ITEMS)||!1===fnObjectCheckNull(b.GROUP))q=doBind(a,b,l);e!==x.length-1&&(c.tableMatrix.makeMatrix(),g_objTableOperation.autoInsertNewRow(c.tableMatrix,q,c.colIndex,c.cloneCells.cloneNode(!0)))}}return q}catch(y){g_objCommonUtil.displayErrorAlert(y,"doBind")}}
function getCloneInfo(a,b){for(var c=null,d,e,f=1E4,g=0,h=1E4,k=0;k<a.length;k++)for(var l=0;l<b.length;l++)if(d=b[l],e=d.getAttribute("mapping_key"),!1===fnObjectCheckNull(e)&&0!==e.length&&e===a[k]){if(0===k){c=g_objNodeUtil.getLoopParentElement(d,DZE_HTMLOBJ_TABLE);if(null===c)return null;c=new TableMatrix(c)}d=g_objNodeUtil.getLoopParentElement(d,DZE_HTMLOBJ_TD);null!==d&&(d=c.getMatrixIndex(d),f=Math.min(f,d[0].row),g=Math.max(g,d[d.length-1].row),h=Math.min(h,d[0].col))}a=c.clone();g+1===a.nMaxRow-
1?a.removeRow(g+1):a.removeRow(g+1,a.nMaxRow-1);0===f-1?a.removeRow(f-1):a.removeRow(0,f-1);0<h&&a.removeCol(0,h-1);return{tableMatrix:c,cloneCells:a.table,colIndex:h}}function getTitleText(a){var b="";if("_attach_"===a)b="[\ucca8\ubd80\ud30c\uc77c]";else if("_cardName_"===a||"_slipPop_"===a||"_mngPop_"===a||"_slipCardName_"===a)b="[\uc0c1\uc138]";return b}
var g_objALinkMgr=new function(){this.getALink=function(a,b){try{var c=g_objNodeUtil;if(g_bBrowserType_CR&&!g_bBrowserType_EDGE){var d=a.composedPath();for(a=0;a<d.length;a++){var e=d[a];if(e&&"A"===e.nodeName)return e;if(c.isLoopBreakNode(e))break}}else return c.getLoopParentElement(b,"a");return null}catch(f){dalert(f)}};this.getEditorMode=function(){return!0};this.isBookmark=function(a){return 0==a.indexOf("#")?1:0};this.getTargetLink=function(a){return a.href.replace(document.location.href,"")};
this.getBookmarkName=function(a){return decodeURIComponent(a.replace("#",""))};this.getTargetInfo=function(a){try{if(!a)return 0;var b=g_objNodeUtil,c=a.offsetTop;if(!c)return 0;for(var d=a.offsetParent;d&&!b.isLoopBreakNode(d);){var e=d.offsetTop;e||(e=0);c+=e;d=d.offsetParent}return c}catch(f){dalert(f)}return 0};this.moveBmkPos=function(a,b,c,d){try{var e=a.getAttribute("name");if(null==e||""==e)return 2;if(e==b){var f=g_objALinkMgr.getTargetInfo(a);if(0<f){var g=g_objEditorDocument[d].body,h=
g.scrollTop,k=f-10;if(500<Math.abs(k-h)){var l=(k-h)/10,m=h+l;g.scrollTop=m;var q=0,n=setInterval(function(){q++;if(100<q)return clearInterval(n),g.scrollTop=k,1;m+=l;0<l&&m>k&&(m=k,clearInterval(n));0>l&&m<k&&(m=k,clearInterval(n));g.scrollTop=m},30)}else g.scrollTop=k;a.focus()}return 1}return 0}catch(r){dalert(r)}};this.goBookmarksPos=function(a,b,c){try{if("undefined"!=typeof b&&null!=b&&""!=b){null==a&&(a=g_objEditorDocument[c].body.getElementsByTagName("a"));for(var d=g_objALinkMgr.getEditorMode(),
e=0;e<a.length;e++)switch(g_objALinkMgr.moveBmkPos(a[e],b,d,c)){case 1:return}}}catch(f){dalert(f)}}};

var dzeVersion={version:"1.1.5.3"};

var commonUtil=function(){this.dpiDiv=null;commonUtil.prototype.displayErrorAlert=function(a,b){try{dzeEnvConfig.bDebugging&&alert(b+" :: "+a)}catch(c){}};commonUtil.prototype.log=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.log(a)}catch(b){}};commonUtil.prototype.dir=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.dir(a)}catch(b){}};commonUtil.prototype.afterFocusSetting_FF=function(a){try{g_objEditorDocument[a].body.focus()}catch(b){this.displayErrorAlert(b,
"afterFocusSetting_FF")}};commonUtil.prototype.openWindowCommon=function(a,b,c,d,f){try{var e,g=(screen.width-b)/2,h=(screen.height-c)/2;(e=window.open(a,f,d?"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+b+",height="+c+",top="+h+",left="+g:"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width="+b+",height="+c+",top="+h+",left="+g))&&4<=parseInt(navigator.appVersion)&&e.window.focus()}catch(k){this.displayErrorAlert(k,
"openWindowCommon")}};commonUtil.prototype.getTimeCodeString=function(){try{return(new Date).getTime()}catch(a){this.displayErrorAlert(a,"getTimeCodeString")}};commonUtil.prototype.getUniqueID=function(){try{return Math.random().toString(36).substr(2,9)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getUniqueID")}};commonUtil.prototype.checkIsHexColorCode=function(a){try{if(null==a||""==a)return!1;if("#"==a.charCodeAt(0))return!0}catch(b){this.displayErrorAlert(b,"checkIsHexColorCode")}return!1};commonUtil.prototype.checkIsRGBColorCode=
function(a){try{if(null==a||""==a)return!1;if("rgb"==a.substr(0,3).toLowerCase())return!0}catch(b){this.displayErrorAlert(b,"checkIsRGBColorCode")}return!1};commonUtil.prototype.convert_RGB_To_Hex=function(a){try{return(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):null}catch(b){this.displayErrorAlert(b,
"convert_RGB_To_Hex")}return null};commonUtil.prototype.getHexColorCode=function(a){try{return this.checkIsRGBColorCode(a)&&(a=this.convert_RGB_To_Hex(a)),a}catch(b){this.displayErrorAlert(b,"getHexColorCode")}return""};commonUtil.prototype.getHexColorCodeByNickName=function(a){try{var b=a.toLowerCase();return"black"==b?"#000000":"red"==b?"#ff0000":"windowtext"==b?"#000000":a}catch(c){this.displayErrorAlert(c,"getHexColorCodeByNickName")}return a};commonUtil.prototype.extractNumberValueUnit=function(a){try{if(null==
a||""==a)return null;var b=parseInt(a);if(isNaN(b))return null;if(b==a)return{nValue:a,strUnit:""};b=!0;for(var c="",d="",f=0;f<a.length;f++){var e=a.charAt(f);g_objCodeLexer.isWhite(e)||(b?g_objCodeLexer.isDigit(e)?c+=e:"."==e?c+=e:"-"==e?c+=e:(b=!1,d+=e):d+=e)}d=d.toLowerCase();"px"==d&&(d="");return{nValue:c,strUnit:d}}catch(g){this.displayErrorAlert(g,"extractNumberValueUnit")}return null};commonUtil.prototype.getNumberValue=function(a){try{return/^[0-9]+$/.test(a)?parseInt(a):null}catch(b){this.displayErrorAlert(b,
"getNumberValue")}return null};commonUtil.prototype.mappingFrom_Pt_To_Px=function(a){try{if(0==a)return 0;if(20>=g_nAdjustFromPtToPxRatio)return null;var b=parseInt(100*a/g_nAdjustFromPtToPxRatio);return 0==b?1:b}catch(c){this.displayErrorAlert(c,"mappingFrom_Pt_To_Px")}return null};commonUtil.prototype.convPxToPt=function(a){""==a&&(a=0);a=a.replace(/px/gi,"");if(!/^[0-9\.\-]+$/.test(a))return-1;a=parseInt(a,10);return Math.round(.75*a)};commonUtil.prototype.convPtToPx=function(a){""==a&&(a=0);a=
a.replace(/pt/gi,"");if(!/^[0-9\.\-]+$/.test(a))return-1;a=parseInt(a,10);return Math.round(a/.75)};commonUtil.prototype.convMMToPx=function(a){a=parseFloat(a);return a*this.getDPI()/25.4};commonUtil.prototype.convPxToMM=function(a){a=parseFloat(a);return 25.4*a/this.getDPI()};commonUtil.prototype.getDPI=function(){try{return this.dpiDiv=this.dpiDiv||document.getElementById("dpi"),this.dpiDiv||(g_objInsertUtil.insertLayerHTML('<div id="dpi" style="width: 1in; height: 1in; left: -100%; top: -100%; position: absolute;"></div>',
!1),this.dpiDiv=document.getElementById("dpi")),this.dpiDiv?this.dpiDiv.offsetHeight:1}catch(a){dalert(a)}};commonUtil.prototype.convPercentToPx=function(a,b){if(!a||!a.parentNode)return 0;var c=g_objPropertyUtil;c=c.getPadding(a.parentNode,c.LEFT)+c.getPadding(a.parentNode,c.RIGHT);return(a.parentNode.offsetWidth-c)*parseFloat(b)};commonUtil.prototype.convPxToPercent=function(a,b){if(!a||!a.parentNode)return 0;var c=g_objPropertyUtil;c=c.getPadding(a.parentNode,c.LEFT)+c.getPadding(a.parentNode,
c.RIGHT);return parseFloat(b)/(a.parentNode.offsetWidth-c)};this.IS_VALID_VALUE=function(a){try{return fnObjectCheckNull(a)||"object"==typeof a||"boolean"==typeof a?!1:!0}catch(b){this.displayErrorAlert(b,"IS_VALID_VALUE")}}},g_objCommonUtil=new commonUtil;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});
var startsWith=function(a,b,c){try{return a&&b?a.substring(!c||0>c?0:c,b.length)===b:!1}catch(d){dalert(d)}},endsWith=function(a,b,c){try{if(!a||!b)return!1;c=!c||c>a.length?a.length:c;return a.substring(c-b.length,c)}catch(d){dalert(d)}},inArray=function(a,b){for(var c in b)if(b[c]==a)return!0;return!1},inArrayIndex=function(a,b){for(var c in b)if(b[c]==a)return parseInt(c);return-1};
function getSelectionParentElement(a,b){b=b.toUpperCase();var c=null;if(window.attachEvent){a=g_objEditorDocument[a].selection.createRange();if(fnObjectCheckNull(a))return null;g_strBookmark_IE=a.getBookmark();if(a.moveToBookmark(g_strBookmark_IE))for(c=a.parentElement();c&&c.nodeName.toUpperCase()!=b;)c=c.parentElement}else c=getSelectionElement(b,!1,a);return c}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var $_=function(a){return duzon_dialog.objLayerDoc.getElementById(a)};
Number.prototype.setComma=function(){return this.toString().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.setComma=function(){return this.replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.removeComma=function(){return this.replace(/,/g,"")};Number.prototype.removeComma=function(){return this};function insertAfter(a,b){try{a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"insertAfter")}}
function checkNumber(a){try{return/^[0-9\-]*$/.test(a)?!0:!1}catch(b){return g_objCommonUtil.displayErrorAlert(b,"dze_menu_control.checkNumber"),!1}}
function changeCss(a,b,c,d,f){try{for(var e,g=0;g<d.styleSheets.length;g++)if(!(f&&d.styleSheets[g].href&&0>d.styleSheets[g].href.lastIndexOf(f)))try{d.styleSheets[g].insertRule(a+" { "+b+": "+c+"; }",d.styleSheets[g][e].length)}catch(k){try{d.styleSheets[g].addRule(a,b+": "+c+";")}catch(l){try{d.styleSheets[g].rules?e="rules":d.styleSheets[g].cssRules&&(e="cssRules");for(var h=0;h<d.styleSheets[g][e].length;h++)if(d.styleSheets[g][e][h].selectorText==a&&d.styleSheets[g][e][h].style[b]){d.styleSheets[g][e][h].style[b]=
c;break}}catch(m){}}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"error:changeCss")}}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",c=0;for(a=Base64._utf8_encode(a);c<a.length;){var d=a.charCodeAt(c++);var f=a.charCodeAt(c++);var e=a.charCodeAt(c++);var g=d>>2;d=(d&3)<<4|f>>4;var h=(f&15)<<2|e>>6;var k=e&63;isNaN(f)?h=k=64:isNaN(e)&&(k=64);b=b+Base64._keyStr.charAt(g)+Base64._keyStr.charAt(d)+Base64._keyStr.charAt(h)+Base64._keyStr.charAt(k)}return b},decode:function(a){var b="",c=0;for(a=a.replace(/[^A-Za-z0-9\+\/=]/g,
"");c<a.length;){var d=Base64._keyStr.indexOf(a.charAt(c++));var f=Base64._keyStr.indexOf(a.charAt(c++));var e=Base64._keyStr.indexOf(a.charAt(c++));var g=Base64._keyStr.indexOf(a.charAt(c++));d=d<<2|f>>4;f=(f&15)<<4|e>>2;var h=(e&3)<<6|g;b+=String.fromCharCode(d);64!=e&&(b+=String.fromCharCode(f));64!=g&&(b+=String.fromCharCode(h))}return b=Base64._utf8_decode(b)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):
(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b},_utf8_decode:function(a){var b="",c=0;for(c1=c2=0;c<a.length;){var d=a.charCodeAt(c);128>d?(b+=String.fromCharCode(d),c++):191<d&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3)}return b}};
window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));function getFullUrlFromPath(a){return 0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("//")?a:0==a.indexOf("/")?document.location.origin+a:document.location.href.substring(0,location.href.lastIndexOf("/"))+"/"+a}
function cloneSimpleObject(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function isShowScrollBar(a){try{return{vertical:g_objEditObject[a].scrollHeight<g_objEditorDocument[a].body.scrollHeight,horizontal:g_objEditObject[a].scrollWidth<g_objEditorDocument[a].body.scrollWidth}}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:isShowScrollBar")}}
function camelCase(a){return a.replace(/-([a-z])/ig,function(a,c){return c.toUpperCase()})}function parseStyle(a){try{if(!a||""==a)return null;var b={},c=a.split(";");a=0;for(var d=c.length;a<d;a++){var f=c[a].split(":");if(f&&""!=f&&2==f.length&&f[0]){var e=f[0].trim(),g=f[1].trim();e=camelCase(e);b[e]=g}}return b}catch(h){return g_objCommonUtil.displayErrorAlert(h,"parseStyle error"),null}}
function throttle(a,b,c){try{var d=a;c=Array.prototype.slice.call(arguments,2);clearTimeout(b.tId);b.tId=setTimeout(function(){b.apply(d,c)},1)}catch(f){dalert(f)}}function functionName(a){try{var b=a.toString();b=b.substr(9);return b=b.substr(0,b.indexOf("("))}catch(c){dalert(c)}}
function quoteFontFamily(a){try{if(""==a)return a;for(var b=/^["'].*["']$/,c=/[\t\n\f\r ]/g,d=a.split(","),f=0;f<d.length;f++){var e=d[f].trim();!b.test(e)&&c.test(e)?d[f]='"'+e+'"':d[f]=e}return d=d.join(", ")}catch(g){return g_objCommonUtil.displayErrorAlert(g,"quoteFontFamily"),a}}function dlog(a){dzeEnvConfig.bDebugging&&console.log(a)}
function dalert(a){if(dzeEnvConfig.bDebugging){try{throw Error();}catch(c){var b=c}b&&(b=b.stack.split("\n"),b.splice(0,2),b=b.join("\n"),console.log(a+" \n"+b),alert(a+" \n"+b))}}function toFloat(a,b){-1!=(a+"").indexOf(".")&&(a=a.toFixed(b),a=a.replace(/(0+$)/,""));return a};

var g_objPropertyUtil=new function(){this.arrOpacityValue="0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9".split(" ");this.arrFilterValue="alpha(opacity=0) alpha(opacity=10) alpha(opacity=20) alpha(opacity=30) alpha(opacity=40) alpha(opacity=50) alpha(opacity=60) alpha(opacity=70) alpha(opacity=80) alpha(opacity=90)".split(" ");this.LEFT=0;this.TOP=1;this.RIGHT=2;this.BOTTOM=3;this.applyFilterOpacityStyle=function(a,b,c){try{b?g_bBrowserType_IE?(a.style.opacity=this.arrOpacityValue[c],a.style.filter=window.attachEvent?
this.arrFilterValue[c]:this.arrOpacityValue[c]):a.style.opacity=this.arrOpacityValue[c]:g_bBrowserType_IE?(a.style.opacity="",a.style.filter=""):a.style.opacity=""}catch(e){g_objCommonUtil.displayErrorAlert(e,"applyFilterOpacityStyle")}};this.setFilterOpacityStyle=function(a,b){try{this.applyFilterOpacityStyle(a,b,3)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setFilterOpacityStyle")}};this.element_hasClass=function(a,b){try{var c=a.className;if(""!=c){var e=c.split(" ");for(a=0;a<e.length;a++)if(e[a]==
b)return!0}}catch(d){g_objCommonUtil.displayErrorAlert(d,"element_hasClass")}return!1};this.element_addClass=function(a,b){try{var c=a.className;if(""!=c)for(var e=c.split(" "),d=0;d<e.length;d++)if(e[d]==b)return;a.className=""==c?b:c+" "+b}catch(f){g_objCommonUtil.displayErrorAlert(f,"element_addClass")}};this.element_removeClass=function(a,b){try{var c="",e=!1,d=a.className;if(""!=d){var f=d.split(" ");for(d=0;d<f.length;d++)f[d]==b?e=!0:c=""==c?c+f[d]:c+(" "+f[d])}e&&(a.className=c)}catch(g){g_objCommonUtil.displayErrorAlert(g,
"element_removeClass")}};this.element_replaceClass=function(a,b,c){try{var e="",d=a.className;if(""!=d){var f=d.split(" ");for(d=0;d<f.length;d++)e=f[d]==b?""==e?e+c:e+(" "+c):""==e?e+f[d]:e+(" "+f[d]);a.className=e}}catch(g){g_objCommonUtil.displayErrorAlert(g,"element_replaceClass")}};this.getElementStyleAttributeValue=function(a,b,c){try{var e="";if(g_bBrowserType_IE)e=a.currentStyle.getAttribute(b);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)e=g_objEditWindow[c].getComputedStyle(a,
null).getPropertyValue(b);return e=null==e?"":e.toLowerCase()}catch(d){g_objCommonUtil.displayErrorAlert(d,"getElementStyleAttributeValue")}return""};this.setElementStyleAttributeValue=function(a,b,c){try{a.style.setProperty?a.style.setProperty(b,c,null):a.style.setAttribute(b,c)}catch(e){g_objCommonUtil.displayErrorAlert(e,"setElementStyleAttributeValue")}};this.getElementBorderStyleAttributeSet=function(a,b){try{var c=[];c[0]=this.getElementStyleAttributeValue(a,"border-left-width",b);c[1]=this.getElementStyleAttributeValue(a,
"border-left-style",b);c[2]=this.getElementStyleAttributeValue(a,"border-left-color",b);c[3]=this.getElementStyleAttributeValue(a,"border-top-width",b);c[4]=this.getElementStyleAttributeValue(a,"border-top-style",b);c[5]=this.getElementStyleAttributeValue(a,"border-top-color",b);c[6]=this.getElementStyleAttributeValue(a,"border-right-width",b);c[7]=this.getElementStyleAttributeValue(a,"border-right-style",b);c[8]=this.getElementStyleAttributeValue(a,"border-right-color",b);c[9]=this.getElementStyleAttributeValue(a,
"border-bottom-width",b);c[10]=this.getElementStyleAttributeValue(a,"border-bottom-style",b);c[11]=this.getElementStyleAttributeValue(a,"border-bottom-color",b);this.checkElementBorderWidthByNickName(c[0])&&(c[0]="1px");this.checkElementBorderWidthByNickName(c[3])&&(c[3]="1px");this.checkElementBorderWidthByNickName(c[6])&&(c[6]="1px");this.checkElementBorderWidthByNickName(c[9])&&(c[9]="1px");return c}catch(e){g_objCommonUtil.displayErrorAlert(e,"getElementBorderStyleAttributeSet")}return null};
this.checkElementBorderWidthByNickName=function(a){try{var b=a.toLowerCase();if("medium"==b||"thin"==b||"thick"==b||"initial"==b)return!0}catch(c){g_objCommonUtil.displayErrorAlert(c,"checkElementBorderWidthByNickName")}return!1};this.setElementBorderStyleAttributeSet=function(a,b){try{null!=b&&12==b.length&&(this.setElementStyleAttributeValue(a,"border-left-width",b[0]),this.setElementStyleAttributeValue(a,"border-left-style",b[1]),this.setElementStyleAttributeValue(a,"border-left-color",b[2]),this.setElementStyleAttributeValue(a,
"border-top-width",b[3]),this.setElementStyleAttributeValue(a,"border-top-style",b[4]),this.setElementStyleAttributeValue(a,"border-top-color",b[5]),this.setElementStyleAttributeValue(a,"border-right-width",b[6]),this.setElementStyleAttributeValue(a,"border-right-style",b[7]),this.setElementStyleAttributeValue(a,"border-right-color",b[8]),this.setElementStyleAttributeValue(a,"border-bottom-width",b[9]),this.setElementStyleAttributeValue(a,"border-bottom-style",b[10]),this.setElementStyleAttributeValue(a,
"border-bottom-color",b[11]))}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElementBorderStyleAttributeSet")}};this.getElementBorderStyleAttributeValue=function(a,b,c){try{var e=this.getElementStyleAttributeValue(a,b,c);if(""==e||null==e||ID_STRING_NAME_UNDEFINED==e)return"";if(this.checkElementBorderWidthByNickName(e))return 1;var d=g_objCommonUtil.getNumberValue(e);return null==d?"":d}catch(f){g_objCommonUtil.displayErrorAlert(f,"getElementBorderStyleAttributeValue")}return""};this.getTargetCellFlag=
function(a,b){try{var c=a.getAttribute(b);return null==c||""==c?null:parseInt(c)}catch(e){g_objCommonUtil.displayErrorAlert(e,"getTargetCellFlag")}};this.setTargetCellFlag=function(a,b,c){try{a.setAttribute(b,c)}catch(e){g_objCommonUtil.displayErrorAlert(e,"setTargetCellFlag")}};this.getTargetCellFlagString=function(a,b){try{return a.getAttribute(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTargetCellFlagString")}};this.setTargetCellFlagString=function(a,b,c){try{a.setAttribute(b,c)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"setTargetCellFlagString")}};this.getDocumentOverFlow=function(a){try{a="";var b=g_objPositionUtil.getDocumentElementObject(!1);if(b)return a=b.style.overflow}catch(c){g_objCommonUtil.displayErrorAlert(c,"getDocumentOverFlow")}return""};this.setDocumentOverFlow=function(a,b){try{var c=g_objPositionUtil.getDocumentElementObject(!1);c&&(c.style.overflow=b)}catch(e){g_objCommonUtil.displayErrorAlert(e,"setDocumentOverFlow")}};this.checkStyleValues=function(a,b){try{a[0]=this.checkStyleFontValue(a[0]);
a[1]=this.checkStyleFontSize(a[1]);a[4]=this.checkStyleLetterSpacingValue(a[4]);a[5]=this.checkStyleLineHeightValue(a[5],a[16],b);if(1==a[11])for(var c=0;c<a[22].length;c++)a[22][c]=this.checkStyleFontValue(a[22][c]);if(1==a[12])for(c=0;c<a[23].length;c++)a[23][c]=this.checkStyleFontSize(a[23][c]);if(1==a[15])for(c=0;c<a[26].length;c++)a[26][c]=this.checkStyleLetterSpacingValue(a[26][c]);if(1==a[16])for(c=0;c<a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c]);if(1==a[16])for(c=0;c<
a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c])}catch(e){g_objCommonUtil.displayErrorAlert(e,"error:checkStyleValues")}};this.checkStyleLineHeightValue=function(a,b,c){try{if("undefined"==typeof a||null==a)a="";if("undefined"==typeof b||1!=b)b=!1;if(0<=a.toLowerCase().indexOf("px")||0<=a.toLowerCase().indexOf("pt")){var e=null;if(window.addEventListener){var d=g_objEditWindow[c].getSelection();1==d.rangeCount&&(e=d.getRangeAt(0))}else d=g_objEditorDocument[c].selection,fnObjectCheckNull(d)||
(e=d.createRange());if(!fnObjectCheckNull(e)&&(c=null,c="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0],"undefined"!=typeof c&&null!=c)){var f=g_objNodeUtil.getLoopParentElement(c,"td");null!=f&&(a=f.style.lineHeight,"undefined"==typeof a||null==a)&&(a="")}}""==a?0==b&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight):((0<=a.toLowerCase().indexOf("px")||0<=a.toLowerCase().indexOf("pt"))&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight),0<=a.indexOf("%")&&(a=
parseInt(a.replace(/%/g,""),10)/100),"string"!=typeof a&&(a=a.toString()),a=a.replace(/[^0-9\.]/g,""));return a}catch(g){return""}};this.checkStyleFontValue=function(a){try{if("undefined"==typeof a||null==a)a="";""!=a&&(a=a.toLowerCase());return a}catch(b){return""}};this.checkStyleFontSize=function(a){try{if("undefined"==typeof a||null==a)a="";0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),a=0>a?"":a+"pt");return a}catch(b){return""}};this.checkStyleLetterSpacingValue=function(a){try{if("string"!=
typeof a)return a;a=a.toLowerCase();0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),a=0>a?"":a+"pt");return a}catch(b){return""}};this.getSelectionAttributeValue_MultiCell=function(a){try{if(-1==a||!GetMultiCellSelection())return null;for(var b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]],c={},e=g_objTable,d=0;d<e.rows.length;d++){var f=g_objTableUtil.getTableCellsLength(e,d);for(j=0;j<f;j++){var g=g_objTableFlag.GetCellAttribute_Flag(e,
d,j);if(2==g||3==g||4==g){var h=g_objTableUtil.getTableCellElement(e,d,j),l=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];c.nDepth=0;c.nTranCount=0;if(!this.getNodeAttributeValue_MultiCell(h,l,c,a))return null;0!=c.nTranCount&&this.checkCompareAttributeValue(b,l,!0,!1)}}}b[0]=this.checkStyleFontValue(b[0]);b[1]=this.checkStyleFontSize(b[1]);b[5]=this.checkStyleLineHeightValue(b[5],!1,a);return b}catch(k){g_objCommonUtil.displayErrorAlert(k,
"getSelectionAttributeValue_MultiCell")}return null};this.getNodeAttributeValue_MultiCell=function(a,b,c,e){try{c.nDepth++;for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){if(!this.getNodeAttributeValue_MultiCell(f,b,c,e))return!1}else if(ID_SELECTION_TEXT_NODE==f.nodeType){c.nTranCount++;var g="",h=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];g=this.getElementStyleAttributeValue(a,
"font-family",e);g=this.getElementStyleAttributeFisrtValue(g);h[0]=g;g=this.getElementStyleAttributeValue(a,"font-size",e);h[1]=g;g=this.getElementStyleAttributeValue(a,"color",e);h[2]=g;g=this.getElementStyleAttributeValue(a,"letter-spacing",e);h[4]=g;g=this.getElementStyleAttributeValue(a,"line-height",e);h[5]=g;this.checkCompareAttributeValue(b,h,!0,!1)}}c.nDepth--;return!0}catch(l){g_objCommonUtil.displayErrorAlert(l,"getNodeAttributeValue_MultiCell")}return!1};this.getSelectionAttributeValue=
function(a,b){try{if(-1==a)return null;var c=[];b="undefined"!=typeof b&&!0===b?33:11;var e=this.doGetSelectionAttributeValue(a);if(null==e){for(var d=0;d<b;d++)c[d]="";return c}for(d=0;d<b;d++)c[d]=e[d],null==c[d]&&(c[d]="");this.checkStyleValues(c,a);return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getSelectionAttributeValue")}};this.doGetSelectionAttributeValue=function(a){try{if(-1==a)return;var b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],
[],[],[],[],[],[],[],[],[],[]];if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[a].selection.type.toLowerCase())return;var c=g_objEditorDocument[a].selection,e=c.createRange(),d=e.parentElement();if(""==e.text){var f=this.checkTargetNodeName(d);return this.getNodeAttributeValueDetail(d,!0,f,a)}var g=!1,h=!1;"p"==d.nodeName.toLowerCase()&&(d=this.getSelectionParentNode(d,c,e));for(var l=0;l<d.childNodes.length;l++){var k=d.childNodes[l];if(ID_SELECTION_ELEMENT_NODE==k.nodeType&&
ID_SELECTION_ELEMENT_NODE==k.nodeType){var r=c.createRange();r.moveToElementText(k);r.collapse(!0);var t=c.createRange();t.moveToElementText(k);t.collapse(!1);var v=e.inRange(r),w=e.inRange(t);if(g)if(v){if(n=this.getNodeAttributeValue(k,b,a),!n)return null}else{h=!0;break}else if(w&&(g=!0),v||w){var n=this.getNodeAttributeValue(k,b,a);if(!n)return null}}}if(!g||!h){f=this.checkTargetNodeName(d);var m=this.getNodeAttributeValueDetail(d,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,
m,!0,f)}return b}c=g_objEditWindow[a].getSelection();if(1!=c.rangeCount)return;e=c.getRangeAt(0);c=!1;d=e.commonAncestorContainer;e.collapsed?c=!0:ID_SELECTION_TEXT_NODE==d.nodeType&&(c=!0);if(c)return ID_SELECTION_ELEMENT_NODE!=d.nodeType&&(d=g_objNodeUtil.getParentElement(d)),f=this.checkTargetNodeName(d),this.getNodeAttributeValueDetail(d,!0,f,a);g=!1;h=g_objEditorDocument[a].createRange();var u=[];g_objNodeUtil.traverseNodesInRange(e,function(a){!1===fnObjectCheckNull(a)&&a.nodeType===ID_SELECTION_TEXT_NODE&&
u.push(a)});for(l=0;l<u.length;l++)if(k=u[l],h.selectNode(k),g)if(q=e.compareBoundaryPoints(Range.START_TO_END,h),0==q||-1==q)break;else if(ID_SELECTION_ELEMENT_NODE==k.nodeType){if(n=this.getNodeAttributeValue(k,b,a),!n)return null}else{if(ID_SELECTION_TEXT_NODE==k.nodeType)if(p=g_objNodeUtil.getParentElement(k),f=this.checkTargetNodeName(p),checkTextNodeAllWhiteCode(k.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(p,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else{m=
this.getNodeAttributeValueDetail(p,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}}else{var q=e.compareBoundaryPoints(Range.END_TO_START,h);if(-1==q)if(g=!0,ID_SELECTION_ELEMENT_NODE==k.nodeType){if(n=this.getNodeAttributeValue(k,b,a),!n)return null}else if(ID_SELECTION_TEXT_NODE==k.nodeType){var p=g_objNodeUtil.getParentElement(k);f=this.checkTargetNodeName(p);if(checkTextNodeAllWhiteCode(k.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(p,!1,f,a);if(null==m)return!1;
this.checkCompareAttributeValue(b,m,!1,f)}}else if(b=this.getNodeAttributeValueDetail(p,!0,f,a),null==b)return null}}return b}catch(x){g_objCommonUtil.displayErrorAlert(x,"doGetSelectionAttributeValue")}return null};this.getSelectionParentNode=function(a,b,c){try{var e=b.createRange();e.moveToElementText(a);return e.inRange(c)?a:g_objNodeUtil.getParentElement(a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"getSelectionParentNode")}};this.getNodeAttributeValue=function(a,b,c){try{for(var e="",d=0;d<
a.childNodes.length;d++){var f=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){if(!this.getNodeAttributeValue(f,b,c))return!1}else ID_SELECTION_TEXT_NODE==f.nodeType&&(e+=f.nodeValue)}if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var g=this.checkTargetNodeName(a);if(checkTextNodeAllWhiteCode(e)){if(g){var h=this.getNodeAttributeValueDetail(a,!1,g,c);if(null==h)return!1;this.checkCompareAttributeValue(b,h,!1,g)}return!0}h=this.getNodeAttributeValueDetail(a,!0,g,c);if(null==h)return!1;this.checkCompareAttributeValue(b,
h,!0,g)}return!0}catch(l){g_objCommonUtil.displayErrorAlert(l,"getNodeAttributeValue")}return!1};this.checkCompareAttributeValue=function(a,b,c,e){try{for(var d=0;11>d;d++)"undefined"==typeof a[d+11+11]&&(a[d+11+11]=[]),a[d+11+11].push(b[d]),a[d+11]&&!0!==g_getSelectionAttribute_Absolute?a[d]="":null==a[d]?6>d?c&&(a[d]=b[d]):e&&(a[d]=b[d]):6>d?c&&a[d]!=b[d]&&(a[d]=!0!==g_getSelectionAttribute_Absolute?"":b[d],a[d+11]=!0):e&&a[d]!=b[d]&&(a[d]=!0!==g_getSelectionAttribute_Absolute?"":b[d],a[d+11]=!0)}catch(f){g_objCommonUtil.displayErrorAlert(f,
"checkCompareAttributeValue")}};this.getNodeAttributeValueDetail=function(a,b,c,e){try{var d=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];if("undefined"==typeof a||null==a||"undefined"==typeof a.style||null==a.style)return d;for(var f=0;11>f;f++){var g="";if(0==f)b&&(g=a.style.fontFamily,""==g&&(g=this.getElementStyleAttributeValue(a,"font-family",e),g=this.getElementStyleAttributeFisrtValue(g)));else if(1==f)b&&(g=a.style.fontSize,
""==g&&(g=this.getElementStyleAttributeValue(a,"font-size",e)));else if(2==f)b&&(g=a.style.color,""==g&&(g=this.getElementStyleAttributeValue(a,"color",e)),g=g_objCommonUtil.getHexColorCode(g));else if(3==f){if(b)try{g=a.style.backgroundColor;if(""==g)for(var h=a,l=0;"undefined"!=typeof h&&null!=h&&"body"!=h.nodeName.toLowerCase();){if(("span"==h.nodeName.toLowerCase()||"p"==h.nodeName.toLowerCase())&&h.getAttribute("style")&&h.style.backgroundColor){g=h.style.backgroundColor;break}l++;if(10<l)break;
h=h.parentNode}g=g_objCommonUtil.getHexColorCode(g)}catch(k){g=""}}else 4==f?b&&(g=a.style.letterSpacing,""==g&&(g=this.getElementStyleAttributeValue(a,"letter-spacing",e))):5==f?b&&(g=a.style.lineHeight,""==g&&(g=this.getElementStyleAttributeValue(a,"line-height",e))):6==f?c&&(g=a.style.marginLeft):7==f?c&&(g=a.style.marginTop):8==f?c&&(g=a.style.marginRight):9==f?c&&(g=a.style.marginBottom):10==f&&c&&(g=a.style.textIndent);d[f]=g}return d}catch(k){g_objCommonUtil.displayErrorAlert(k,"getNodeAttributeValueDetail")}return null};
this.getElementStyleAttributeFisrtValue=function(a){try{var b=a.split(",");if(0==b.length)return"";if(1==b.length)return a;var c=b[0].trim();return c=c.replace(/(")/g,"")}catch(e){g_objCommonUtil.displayErrorAlert(e,"getElementStyleAttributeFisrtValue")}};this.checkTargetNodeName=function(a){try{var b=this.checkNodeName(a,"p");b||(b=this.checkNodeName(a,"h1"));b||(b=this.checkNodeName(a,"h2"));b||(b=this.checkNodeName(a,"h3"));b||(b=this.checkNodeName(a,"h4"));b||(b=this.checkNodeName(a,"h5"));b||
(b=this.checkNodeName(a,"h6"));return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"checkTargetNodeName")}return!1};this.checkNodeName=function(a,b){try{b=b.toLowerCase();var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if(b==c)return!0}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkNodeName")}return!1};this.removeStyleAttribute=function(a,b){try{a.style.removeAttribute?a.style.removeAttribute(b):a.style.removeProperty&&a.style.removeProperty(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,
"removeStyleAttribute")}};this.getBackgroundImageURL=function(a){try{var b=a.style.backgroundImage;""!=b&&(a=b,a.toLowerCase(),-1!=a.indexOf("url(")&&(b=a.substring(4,a.length-1)));'"'==b[0]&&'"'==b[b.length-1]&&(b=b.substring(1,b.length-1));return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getBackgroundImageURL")}return""};this.getElement_Align=function(a){try{var b=a.align;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getElement_Align")}return null};
this.setElement_Align=function(a,b){try{fnObjectCheckNull(b)||(""==b?(a.align="",a.removeAttribute("align")):a.align=b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_Align")}};this.getElement_TextAlign=function(a){try{var b=a.style.textAlign;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getElement_TextAlign")}return null};this.setElement_TextAlign=function(a,b){try{fnObjectCheckNull(b)||(a.style.textAlign=""==b?"":b)}catch(c){g_objCommonUtil.displayErrorAlert(c,
"setElement_TextAlign")}};this.getElement_BorderWidth_With_Unit=function(a,b){try{var c="";"left"==b?c=a.style.borderLeftWidth:"top"==b?c=a.style.borderTopWidth:"right"==b?c=a.style.borderRightWidth:"bottom"==b&&(c=a.style.borderBottomWidth);return""==c||null==c||ID_STRING_NAME_UNDEFINED==c?{nValue:0,strUnit:""}:this.checkElementBorderWidthByNickName(c)?{nValue:1,strUnit:"px"}:g_objCommonUtil.extractNumberValueUnit(c)}catch(e){g_objCommonUtil.displayErrorAlert(e,"getElement_BorderWidth_With_Unit")}return null};
this.getElement_BGColor=function(a){try{var b=a.style.backgroundColor;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)if(b=a.bgColor,""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getElement_BGColor")}return""};this.setElement_BGColor=function(a,b){try{"-1"==b||""==b||"null"==b?(a.bgColor="",a.style.backgroundColor="",a.removeAttribute("bgColor"),a.style.removeAttribute?a.style.removeAttribute("backgroundColor"):a.style.removeProperty&&a.style.removeProperty("backgroundColor")):
(a.bgColor=b,a.style.backgroundColor=b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_BGColor")}};this.setElement_BorderLeftColor=function(a,b){try{"-1"==b||""==b?(a.style.borderLeftColor="",a.style.removeAttribute?a.style.removeAttribute("borderLeftColor"):a.style.removeProperty&&a.style.removeProperty("borderLeftColor")):a.style.borderLeftColor=b}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_BorderLeftColor")}};this.setElement_BorderTopColor=function(a,b){try{"-1"==b||""==
b?(a.style.borderTopColor="",a.style.removeAttribute?a.style.removeAttribute("borderTopColor"):a.style.removeProperty&&a.style.removeProperty("borderTopColor")):a.style.borderTopColor=b}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_BorderTopColor")}};this.setElement_BorderRightColor=function(a,b){try{"-1"==b||""==b?(a.style.borderRightColor="",a.style.removeAttribute?a.style.removeAttribute("borderRightColor"):a.style.removeProperty&&a.style.removeProperty("borderRightColor")):a.style.borderRightColor=
b}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_BorderRightColor")}};this.setElement_BorderBottomColor=function(a,b){try{"-1"==b||""==b?(a.style.borderBottomColor="",a.style.removeAttribute?a.style.removeAttribute("borderBottomColor"):a.style.removeProperty&&a.style.removeProperty("borderBottomColor")):a.style.borderBottomColor=b}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElement_BorderBottomColor")}};this.setElement_BorderStyle=function(a,b,c){try{fnObjectCheckNull(b)&&(b=""),"left"==
c?a.style.borderLeftStyle=b:"top"==c?a.style.borderTopStyle=b:"right"==c?a.style.borderRightStyle=b:"bottom"==c&&(a.style.borderBottomStyle=b)}catch(e){g_objCommonUtil.displayErrorAlert(e,"setElement_BorderStyle")}};this.getElementPaddingStyleAttributeSet=function(a,b){try{var c=[];c[0]=this.getElementStyleAttributeValue(a,"padding-left",b);c[1]=this.getElementStyleAttributeValue(a,"padding-top",b);c[2]=this.getElementStyleAttributeValue(a,"padding-right",b);c[3]=this.getElementStyleAttributeValue(a,
"padding-bottom",b);return c}catch(e){g_objCommonUtil.displayErrorAlert(e,"getElementPaddingStyleAttributeSet")}return null};this.getPadding=function(a,b){try{if(!a||a.nodeType!=ID_SELECTION_ELEMENT_NODE)return 0;var c=g_objCommonUtil,e=this.LEFT,d=this.BOTTOM,f=[];"undefined"!=typeof b&&(d=e=b);for(b=e;b<=d;b++){e="";switch(b){case this.LEFT:e=a.style.paddingLeft;break;case this.TOP:e=a.style.paddingTop;break;case this.RIGHT:e=a.style.paddingRight;break;case this.BOTTOM:e=a.style.paddingBottom}var g=
c.extractNumberValueUnit(e);g=g?"pt"==g.strUnit?c.convPtToPx(g.nValue):parseFloat(g.nValue):0;f.push(parseFloat(g.toFixed(2)))}return 1==f.length?f[0]:f}catch(h){g_objCommonUtil.displayErrorAlert(h,"util_property.getPadding")}};this.setElementPaddingStyleAttributeSet=function(a,b){try{null!=b&&4==b.length&&(this.setElementStyleAttributeValue(a,"padding-left",b[0]),this.setElementStyleAttributeValue(a,"padding-top",b[1]),this.setElementStyleAttributeValue(a,"padding-right",b[2]),this.setElementStyleAttributeValue(a,
"padding-bottom",b[3]))}catch(c){g_objCommonUtil.displayErrorAlert(c,"setElementPaddingStyleAttributeSet")}};this.getStyleStringByOption=function(a,b,c){try{var e=a.getAttribute("style");e=e.trim();var d=e.split(";");for(a=0;a<d.length;a++)if(""==d[a])d.splice(a,1),a--;else{var f=d[a].split(":");if(2==f.length){var g=f[0].trim().toLowerCase();b&&"width"==g?(d.splice(a,1),a--):c&&"height"==g&&(d.splice(a,1),a--)}else d.splice(a,1),a--}b="";for(a=0;a<d.length;a++)b+=d[a],b+=";";return b}catch(h){g_objCommonUtil.displayErrorAlert(h,
"getStyleStringByOption")}return""};this.getTextContent=function(a){try{var b="";a.innerText?b=a.innerText:a.textContent&&(b=a.textContent);return b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTextContent")}return""};this.setSkinColorSet=function(a){try{g_arrSkinColor.length&&"blue"!=g_arrSkinColor[0]&&("undefined"==typeof a&&(a=document),changeCss(".duzon_menubar_title_over","background-color",g_arrSkinColor[1],a),changeCss(".duzon_menubar_title_down","background-color",g_arrSkinColor[1],a),
changeCss(".duzon_menubar_title_up","background-color",g_arrSkinColor[1],a),changeCss(".duzon_menubar_line","background-color",g_arrSkinColor[2],a),changeCss(".duzon_menubar_title","background-color",g_arrSkinColor[2],a),changeCss(".duzon_dialog_title","background-color",g_arrSkinColor[2],a),changeCss(".dze_extdlg_title_container","background-color",g_arrSkinColor[2],a),!0===dzeUiConfig.bUseUiMode&&g_arrSkinColor[3]&&(changeCss(".duzon_tb_button_over_ribbon","background-color",g_arrSkinColor[3],document),
changeCss(".duzon_tb_button_down_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_button_up_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_over_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_down_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_up_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_arrow_over_ribbon","background-color",
g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_arrow_down_ribbon","background-color",g_arrSkinColor[3],document)))}catch(b){g_objCommonUtil.displayErrorAlert(b,"setSkinColorSet")}};this.getStyleWidth=function(a){try{if(!a)return 0;var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.width);if(!c)return 0;var e=parseFloat(c.nValue),d=c.strUnit;return""==d||"px"==d?e:"pt"==d?b.convPtToPx(e):"mm"==d?b.convMMToPx(e):0}catch(f){dalert(f)}};this.getStyleHeight=function(a){try{if(!a)return 0;
var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.height);if(!c)return 0;var e=parseFloat(c.nValue),d=c.strUnit;return""==d||"px"==d?e:"pt"==d?b.convPtToPx(e):"mm"==d?b.convMMToPx(e):0}catch(f){dalert(f)}}};

var g_objNodeUtil=new function(){this.getChildrenCollection=function(a){try{var b=null;return b=window.attachEvent?a.children:a.childNodes}catch(c){g_objCommonUtil.displayErrorAlert(c,"getChildrenCollection")}return null};this.getSelectionElement_Anchor=function(a,b,c){try{if(window.attachEvent)return null;var d=g_objEditWindow[c].getSelection();if(0==d.rangeCount)return;var e=d.getRangeAt(0),f=null,g=e.startContainer;g_bBrowserType_IE&&g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&
"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase()&&(g=g_objObjectSelectionInfo.objSelectionObject);for(;g;){if(a==g.nodeName.toUpperCase()){f=g;break}g=g.parentNode}if(!f)if(g_bBrowserType_IE){if(g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase())return null;var h=e.commonAncestorContainer,k=g_objEditorDocument[c].createRange();for(c=0;c<h.childNodes.length;c++){var l=
h.childNodes[c];k.selectNode(l);var m=e.compareBoundaryPoints(Range.START_TO_START,k);if((0==m||-1==m)&&a==l.nodeName.toUpperCase()){f=l;break}}if(!f)return null}else return null;b&&(g_bBrowserType_FF?e.selectNode(f):(g_bBrowserType_IE||g_bBrowserType_WK||g_bBrowserType_OP)&&d.selectAllChildren(f));return f}catch(n){g_objCommonUtil.displayErrorAlert(n,"getSelectionElement_Anchor")}return null};this.getElementTagName=function(a){try{if(window.attachEvent){if("undefined"!=typeof a.tagName)return a.tagName;
if("undefined"!=typeof a.nodeName)return a.nodeName}else return a.nodeName}catch(b){g_objCommonUtil.displayErrorAlert(b,"getElementTagName")}return null};this.getLoopChildNodeByTagName=function(a,b){try{for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(b==this.getElementTagName(d).toLowerCase())return d;var e=this.getLoopChildNodeByTagName(d,b);if(e)return e}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getLoopChildNodeByTagName")}return null};
this.getLoopChildNodeByTagNames=function(a,b){try{for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(inArray(this.getElementTagName(d).toLowerCase(),b))return d;var e=this.getLoopChildNodeByTagName(d,b);if(e)return e}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getLoopChildNodeByTagNames")}return null};this.getImmediateChildNodesByTagName=function(a,b){try{if(!a)return[];for(var c=[],d=a.childNodes.length,e=0;e<d;e++)this.checkTagName(a.childNodes[e],
b)&&c.push(a.childNodes[e]);return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getImmediateChildNodesByTagName")}};this.getParentElement=function(a){try{return!0===fnObjectCheckNull(a)?null:window.attachEvent?"undefined"!=typeof a.parentElement?a.parentElement:a.parentNode:a.parentNode}catch(b){g_objCommonUtil.displayErrorAlert(b,"getParentElement")}return null};this.getCheckElementTagName=function(a){a=g_objNodeUtil.getElementTagName(a);return"undefined"==typeof a||null==a?null:a=a.toLowerCase()};
this.CheckTagName=function(a,b,c){for(var d=0;d<b;d++){var e=a[d].check.toLowerCase();if("undefined"==typeof e||null==e)return null;if(e==c)return d}return-1};this.checkTagName=function(a){try{if(!a||!a.tagName)return null;for(var b=a.tagName.toLowerCase(),c=1;c<arguments.length;c++)if(b==arguments[c])return a;return null}catch(d){g_objCommonUtil.displayErrorAlert(d,"g_objNodeUtil.checkTagName")}};this.getParentElementForTargetTags=function(a,b,c){try{if(null==a||0==c||a.nodeType!=ID_SELECTION_TEXT_NODE||
"undefined"==typeof b)return null;for(;;){var d=g_objNodeUtil.getCheckElementTagName(a);if(null==d)break;var e=g_objNodeUtil.CheckTagName(b,c,d);if(0==e||1==e||2==e)return a;if(-1==e){var f=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(f))break;a=f}else if(d==DZE_HTMLOBJ_BODY)break}}catch(g){g_objCommonUtil.displayErrorAlert(g,"getLoopParentElement")}return null};this.getLoopParentElement=function(a,b){try{if(null==a||"undefined"==typeof b||null==b)return null;var c=b.toLowerCase(),d=g_objNodeUtil.getElementTagName(a);
if("undefined"==typeof d||null==d)return null;if(c==d.toLowerCase())return a;for(;;){var e=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(e))break;d=g_objNodeUtil.getElementTagName(e);if(c==d.toLowerCase())return e;a=e;if(fnObjectCheckNull(a))break}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getLoopParentElement")}return null};this.addOptionForSelectBox=function(a,b,c){try{var d=document.createElement("option");d.value=b;d.text=c;window.attachEvent?a.add(d):a.add(d,null)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"addOptionForSelectBox")}};this.getNodeWidthHeight=function(a,b){try{var c=!1,d=null,e="",f="";f=b?a.style.width:a.style.height;if(""!=f&&null!=f){var g=g_objCommonUtil.extractNumberValueUnit(f);null!=g&&(c=!0,d=g.nValue,e=g.strUnit)}c||(f=b?a.width:a.height,""!=f&&null!=f&&(g=g_objCommonUtil.extractNumberValueUnit(f),null!=g&&(d=g.nValue,e=g.strUnit)));d=null!=d&&""!=d?parseInt(d):null;return{styleValue:c,nValue:d,strUnit:e}}catch(h){g_objCommonUtil.displayErrorAlert(h,"getNodeWidthHeight")}return null};
this.getEventSrcElement=function(a,b){try{return window.attachEvent?b.srcElement:b.target}catch(c){g_objCommonUtil.displayErrorAlert(c,"getEventSrcElement")}return null};this.initFalsePropagationEvent=function(a){try{window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"initFalsePropagationEvent")}};this.checkIsAlignAvailableNode=function(a){return"div"==a||"h1"==a||"h2"==a||"h3"==a||
"h4"==a||"h5"==a||"h6"==a||"p"==a||"td"==a||"section"==a||"article"==a||"ul"==a||"ol"==a?!0:!1};this.check_is_CM_INLINE=function(a){return"a"==a||"abbr"==a||"acronym"==a||"b"==a||"basefont"==a||"bdo"==a||"big"==a||"br"==a||"button"==a||"cite"==a||"code"==a||"del"==a||"dfn"==a||"em"==a||"font"==a||"i"==a||"iframe"==a||"img"==a||"input"==a||"ins"==a||"kbd"==a||"label"==a||"legend"==a||"map"==a||"param"==a||"q"==a||"rb"==a||"rbc"==a||"rp"==a||"rt"==a||"rtc"==a||"ruby"==a||"s"==a||"samp"==a||"select"==
a||"small"==a||"span"==a||"strike"==a||"strong"==a||"sub"==a||"sup"==a||"textarea"==a||"tt"==a||"u"==a||"var"==a?!0:!1};this.getLoop_ParentAlignElement=function(a){try{if(null==a)return null;if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&"body"==a.nodeName.toLowerCase())return a;for(;!1===fnObjectCheckNull(a);){var b=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(b))break;var c=b.nodeName.toLowerCase();if("body"==c||g_objNodeUtil.checkIsAlignAvailableNode(c))return b;a=b}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"getLoop_ParentAlignElement")}return null};this.getNodeAlignCode=function(a){try{var b=0,c=g_objPropertyUtil.getElement_TextAlign(a);if(null==c||""==c)c=g_objPropertyUtil.getElement_Align(a);null==c||""==c?b=0:(c=c.toLowerCase(),b="left"==c?1:"center"==c?2:"right"==c?3:"justify"==c?4:0);return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"getNodeAlignCode")}return 0};this.getAncestorNodeOnCaret=function(a){try{var b=null;if(window.addEventListener){var c=g_objEditWindow[a].getSelection();1==c.rangeCount&&
(b=c.getRangeAt(0))}else{c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return;b=c.createRange()}if(fnObjectCheckNull(b))return;if(null==b)return null;a=null;return a="commonAncestorContainer"in b?b.commonAncestorContainer:b.parentElement().childNodes[0]}catch(d){g_objCommonUtil.displayErrorAlert(d,"getAncestorNodeOnCaret")}return null};this.traverseNodesInRange=function(a,b){try{var c=a.startContainer.childNodes[a.startOffset]||a.startContainer,d=a.endContainer.childNodes[a.endOffset]||
a.endContainer,e=a.commonAncestorContainer;if(c!=d||c.firstChild)for(a=c,c=null;a;){c=this.getNextNode(a,!1,d);if(!1===b(a))break;if(a==d||a==e||this.isLoopBreakNode(a))break;a=c}else b(c)}catch(f){g_objCommonUtil.displayErrorAlert(f,"g_objNodeUtil.traverseNodesInRange")}};this.getNextNode=function(a,b,c){try{return c==a||this.isLoopBreakNode(a)?null:a.firstChild&&!b?a.firstChild:a.parentNode?a.nextSibling||this.getNextNode(a.parentNode,!0,c):null}catch(d){g_objCommonUtil.displayErrorAlert(d,"g_objNodeUtil.getNextNode")}};
this.splitOn=function(a,b){try{for(var c=b.parentNode;a!=c;c=e){for(var d=c.cloneNode(!1);b.nextSibling;)d.appendChild(b.nextSibling);var e=c.parentNode;e.insertBefore(d,c.nextSibling);e.insertBefore(b,d)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"splitOn")}};this.getTextNodesOnSelection=function(a){try{var b=function(a){var c=a.nodeValue;a==d&&a==e?(c&&h.push(a),f=g=!0):a==d?(c&&h.push(a),f=!0):a==e?(c&&h.push(a),g=!0):3==a.nodeType&&c&&f&&!g&&!/^\s*$/.test(c)&&h.push(a);c=0;for(var k=a.childNodes.length;!g&&
c<k;++c)b(a.childNodes[c])},c=a.getRangeAt(0),d=c.startContainer,e=c.endContainer,f=!1,g=!1,h=[];b(c.commonAncestorContainer);return h}catch(k){g_objCommonUtil.displayErrorAlert(k,"getTextNodesOnSelection")}};this.splitTextNodeByOffset=function(a){try{var b=a.startContainer,c=a.endContainer,d=!1,e=!1;if("body"===b.nodeName.toLowerCase()||"body"===c.nodeName.toLowerCase()){for(var f=!1,g=!1;!1===f||!1===g;){if(!1===f&&(b=b.firstChild,b.nodeType===ID_SELECTION_TEXT_NODE)){f=!0;continue}!1===g&&(c="br"===
c.tagName.toLowerCase()?c.previousSibling:c.lastChild,c.nodeType===ID_SELECTION_TEXT_NODE&&(g=!0))}a.setStart(b,0);a.setEnd(c,c.nodeValue.length)}0!==a.startOffset&&(d=!0,a.startContainer.splitText(a.startOffset));a.endOffset!==a.endContainer.length&&(e=!0,a.collapse(!1),a.endContainer.splitText(a.endOffset));!0===d&&a.setStart(b.nextSibling,0);!0===e&&(!1===d&&a.setStart(b,0),b===c?a.setEnd(a.endContainer,a.endContainer.length):a.setEnd(c,c.nodeValue.length))}catch(h){g_objCommonUtil.displayErrorAlert(h,
"splitTextNodeByOffset")}};this.isAllWhiteSpace=function(a){try{return a?!/[^\t\n\r ]/.test(a.textContent):!1}catch(b){g_objCommonUtil.displayErrorAlert(b,"g_objNodeUtil.isAllWhiteSpace")}};this.isIgnorable=function(a){try{return a?a.nodeType==ID_SELECTION_COMMENT_NODE||a.nodeType==ID_SELECTION_TEXT_NODE&&this.isAllWhiteSpace(a):!1}catch(b){g_objCommonUtil.displayErrorAlert(b,"g_objNodeUtil.isIgnorable")}};this.isLoopBreakNode=function(a){try{if(!a)return!1;var b=this.getElementTagName(a);return(b=
b?b.toLowerCase():"")&&"body"==b?!0:!1}catch(c){g_objCommonUtil.displayErrorAlert(c,"g_objNodeUtil.isLoopBreakNode")}};this.getTextNodesIn=function(a,b){try{var c=[];if(a)for(var d=a.childNodes,e=d.length;e--;){var f=d[e],g=f?f.nodeType:0;if(g==ID_SELECTION_TEXT_NODE)b&&!b(f,a)||c.push(f);else if(g==ID_SELECTION_ELEMENT_NODE||g==ID_SELECTION_DOCUMENT_NODE||g==ID_SELECTION_DOCUMENT_FRAGMENT_NODE)c=c.concat(this.getTextNodesIn(f,b))}return c}catch(h){g_objCommonUtil.displayErrorAlert(h,"getTextNodesIn")}};
this.clean=function(a){try{var b=g_objNodeUtil;this.getTextNodesIn(a,function(a,d){b.isIgnorable(a)&&!b.checkTagName(a.parentNode,"p","li","span","a","b","i")?d.removeChild(a):b.normalize(a.parentNode)})}catch(c){g_objCommonUtil.displayErrorAlert(c,"util_node.clean")}};this.normalize=function(a){try{if(a)if(g_bBrowserType_IE){var b=ID_SELECTION_TEXT_NODE;if(a.nodeType==b)for(;a.nextSibling&&a.nextSibling.nodeType==b;)a.nodeValue+=a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);else this.normalize(a.firstChild);
this.normalize(a.nextSibling)}else a.normalize()}catch(c){g_objCommonUtil.displayErrorAlert(c,"util_node.normalize")}};this.moveNodesTo=function(a,b,c){try{if(a&&b)for(var d=null;b;){d=b.nextSibling;a.appendChild(b);if(b==c)break;b=d}}catch(e){g_objCommonUtil.displayErrorAlert(e,"moveNodesTo")}};this.removeAllChild=function(a){try{for(;a.firstChild;)a.removeChild(a.firstChild)}catch(b){g_objCommonUtil.displayErrorAlert(b,"removeAllChild")}};this.isNodeInShape=function(a){try{for(var b=g_objNodeUtil,
c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if(c.element_hasClass(a,"dze_shape_main"))return!0;a=a.parentNode}return!1}catch(d){dalert(d)}};this.TreeWalkerFilterTextNode=function(a){var b=a.nodeType;return b==ID_SELECTION_TEXT_NODE&&!g_objNodeUtil.isIgnorable(a)||b==ID_SELECTION_ELEMENT_NODE&&g_objNodeUtil.checkTagName(a,"br")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};g_bBrowserType_IE||(this.TreeWalkerFilterTextNode={acceptNode:this.TreeWalkerFilterTextNode});this.getFirstTextNode=function(a,
b){try{if(!a)return null;var c=a.ownerDocument;if(!c)return null;var d=c.createTreeWalker(a,NodeFilter.SHOW_ALL,this.TreeWalkerFilterTextNode,!1);d.nextNode();if(!0===b&&!this.isNodeInShape(a))for(;this.isNodeInShape(d.currentNode);)d.nextNode();return d.currentNode}catch(e){dalert(e)}};this.getLastTextNode=function(a){try{if(!a)return null;var b=a.ownerDocument;if(!b)return null;var c=b.createTreeWalker(a,NodeFilter.SHOW_ALL,this.TreeWalkerFilterTextNode,!1);for(a=null;c.nextNode();)a=c.currentNode;
return a}catch(d){dalert(d)}};this.setAttribute=function(a,b,c){try{a&&a.hasAttribute&&a.setAttribute(b,c)}catch(d){g_objCommonUtil.displayErrorAlert(d,"setAttribute")}};this.getAttribute=function(a,b){try{if(a&&a.getAttribute)return a.getAttribute(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"getAttribute")}};this.removeAttribute=function(a,b){try{if(a&&a.removeAttribute)return a.removeAttribute(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeAttribute")}};this.hasAttribute=function(a,
b){try{if(a&&a.hasAttribute)return a.hasAttribute(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"hasAttribute")}};this.isInlineNode=function(a){try{var b=this.getCheckElementTagName(a);return b?this.isInlineNodeTagName(b):!1}catch(c){return dalert(c),!1}};this.isInlineNodeTagName=function(a){switch(a){case "a":case "abbr":case "acronym":case "b":case "basefont":case "bdo":case "big":case "br":case "button":case "cite":case "code":case "del":case "dfn":case "em":case "font":case "i":case "iframe":case "img":case "input":case "ins":case "kbd":case "label":case "legend":case "map":case "param":case "q":case "rb":case "rbc":case "rp":case "rt":case "rtc":case "ruby":case "s":case "samp":case "select":case "small":case "span":case "strike":case "strong":case "sub":case "sup":case "textarea":case "tt":case "u":case "var":return!0}return!1};
this.isBlockNode=function(a){try{var b=this.getCheckElementTagName(a);return b?this.isBlockNodeTagName(b):!1}catch(c){return dalert(c),!1}};this.isBlockNodeTagName=function(a){switch(a){case "address":case "article":case "aside":case "blockquote":case "canvas":case "dd":case "div":case "dl":case "dt":case "fieldset":case "figcaption":case "figure":case "footer":case "form":case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":case "header":case "hr":case "li":case "main":case "nav":case "noscript":case "ol":case "p":case "pre":case "section":case "table":case "tfoot":case "ul":case "video":return!0}return!1};
this.isAllTextInlineChildNode=function(a){try{for(var b=a.firstChild;b;)if(b.nodeType==ID_SELECTION_TEXT_NODE||this.checkTagName(b,"br")||this.isInlineNode(b))b=b.nextSibling;else return!1;return!0}catch(c){return dalert(c),!1}};this.isCell=function(a){try{return!a||"TD"!==a.nodeName&&"TH"!==a.nodeName?!1:!0}catch(b){dalert(b)}};this.isTr=function(a){try{return a&&"TR"===a.nodeName?!0:!1}catch(b){dalert(b)}}};

var layerEventUtil=function(){var c=this;this.arrTableCellHTML=this.objCurrentLayer=null;this.bRestoreUnDo=!1;layerEventUtil.prototype.showLayerWin=function(a,b,c,g){try{a.style.left="-2000px";a.style.top="-2000px";a.style.display="";var f=g_objPositionUtil.getLayerNodeElementPosition(b),e=f.bottom;if(ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT==c){var d=f.left;g_bBrowserType_FF?(d=d-g_nFireFoxLayerSetting_X+1,e=e-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(d+=2,e+=2):g_bBrowserType_OP?(d+=1,e+=1):g_bBrowserType_IE&&
g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(d+=2,e+=2);a.style.left=d-2+g_nIframeBorderSetting+"px";a.style.top=e-2+g_nIframeBorderSetting+"px"}else if(ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT==c)d=f.right,g_bBrowserType_FF?(d=d-g_nFireFoxLayerSetting_X+1,e=e-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(d+=2,e+=2):g_bBrowserType_OP?(d+=1,e+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(d+=2,e+=2),a.style.left=d-a.offsetWidth-2+g_nIframeBorderSetting+"px",a.style.top=e-2+g_nIframeBorderSetting+
"px";else return;duzon_dialog.animateDlg(a,"down");this.objCurrentLayer=a;this.bRestoreUnDo=g;detachMouseEvent();this.addLayerEvent()}catch(k){g_objCommonUtil.displayErrorAlert(k,"showLayerWin")}};layerEventUtil.prototype.addLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?g_objLayerKit.getLayerDocument().attachEvent("onmousedown",this.checkdownParentLayer):g_objLayerKit.getLayerDocument().addEventListener("mousedown",this.checkdownParentLayer,!1));window.attachEvent?document.attachEvent("onmousedown",
this.checkdownLayer):document.addEventListener("mousedown",this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",this.checkdownHideLayer):g_objEditorDocument[a].addEventListener("mousedown",this.checkdownHideLayer,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"addLayerEvent")}};layerEventUtil.prototype.removeLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?g_objLayerKit.getLayerDocument().detachEvent("onmousedown",
this.checkdownParentLayer):g_objLayerKit.getLayerDocument().removeEventListener("mousedown",this.checkdownParentLayer,!1));window.detachEvent?document.detachEvent("onmousedown",this.checkdownLayer):document.removeEventListener("mousedown",this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[a].detachEvent("onmousedown",this.checkdownHideLayer):g_objEditorDocument[a].removeEventListener("mousedown",this.checkdownHideLayer,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,
"removeLayerEvent")}};layerEventUtil.prototype.checkdownParentLayer=function(a){try{if(null!=c.objCurrentLayer){TBCancelBubbleEvent_iFrameLayer(a);var b=g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(a),f=b.nPos_X,g=b.nPos_Y,h=c.objCurrentLayer.offsetWidth,e=c.objCurrentLayer.offsetHeight;c.objCurrentLayer.offsetLeft<f&&c.objCurrentLayer.offsetTop<g&&f<c.objCurrentLayer.offsetLeft+h&&g<c.objCurrentLayer.offsetTop+e||(c.initHideDynamicLayer(),c.restoreUnDoForPreview())}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"checkdownParentLayer")}};layerEventUtil.prototype.checkdownLayer=function(a){try{if(null!=c.objCurrentLayer){TBCancelBubbleEvent(a);var b=g_objPositionUtil.GetDocumentClientPos_XY(a),f=b.nPos_X,g=b.nPos_Y,h=c.objCurrentLayer.offsetWidth,e=c.objCurrentLayer.offsetHeight;c.objCurrentLayer.offsetLeft<f&&c.objCurrentLayer.offsetTop<g&&f<c.objCurrentLayer.offsetLeft+h&&g<c.objCurrentLayer.offsetTop+e||(c.initHideDynamicLayer(),c.restoreUnDoForPreview())}}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkdownLayer")}};
layerEventUtil.prototype.checkdownHideLayer=function(a){try{c.initHideDynamicLayer(),c.restoreUnDoForPreview(),editor_onmousedown(null,-1),g_objTableFlag.ResetTableInfo(!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"checkdownHideLayer")}};layerEventUtil.prototype.initHideDynamicLayer=function(){try{if(g_bDynamicLayer){g_objMenuWin.TBMenuCloseMenuState();g_objMenuWin.initMenuLayerEvent();g_objComboBoxWin.initComboBoxLayerEvent();g_objTableSizeBoxWin.initTableSizeLayerEvent();g_objContextMenuWin.initContextMenuLayerEvent();
g_objLetterSpacingWin.initLetterSpacingLayerEvent();g_objLineHeightWin.initLineHeightLayerEvent();g_objWrapperOutlineResize.resetExtOutlineInfo();for(var a in g_TBDropDown)for(var b in g_TBDropDown[a])fnObjectCheckNull(g_TBDropDown[a][b].element)||ID_STRING_NAME_CHECKED==g_TBDropDown[a][b].element.TBSTATE&&TBSetState(g_TBDropDown[a][b].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[a][b].button_type);for(a in g_TBComboBox)for(b in g_TBComboBox[a])fnObjectCheckNull(g_TBComboBox[a][b].element)||ID_STRING_NAME_CHECKED==
g_TBComboBox[a][b].element.TBSTATE&&TBSetState(g_TBComboBox[a][b].element,ID_STRING_NAME_UNCHECKED,g_TBComboBox[a][b].button_type);g_bForceNoSelectionChange=g_bDynamicLayer=!1;attachMouseEvent();duzon_menubar.closeHiddenTbContainerTool();!0===dzeUiConfig.bUseUiMode&&(dze_menu_control.removeUiToggleBtnLayer(),dze_menu_control.removeHelpBtnLayer());this.arrTableCellHTML=null;this.bRestoreUnDo=!1}}catch(f){g_objCommonUtil.displayErrorAlert(f,"initHideDynamicLayer")}};layerEventUtil.prototype.saveTableSelectedCellHTML=
function(a){try{this.arrTableCellHTML=g_objTableFunction.getTableSelectedCellHTML(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"saveTableSelectedCellHTML")}};layerEventUtil.prototype.restoreTableSelectedCellHTML=function(a){try{g_objTableFunction.setTableSelectedCellHTML(a,this.arrTableCellHTML)}catch(b){g_objCommonUtil.displayErrorAlert(b,"restoreTableSelectedCellHTML")}};layerEventUtil.prototype.restoreUnDoForPreview=function(){try{!0===this.bRestoreUnDo&&!0===dzeUiConfig.bTBPreviewLetterOperation&&
g_objUndoRedo.operateUndoRedoStack(!0,!0,g_nActiveEditNumber)}catch(a){g_objCommonUtil.displayErrorAlert(a,"restoreUnDoStack")}}},g_objLayerEventUtil=new layerEventUtil;

var transparentViewUtil=function(){this.objTransparentView=null;transparentViewUtil.prototype.initTransparentView=function(){try{null==this.objTransparentView&&g_objInsertUtil.insertLayerHTML('<div id="transparentView" style="display:none;position:absolute;z-index:20009;border:0px;background-color:#ffffff;filter:alpha(opacity=40);opacity:0.4;"></div>',!1)&&(this.objTransparentView=document.getElementById("transparentView"))}catch(a){g_objCommonUtil.displayErrorAlert(a,"initTransparentView")}};transparentViewUtil.prototype.showTransparentView=
function(a,d){try{if(null==this.objTransparentView&&this.initTransparentView(),a){g_objPropertyUtil.applyFilterOpacityStyle(this.objTransparentView,a,d);var b=g_objPositionUtil.getDocumentClientSize(self),e=b.nClientWidth,f=b.nClientHeight,c=g_objPositionUtil.getDocumentScrollPosition(!1),g=c.nScrollLeft,h=c.nScrollTop;this.objTransparentView.style.left="0px";this.objTransparentView.style.top="0px";this.objTransparentView.style.width=g+e+"px";this.objTransparentView.style.height=h+f+"px";this.objTransparentView.style.display=
""}else this.objTransparentView.style.display="none"}catch(k){g_objCommonUtil.displayErrorAlert(k,"showTransparentView")}}},g_objTransparentViewUtil=new transparentViewUtil;

var g_objTableUtil=new function(){this.ID_TABLE_ALIGN_NONE=0;this.ID_TABLE_ALIGN_LEFT=1;this.ID_TABLE_ALIGN_CENTER=2;this.ID_TABLE_ALIGN_RIGHT=3;this.getTableRowElement=function(a,b){try{if(g_bBrowserType_IE)return a.rows(b);if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return a.rows[b]}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTableRowElement")}return null};this.getTableCellElement=function(a,b,c){try{if(g_bBrowserType_IE)return a.rows(b).cells(c);if(g_bBrowserType_FF||g_bBrowserType_WK||
g_bBrowserType_OP)return a.rows[b].cells[c]}catch(d){g_objCommonUtil.displayErrorAlert(d,"getTableCellElement")}return null};this.getTableCellsLength=function(a,b){try{if(g_bBrowserType_IE)return a.rows(b).cells.length;if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return a.rows[b].cells.length}catch(c){g_objCommonUtil.displayErrorAlert(c,"getTableCellsLength")}return null};this.getTableMaxColSpanCount=function(a){try{for(var b=0,c=a.rows.length,d=0;d<c;d++){for(var e=0,f=this.getTableCellsLength(a,
d),h=0;h<f;h++){var l=this.getTableCellElement(a,d,h);e+=l.colSpan}b<e&&(b=e)}return b}catch(k){g_objCommonUtil.displayErrorAlert(k,"getTableMaxColSpanCount")}return 0};this.getTableRowColSpanCount=function(a,b){try{for(var c=0,d=this.getTableCellsLength(a,b),e=0;e<d;e++){var f=this.getTableCellElement(a,b,e);c+=f.colSpan}return c}catch(h){g_objCommonUtil.displayErrorAlert(h,"getTableRowColSpanCount")}return 0};this.getTableColGroupWidthValue=function(a){try{var b=[],c=a.getElementsByTagName("col");
for(a=0;a<c.length;a++){var d=c[a].getAttribute("width"),e=g_objCommonUtil.extractNumberValueUnit(d);if(null==e)return null;b[a]=e}return b}catch(f){g_objCommonUtil.displayErrorAlert(f,"getTableColGroupWidthValue")}return null};this.getTableCellPadding=function(a){try{var b=a.cellPadding;if(null==b||""==b||ID_STRING_NAME_UNDEFINED==b)return"";var c=g_objCommonUtil.getNumberValue(b);return null==c?"":c}catch(d){g_objCommonUtil.displayErrorAlert(d,"getTableCellPadding")}return null};this.setTableCellPadding=
function(a,b){try{null==b||""==b?a.removeAttribute("cellpadding"):a.cellPadding=b}catch(c){g_objCommonUtil.displayErrorAlert(c,"setTableCellPadding")}};this.setNodeValue_Width=function(a,b,c){try{g_objNodeUtil.getNodeWidthHeight(a,!0).styleValue?(a.style.width=b+c,a.removeAttribute("width")):a.width=b+c}catch(d){g_objCommonUtil.displayErrorAlert(d,"setNodeValue_Width")}};this.setNodeValue_Height=function(a,b,c){try{g_objNodeUtil.getNodeWidthHeight(a,!1).styleValue?(a.style.height=b+c,a.removeAttribute("height")):
a.height=b+c}catch(d){g_objCommonUtil.displayErrorAlert(d,"setNodeValue_Height")}};this.removeChildNode_AllWhiteCode_For_TableOperation=function(a){try{var b=!1,c=g_objNodeUtil.getElementTagName(a).toLowerCase();if("table"==c||"tbody"==c||"tr"==c)b=!0;for(c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==d.nodeType?removeChildNode_AllWhiteCode(d):ID_SELECTION_TEXT_NODE==d.nodeType&&b&&checkTextNodeAllWhiteCode(d.nodeValue)&&(a.removeChild(d),c--)}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"removeChildNode_AllWhiteCode_For_TableOperation")}};this.getAlignTableByStyleProperty=function(a){try{if("0px"!=a.style.marginLeft&&"0"!=a.style.marginLeft||"auto"!=a.style.marginRight){if("auto"==a.style.marginLeft&&"auto"==a.style.marginRight)return this.ID_TABLE_ALIGN_CENTER;if("auto"==a.style.marginLeft&&("0px"==a.style.marginRight||"0"==a.style.marginRight))return this.ID_TABLE_ALIGN_RIGHT}else return this.ID_TABLE_ALIGN_LEFT;var b=a.getAttribute("align");if(null==b||""==b)return this.ID_TABLE_ALIGN_NONE;
b=b.toLowerCase();return"left"==b?this.ID_TABLE_ALIGN_LEFT:"center"==b?this.ID_TABLE_ALIGN_CENTER:"right"==b?this.ID_TABLE_ALIGN_RIGHT:this.ID_TABLE_ALIGN_NONE}catch(c){g_objCommonUtil.displayErrorAlert(c,"getAlignTableByStyleProperty")}return this.ID_TABLE_ALIGN_NONE};this.setAlignTableByStyleProperty=function(a,b,c){try{a.removeAttribute("align"),c?(a.style.marginLeft="",a.style.marginRight=""):"left"==b?(a.style.marginLeft="0px",a.style.marginRight="auto"):"center"==b?(a.style.marginLeft="auto",
a.style.marginRight="auto"):"right"==b&&(a.style.marginLeft="auto",a.style.marginRight="0px")}catch(d){g_objCommonUtil.displayErrorAlert(d,"setAlignTableByStyleProperty")}};this.getID=function(a){try{var b=a.id;return!1===fnObjectCheckNull(b)&&0<b.length?b:""}catch(c){g_objCommonUtil.displayErrorAlert(c,"getID")}};this.setID=function(a,b){try{this.getID(a)!==b&&(a.id=b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setID")}};this.getClass=function(a){try{var b=a.className;return!1===fnObjectCheckNull(b)&&
0<b.length?b:""}catch(c){g_objCommonUtil.displayErrorAlert(c,"getClass")}};this.setClass=function(a,b){try{this.getClass(a)!==b&&(a.className=b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setClass")}};this.setTable_Outdent_Indent=function(a,b){try{a.removeAttribute("align");var c=a.style.marginLeft,d=a.style.marginRight;c=c.toLowerCase();d=d.toLowerCase();"auto"==c&&(c=a.style.marginLeft="");"auto"==d&&(a.style.marginRight="");var e=dzeUiConfig.nCustomOutdentIndentWidth;b&&(e*=-1);""==c?a.style.marginLeft=
e+"px":isNaN(c)?-1==c.indexOf("px")?a.style.marginRight="":a.style.marginLeft=parseInt(c)+e+"px":a.style.marginLeft=parseInt(c)+e+"px"}catch(f){g_objCommonUtil.displayErrorAlert(f,"setTable_Outdent_Indent")}};this.setAlignTable=function(a,b,c){try{var d="";if(!b)if(a==ID_COMMAND_JUSTIFY_LEFT)d="left";else if(a==ID_COMMAND_JUSTIFY_CENTER)d="center";else if(a==ID_COMMAND_JUSTIFY_RIGHT)d="right";else if(a==ID_COMMAND_JUSTIFY_JUSTIFY)b=!0;else return;if(window.attachEvent)for(var e=g_objEditorDocument[c].selection,
f=e.createRange(),h=f.parentElement(),l=h.getElementsByTagName("table"),k=0;k<l.length;k++){var g=l[k],n=e.createRange();n.moveToElementText(g);n.collapse(!0);var r=e.createRange();r.moveToElementText(g);r.collapse(!1);var p=f.inRange(n),q=f.inRange(r);p||q&&g_objTableUtil.setAlignTableByStyleProperty(g,d,b);p&&q&&g_objTableUtil.setAlignTableByStyleProperty(g,d,b);p&&(q||g_objTableUtil.setAlignTableByStyleProperty(g,d,b))}else if(g_objTableSelection.isTableSelected(c))this.setAlignTableByStyleProperty(g_objTable,
d,b);else if(e=g_objEditWindow[c].getSelection(),1==e.rangeCount){f=e.getRangeAt(0);h=f.commonAncestorContainer;var m=g_objEditorDocument[c].createRange();if(h.nodeType!=ID_SELECTION_TEXT_NODE)for(l=h.getElementsByTagName("table"),k=0;k<l.length;k++){g=l[k];m.selectNode(g);var v=f.compareBoundaryPoints(Range.END_TO_START,m),t=f.compareBoundaryPoints(Range.START_TO_START,m),u=f.compareBoundaryPoints(Range.END_TO_END,m),w=f.compareBoundaryPoints(Range.START_TO_END,m);-1!=v||1!=t&&0!=t||g_objTableUtil.setAlignTableByStyleProperty(g,
d,b);0!=t&&-1!=t||1!=u&&0!=u||g_objTableUtil.setAlignTableByStyleProperty(g,d,b);1!=w||0!=u&&-1!=u||g_objTableUtil.setAlignTableByStyleProperty(g,d,b)}}}catch(x){g_objCommonUtil.displayErrorAlert(x,"setAlignTable")}};this.setMultiToOneColgroup=function(a){try{if(!a)return!1;var b=g_objNodeUtil,c=b.getImmediateChildNodesByTagName(a,"colgroup");if(1>=c.length)return!1;var d=c[0];for(a=1;a<c.length;a++)b.moveNodesTo(d,c[a].firstChild),c[a].parentNode.removeChild(c[a]);return!0}catch(e){g_objCommonUtil.displayErrorAlert(e,
"util_table.setMultiToOneColgroup")}};this.addColgroup=function(a,b){try{if(!a)return!1;var c=g_objNodeUtil,d=a.ownerDocument,e=b||g_objTableUtil.getMatrix(a),f=e.tables,h=!1,l=c.getImmediateChildNodesByTagName(a,"colgroup")[0];h|=this.setMultiToOneColgroup(a);var k=c.getImmediateChildNodesByTagName(l,"col");a=!1;for(var g=0;g<k.length;g++)if(!k[g].style.width){a=!0;break}if(!l||k.length!=e.colLength||a){h|=1;var n=e.calculateColWidth(),r=e.arraySum(n),p=d.createDocumentFragment();for(g=0;g<e.colLength;g++){var q=
d.createElement("col");q.style.width=n[g]+"px";p.appendChild(q)}for(g=0;g<f.length;g++){var m=c.getImmediateChildNodesByTagName(f[g],"colgroup")[0];h|=this.setMultiToOneColgroup(f[g]);m||(bDirty=!0,m=d.createElement("colgroup"),f[g].firstChild?f[g].insertBefore(m,f[g].firstChild):f[g].insertBefore(m));c.removeAllChild(m);m.appendChild(p.cloneNode(!0));this.setNodeValue_Width(f[g],r,"px")}}h&&b&&b.initColgroup();return h}catch(v){g_objCommonUtil.displayErrorAlert(v,"util_table.addColgroup")}};this.removeColgroup=
function(a){try{if(a){var b=g_objNodeUtil,c=g_objTableUtil.getSplitTables(a);a=null;for(var d=0;d<c.length;d++)(a=b.getImmediateChildNodesByTagName(c[d],"colgroup")[0])&&c[d].removeChild(a)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"util_table.removeColgroup")}};this.removeTableColGroupAll=function(a){try{a.setAttribute("cusCheckTarget","y");var b=a.getElementsByTagName("colgroup");if(null!==b&&0<b.length){for(var c,d,e=0;e<b.length;e++)if(c=g_objNodeUtil.getLoopParentElement(b[e],"table"),"y"===
c.getAttribute("cusCheckTarget")){d="y";break}if(!fnObjectCheckNull(d)&&"y"===d)for(g_objTableResize.resetTableCellPixelWidth(a),e=b.length-1;0<=e;e--)c=g_objNodeUtil.getLoopParentElement(b[e],"table"),"y"===c.getAttribute("cusCheckTarget")&&a.removeChild(b[e])}a.removeAttribute("cusCheckTarget")}catch(f){g_objCommonUtil.displayErrorAlert(f,"removeTableColGroupAll")}};this.getEditorFrameWidth=function(){try{var a=document.getElementById("dzeditor_"+duzon_dialog.nEditNumber),b=g_objEditorDocument[duzon_dialog.nEditNumber].body,
c=g_objPropertyUtil.getElementStyleAttributeValue(b,"margin-left",duzon_dialog.nEditNumber),d=g_objPropertyUtil.getElementStyleAttributeValue(b,"margin-right",duzon_dialog.nEditNumber);return 0===a.offsetWidth?0:a.offsetWidth-(parseInt(c)+parseInt(d))}catch(e){g_objCommonUtil.displayErrorAlert(e,"getEditorFrameWidth")}};this.getMaxTableWidth=function(){try{var a=2E3;dzeUiConfig.bLimitTableWidthSize&&(a=this.getEditorFrameWidth());return a}catch(b){g_objCommonUtil.displayErrorAlert(b,"getMaxTableWidth")}};
this.hasOverSizedTable=function(a){try{var b=!1,c=g_objTableUtil.getMaxTableWidth();if(0===c)return null;for(var d=0;d<a.length;d++){var e=a[d].offsetWidth;if(e>c){b=!0;break}}return b?c:null}catch(f){g_objCommonUtil.displayErrorAlert(f,"hasOverSizedTable")}};this.cloneCell=function(a,b,c){try{if(g_objNodeUtil.checkTagName(a,"td")){"undefined"==typeof c&&(c=!1);var d=a.cloneNode(b);!1===b&&(d.innerHTML="<p><br></p>");c||g_objTableFlag.RemoveCellAfterCheckExist(d);if(d.hasAttribute("style")&&this.isBlankCell(d)){var e=
parseStyle(d.getAttribute("style")),f=g_objNodeUtil.checkTagName(d.firstChild,"p");if(e&&f)for(var h in e)if("fontFamily"==h||"fontSize"==h||"color"==h||"fontWeight"==h||"lineHeight"==h||"letterSpacing"==h)f.style[h]=e[h]}return d}}catch(l){g_objCommonUtil.displayErrorAlert(l,"g_objTableUtil.cloneCell")}};this.createEmptyCell=function(a,b,c){try{var d=g_objEditorDocument[c].createElement("td");d.innerHTML="<p><br /></p>";this.setRowspan(d,a);this.setColspan(d,b);return d}catch(e){g_objCommonUtil.displayErrorAlert(e,
"g_objTableUtil.createEmptyCell")}};this.isBlankCell=function(a){try{if(!a)return!0;var b=a.firstChild;if(!b)return!0;a=g_objNodeUtil;if(!b.nextSibling&&a.checkTagName(b,"p")){var c=b.firstChild;if(!c||!c.nextSibling&&a.checkTagName(c,"br"))return!0}return!1}catch(d){g_objCommonUtil.displayErrorAlert(d,"g_objTableUtil.isBlankCell")}};this.getSplitTables=function(a){return[a]};this.getMatrix=function(a){try{return a?new TableMatrix(a):null}catch(b){g_objCommonUtil.displayErrorAlert(b,"util_table.getMatrix")}};
this.setCellInnerText=function(a,b,c){try{if(!b)return null;a=a||"<br>";c=c?c:b;var d=b.ownerDocument,e=g_objNodeUtil.getFirstTextNode(c),f=TextAtt.getAtt(e),h=ParaAtt.getAtt(e),l=b.querySelectorAll("span.dze_shape_main");for(c=null;l[0];)c||(c=d.createDocumentFragment()),c.appendChild(l[0]);b.innerHTML="<p>"+a+"</p>";var k=b.firstChild;TextAtt.setAtt(k.firstChild,f);ParaAtt.setAtt(k,h);c&&c.firstChild&&k.insertBefore(c,k.firstChild);return b}catch(g){dalert(g)}}};

function TableMatrix(a,b){this.matrix=[];this.table=a?a:null;this.tables=[];this.trs=[];this.colgroups=[];this.colLength=this.rowLength=0;this.arrBlankRow=this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null;this.bDirty=!1;this.bOneTable=b?!0:!1;a&&this.makeMatrix();return this}
TableMatrix.prototype={SHOW:1,HIDE_ROWSPAN:16,HIDE_COLSPAN:256,DZE_TEMP:"dze_temp",isShow:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.SHOW)?!0:!1},isHide:function(a,b){return!this.isShow(a,b)},isHideForRowspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_ROWSPAN)?!0:!1},isHideForColspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_COLSPAN)?!0:!1},getColspan:function(a){a=a.getAttribute("colspan")|
0;return parseInt(a?a:1)},getRowspan:function(a){a=a.getAttribute("rowspan")|0;return parseInt(a?a:1)},setColspan:function(a,b){1>=b?a.removeAttribute("colspan"):a.setAttribute("colspan",b)},setRowspan:function(a,b){1>=b?a.removeAttribute("rowspan"):a.setAttribute("rowspan",b)},arraySum:function(a,b,c){c="undefined"==typeof c?a.length-1:c;var d=0;for(b="undefined"==typeof b?0:b;b<=c;b++)d+=a[b];return d},arrayCloset:function(a,b){for(var c=Number.MAX_VALUE,d=0,e=0;e<a.length;e++){var h=Math.abs(b-
a[e]);h<c&&(d=e,c=h)}return a[d]},arrayUnion:function(a,b){a=a.concat();for(var c=0;c<b.length;c++)0>a.indexOf(b[c])&&a.push(b[c]);return a},arrayWidthToPos:function(a,b){b[0]=0;for(var c=1;c<=a.length;c++)b[c]=b[c-1]+a[c-1];return b},arrayPosToWidth:function(a,b){for(var c=0;c<a.length-1;c++)b[c]=a[c+1]-a[c];return b},arrayFillNullWithMedian:function(a){try{if(a){for(var b=1,c=a.length;b<c;b++)if(null===a[b]){for(var d=b-1;0<=d&&null===a[d];d--);for(var e=b+1;e<c&&null===a[e];e++);0>d&&(d=0);e>=
c&&(e=c-1);var h=a[d],f=a[e];e-=d;f<h&&(f=h);var g=this.getIntegerDivision(f-h,e);for(e=0;e<g.length-1;e++)a[e+d+1]=a[e+d]+g[e]}return a}}catch(k){dalert(k)}},getGCD:function(a,b){return b?this.getGCD(b,a%b):a},getIntegerDivision:function(a,b){var c=Math.floor(a/b);a%=b;for(var d=[],e=0;e<b;e++)d[e]=c;for(e=b-1;0<e&&0<a;e--)d[e]+=1,a--;return d},getCellIndex:function(a,b){try{if(0>a||a>=this.rowLength||0>b||b>=this.colLength)return null;var c=0,d=0;for(c=a;this.isHideForRowspan(c,b);c--);for(a=0;d<=
b;d++)this.isHide(c,d)&&a++;return{row:c,col:d-a-1}}catch(e){dalert(e)}},getCell:function(a,b){try{var c=this.getCellIndex(a,b);return c?this.trs[c.row].cells[c.col]:null}catch(d){dalert(d)}},getMatrixIndex:function(a){try{if(!a)return null;var b=this.trs.indexOf(a.parentNode);if(0>b)return null;var c=a.cellIndex,d=0;for(a=0;a<=c&&d<this.colLength;a++,d++)this.isHide(b,d)&&a--;--d;var e=this.getColRange(b,d),h=this.getRowRange(b,d);b=[];for(var f=h.start;f<=h.end;f++)for(a=e.start;a<=e.end;a++)b.push({row:f,
col:a});return b}catch(g){dalert(g)}},getRowRange:function(a,b){try{for(var c=0,d=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);c=a;for(a+=1;this.isHideForRowspan(a,b);a++);d=a-1;return{start:c,end:d,length:d-c+1}}catch(e){dalert(e)}},getColRange:function(a,b){try{for(var c=0,d=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);c=b;for(b+=1;this.isHideForColspan(a,b);b++);d=b-1;return{start:c,end:d,length:d-c+1}}catch(e){dalert(e)}},getRowRangeFromCell:function(a){try{var b=
this.getMatrixIndex(a);return b?this.getRowRange(b[0].row,b[0].col):null}catch(c){dalert(c)}},getColRangeFromCell:function(a){try{var b=this.getMatrixIndex(a);return b?this.getColRange(b[0].row,b[0].col):null}catch(c){dalert(c)}},insertCell:function(a,b,c){try{if(!a)return!1;for(var d=c;d<this.colLength&&!this.isShow(b,d);d++);var e=this.getCell(b,d);e?this.trs[b].insertBefore(a,e):this.trs[b].appendChild(a);if(g_objNodeUtil.checkTagName(a,"td","th")){var h=this.getColspan(a),f=this.getRowspan(a);
for(a=b;a<b+f;a++)for(d=c;d<c+h;d++)"undefined"!=typeof this.matrix[a][d]&&(a==b&&d==c?this.matrix[a][d]=this.SHOW:(this.matrix[a][d]=0,d>c&&(this.matrix[a][d]|=this.HIDE_COLSPAN),a>b&&(this.matrix[a][d]|=this.HIDE_ROWSPAN)))}return!0}catch(g){dalert(g)}},equalCell:function(a,b,c,d){try{if(a==c&&b==d)return!0;var e=this.getCellIndex(a,b),h=this.getCellIndex(c,d);return e.row==h.row&&e.col==h.col?!0:!1}catch(f){dalert(f)}},createBlankCell:function(a,b){try{var c=this.table.ownerDocument.createElement("td");
c.innerHTML="<p><br /></p>";c.style.width="0px";this.setRowspan(c,a);this.setColspan(c,b);return c}catch(d){dalert(d)}},clone:function(){try{var a=new TableMatrix(null);a.bClone=!0;a.table=this.table.cloneNode(!0);for(var b=0;b<this.tables.length;b++)a.tables[b]=this.tables[b]==this.table?a.table:this.tables[b].cloneNode(!0);a.initTrs();a.initColgroup();a.rowLength=this.rowLength;a.colLength=this.colLength;a.arrColWidth=this.arrColWidth?this.arrColWidth.slice(0):this.calculateColWidth();a.arrRowHeight=
this.arrRowHeight?this.arrRowHeight.slice(0):this.calculateRowHeight();a.bDirty=this.bDirty;a.matrix=this.matrix?this.matrix.slice(0):null;return a}catch(c){dalert(c)}},setTable:function(a){try{if(!a)return this;this.table=a;this.makeMatrix();return this}catch(b){dalert(b)}},init:function(){try{this.bClone?(this.initTrs(),this.initColgroup(),this.bDirty=!1):(this.tables=this.bOneTable?[this.table]:g_objTableUtil.getSplitTables(this.table),this.initTrs(),this.initColgroup(),this.bDirty=!1,this.clearCache())}catch(a){dalert(a)}},
initColgroup:function(){try{if(!this.colgroups||0<this.colgroups.length)this.colgroups=[];for(var a=0;a<this.tables.length;a++){var b=g_objNodeUtil.getImmediateChildNodesByTagName(this.tables[a],"colgroup");this.colgroups=this.colgroups.concat(b)}}catch(c){dalert(c)}},initTrs:function(){try{if(!this.trs||0<this.trs.length)this.trs=[];for(var a=0;a<this.tables.length;a++){var b=[].slice.call(this.tables[a].rows);this.trs=this.trs.concat(b)}}catch(c){dalert(c)}},clearCache:function(){try{this.arrBlankRow=
this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null}catch(a){dalert(a)}},makeMatrix:function(){try{this.init();this.matrix=[];var a=this.trs,b=null,c=null,d=null,e=0,h=0,f=0,g=0,k=a.length,l=0;for(h=0;h<k;h++)for(c=a[h],b=c.cells,l=b.length,f=e=0;e<l;e++){d=b[e];for(var m=this.getColspan(d),n=this.getRowspan(d);this.matrix[h]&&this.matrix[h][f];f++);for(var q=f;q<f+m;q++)for(var p=h;p<h+n;p++)this.matrix[p]||(this.matrix[p]=[]),p==h&&q==f?this.matrix[p][q]=this.SHOW:(this.matrix[p][q]=0,q>f&&
(this.matrix[p][q]|=this.HIDE_COLSPAN),p>h&&(this.matrix[p][q]|=this.HIDE_ROWSPAN))}this.rowLength=this.matrix.length;this.colLength=this.matrix[0].length;if(this.matrix.length>k){for(g=this.matrix.length-1;g>=k;g--)for(f=this.matrix[g].length-1;0<=f;f=this.getColRange(g,f).start-1)if(this.matrix[g][f]&&this.isHideForRowspan(g,f)){var t=this.getCell(g,f);t&&this.setRowspan(t,this.getRowspan(t)-1)}this.matrix.splice(k);this.rowLength=k}}catch(r){dalert(r)}},calculateColWidth:function(){try{if(this.arrColWidth&&
this.arrColWidth.length==this.colLength)return this.arrColWidth.slice(0);for(var a=[],b=0;b<this.colLength;b++)a[b]=null;var c=a.length;for(b=0;b<this.rowLength&&0<c;b++)for(var d=0,e=0;e<this.colLength;e++)if(!this.isHideForColspan(b,e))if(e=this.getColRange(b,e).end,null===a[e]){var h=this.getCell(b,e);d+=h.offsetWidth;a[e]=d;c--}else d=a[e];a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;this.arrayFillNullWithMedian(a);this.arrColWidth=this.arrayPosToWidth(a,[]);return this.arrColWidth.slice(0)}catch(f){dalert(f)}},
calculateRowHeight:function(){try{if(this.arrRowHeight&&this.arrRowHeight.length==this.rowLength)return this.arrRowHeight.slice(0);for(var a=[],b=0;b<this.rowLength;b++)a[b]=null;for(var c=a.length,d=0;d<this.colLength&&0<c;d++){var e=0;for(b=0;b<this.rowLength;b++)if(!this.isHideForRowspan(b,d))if(b=this.getRowRange(b,d).end,null===a[b]){var h=this.getCell(b,d);e+=h.offsetHeight;a[b]=e;c--}else e=a[b]}a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;this.arrayFillNullWithMedian(a);
this.arrRowHeight=this.arrayPosToWidth(a,[]);return this.arrRowHeight.slice(0)}catch(f){dalert(f)}},splitRow:function(a,b){try{if("undefined"==typeof a||0>a||a>=this.rowLength)return!1;b=b?!0:!1;for(var c=this.calculateRowHeight(),d=g_objTableUtil,e=g_objTableResize,h=g_objPropertyUtil,f=this.colLength-1;0<=f;f--)if(this.isHideForRowspan(a,f)){var g=this.getCell(a,f),k=g.cloneNode(b),l=this.getRowRange(a,f),m=this.getColRange(a,f);this.setRowspan(g,a-l.start);this.setRowspan(k,l.end-a+1);if(10<h.getStyleHeight(g)){var n=
e.offsetHeightToStyleHeight(this.arraySum(c,l.start,a-1),g);d.setNodeValue_Height(g,n,"px");n=e.offsetHeightToStyleHeight(this.arraySum(c,a,l.end),g);d.setNodeValue_Height(k,n,"px")}this.insertCell(k,a,f);f=m.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(q){dalert(q)}},splitCol:function(a,b){try{if("undefined"==typeof a||0>a||a>=this.colLength)return!1;b=b?!0:!1;for(var c=this.calculateColWidth(),d=g_objTableUtil,e=g_objTableResize,h=g_objPropertyUtil,f=this.rowLength-1;0<=f;f--)if(this.isHideForColspan(f,
a)){var g=this.getCell(f,a),k=g.cloneNode(b),l=this.getRowRange(f,a),m=this.getColRange(f,a);this.setColspan(g,a-m.start);this.setColspan(k,m.end-a+1);if(10<h.getStyleWidth(g)){var n=e.offsetWidthToStyleWidth(this.arraySum(c,m.start,a-1),g);d.setNodeValue_Width(g,n,"px");n=e.offsetWidthToStyleWidth(this.arraySum(c,a,m.end),g);d.setNodeValue_Width(k,n,"px")}insertAfter(g,k);f=l.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(q){dalert(q)}},removeRow:function(a,b){try{if("undefined"==
typeof a)return null;"undefined"==typeof b&&(b=a);if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var c=this.table.ownerDocument;if(!c)return null;for(var d=g_objNodeUtil,e=g_objTableUtil,h=g_objTableResize,f=g_objPropertyUtil,g=!1,k=this.colLength-1;0<=k;k--){var l=this.getRowRange(a,k);l.start<a&&l.end>b&&d.setAttribute(this.getCell(a,k),this.DZE_TEMP,"")}this.splitRow(a,!1);this.splitRow(b+1,!0);var m=c.createDocumentFragment();for(c=b;c>=a;c--)m.firstChild?m.insertBefore(this.trs[c],
m.firstChild):m.appendChild(this.trs[c]);for(var n=this.tables.length-1;0<=n;n--)0==this.tables[n].rows.length&&(this.tables[n].parentNode&&this.tables[n].parentNode.removeChild(this.tables[n]),this.table==this.tables[n]&&(this.table=0<=n-1?this.tables[n-1]:null),this.tables.splice(n,1));this.makeMatrix();for(k=this.colLength-1;0<=k;k--){var q=this.getCell(a-1,k),p=this.getCell(a,k);q=d.hasAttribute(q,this.DZE_TEMP)?q:null;p=d.hasAttribute(p,this.DZE_TEMP)?p:null;d.removeAttribute(q,this.DZE_TEMP);
d.removeAttribute(p,this.DZE_TEMP);if(q&&p){if(10<f.getStyleHeight(q)){var t=h.offsetHeightToStyleHeight(q.offsetHeight+p.offsetHeight,q);e.setNodeValue_Height(q,t,"px")}this.setRowspan(q,this.getRowspan(q)+this.getRowspan(p));p.parentNode.removeChild(p);g=!0}}g&&this.makeMatrix();this.arrRowHeight&&0<this.arrRowHeight.length&&this.arrRowHeight.splice(a,b-a+1);return m&&m.firstChild?m:null}catch(r){dalert(r)}},removeCol:function(a,b){try{if("undefined"==typeof a)return null;"undefined"==typeof b&&
(b=a);if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var c=g_objNodeUtil,d=g_objTableResize,e=g_objTableUtil,h=this.table.ownerDocument;if(!h)return null;for(var f=this.calculateColWidth(),g=this.rowLength-1;0<=g;g--){var k=this.getColRange(g,a);k.start<a&&k.end>b&&c.setAttribute(this.getCell(g,a),this.DZE_TEMP,"")}this.splitCol(a,!1);this.splitCol(b+1,!0);var l=[];for(g=0;g<this.rowLength;g++)for(var m=a;m<=b;m++)l[g]||(l[g]=[]),l[g][m]=!1;var n=h.createDocumentFragment();for(g=
this.rowLength-1;0<=g;g--){var q=this.trs[g].cloneNode(!1);for(m=b;m>=a;m--)if(!l[g][m]){var p=this.getRowRange(g,m);k=this.getColRange(g,m);if(!(p.start<g)){for(var t=p.start;t<=p.end;t++)for(var r=k.start;r<=k.end;r++)l[t]&&!1===l[t][r]&&(l[t][r]=!0);q.insertBefore(this.getCell(g,m),q.firstChild)}}n.insertBefore(q,n.firstChild)}this.makeMatrix();for(g=this.rowLength-1;0<=g;g--){var v=this.getCell(g,a-1),u=this.getCell(g,a);v=c.hasAttribute(v,this.DZE_TEMP)?v:null;u=c.hasAttribute(u,this.DZE_TEMP)?
u:null;c.removeAttribute(v,this.DZE_TEMP);c.removeAttribute(u,this.DZE_TEMP);if(v&&u){var w=d.offsetWidthToStyleWidth(v.offsetWidth+u.offsetWidth,v);e.setNodeValue_Width(v,w,"px");this.setColspan(v,this.getColspan(v)+this.getColspan(u));u.parentNode.removeChild(u)}}d=0;for(var x=this.colgroups.length;d<x;d++){var y=c.getImmediateChildNodesByTagName(this.colgroups[d],"col");for(h=b;h>=a;h--)y[h]&&y[h].parentNode&&y[h].parentNode.removeChild(y[h])}f.splice(a,b-a+1);d=0;for(x=this.tables.length;d<x;d++)e.setNodeValue_Width(this.tables[d],
this.arraySum(f,0),"px");this.makeMatrix();this.arrColWidth&&0<this.arrColWidth.length&&this.arrColWidth.splice(a,b-a+1);return n&&n.firstChild?n:null}catch(z){dalert(z)}},cloneRow:function(a,b,c){try{if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var d=this.table.ownerDocument;if(!d)return null;c=c?!0:!1;for(var e=g_objTableUtil,h=g_objTableResize,f=g_objPropertyUtil,g=null,k=[],l=a;l<=b;l++)for(var m=0;m<this.colLength;m++)k[l]||(k[l]=[]),k[l][m]=!1;var n=d.createDocumentFragment();
for(l=a;l<=b;l++){var q=this.trs[l].cloneNode(!1);for(m=0;m<this.colLength;m++)if(!k[l][m]){for(var p=this.getRowRange(l,m),t=this.getColRange(l,m),r=p.start;r<=p.end;r++)for(var v=t.start;v<=t.end;v++)k[r]&&!1===k[r][v]&&(k[r][v]=!0);var u=this.getCell(l,m),w=e.cloneCell(u,c),x=Math.max(a,p.start),y=Math.min(b,p.end),z=this.getRowspan(u);d=y-x+1;if(z!=d&&(this.setRowspan(w,d),10<f.getStyleHeight(u))){g=g||this.calculateRowHeight();var A=this.arraySum(g,x,y);e.setNodeValue_Height(w,h.offsetHeightToStyleHeight(A,
u),"px")}q.appendChild(w)}n.appendChild(q)}return n}catch(B){dalert(B)}},cloneCol:function(a,b,c){try{if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var d=this.table.ownerDocument;if(!d)return null;c=c?!0:!1;for(var e=g_objTableUtil,h=g_objTableResize,f=null,g=[],k=0;k<=this.rowLength;k++)for(var l=a;l<=b;l++)g[k]||(g[k]=[]),g[k][l]=!1;var m=d.createDocumentFragment();for(k=0;k<this.rowLength;k++){var n=this.trs[k].cloneNode(!1);for(l=a;l<=b;l++)if(!g[k][l]){for(var q=this.getRowRange(k,
l),p=this.getColRange(k,l),t=q.start;t<=q.end;t++)for(var r=p.start;r<=p.end;r++)g[t]&&!1===g[t][r]&&(g[t][r]=!0);var v=this.getCell(k,l),u=e.cloneCell(v,c),w=Math.max(a,p.start),x=Math.min(b,p.end),y=this.getColspan(v);d=x-w+1;if(d!=y){this.setColspan(u,d);f=f||this.calculateColWidth();var z=this.arraySum(f,w,x);e.setNodeValue_Width(u,h.offsetWidthToStyleWidth(z,v),"px")}n.appendChild(u)}m.appendChild(n)}return m}catch(A){dalert(A)}},divideCellCol:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellCol_NotAddCol(a,
b))return!0;var c=this.table.ownerDocument;if(!c)return!1;var d=g_objTableUtil,e=g_objTableResize,h=this.getDividePosition(a,b,!0);if(!h)return!1;var f=this.getDivideRowCol(h);if(!f)return!1;for(var g=this.getMatrixIndex(a),k=this.getColRange(g[0].row,g[0].col),l=f.length-1;0<=l;l--)1<f[l].span&&this.divideCol(k.start+l,f[l].span,f[l].arrSize);f=this.getDivideCell(h);if(!f)return!1;g=this.getMatrixIndex(a);this.getColRange(g[0].row,g[0].col);var m=c.createDocumentFragment();for(l=0;l<b;l++)c=a,0<
l&&(c=d.cloneCell(a,!1,!0),m.appendChild(c)),this.setColspan(c,f[l].span),d.setNodeValue_Width(c,e.offsetWidthToStyleWidth(f[l].size,a),"px");var n=a.parentNode,q=a.nextSibling;q?n.insertBefore(m,q):n.appendChild(m);this.makeMatrix();this.arrColWidth=null;return!0}catch(p){dalert(p)}},divideCellRow:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellRow_NotAddRow(a,b))return!0;if(!this.table.ownerDocument)return!1;var c=g_objTableUtil,d=g_objTableResize,e=this.getDividePosition(a,b,!1);
if(!e)return!1;var h=this.getDivideRowCol(e);if(!h)return!1;for(var f=this.getMatrixIndex(a),g=this.getRowRange(f[0].row,f[0].col),k=h.length-1;0<=k;k--)1<h[k].span&&this.divideRow(g.start+k,h[k].span,h[k].arrSize);h=this.getDivideCell(e);if(!h)return!1;f=this.getMatrixIndex(a);g=this.getRowRange(f[0].row,f[0].col);var l=g.end+1;for(k=h.length-1;0<=k;k--)b=a,0<k&&(b=c.cloneCell(a,!1,!0)),this.setRowspan(b,h[k].span),c.setNodeValue_Height(b,d.offsetHeightToStyleHeight(h[k].size,a),"px"),0<k&&(l-=h[k].span,
this.insertCell(b,l,f[0].col));this.makeMatrix();this.arrRowHeight=null;return!0}catch(m){dalert(m)}},getDividePosition:function(a,b,c){try{var d=this.getMatrixIndex(a);if(!d)return null;var e=null,h=null;a=0;c?(e=this.getColRange(d[0].row,d[0].col),h=this.arrColWidth=this.arrColWidth||this.calculateColWidth(),a=10):(e=this.getRowRange(d[0].row,d[0].col),h=this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight(),a=25);if(!h)return null;c=[];d=[];var f=[],g=h.slice(e.start,e.end+1);this.arrayWidthToPos(g,
c);var k=this.getIntegerDivision(this.arraySum(g),b);this.arrayWidthToPos(k,d);d[0]=0;d[b]=c[c.length-1];for(b=1;b<d.length-1;b++){var l=this.arrayCloset(c,d[b]),m=Math.abs(d[b]-l);0!=m&&m<a&&0>d.indexOf(l)&&l<d[b+1]&&(d[b]=l)}f=this.arrayUnion(c,d);f.sort(function(a,b){return a-b});return{arrCurPos:c,arrPos:d,arrNewPos:f}}catch(n){dalert(n)}},getDivideRowCol:function(a){try{if(!a)return null;var b=a.arrCurPos,c=a.arrNewPos;if(!b||!c)return null;a=[];for(var d=0,e=0,h=1;h<b.length;h++){e=c.indexOf(b[h],
d+1);var f=[];this.arrayPosToWidth(c.slice(d,e+1),f);a.push({span:e-d,arrSize:f});d=e}return a}catch(g){dalert(g)}},getDivideCell:function(a){try{if(!a)return null;var b=a.arrPos,c=a.arrNewPos;if(!b||!c)return null;a=[];for(var d=0,e=0,h=1;h<b.length;h++)e=c.indexOf(b[h],d+1),a.push({span:e-d,size:c[e]-c[d]}),d=e;return a}catch(f){dalert(f)}},divideCellCol_NotAddCol:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;var c=this.table.ownerDocument;if(!c)return!1;var d=this.getColspan(a),
e=this.getGCD(d,b);if(d<b||e!=b)return!1;var h=g_objTableUtil,f=g_objTableResize,g=this.getMatrixIndex(a),k=this.getColRange(g[0].row,g[0].col);this.arrColWidth=this.arrColWidth||this.calculateColWidth();var l=this.arrColWidth.slice(k.start,k.end+1),m=parseInt(d/e),n=c.createDocumentFragment();for(c=0;c<b;c++){d=a;0<c&&(d=h.cloneCell(a,!1,!0),n.appendChild(d));this.setColspan(d,m);var q=this.arraySum(l,m*c,m*c+m-1);h.setNodeValue_Width(d,f.offsetWidthToStyleWidth(q,a),"px")}var p=a.parentNode,t=a.nextSibling;
t?p.insertBefore(n,t):p.appendChild(n);this.makeMatrix();return!0}catch(r){dalert(r)}},divideCellRow_NotAddRow:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;if(!this.table.ownerDocument)return!1;var c=this.getRowspan(a),d=this.getGCD(c,b);if(c<b||d!=b)return!1;var e=g_objTableUtil,h=g_objTableResize,f=this.getMatrixIndex(a),g=f[0].row,k=f[0].col,l=this.getRowRange(g,k);this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight();var m=this.arrRowHeight.slice(l.start,l.end+1),
n=parseInt(c/d);for(--b;0<=b;b--){c=a;0<b&&(c=e.cloneCell(a,!1,!0));this.setRowspan(c,n);var q=this.arraySum(m,n*b,n*b+n-1);e.setNodeValue_Height(c,h.offsetWidthToStyleWidth(q,a),"px");0<b&&this.insertCell(c,g+b*n,k)}this.makeMatrix();return!0}catch(p){dalert(p)}},divideCol:function(a,b,c){try{if(isNaN(a)||isNaN(b))return!1;if(1==b)return!0;var d=this.table.ownerDocument;if(!d)return!1;var e=g_objNodeUtil,h=g_objTableUtil;this.arrColWidth=this.arrColWidth||this.calculateColWidth();if(!c){var f=this.arrColWidth[a];
c=[];for(var g=0;g<b;g++)c.push(+(f/b).toFixed(2))}for(var k=this.rowLength-1;0<=k;k=this.getRowRange(k,a).start-1){var l=this.getCell(k,a);l&&this.setColspan(l,this.getColspan(l)+b-1)}var m=d.createDocumentFragment();g=0;for(var n=this.colgroups.length;g<n;g++){var q=e.getImmediateChildNodesByTagName(this.colgroups[g],"col")[a];for(d=0;d<b;d++)f=q,0<d&&(f=q.cloneNode(),m.appendChild(f)),h.setNodeValue_Width(f,c[d],"px");var p=q.parentNode,t=q.nextSibling;t?p.insertBefore(m,t):p.appendChild(m)}this.makeMatrix();
return!0}catch(r){dalert(r)}},divideRow:function(a,b,c){try{if(isNaN(a)||isNaN(b)||0>a||a>=this.rowLength)return!1;if(1==b)return!0;var d=this.table.ownerDocument;if(!d)return!1;var e=g_objTableUtil;this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight();if(!c){var h=this.arrRowHeight[a];c=[];for(var f=0;f<b;f++)c.push(+(h/b).toFixed(2))}for(var g=this.colLength-1;0<=g;g=this.getColRange(a,g).start-1){var k=this.getCell(a,g);k&&this.setRowspan(k,this.getRowspan(k)+b-1)}var l=d.createDocumentFragment(),
m=this.trs[a];for(f=0;f<b;f++)a=m,0<f&&(a=m.cloneNode(),l.appendChild(a)),e.setNodeValue_Height(a,c[f],"px");var n=m.parentNode,q=m.nextSibling;q?n.insertBefore(l,q):n.appendChild(l);this.makeMatrix();return!0}catch(p){dalert(p)}},insertBlankCol:function(a,b){try{if("undefined"==typeof a||0>a||a>this.colLength||0>=b)return!1;b=b||0;this.splitCol(a,!1);var c=this.createBlankCell(this.rowLength,b);this.insertCell(c,0,a);if(0<this.colgroups.length){var d=this.table.ownerDocument;c=g_objNodeUtil;for(var e=
d.createDocumentFragment(),h=0;h<b;h++){var f=d.createElement("col");f.style.width="0px";e.appendChild(f)}h=0;for(var g=this.colgroups.length;h<g;h++){var k=c.getImmediateChildNodesByTagName(this.colgroups[h],"col");k[a]&&k[a].parentNode&&(a<k.length?k[a].parentNode.insertBefore(e.cloneNode(!0),k[a]):k[a].parentNode.appendChild(e.cloneNode(!0)))}}this.makeMatrix();return!0}catch(l){dalert(l)}},insertBlankRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength||0>=b)return!1;b=b||0;this.splitRow(a,
!1);for(var c=this.table.ownerDocument.createDocumentFragment(),d=0;d<b;d++)0==a?c.appendChild(this.trs[0].cloneNode(!1)):c.appendChild(this.trs[a-1].cloneNode(!1));var e=c.firstChild;0==a?this.trs[0].parentNode.insertBefore(c,this.trs[0]):insertAfter(this.trs[a-1],c);var h=this.createBlankCell(b,this.colLength);e.appendChild(h);this.makeMatrix();return!0}catch(f){dalert(f)}},insertRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength)return!1;b=b||1;this.splitRow(a,!1);a=0<a?a-1:
a;for(var c=this.cloneRow(a,a),d=this.table.ownerDocument.createDocumentFragment(),e=0;e<b;e++)d.appendChild(c.cloneNode(!0));0==a?this.trs[0].parentNode.insertBefore(d,this.trs[0]):insertAfter(this.trs[a],d);this.makeMatrix();return!0}catch(h){dalert(h)}},getSelection:function(){try{for(var a=g_objTableUtil,b=g_objTableFlag,c=null,d=null,e=!1,h=[],f=function(a){a=this.getMatrixIndex(a);for(var b=0;b<a.length;b++){var c=a[b].row,d=a[b].col;h[c]||(h[c]=[]);h[c][d]=!0}}.bind(this),g=function(a,b,c,
d){for(;a<=c;a++)for(var e=b;e<=d;e++)h[a]&&h[a][e]&&(h[a][e]=!1)}.bind(this),k=function(a,b,c,d){for(;a<=c;a++)for(var e=b;e<=d;e++)if(!h[a]||!h[a][e])return!1;return!0}.bind(this),l=0,m=this.tables.length;l<m;l++){c=this.tables[l];for(var n=0,q=c.rows.length;n<q;n++)for(var p=0,t=a.getTableCellsLength(c,n);p<t;p++){var r=b.GetCellAttribute_Flag(c,n,p);if(1==r||2==r||3==r||4==r)d=a.getTableCellElement(c,n,p),f(d),e=!0}}if(!e)return null;a=[];b=null;c=0;l=f=e=d=-1;n=0;for(q=h.length;n<q;n++)if(h[n])for(p=
0,t=h[n].length;p<t;p++)if(h[n][p]){d=e=n;f=l=p;c=1;for(m=n;m<q;m++)for(r=p;r<t;r++)if(k(n,p,m,r)){var v=(m-n+1)*(r-p+1);v>c&&(e=m,l=r,c=v)}g(d,f,e,l);a.push({nStartRow:d,nStartCol:f,nEndRow:e,nEndCol:l})}b=g=null;for(n=0;n<a.length;n++){g=a[n];b=null;for(var u=g.nStartRow;u<=g.nEndRow;u++)for(var w=g.nStartCol;w<=g.nEndCol;w++)this.isShow(u,w)&&(b||(b=[]),b.push(this.getCell(u,w)));g.arrCell=b}return a}catch(x){dalert(x)}},isBlankCol:function(a){try{if(0>a||a>=this.colLength)return!0;if(this.arrBlankCol&&
null!==this.arrBlankCol[a])return this.arrBlankCol[a];if(!this.arrBlankCol){this.arrBlankCol=[];for(var b=0;b<this.colLength;b++)this.arrBlankCol[b]=null}for(b=0;b<this.rowLength&&!this.isShow(b,a);b++);this.arrBlankCol[a]=b<this.rowLength?!1:!0;return this.arrBlankCol[a]}catch(c){dalert(c)}},isBlankRow:function(a){try{if(0>a||a>=this.rowLength)return!0;if(this.arrBlankRow&&null!==this.arrBlankRow[a])return this.arrBlankRow[a];if(!this.arrBlankRow){this.arrBlankRow=[];for(var b=0;b<this.rowLength;b++)this.arrBlankRow[b]=
null}for(b=0;b<this.colLength&&!this.isShow(a,b);b++);this.arrBlankRow[a]=b<this.colLength?!1:!0;return this.arrBlankRow[a]}catch(c){dalert(c)}}};

var g_objPositionUtil=new function(){this.getNodeElementPosition=function(b){try{var a=this.getElementPosition(b,!1);if(dzeEnvConfig.iFrameLayer){var c=this.getElementPosition(window.frameElement,!0);a.left+=c.left;a.top+=c.top;a.right+=c.left;a.bottom+=c.top}return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getNodeElementPosition")}return{left:0,top:0,right:0,bottom:0}};this.getElementPosition=function(b,a){try{var c={left:0,top:0,right:0,bottom:0},d=this.getDocumentScrollPosition(a),f=d.nScrollLeft,
e=d.nScrollTop,g=b.getBoundingClientRect();c.left=parseInt(g.left+f);c.top=parseInt(g.top+e);c.right=parseInt(g.right+f);c.bottom=parseInt(g.bottom+e);return c}catch(h){g_objCommonUtil.displayErrorAlert(h,"getElementPosition")}return{left:0,top:0,right:0,bottom:0}};this.getOuterRect=function(b){try{return{left:this.getLeft(b),top:this.getTop(b),width:b.offsetWidth,height:b.offsetHeight}}catch(a){g_objCommonUtil.displayErrorAlert(a,"getOuterRect")}};this.getLeft=function(b){try{return null==b?0:b.offsetLeft+
this.getInnerLeft(b.offsetParent)+this.getInnerScrollLeft(b)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getLeft")}};this.getInnerLeft=function(b){try{if(null==b)return 0;if(g_bDocType_XHTML){if(b==document.documentElement)return 0}else if(b==document.body)return 0;return this.getLeft(b)+this.getBorderLeft(b)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getInnerLeft")}};this.getBorderLeft=function(b){try{return g_bBrowserType_IE?b.clientLeft:parseInt(window.getComputedStyle(b,null).getPropertyValue("border-left-width"))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"getBorderLeft")}};this.getInnerScrollLeft=function(b){try{if(null==b||null==b.offsetParent||b.ownerDocument==g_objEditorDocument[g_nActiveEditNumber])return 0;for(var a=b,c=0,d=0;a&&!1===a.isEqualNode(b.offsetParent);)d=a.scrollLeft,!1===fnObjectCheckNull(d)&&!1===isNaN(d)&&(c-=d),a=a.parentNode;return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getInnerScrollLeft")}};this.getTop=function(b){try{return null==b?0:b.offsetTop+this.getInnerTop(b.offsetParent)+this.getInnerScrollTop(b)}catch(a){g_objCommonUtil.displayErrorAlert(a,
"getTop")}};this.getInnerTop=function(b){try{if(null==b)return 0;if(g_bDocType_XHTML){if(b==document.documentElement)return 0}else if(b==document.body)return 0;return this.getTop(b)+this.getBorderTop(b)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getInnerTop")}};this.getBorderTop=function(b){try{return g_bBrowserType_IE?b.clientTop:parseInt(window.getComputedStyle(b,null).getPropertyValue("border-top-width"))}catch(a){g_objCommonUtil.displayErrorAlert(a,"getBorderTop")}};this.getInnerScrollTop=
function(b){try{if(null==b||null==b.offsetParent||b.ownerDocument==g_objEditorDocument[g_nActiveEditNumber])return 0;for(var a=b,c=0,d=0;a&&!1===a.isEqualNode(b.offsetParent);)d=a.scrollTop,!1===fnObjectCheckNull(d)&&!1===isNaN(d)&&(c-=d),a=a.parentNode;return c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getInnerScrollTop")}};this.getDocumentScrollPosition=function(b){try{var a=this.getDocumentElementObject(b);if(a)return{nScrollLeft:a.scrollLeft,nScrollTop:a.scrollTop}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"getDocumentScrollPosition")}return{nScrollLeft:0,nScrollTop:0}};this.getDocumentElementObject=function(b){try{if(b){if(g_bBrowserType_IE||g_bBrowserType_FF||g_bBrowserType_OP)return g_bDocType_XHTML?window.parent.document.documentElement:window.parent.document.body;if(g_bBrowserType_WK)return window.parent.document.body}else{if(g_bBrowserType_IE||g_bBrowserType_FF||g_bBrowserType_OP)return g_bDocType_XHTML?document.documentElement:document.body;if(g_bBrowserType_WK)return document.body}}catch(a){g_objCommonUtil.displayErrorAlert(a,
"getDocumentElementObject")}return null};this.getEditorDocumentType=function(b){try{return!(null==g_objEditorDocument[b].compatMode||"CSS1Compat"!=g_objEditorDocument[b].compatMode)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getEditorDocumentType")}};this.getEditDocScrollPosition=function(b,a){try{if(g_bBrowserType_IE)return this.getEditorDocumentType(a)?{nScrollLeft:b.documentElement.scrollLeft,nScrollTop:b.documentElement.scrollTop}:{nScrollLeft:b.body.scrollLeft,nScrollTop:b.body.scrollTop};
if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return{nScrollLeft:b.body.scrollLeft,nScrollTop:b.body.scrollTop}}catch(c){g_objCommonUtil.displayErrorAlert(c,"getEditDocScrollPosition")}return{nScrollLeft:0,nScrollTop:0}};this.getElementPosClientRect=function(b){try{var a={left:0,top:0,right:0,bottom:0},c=b.getBoundingClientRect();a.left=parseInt(c.left);a.top=parseInt(c.top);a.right=parseInt(c.right);a.bottom=parseInt(c.bottom);return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getElementPosClientRect")}return{left:0,
top:0,right:0,bottom:0}};this.getOuterRectByClientWidthHeight=function(b){try{return{left:this.getLeft(b),top:this.getTop(b),width:b.clientWidth,height:b.clientHeight}}catch(a){g_objCommonUtil.displayErrorAlert(a,"getOuterRectByClientWidthHeight")}};this.getElementPosInEditArea=function(b){try{var a={left:0,top:0,right:0,bottom:0};if(g_bBrowserType_IE){var c=b.getBoundingClientRect();a.left=parseInt(c.left);a.top=parseInt(c.top);a.right=parseInt(c.right);a.bottom=parseInt(c.bottom)}else if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP){var d=this.getOuterRectByClientWidthHeight(b);a.left=parseInt(d.left);a.top=parseInt(d.top);a.right=parseInt(d.left)+parseInt(d.width);a.bottom=parseInt(d.top)+parseInt(d.height)}return a}catch(f){g_objCommonUtil.displayErrorAlert(f,"getElementPosInEditArea")}return{left:0,top:0,right:0,bottom:0}};this.getElementPosInEditAreaWithScrollPos=function(b,a){try{var c=this.getEditorDocumentType(a),d=0,f=0;g_bBrowserType_IE&&(c?(d=g_objEditorDocument[a].documentElement.scrollLeft,
f=g_objEditorDocument[a].documentElement.scrollTop):(d=g_objEditorDocument[a].body.scrollLeft,f=g_objEditorDocument[a].body.scrollTop));var e=this.getElementPosInEditArea_ByOffset(b);e.left+=d;e.top+=f;e.right+=d;e.bottom+=f;e.left=parseInt(e.left);e.top=parseInt(e.top);e.right=parseInt(e.right);e.bottom=parseInt(e.bottom);return e}catch(g){g_objCommonUtil.displayErrorAlert(g,"getElementPosInEditAreaWithScrollPos")}return null};this.getElementPosInEditArea_ByOffset=function(b){try{var a={left:0,top:0,
right:0,bottom:0};if(g_bBrowserType_IE){var c=b.getBoundingClientRect();a.left=c.left;a.top=c.top;a.right=c.right;a.bottom=c.bottom}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var d=this.getOuterRect(b);a.left=d.left;a.top=d.top;a.right=d.left+d.width;a.bottom=d.top+d.height}return a}catch(f){g_objCommonUtil.displayErrorAlert(f,"getElementPosInEditArea_ByOffset")}return{left:0,top:0,right:0,bottom:0}};this.getTableCellPosInEditAreaWithScrollPos=function(b,a,c,d){try{var f={left:0,
top:0,right:0,bottom:0};if(g_bBrowserType_IE||g_bBrowserType_FF)return this.getElementPosInEditAreaWithScrollPos(b,d);if(g_bBrowserType_WK||g_bBrowserType_OP){var e=this.getElementPosInEditAreaWithScrollPos(g_objTableUtil.getTableRowElement(a,c),d);f=this.getElementPosInEditAreaWithScrollPos(b,d);f.top=e.top;var g=c+b.rowSpan;if(g<a.rows.length){var h=this.getElementPosInEditAreaWithScrollPos(g_objTableUtil.getTableRowElement(a,g),d);f.bottom=h.top-1}else{var k=this.getElementPosInEditAreaWithScrollPos(a,
d);f.bottom=k.bottom-1}return f}}catch(l){g_objCommonUtil.displayErrorAlert(l,"getTableCellPosInEditAreaWithScrollPos")}return{left:0,top:0,right:0,bottom:0}};this.GetDocumentClientPos_XY=function(b){try{var a=this.getDocumentElementObject(!1);if(a){if(g_bBrowserType_IE)return{nPos_X:event.clientX+a.scrollLeft,nPos_Y:event.clientY+a.scrollTop};if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return{nPos_X:b.clientX+a.scrollLeft,nPos_Y:b.clientY+a.scrollTop}}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"GetDocumentClientPos_XY")}return{nPos_X:0,nPos_Y:0}};this.GetDocumentClientPos_XY_iFrameLayer=function(b){try{if(!dzeEnvConfig.iFrameLayer)return;var a=this.getDocumentElementObject(!0);if(a){if(g_bBrowserType_IE)return{nPos_X:window.parent.event.clientX+a.scrollLeft,nPos_Y:window.parent.event.clientY+a.scrollTop};if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return{nPos_X:b.clientX+a.scrollLeft,nPos_Y:b.clientY+a.scrollTop}}}catch(c){g_objCommonUtil.displayErrorAlert(c,"GetDocumentClientPos_XY_iFrameLayer")}return{nPos_X:0,
nPos_Y:0}};this.getDocumentClientSize=function(b){try{var a=this.getDocumentElementObject(!1);if(a)return{nClientWidth:a.clientWidth,nClientHeight:a.clientHeight}}catch(c){g_objCommonUtil.displayErrorAlert(c,"getDocumentClientSize")}return{nClientWidth:0,nClientHeight:0}};this.getLayerNodeElementPosition=function(b){try{var a=this.getLayerElementPosition(b,!1);if(dzeEnvConfig.iFrameLayer){var c=this.getLayerElementPosition(window.frameElement,!0);a.left+=c.left;a.top+=c.top;a.right+=c.left;a.bottom+=
c.top}return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getLayerNodeElementPosition")}return{left:0,top:0,right:0,bottom:0}};this.getLayerElementPosition=function(b,a){try{a={left:0,top:0,right:0,bottom:0};var c=this.getOuterRect(b);a.left=parseInt(c.left);a.top=parseInt(c.top);a.right=parseInt(c.left)+parseInt(c.width);a.bottom=parseInt(c.top)+parseInt(c.height);return a}catch(d){g_objCommonUtil.displayErrorAlert(d,"getLayerElementPosition")}return{left:0,top:0,right:0,bottom:0}};this.getOverlapRange=
function(b,a,c,d){b=Math.max(b,c);a=Math.min(a,d);return b<a?a-b:0}};

var tagUtil=function(){this.bFormTagSwitch=!1;tagUtil.prototype.updateTagAttribute=function(a,c){try{c=c||g_objEditorDocument[a];var b=c.getElementsByTagName("input");for(a=0;a<b.length;a++){var d=b[a].getAttribute("type").toLowerCase();if("checkbox"==d||"radio"==d)b[a].checked?b[a].setAttribute("checked",!0):b[a].removeAttribute("checked")}var e=c.getElementsByTagName("select");for(a=0;a<e.length;a++)this.updateTagAttribute_Select(e[a])}catch(f){g_objCommonUtil.displayErrorAlert(f,"updateTagAttribute")}};
tagUtil.prototype.undoRedoCheckBoxRadioTagAttribute=function(a,c){a=a.srcElement?a.srcElement:a.target;"checkbox"!=a.type&&"radio"!=a.type||setTimeout(function(){g_objTagUtil.updateTagAttribute(c);g_objUndoRedo.registerUndoRedoStack(0,c)},0)};tagUtil.prototype.updateTagAttribute_Select=function(a){try{for(var c=a.selectedIndex,b=0;b<a.options.length;b++){var d=a.options[b];c==b?d.setAttribute("selected","selected"):d.removeAttribute("selected")}}catch(e){g_objCommonUtil.displayErrorAlert(e,"updateTagAttribute_Select")}};
tagUtil.prototype.formTagSwitch=function(a,c){try{for(var b=g_objEditorDocument[c].getElementsByTagName("input"),d=0;d<b.length;d++)"checkbox"==b[d].getAttribute("type").toLowerCase()&&this.formTagSwitch_ContentEditable(b[d],a,c);var e=g_objEditorDocument[c].getElementsByTagName("select");for(d=0;d<e.length;d++)this.formTagSwitch_ContentEditable(e[d],a,c)}catch(f){g_objCommonUtil.displayErrorAlert(f,"formTagSwitch")}};tagUtil.prototype.formTagSwitch_ContentEditable=function(a,c,b){try{var d=g_objNodeUtil.getParentElement(a);
if("span"==g_objNodeUtil.getElementTagName(d).toLowerCase())d.contentEditable=c?"true":"false";else{var e=g_objEditorDocument[b].createElement("span");e.contentEditable=c?"true":"false";d.replaceChild(e,a);e.appendChild(a)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"formTagSwitch_ContentEditable")}};tagUtil.prototype.force_formTagSwitch=function(a){try{this.bFormTagSwitch=!1;for(var c=g_objEditorDocument[a].getElementsByTagName("input"),b=0;b<c.length;b++){var d=c[b].getAttribute("type").toLowerCase();
"checkbox"!=d&&"radio"!=d||this.formTagSwitch_ContentEditable(c[b],!1,a)}var e=g_objEditorDocument[a].getElementsByTagName("select");for(b=0;b<e.length;b++)this.formTagSwitch_ContentEditable(e[b],!1,a)}catch(f){g_objCommonUtil.displayErrorAlert(f,"force_formTagSwitch")}}},g_objTagUtil=new tagUtil;

var insertUtil=function(){insertUtil.prototype.insertTableCodeAtSelection=function(d,b){try{if(window.attachEvent){var a=g_objEditorDocument[b].selection;if(null!=a){var c=a.createRange();c.execCommand("Delete");var k=c.parentElement(),e=this.getNodePosition_For_PTag(k);if(null==e)insertHTMLCodeAtSelection(d,null,b);else{var p=g_objUndoRedo.getSelectionPos_IE(c,e.paramNode,a),f=g_objEditorDocument[b].createElement("p");f.innerHTML=e.paramNode.innerHTML;var l=g_objNodeUtil.getParentElement(e.paramNode);
if(null!=l){var m=!1;if(0==f.childNodes.length)m=!0;else if(1==f.childNodes.length){var h=f.childNodes[0];if(ID_SELECTION_ELEMENT_NODE==h.nodeType){var q=g_objNodeUtil.getElementTagName(h).toLowerCase();"br"==q&&(m=!0)}}if(m){var g=g_objEditorDocument[b].createElement("div");for(g.innerHTML=d;0<g.childNodes.length;)h=g.childNodes[0],l.insertBefore(h,e.paramNode)}else{l.insertBefore(f,e.paramNode);g=g_objEditorDocument[b].createElement("div");for(g.innerHTML=d;0<g.childNodes.length;)h=g.childNodes[0],
l.insertBefore(h,e.paramNode);c=a.createRange();c.moveToElementText(f);c.moveStart("character",p.nStartRangePos);c.execCommand("Delete");c=a.createRange();c.moveToElementText(e.paramNode);c.collapse(!0);c.moveEnd("character",p.nStartRangePos);c.execCommand("Delete")}}}}}else if(a=g_objEditWindow[b].getSelection(),null!=a&&1==a.rangeCount){c=a.getRangeAt(0);c.deleteContents();var n=c.startContainer,r=c.startOffset;e=this.getNodePosition_For_PTag(n);if(null==e)insertHTMLCodeAtSelection(d,null,b);else if(f=
g_objEditorDocument[b].createElement("p"),f.innerHTML=e.paramNode.innerHTML,l=g_objNodeUtil.getParentElement(e.paramNode),null!=l)if(m=!1,0==f.childNodes.length?m=!0:1==f.childNodes.length&&(h=f.childNodes[0],ID_SELECTION_ELEMENT_NODE==h.nodeType&&(q=g_objNodeUtil.getElementTagName(h).toLowerCase(),"br"==q&&(m=!0))),m)for(g=g_objEditorDocument[b].createElement("div"),g.innerHTML=d;0<g.childNodes.length;)h=g.childNodes[0],l.insertBefore(h,e.paramNode);else{l.insertBefore(f,e.paramNode);g=g_objEditorDocument[b].createElement("div");
for(g.innerHTML=d;0<g.childNodes.length;)h=g.childNodes[0],l.insertBefore(h,e.paramNode);a.removeAllRanges();c=g_objEditorDocument[b].createRange();c.selectNode(f);n=g_objUndoRedo.setNodePosition(e.paramPos,f);c.setStart(n,r);a.addRange(c);c.deleteContents();""==f.innerHTML&&l.removeChild(f);a.removeAllRanges();c=g_objEditorDocument[b].createRange();c.selectNode(e.paramNode);n=g_objUndoRedo.setNodePosition(e.paramPos,e.paramNode);c.setEnd(n,r);a.addRange(c);c.deleteContents()}}}catch(t){g_objCommonUtil.displayErrorAlert(t,
"insertTableCodeAtSelection")}};insertUtil.prototype.getNodePosition_For_PTag=function(d){try{for(var b=[];;){if("body"==d.nodeName.toLowerCase())return null;if("p"==d.nodeName.toLowerCase())break;var a=this.getNodePosition_previousSibling_For_PTag(d);b[b.length]=a;d=g_objNodeUtil.getParentElement(d);if(null==d)return null}return{paramNode:d,paramPos:b}}catch(c){g_objCommonUtil.displayErrorAlert(c,"getNodePosition_For_PTag")}return null};insertUtil.prototype.getNodePosition_previousSibling_For_PTag=
function(d){try{for(var b=0;null!=d.previousSibling;)b++,d=d.previousSibling;return b}catch(a){g_objCommonUtil.displayErrorAlert(a,"getNodePosition_previousSibling_For_PTag")}};insertUtil.prototype.insertLayerHTML=function(d,b){try{var a=null;if(b){if(a=g_objLayerKit.getLayerDocument(),null==a)return!1}else a=document;if(g_bBrowserType_IE)return a.body.insertAdjacentHTML("beforeEnd",d),!0;if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var c=a.createElement("div");c.innerHTML=d;a.getElementsByTagName("body")[0].appendChild(c);
return!0}}catch(k){g_objCommonUtil.displayErrorAlert(k,"insertLayerHTML")}return!1};insertUtil.prototype.saveSelectionRange_IE=function(d,b){try{if(0==d)if(window.attachEvent){var a=g_objEditorDocument[b].selection;g_objLastRange[b]=a.createRange()}else g_bBrowserType_IE&&(a=g_objEditWindow[b].getSelection(),1==a.rangeCount&&(g_objLastRange[b]=a.getRangeAt(0)));else 1==d&&(window.attachEvent?(a=g_objEditorDocument[b].selection,g_objCurrentRange[b]=a.createRange()):g_bBrowserType_IE&&(a=g_objEditWindow[b].getSelection(),
1==a.rangeCount&&(g_objCurrentRange[b]=a.getRangeAt(0))))}catch(c){g_objCommonUtil.displayErrorAlert(c,"saveSelectionRange_IE")}};insertUtil.prototype.activeSaveRangeFocus=function(d,b){try{if("undefined"!=typeof d){var a=null;if(0==d)a=g_objLastRange[b];else if(1==d)a=g_objCurrentRange[b];else return;window.attachEvent?g_objEditWindow[b].focus():g_objEditorDocument[b].body.focus();if(null!=a)if(window.attachEvent)a.select();else if(g_bBrowserType_IE){var c=g_objEditWindow[b].getSelection();c.removeAllRanges();
c.addRange(a)}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"activeSaveRangeFocus")}};insertUtil.prototype.dynamicLoad_CSS=function(d,b,a){try{"undefined"==typeof a&&(a=function(){});var c=d.getElementsByTagName("head")[0],k=c.getElementsByTagName("link");for(d=0;d<k.length;d++)if(k[d].getAttribute("href")==b){a();return}var e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");e.setAttribute("href",b);e.onload=function(){a()};c.appendChild(e)}catch(p){g_objCommonUtil.displayErrorAlert(p,
"dynamicLoad_CSS")}};insertUtil.prototype.dynamicLoad_JS=function(d,b){try{var a=d.getElementsByTagName("head")[0],c=a.getElementsByTagName("script");for(d=0;d<c.length;d++)if(c[d].getAttribute("src")==b)return;var k=document.createElement("script");k.setAttribute("type","text/javascript");k.setAttribute("src",b);a.appendChild(k)}catch(e){g_objCommonUtil.displayErrorAlert(e,"dynamicLoad_JS")}}},g_objInsertUtil=new insertUtil;

var g_objBorderComboBoxUtil=new function(){var h=this;this.arrBorderStyle=["noline","solid","dotted","dashed","double"];this.arrBorderWidth=["0","1","2","3"];this.makeBorderComboBoxHTML=function(c,d,f,e){try{var a="";a+='<div id="borderComboBoxContainer_'+c+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+f+'px;line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+f+'px;line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td class="tbComboBox_AreaLabel_1" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:2px;">';
if(0==d)for(var b=0;b<this.arrBorderStyle.length;b++)a="double"==this.arrBorderStyle[b]?a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:3px '+this.arrBorderStyle[b]+' #000000;display:none;"></div>'):"noline"==this.arrBorderStyle[b]?a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="display:none;">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:1px '+this.arrBorderStyle[b]+' #000000;display:none;"></div>');
else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)a+='<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:'+this.arrBorderWidth[b]+'px solid #000000;display:none;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';
a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div id="borderComboBoxLayer_'+c+'" style="position:absolute;display:none;z-index:20032;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+e+'px;border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'">';a+="<tr>";a+='<td style="line-height:normal;height:20px;border:0;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+e+'px;border-collapse:separate;table-layout:auto;">';if(0==d)for(b=0;b<this.arrBorderStyle.length;b++)a+=
"<tr>",a+='<td style="line-height:normal;padding:1px;height:20px;border:0;">',a+='<table id="borderSubContainer_'+c+"_"+this.arrBorderStyle[b]+'" width="'+e+'px" height="20" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:20px;"></td>',a+='<td id="borderSub_'+c+"_"+this.arrBorderStyle[b]+'" cusBorderIndex="'+b+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:20px;">',
a="double"==this.arrBorderStyle[b]?a+('<div style="height:1px;border-top:3px '+this.arrBorderStyle[b]+' #000000;"></div>'):"noline"==this.arrBorderStyle[b]?a+('<div style="">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):a+('<div style="height:1px;border-top:1px '+this.arrBorderStyle[b]+' #000000;"></div>'),a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)a+="<tr>",a+='<td style="line-height:normal;padding:1px;height:18px;border:0;">',a+='<table id="borderSubContainer_'+
c+"_"+this.arrBorderWidth[b]+'" width="'+e+'px" height="18" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:18px;"></td>',a+='<td id="borderSub_'+c+"_"+this.arrBorderWidth[b]+'" cusBorderIndex="'+b+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:18px;">',a+='<div style="height:1px;border-top:'+this.arrBorderWidth[b]+
'px solid #000000;"></div>',a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(g){g_objCommonUtil.displayErrorAlert(g,"makeBorderComboBoxHTML")}};this.initBorderComboBox=function(c,d,f){try{var e=g_objLayerKit.getElementById("borderComboBoxContainer_"+c);if(null!=e){var a=g_objLayerKit.getElementById("borderComboBoxLayer_"+c);if(null!=a)if(e.onmouseover=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_AreaOver)},
e.onmouseout=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_Area)},e.onmousedown=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_AreaDown)},e.onmouseup=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_Area)},e.onclick=function(a){h.showBorderComboBoxLayer(c)},g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_1").style.display="",0==d)for(var b=0;b<this.arrBorderStyle.length;b++){var g=g_objLayerKit.getElementById("borderSubContainer_"+
c+"_"+this.arrBorderStyle[b]);g.onmouseover=function(a){g_objComboBoxWin.fnComboBoxItemOver(this)};g.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)};g_objLayerKit.getElementById("borderSub_"+c+"_"+this.arrBorderStyle[b]).onclick=function(a){h.clickBorderComboBoxLayer(this,c,d);"undefined"!=typeof f&&f(h.getSelectedBorderValue(c,d))}}else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)g=g_objLayerKit.getElementById("borderSubContainer_"+c+"_"+this.arrBorderWidth[b]),g.onmouseover=
function(a){g_objComboBoxWin.fnComboBoxItemOver(this)},g.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)},g_objLayerKit.getElementById("borderSub_"+c+"_"+this.arrBorderWidth[b]).onclick=function(a){h.clickBorderComboBoxLayer(this,c,d);"undefined"!=typeof f&&f(h.getSelectedBorderValue(c,d))}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"initBorderComboBox")}};this.showBorderComboBoxLayer=function(c){try{var d=g_objLayerKit.getElementById("borderComboBoxContainer_"+c);if(null!=d){var f=
g_objLayerKit.getElementById("borderComboBoxLayer_"+c);null!=f&&(""==f.style.display?(f.style.display="none",d.className=g_strSkin_ComboBox_Area):(f.style.display="",d.className=g_strSkin_ComboBox_AreaDown))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"showBorderComboBoxLayer")}};this.clickBorderComboBoxLayer=function(c,d,f){try{this.showBorderComboBoxLayer(d);var e=g_objPropertyUtil.getTargetCellFlag(c,"cusBorderIndex");if("double"==this.arrBorderStyle[e]){var a=g_objLayerKit.getElementById("txtBorderWidth");
3>a.value&&(a.value=3,g_objBorderSelectionUtil.setBorderWidth(3))}var b=this.getSubArrayObject(f);if(null!=b)for(c=0;c<b.length;c++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+d+"_"+c).style.display=c==e?"":"none"}catch(g){g_objCommonUtil.displayErrorAlert(g,"clickBorderComboBoxLayer")}};this.getSelectedBorderValue=function(c,d){try{var f=this.getSubArrayObject(d);if(null==f)return"";for(d=0;d<f.length;d++)if(""==g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_"+d).style.display)return f[d];
return""}catch(e){g_objCommonUtil.displayErrorAlert(e,"getSelectedBorderValue")}};this.setSelectedBorderValue=function(c,d,f){try{var e=this.getSubArrayObject(d);if(null!=e)for(d=0;d<e.length;d++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_"+d).style.display=e[d]==f?"":"none"}catch(a){g_objCommonUtil.displayErrorAlert(a,"setSelectedBorderValue")}};this.setSelectedIndex=function(c,d,f){try{var e=this.getSubArrayObject(d);if(null!=e)for(d=0;d<e.length;d++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+
c+"_"+d).style.display=d==f?"":"none"}catch(a){g_objCommonUtil.displayErrorAlert(a,"setSelectedIndex")}};this.getSubArrayObject=function(c){try{if(COMBOBOX_TYPE_BORDER_STYLE==c)return this.arrBorderStyle;if(1==c)return this.arrBorderWidth}catch(d){g_objCommonUtil.displayErrorAlert(d,"getSubArrayObject")}return null}};

var g_objBorderSelectionUtil=new function(){var g=this;this.bUseSelectRec=!1;this.arrID_SelectRec=["selectRec_0","selectRec_1","selectRec_2"];this.arrObjSelectRec=[];this.arrID_MainRec=["mainRec_0","mainRec_1","mainRec_2","mainRec_3"];this.arrObjMainRec=[];this.arrID_MiniRec="miniRec_h_0 miniRec_h_1 miniRec_h_2 miniRec_v_0 miniRec_v_1 miniRec_v_2".split(" ");this.arrObjMiniRec=[];this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.strBorderString="";this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle=
"";this.makeBorderSelectionHTML=function(a,c,d,b){try{var e=2*c+2*d,f=parseInt(e/3),g=e+10;this.bUseSelectRec=1==a?!1:b;b="";b+='<div id="borderSelectionContainer" style="overflow:hidden;display:inline-block">';b+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';b+="<tr>";b+='<td colspan="2">';this.bUseSelectRec&&(b+=this.makeBorderSelectionHTML_selectRec(g));b+="</td>";b+="</tr>";b+="<tr>";b+="<td>";b+=this.makeBorderSelectionHTML_mainRec(a,
c,d);b+="</td>";b+="<td>";b+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';b+="<tr>";b+='<td style="height:'+f+'px;vertical-align:top;">';b+=this.makeBorderSelectionHTML_miniRec("miniRec_h_0",10,!0,0);b+="</td>";b+="</tr>";b+="<tr>";b+='<td style="height:'+f+'px;vertical-align:middle;">';0==a&&(b+=this.makeBorderSelectionHTML_miniRec("miniRec_h_1",10,!0,1));b+="</td>";b+="</tr>";b+="<tr>";b+='<td style="height:'+f+'px;vertical-align:bottom;">';
b+=this.makeBorderSelectionHTML_miniRec("miniRec_h_2",10,!0,2);b+="</td>";b+="</tr>";b+="</table>";b+="</td>";b+="</tr>";b+="<tr>";b+="<td>";b+='<table width="'+e+'"style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';b+="<tr>";b+='<td align="left">';b+=this.makeBorderSelectionHTML_miniRec("miniRec_v_0",10,!1,0);b+="</td>";b+='<td align="center">';0==a&&(b+=this.makeBorderSelectionHTML_miniRec("miniRec_v_1",10,!1,1));b+="</td>";b+='<td align="right">';
b+=this.makeBorderSelectionHTML_miniRec("miniRec_v_2",10,!1,2);b+="</td>";b+="</tr>";b+="</table>";b+="</td>";b+="<td></td>";b+="</tr>";return b+"</table></div>"}catch(h){g_objCommonUtil.displayErrorAlert(h,"makeBorderSelectionHTML")}};this.makeBorderSelectionHTML_selectRec=function(a){try{var c=parseInt((a-24)/3),d=parseInt(c/2);a="";a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="'+c+'">';a+='<table id="selectRec_0" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_left"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_left"></td>';a+="</tr>";a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_left"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_left"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="12"></td>';a+='<td width="'+c+'" align="center">';a+='<table id="selectRec_1" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_1"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_2"></td>';a+="</tr>";a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_3"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_4"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="12"></td>';a+='<td width="'+c+'" align="right">';a+='<table id="selectRec_2" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_1"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_2"></td>';a+="</tr>";a+="<tr>";a+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_3"></td>';a+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_4"></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="5" height="14"></td>';return a+"</tr></table>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"makeBorderSelectionHTML_selectRec")}};
this.makeBorderSelectionHTML_mainRec=function(a,c,d){try{var b="";b+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';b+="<tr>";b+='<td class="b_s_out_left_top" style="width:'+c+"px;height:"+c+'px;"></td>';b+='<td style="width:'+d+"px;height:"+c+'px;"></td>';b+='<td style="width:'+d+"px;height:"+c+'px;"></td>';b+='<td class="b_s_out_right_top" style="width:'+c+"px;height:"+c+'px;"></td>';b+="</tr>";b+="<tr>";b+='<td style="height:'+d+'px;"></td>';
0==a?(b+='<td id="mainRec_0" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',b+='<td id="mainRec_1" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(b+='<td id="mainRec_0" class="b_s_in_left b_s_in_top" style="height:'+d+'px;"></td>',b+='<td id="mainRec_1" class="b_s_in_right b_s_in_top" style="height:'+d+'px;"></td>');b+='<td style="height:'+d+'px;"></td>';b+="</tr>";b+="<tr>";b+='<td style="height:'+d+'px;"></td>';
0==a?(b+='<td id="mainRec_2" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',b+='<td id="mainRec_3" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(b+='<td id="mainRec_2" class="b_s_in_left b_s_in_bottom" style="height:'+d+'px;"></td>',b+='<td id="mainRec_3" class="b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>');b+='<td style="height:'+d+'px;"></td>';b+="</tr>";b+="<tr>";b+='<td class="b_s_out_left_bottom" style="height:'+
c+'px;"></td>';b+='<td style="height:'+c+'px;"></td>';b+='<td style="height:'+c+'px;"></td>';b+='<td class="b_s_out_right_bottom" style="height:'+c+'px;"></td>';return b+"</tr></table>"}catch(e){g_objCommonUtil.displayErrorAlert(e,"makeBorderSelectionHTML_mainRec")}};this.makeBorderSelectionHTML_miniRec=function(a,c,d,b){try{var e="";e+='<table id="'+a+'" class="b_s_mini" style="border-collapse:separate;table-layout:fixed;cursor:pointer;border-spacing:2px;" border="0" cellspacing="2" cellpadding="0">';
d?0==b?(e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>"):1==b?(e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #000000;"></td>',e+=
"</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>"):2==b&&(e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+c+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>"):(e+="<tr>",0==b?(e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #000000;"></td>',
e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #c5c5c5;"></td>'):1==b?(e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #000000;"></td>',e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #c5c5c5;"></td>'):2==b&&(e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+
c+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+c+'px;border-left:1px solid #000000;"></td>'),e+="</tr>");return e+"</table>"}catch(f){g_objCommonUtil.displayErrorAlert(f,"makeBorderSelectionHTML_miniRec")}};this.initBorderSelection=function(){try{this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.strBorderString="";this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle="";if(this.bUseSelectRec)for(var a=0;a<this.arrID_SelectRec.length;a++)this.arrObjSelectRec[a]=
g_objLayerKit.getElementById(this.arrID_SelectRec[a]),this.arrObjSelectRec[a].onclick=function(a){g.clickSelectRec(this)};for(a=0;a<this.arrID_MainRec.length;a++)this.arrObjMainRec[a]=g_objLayerKit.getElementById(this.arrID_MainRec[a]);for(a=0;a<this.arrID_MiniRec.length;a++){var c=g_objLayerKit.getElementById(this.arrID_MiniRec[a]);null==c?this.arrObjMiniRec[a]=null:(this.arrObjMiniRec[a]=c,c.onclick=function(a){g.clickMiniRec(this)})}}catch(d){g_objCommonUtil.displayErrorAlert(d,"initBorderSelection")}};
this.setBorderWidth=function(a){try{this.nBorderWidth=a,this.strBorderString=this.getBorderString()}catch(c){g_objCommonUtil.displayErrorAlert(c,"setBorderWidth")}};this.setBorderStyle=function(a){try{this.strBorderStyle=a,this.strBorderString=this.getBorderString()}catch(c){g_objCommonUtil.displayErrorAlert(c,"setBorderStyle")}};this.setBorderColor=function(a){try{this.strBorderColor=a,this.strBorderString=this.getBorderString()}catch(c){g_objCommonUtil.displayErrorAlert(c,"setBorderColor")}};this.getBorderString=
function(){try{return"noline"==this.strBorderStyle?"0px solid #000000":""==this.strBorderColor?this.nBorderWidth+"px none":this.nBorderWidth+"px "+this.strBorderStyle+" "+this.strBorderColor}catch(a){g_objCommonUtil.displayErrorAlert(a,"getBorderString")}};this.clickSelectRec=function(a){try{if(this.bUseSelectRec){for(var c=a.id,d=-1,b=!1,e=0;e<this.arrID_SelectRec.length;e++)this.arrID_SelectRec[e]==c?(d=e,g_objPropertyUtil.element_hasClass(this.arrObjSelectRec[e],"b_s_rec_selected")?g_objPropertyUtil.element_removeClass(this.arrObjSelectRec[e],
"b_s_rec_selected"):(g_objPropertyUtil.element_addClass(a,"b_s_rec_selected"),b=!0)):g_objPropertyUtil.element_hasClass(this.arrObjSelectRec[e],"b_s_rec_selected")&&g_objPropertyUtil.element_removeClass(this.arrObjSelectRec[e],"b_s_rec_selected");b?0==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],
!0),this.setChecked(this.arrID_MiniRec[5],!0)):1==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!1),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!1),this.setChecked(this.arrID_MiniRec[5],!0)):2==d&&(this.setChecked(this.arrID_MiniRec[0],!1),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.setChecked(this.arrID_MiniRec[2],
!1),this.setChecked(this.arrID_MiniRec[3],!1),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!0),this.setChecked(this.arrID_MiniRec[5],!1)):(this.setChecked(this.arrID_MiniRec[0],!1),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!1),this.setChecked(this.arrID_MiniRec[2],!1),this.setChecked(this.arrID_MiniRec[3],!1),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!1),this.setChecked(this.arrID_MiniRec[5],!1))}}catch(f){g_objCommonUtil.displayErrorAlert(f,
"clickSelectRec")}};this.updateSelectRec=function(){try{if(this.bUseSelectRec){for(var a=[],c=0;c<this.arrObjMiniRec.length;c++){if(1==c){if(this.bHide_MiniRec_h_1){a[c]=!0;continue}}else if(4==c&&this.bHide_MiniRec_v_1){a[c]=!0;continue}g_objPropertyUtil.element_hasClass(this.arrObjMiniRec[c],"b_s_rec_selected")?a[c]=!0:a[c]=!1}var d=-1;1==a[0]&&1==a[1]&&1==a[2]&&1==a[3]&&1==a[4]&&1==a[5]?d=0:1==a[0]&&0==a[1]&&1==a[2]&&1==a[3]&&0==a[4]&&1==a[5]?d=1:0==a[0]&&1==a[1]&&0==a[2]&&0==a[3]&&1==a[4]&&0==
a[5]&&(d=2);for(c=0;c<this.arrObjSelectRec.length;c++)c==d?g_objPropertyUtil.element_hasClass(this.arrObjSelectRec[c],"b_s_rec_selected")||g_objPropertyUtil.element_addClass(this.arrObjSelectRec[c],"b_s_rec_selected"):g_objPropertyUtil.element_hasClass(this.arrObjSelectRec[c],"b_s_rec_selected")&&g_objPropertyUtil.element_removeClass(this.arrObjSelectRec[c],"b_s_rec_selected")}}catch(b){g_objCommonUtil.displayErrorAlert(b,"updateSelectRec")}};this.clickMiniRec=function(a){try{g_objPropertyUtil.element_hasClass(a,
"b_s_rec_selected")?(g_objPropertyUtil.element_removeClass(a,"b_s_rec_selected"),this.doClickMiniRec(a,!1)):(g_objPropertyUtil.element_addClass(a,"b_s_rec_selected"),this.doClickMiniRec(a,!0)),this.bUseSelectRec&&this.updateSelectRec()}catch(c){g_objCommonUtil.displayErrorAlert(c,"clickMiniRec")}};this.doClickMiniRec=function(a,c){try{var d=a.id;c?this.arrID_MiniRec[0]==d?(this.arrObjMainRec[0].style.borderTop=this.getBorderString(),this.arrObjMainRec[1].style.borderTop=this.getBorderString()):this.arrID_MiniRec[1]==
d?(this.arrObjMainRec[0].style.borderBottom=this.getBorderString(),this.arrObjMainRec[1].style.borderBottom=this.getBorderString()):this.arrID_MiniRec[2]==d?(this.arrObjMainRec[2].style.borderBottom=this.getBorderString(),this.arrObjMainRec[3].style.borderBottom=this.getBorderString()):this.arrID_MiniRec[3]==d?(this.arrObjMainRec[0].style.borderLeft=this.getBorderString(),this.arrObjMainRec[2].style.borderLeft=this.getBorderString()):this.arrID_MiniRec[4]==d?(this.arrObjMainRec[0].style.borderRight=
this.getBorderString(),this.arrObjMainRec[2].style.borderRight=this.getBorderString()):this.arrID_MiniRec[5]==d&&(this.arrObjMainRec[1].style.borderRight=this.getBorderString(),this.arrObjMainRec[3].style.borderRight=this.getBorderString()):this.arrID_MiniRec[0]==d?(this.arrObjMainRec[0].style.borderTop="",this.arrObjMainRec[1].style.borderTop=""):this.arrID_MiniRec[1]==d?(this.arrObjMainRec[0].style.borderBottom="",this.arrObjMainRec[1].style.borderBottom=""):this.arrID_MiniRec[2]==d?(this.arrObjMainRec[2].style.borderBottom=
"",this.arrObjMainRec[3].style.borderBottom=""):this.arrID_MiniRec[3]==d?(this.arrObjMainRec[0].style.borderLeft="",this.arrObjMainRec[2].style.borderLeft=""):this.arrID_MiniRec[4]==d?(this.arrObjMainRec[0].style.borderRight="",this.arrObjMainRec[2].style.borderRight=""):this.arrID_MiniRec[5]==d&&(this.arrObjMainRec[1].style.borderRight="",this.arrObjMainRec[3].style.borderRight="")}catch(b){g_objCommonUtil.displayErrorAlert(b,"doClickMiniRec")}};this.getBorderSelectionMiniRecById=function(a){try{for(var c=
0;c<this.arrID_MiniRec.length;c++)if(this.arrID_MiniRec[c]==a)return this.arrObjMiniRec[c]}catch(d){g_objCommonUtil.displayErrorAlert(d,"getBorderSelectionMiniRecById")}return null};this.getBorderValue=function(a){try{if(this.arrID_MiniRec[0]==a){var c=this.arrObjMainRec[0].style.borderTopWidth,d=this.arrObjMainRec[0].style.borderTopStyle,b=this.arrObjMainRec[0].style.borderTopColor;b=g_objCommonUtil.getHexColorCode(b);var e=c+" "+d+" "+b;return e=e.trim()}if(this.arrID_MiniRec[1]==a)return c=this.arrObjMainRec[0].style.borderBottomWidth,
d=this.arrObjMainRec[0].style.borderBottomStyle,b=this.arrObjMainRec[0].style.borderBottomColor,b=g_objCommonUtil.getHexColorCode(b),e=c+" "+d+" "+b,e=e.trim();if(this.arrID_MiniRec[2]==a)return c=this.arrObjMainRec[2].style.borderBottomWidth,d=this.arrObjMainRec[2].style.borderBottomStyle,b=this.arrObjMainRec[2].style.borderBottomColor,b=g_objCommonUtil.getHexColorCode(b),e=c+" "+d+" "+b,e=e.trim();if(this.arrID_MiniRec[3]==a)return c=this.arrObjMainRec[0].style.borderLeftWidth,d=this.arrObjMainRec[0].style.borderLeftStyle,
b=this.arrObjMainRec[0].style.borderLeftColor,b=g_objCommonUtil.getHexColorCode(b),e=c+" "+d+" "+b,e=e.trim();if(this.arrID_MiniRec[4]==a)return c=this.arrObjMainRec[0].style.borderRightWidth,d=this.arrObjMainRec[0].style.borderRightStyle,b=this.arrObjMainRec[0].style.borderRightColor,b=g_objCommonUtil.getHexColorCode(b),e=c+" "+d+" "+b,e=e.trim();if(this.arrID_MiniRec[5]==a)return c=this.arrObjMainRec[1].style.borderRightWidth,d=this.arrObjMainRec[1].style.borderRightStyle,b=this.arrObjMainRec[1].style.borderRightColor,
b=g_objCommonUtil.getHexColorCode(b),e=c+" "+d+" "+b,e=e.trim()}catch(f){g_objCommonUtil.displayErrorAlert(f,"getBorderValue")}return""};this.getChecked=function(a){try{var c=this.getBorderSelectionMiniRecById(a);return null==c?null:g_objPropertyUtil.element_hasClass(c,"b_s_rec_selected")?!0:!1}catch(d){g_objCommonUtil.displayErrorAlert(d,"getChecked")}return null};this.setChecked=function(a,c){try{var d=this.getBorderSelectionMiniRecById(a);null!=d&&(c?g_objPropertyUtil.element_hasClass(d,"b_s_rec_selected")||
g_objPropertyUtil.element_addClass(d,"b_s_rec_selected"):g_objPropertyUtil.element_hasClass(d,"b_s_rec_selected")&&g_objPropertyUtil.element_removeClass(d,"b_s_rec_selected"),this.doClickMiniRec(d,c))}catch(b){g_objCommonUtil.displayErrorAlert(b,"setChecked")}};this.hideMiniRec=function(a){try{if(a==this.arrID_MiniRec[1]||a==this.arrID_MiniRec[4]){var c=this.getBorderSelectionMiniRecById(a);if(null==c)return null;c.style.display="none";a==this.arrID_MiniRec[1]?(this.bHide_MiniRec_h_1=!0,g_objPropertyUtil.element_removeClass(this.arrObjMainRec[0],
"b_s_in_bottom"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[1],"b_s_in_bottom"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[2],"b_s_in_top"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[3],"b_s_in_top"),g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],0,0).style.borderBottom="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],0,1).style.borderBottom="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],1,0).style.borderTop="0px",
g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],1,1).style.borderTop="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],0,0).style.borderBottom="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],0,1).style.borderBottom="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],1,0).style.borderTop="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],1,1).style.borderTop="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],0,0).style.borderBottom=
"0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],0,1).style.borderBottom="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],1,0).style.borderTop="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],1,1).style.borderTop="0px"):a==this.arrID_MiniRec[4]&&(this.bHide_MiniRec_v_1=!0,g_objPropertyUtil.element_removeClass(this.arrObjMainRec[0],"b_s_in_right"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[1],"b_s_in_left"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[2],
"b_s_in_right"),g_objPropertyUtil.element_removeClass(this.arrObjMainRec[3],"b_s_in_left"),g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],0,0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],0,1).style.borderLeft="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],1,0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[0],1,1).style.borderLeft="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],0,
0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],0,1).style.borderLeft="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],1,0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[1],1,1).style.borderLeft="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],0,0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],0,1).style.borderLeft="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],
1,0).style.borderRight="0px",g_objTableUtil.getTableCellElement(this.arrObjSelectRec[2],1,1).style.borderLeft="0px");this.bHide_MiniRec_h_1&&this.bHide_MiniRec_v_1&&(this.arrObjSelectRec[1].style.display="none")}}catch(d){g_objCommonUtil.displayErrorAlert(d,"hideMiniRec")}};this.setChecked_borderValue=function(a,c,d){try{var b=this.getBorderSelectionMiniRecById(a);if(null!=b){var e="";c?(g_objPropertyUtil.element_hasClass(b,"b_s_rec_selected")||g_objPropertyUtil.element_addClass(b,"b_s_rec_selected"),
e=d):g_objPropertyUtil.element_hasClass(b,"b_s_rec_selected")&&g_objPropertyUtil.element_removeClass(b,"b_s_rec_selected");this.arrID_MiniRec[0]==a?(this.arrObjMainRec[0].style.borderTop=e,this.arrObjMainRec[1].style.borderTop=e):this.arrID_MiniRec[1]==a?(this.arrObjMainRec[0].style.borderBottom=e,this.arrObjMainRec[1].style.borderBottom=e):this.arrID_MiniRec[2]==a?(this.arrObjMainRec[2].style.borderBottom=e,this.arrObjMainRec[3].style.borderBottom=e):this.arrID_MiniRec[3]==a?(this.arrObjMainRec[0].style.borderLeft=
e,this.arrObjMainRec[2].style.borderLeft=e):this.arrID_MiniRec[4]==a?(this.arrObjMainRec[0].style.borderRight=e,this.arrObjMainRec[2].style.borderRight=e):this.arrID_MiniRec[5]==a&&(this.arrObjMainRec[1].style.borderRight=e,this.arrObjMainRec[3].style.borderRight=e)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setChecked_borderValue")}}};

var colorComboBoxUtil=function(){var e=this;this.strDisabledColor="#dedede";colorComboBoxUtil.prototype.makeColorComboBoxHTML=function(b,c){try{var a="";a+='<div id="colorComboBoxContainer_'+b+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+c+'px;line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+c+'px;line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td id="colorComboBoxLabel_'+b+'" class="tbComboBox_AreaLabel_1" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:3px;">';
a+='<div id="colorComboBoxLabel_Sub_'+b+'" style="height:10px;background-color:#000000;border:1px dotted #000000;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';a+="</td>";a+="</tr>";return a+"</table></div>"}catch(d){g_objCommonUtil.displayErrorAlert(d,
"makeColorComboBoxHTML")}};colorComboBoxUtil.prototype.initColorComboBox=function(b,c,a){try{var d=g_objLayerKit.getElementById("colorComboBoxContainer_"+b);null!=d&&(d.onmouseover=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_AreaOver)},d.onmouseout=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},d.onmousedown=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||
(this.className=g_strSkin_ComboBox_AreaDown)},d.onmouseup=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},d.onclick=function(d){"undefined"==typeof a&&(a=[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR]);g_objPropertyUtil.element_hasClass(this,"disableStatus")||duzon_dialog.viewExtendsDlg(this,g_nActiveEditNumber,function(a){duzon_dialog.closeExtendsDlg();e.clickColorComboBoxLayer(b,a);"undefined"!=typeof c&&c(a)},a,[function(a){duzon_dialog.closeExtendsDlg();
e.clickColorComboBoxLayer(b,"");"undefined"!=typeof c&&c("")},function(a){a=e.getColorValue(b);duzon_dialog.viewDetailColorPicker(a,function(a){""!=a&&(duzon_dialog.closeExtendsDlg(),e.clickColorComboBoxLayer(b,a),"undefined"!=typeof c&&c(a))})}],"",!1)})}catch(f){g_objCommonUtil.displayErrorAlert(f,"initColorComboBox")}};colorComboBoxUtil.prototype.clickColorComboBoxLayer=function(b,c){try{g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+b).style.backgroundColor=c}catch(a){g_objCommonUtil.displayErrorAlert(a,
"clickColorComboBoxLayer")}};colorComboBoxUtil.prototype.getColorValue=function(b){try{var c=g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+b).style.backgroundColor;return g_objCommonUtil.getHexColorCode(c)}catch(a){g_objCommonUtil.displayErrorAlert(a,"getColorValue")}};colorComboBoxUtil.prototype.setColorValue=function(b,c){try{g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+b).style.backgroundColor=c}catch(a){g_objCommonUtil.displayErrorAlert(a,"setColorValue")}};colorComboBoxUtil.prototype.setActive=
function(b,c){try{var a=g_objLayerKit.getElementById("colorComboBoxContainer_"+b);if(null!=a){var d=g_objLayerKit.getElementById("colorComboBoxLabel_"+b);null!=d&&(c?(a.style.backgroundColor="",d.style.backgroundColor="",g_objPropertyUtil.applyFilterOpacityStyle(a,!1,-1),g_objPropertyUtil.element_hasClass(a,"disableStatus")&&g_objPropertyUtil.element_removeClass(a,"disableStatus")):(a.style.backgroundColor=this.strDisabledColor,d.style.backgroundColor=this.strDisabledColor,g_objPropertyUtil.applyFilterOpacityStyle(a,
!0,4),g_objPropertyUtil.element_hasClass(a,"disableStatus")||g_objPropertyUtil.element_addClass(a,"disableStatus")))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setActive")}}},g_objColorComboBoxUtil=new colorComboBoxUtil;

var nOutlineCount=0,outlineUtil=function(){this.arrStrID_Outline_Line=this.arrStrID_Outline_Rectangle=this.arrObj_Outline_Line=this.arrObj_Outline_Rectangle=null;this.nOutline_Basis_Min_Line=6;this.nOutline_Basis_Min_Center_Rectangle=30;this.bSkipSolidDotted=!1;outlineUtil.prototype.initializeExtOutline=function(a){try{var c=document,e=!1;a&&dzeEnvConfig.iFrameLayer&&(c=g_objLayerKit.getLayerDocument(),e=!0);this.arrObj_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrObj_Outline_Rectangle[a]=null;this.arrObj_Outline_Line=
[];for(a=0;4>a;a++)this.arrObj_Outline_Line[a]=null;var d=g_objCommonUtil.getTimeCodeString()+"_"+nOutlineCount;nOutlineCount++;this.arrStrID_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrStrID_Outline_Rectangle[a]="outline_rect_"+d+"_"+a;this.arrStrID_Outline_Line=[];for(a=0;4>a;a++)this.arrStrID_Outline_Line[a]="outline_line_"+d+"_"+a;d="";var f=g_bDocType_XHTML,g=!0;g_bBrowserType_IE&&6>=g_bBrowserVerInfo&&(g=!1);g_bBrowserType_IE&&!f&&(g=!1);for(a=0;8>a;a++)if(d=g?'<div id="'+this.arrStrID_Outline_Rectangle[a]+
'" style="display:none;position:absolute;z-index:20008;width:7px;height:7px;border:1px solid #0000ff;background-color:#ffffff"></div>':'<img id="'+this.arrStrID_Outline_Rectangle[a]+'" src="'+dzeEnvConfig.strPath_Image+'blank.gif" width="5" height="5" border="0" alt="" style="display:none;position:absolute;z-index:20008;width:5px;height:5px;border:1px solid #0000ff;background-color:#ffffff;" />',!g_objInsertUtil.insertLayerHTML(d,e))return;for(a=0;4>a;a++)if(d=0==a||2==a?g?'<div id="'+this.arrStrID_Outline_Line[a]+
'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:1px solid #0000ff;border-top:0px;border-right:0px;border-bottom:0px;"></div>':'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+dzeEnvConfig.strPath_Image+'blank.gif" alt="" style="display:none;position:absolute;z-index:20008;width:1px;border-left:1px solid #0000ff;border-top:0px;border-right:0px;border-bottom:0px;" />':g?'<div id="'+this.arrStrID_Outline_Line[a]+'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:0px;border-top:1px solid #0000ff;border-right:0px;border-bottom:0px;"></div>':
'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+dzeEnvConfig.strPath_Image+'blank.gif" alt="" style="display:none;position:absolute;z-index:20008;width:1px;height:1px;border-left:0px;border-top:1px solid #0000ff;border-right:0px;border-bottom:0px;"></div>',!g_objInsertUtil.insertLayerHTML(d,e))return;for(a=0;8>a;a++)this.arrObj_Outline_Rectangle[a]=c.getElementById(this.arrStrID_Outline_Rectangle[a]);for(a=0;4>a;a++)this.arrObj_Outline_Line[a]=c.getElementById(this.arrStrID_Outline_Line[a])}catch(h){g_objCommonUtil.displayErrorAlert(h,
"initializeExtOutline")}};outlineUtil.prototype.showExtOutline=function(a,c,e,d,f,g,h,k,l){try{for(var b=0;8>b;b++)if(null==this.arrObj_Outline_Rectangle[b])return!1;for(b=0;4>b;b++){if(null==this.arrObj_Outline_Line[b])return!1;this.bSkipSolidDotted||(this.arrObj_Outline_Line[b].style.borderStyle=e?"dotted":"solid")}if(a){if(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.left=d-3+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.top=f-4+"px",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT_TOP]?
(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.cursor="NW-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.left=g-5+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.top=f-4+"px",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT_TOP]?
(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.cursor="NE-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.left=g-5+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.top=h-5+"px",k?(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.backgroundColor=
"#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.cursor="NW-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.left=d-3+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.top=h-5+"px",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT_BOTTOM]?(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.backgroundColor=
"#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.cursor="SW-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].style.display="",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].style.display="",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].style.display="",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].style.display=
"",a=g-d,e=h-f,a>this.nOutline_Basis_Min_Center_Rectangle?(k=d+a/2-5,this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.left=k+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.top=f-4+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.display="",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_TOP]?(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.cursor="N-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.backgroundColor=
"#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.left=k+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.top=h-5+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.display="",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.cursor="S-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].style.display=
"none",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].style.display="none"),e>this.nOutline_Basis_Min_Center_Rectangle?(k=f+e/2-3,this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.left=g-5+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.top=k+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.display="",l?(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.cursor="E-resize"):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.backgroundColor=
"#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.cursor="default"),this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.left=d-3+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.top=k+"px",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.display="",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT]?(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.cursor="W-resize"):
(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.cursor="default")):(this.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].style.display="none",this.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].style.display="none"),e>this.nOutline_Basis_Min_Line?(c?(this.arrObj_Outline_Line[0].style.left=d+"px",this.arrObj_Outline_Line[0].style.top=f+5+"px",this.arrObj_Outline_Line[0].style.width="1px",this.arrObj_Outline_Line[0].style.height=
e-9+"px"):(this.arrObj_Outline_Line[0].style.left=d+"px",this.arrObj_Outline_Line[0].style.top=f+"px",this.arrObj_Outline_Line[0].style.width="1px",this.arrObj_Outline_Line[0].style.height=e+"px"),this.arrObj_Outline_Line[0].style.display=""):this.arrObj_Outline_Line[0].style.display="none",a>this.nOutline_Basis_Min_Line?(c?(this.arrObj_Outline_Line[1].style.left=d+5+"px",this.arrObj_Outline_Line[1].style.top=f+"px",this.arrObj_Outline_Line[1].style.width=a-9+"px"):(this.arrObj_Outline_Line[1].style.left=
d+"px",this.arrObj_Outline_Line[1].style.top=f+"px",this.arrObj_Outline_Line[1].style.width=a+"px"),this.arrObj_Outline_Line[1].style.display=""):this.arrObj_Outline_Line[1].style.display="none",e>this.nOutline_Basis_Min_Line?(c?(this.arrObj_Outline_Line[2].style.left=g-1+"px",this.arrObj_Outline_Line[2].style.top=f+5+"px",this.arrObj_Outline_Line[2].style.height=e-9+"px"):(this.arrObj_Outline_Line[2].style.left=g+"px",this.arrObj_Outline_Line[2].style.top=f+"px",this.arrObj_Outline_Line[2].style.height=
e+"px"),this.arrObj_Outline_Line[2].style.display=""):this.arrObj_Outline_Line[2].style.display="none",a>this.nOutline_Basis_Min_Line?(c?(this.arrObj_Outline_Line[3].style.left=d+5+"px",this.arrObj_Outline_Line[3].style.top=h-1+"px",this.arrObj_Outline_Line[3].style.width=a-9+"px"):(this.arrObj_Outline_Line[3].style.left=d+"px",this.arrObj_Outline_Line[3].style.top=h+"px",this.arrObj_Outline_Line[3].style.width=a+"px"),this.arrObj_Outline_Line[3].style.display=""):this.arrObj_Outline_Line[3].style.display=
"none",!c)for(b=0;8>b;b++)this.arrObj_Outline_Rectangle[b].style.display="none"}else{for(b=0;8>b;b++)this.arrObj_Outline_Rectangle[b].style.display="none";for(b=0;4>b;b++)this.arrObj_Outline_Line[b].style.display="none"}}catch(m){g_objCommonUtil.displayErrorAlert(m,"outlineUtil.showExtOutline")}};outlineUtil.prototype.setZIndexExtOutline=function(a){try{for(var c=0;8>c;c++)this.arrObj_Outline_Rectangle[c].style.zIndex=a;for(c=0;4>c;c++)this.arrObj_Outline_Line[c].style.zIndex=a}catch(e){g_objCommonUtil.displayErrorAlert(e,
"setZIndexExtOutline")}};outlineUtil.prototype.setExtOutlineBorder=function(a){try{this.bSkipSolidDotted=!0,this.arrObj_Outline_Line[0].style.borderLeftWidth=a[0],this.arrObj_Outline_Line[0].style.borderLeftStyle=a[1],this.arrObj_Outline_Line[0].style.borderLeftColor=a[2],this.arrObj_Outline_Line[1].style.borderTopWidth=a[3],this.arrObj_Outline_Line[1].style.borderTopStyle=a[4],this.arrObj_Outline_Line[1].style.borderTopColor=a[5],this.arrObj_Outline_Line[2].style.borderLeftWidth=a[6],this.arrObj_Outline_Line[2].style.borderLeftStyle=
a[7],this.arrObj_Outline_Line[2].style.borderLeftColor=a[8],this.arrObj_Outline_Line[3].style.borderTopWidth=a[9],this.arrObj_Outline_Line[3].style.borderTopStyle=a[10],this.arrObj_Outline_Line[3].style.borderTopColor=a[11]}catch(c){g_objCommonUtil.displayErrorAlert(c,"setExtOutlineBorder")}}};

var g_objCaretUtil=new function(){this.CARET_MARKER="dze_caret_marker";this.CARET_MARKER_START="dze_caret_marker_start";this.CARET_MARKER_END="dze_caret_marker_end";this.ID_CURRENT_CARET="dze_page_caret_current_position";this.DZE_ONTEXT="dze_ontext";this.DZE_PAIR="dze_pair";this.nEditNumber=0;this.DEFAULT_SCROLL_MARGIN=60;this.bComposing=!1;this.isComposing=function(a){try{return a&&"undefined"!=typeof a.isComposing?a.isComposing:this.bComposing}catch(c){dalert(c)}};this.isCollapsed=function(a){try{"undefined"==
typeof a&&(a=g_nActiveEditNumber);var c=g_objEditWindow[a];return(c?c.getSelection():null).isCollapsed?!0:!1}catch(b){dalert(b)}};this.getStartContainer=function(){try{var a=g_objEditWindow[this.nEditNumber],c=a?a.getSelection():null,b=c&&0<c.rangeCount?c.getRangeAt(0):null;return b?b.startContainer.childNodes[b.startOffset]||b.startContainer:null}catch(d){dalert(d)}};this.getEndContainer=function(){try{var a=g_objEditWindow[this.nEditNumber],c=a?a.getSelection():null,b=c&&0<c.rangeCount?c.getRangeAt(0):
null;return b?b.endContainer.childNodes[b.endOffset]||b.endContainer:null}catch(d){dalert(d)}};this.getNode=function(a){try{return a?this.getStartContainer():this.getEndContainer()}catch(c){dalert(c)}};this.removeMarkerAttribute=function(a){try{var c=g_objNodeUtil,b=g_objPropertyUtil;if(!c.checkTagName(a,"span"))return!1;var d=a.id;d&&0<=d.indexOf("caret")&&c.removeAttribute(a,"id");b.element_removeClass(a,this.CARET_MARKER);b.element_removeClass(a,this.CARET_MARKER_START);b.element_removeClass(a,
this.CARET_MARKER_END);c.removeAttribute(a,this.DZE_ONTEXT);c.removeAttribute(a,this.DZE_PAIR);return!0}catch(f){dalert(f)}};this.insertCaretMarker=function(a,c,b){try{if(!a||!c)return null;var d=g_objEditorDocument[this.nEditNumber];if(!d)return null;var f=null,e=null,g=a.cloneRange(),m=a.startContainer&&a.startContainer.nodeType==ID_SELECTION_TEXT_NODE,k=a.endContainer&&a.endContainer.nodeType==ID_SELECTION_TEXT_NODE;"undefined"!=typeof b&&g.collapse(b);if(a.collapsed)e=d.createElement("span"),
e.id=c,e.className=this.CARET_MARKER,e.setAttribute(this.DZE_ONTEXT,k);else{var h=g_objCommonUtil.getUniqueID();f=d.createElement("span");f.id=c;f.className=this.CARET_MARKER_START;f.setAttribute(this.DZE_PAIR,h);f.setAttribute(this.DZE_ONTEXT,m);g.collapse(!0);g.insertNode(f);e=d.createElement("span");e.id=c;e.className=this.CARET_MARKER_END;e.setAttribute(this.DZE_PAIR,h);e.setAttribute(this.DZE_ONTEXT,k);g=a.cloneRange();g.collapse(!1)}g.insertNode(e);return{start:f,end:e}}catch(l){dalert(l)}};
this.removeCaretMarker=function(a,c,b){try{if(!a||!c)return!1;var d=g_objNodeUtil,f=g_objEditorDocument[this.nEditNumber];if(!f)return!1;var e=b?b:f.getElementById(c);if(!e)return!1;var g=e.className&&e.className!=this.CARET_MARKER?!1:!0,m=e.className==this.CARET_MARKER_START?!0:!1;b=null;g||(b=f.querySelector("#"+c+"."+(m?this.CARET_MARKER_END:this.CARET_MARKER_START)))||(g=!0);if(g)if(this.isExistOnText(e)){var k=e.parentNode;a.selectNodeContents(k);a.setEndAfter(e);var h=this.getTextCountInRange(a);
e.parentNode.removeChild(e);d.normalize(k);a.selectNodeContents(k);var l=this.getTextNodeFromOffset(h,a);a.setStart(l.textNode,l.textOffset);a.collapse(!0)}else a.selectNode(e),a.deleteContents();else{c=m?e:b;e=m?b:e;var q=this.isExistOnText(c),r=this.isExistOnText(e),n=c.parentNode,p=e.parentNode;g=m=0;l=h=k=b=null;q&&r?(a.selectNodeContents(n),a.setEndAfter(c),m=this.getTextCountInRange(a),a.selectNodeContents(p),a.setEndAfter(e),g=this.getTextCountInRange(a),n.removeChild(c),p.removeChild(e),d.normalize(n),
d.normalize(p),a.selectNodeContents(n),b=this.getTextNodeFromOffset(m,a),a.selectNodeContents(p),k=this.getTextNodeFromOffset(g,a),a.setStart(b.textNode,b.textOffset),a.setEnd(k.textNode,k.textOffset)):q&&!r?(a.selectNodeContents(n),a.setEndAfter(c),m=this.getTextCountInRange(a),n.removeChild(c),d.normalize(n),l=f.createRange(),l.selectNode(e),l.deleteContents(),a.selectNodeContents(n),b=this.getTextNodeFromOffset(m,a),a.setStart(b.textNode,b.textOffset),a.setEnd(l.endContainer,l.endOffset)):!q&&
r?(a.selectNodeContents(p),a.setEndAfter(e),g=this.getTextCountInRange(a),p.removeChild(e),d.normalize(p),h=f.createRange(),h.selectNode(c),h.deleteContents(),a.selectNodeContents(p),k=this.getTextNodeFromOffset(g,a),a.setStart(h.startContainer,h.startOffset),a.setEnd(k.textNode,k.textOffset)):(h=f.createRange(),h.selectNode(c),h.deleteContents(),l=f.createRange(),l.selectNode(e),l.deleteContents(),a.setStart(h.startContainer,h.startOffset),a.setEnd(l.endContainer,l.endOffset))}return!0}catch(t){dalert(t)}};
this.isExistOnText=function(a){try{if(!a)return!1;var c="true"==a.getAttribute(this.DZE_ONTEXT)?!0:!1,b=a.previousSibling,d=a.nextSibling;a=null;var f=g_objNodeUtil;b&&b.nodeType==ID_SELECTION_TEXT_NODE&&!f.isIgnorable(b)?a=b:d&&d.nodeType==ID_SELECTION_TEXT_NODE&&!f.isIgnorable(d)&&(a=d);return a&&c}catch(e){dalert(e)}};this.getTextCountInRange=function(a){try{if(!a)return 0;var c=0,b=a.endContainer.childNodes[a.endOffset]||a.endContainer;g_objNodeUtil.traverseNodesInRange(a,function(a){if(a==b)return!1;
a&&a.nodeType==ID_SELECTION_TEXT_NODE&&!g_objNodeUtil.isIgnorable(a)&&(c+=a.nodeValue.length);return!0});return c}catch(d){dalert(d)}};this.getTextNodeFromOffset=function(a,c){try{if(!c)return null;var b={textNode:null,textOffset:a};g_objNodeUtil.traverseNodesInRange(c,function(a){if(a&&a.nodeType==ID_SELECTION_TEXT_NODE&&!g_objNodeUtil.isIgnorable(a))if(b.textOffset>a.nodeValue.length)b.textOffset-=a.nodeValue.length;else if(a.parentNode!=c.commonAncestorContainer)b.textOffset-=a.nodeValue.length;
else return b.textNode=a,!1;return!0});return b.textNode?b:null}catch(d){dalert(d)}};this.saveCaret=function(a,c){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var b=g_objEditorDocument[a],d=g_objEditWindow[a];if(!d||!b)return!1;this.nEditNumber=a;var f=d.getSelection();if(fnObjectCheckNull(f))return!1;a=!1;c=c||this.ID_CURRENT_CARET;for(b=0;b<f.rangeCount&&1>b;b++){var e=f.getRangeAt(b);e&&(a=this.insertCaretMarker(e,c))}return a?!0:!1}catch(g){dalert(g)}};this.restoreCaret=function(a,c){try{"undefined"==
typeof a&&(a=g_nActiveEditNumber);var b=g_objEditorDocument[a],d=g_objEditWindow[a];if(!d||!b)return!1;this.nEditNumber=a;c=c||this.ID_CURRENT_CARET;var f=b.getElementById(c);if(f){var e=b.createRange(),g=this.removeCaretMarker(e,c,f);if(g){var m=d.getSelection();m.removeAllRanges();m.addRange(e)}}return g}catch(k){dalert(k)}};this.moveCaret=function(a,c,b){try{if(!a)return!1;var d=g_objNodeUtil,f=a.ownerDocument;if(3===a.nodeType){d=0;!1===b?d=a.nodeValue.length:!0===b||isNaN(b)?d=0:0<=d&&d<=a.nodeValue.length&&
(d=b);var e=f.defaultView.getSelection(),g=f.createRange();g.setStart(a,d);g.setEnd(a,d);e.removeAllRanges();e.addRange(g)}else e=null,a=(e=!1===b?d.getLastTextNode(a):d.getFirstTextNode(a,!0,!0))?e:a,b=!1===b?"end":"start","BR"==a.nodeName&&(b="end",d=null,a.previousSibling&&3===a.previousSibling.nodeType?d=a.previousSibling:(d=f.createTextNode(""),a.parentNode.insertBefore(d,a)),a=d),duzon_dialog.setFocusElement(a,this.nEditNumber,b);!1!==c&&this.scrollTo(a);return!0}catch(m){dalert(m)}};this.moveCaretToNextCharacter=
function(a){try{var c=g_objEditWindow[this.nEditNumber],b=c?c.getSelection():null;if(b&&0<b.rangeCount&&b.focusNode&&b.focusNode.nodeType==ID_SELECTION_TEXT_NODE){var d=b.focusNode;b.collapse(d,Math.min(d.length,b.focusOffset+a));return!0}return!1}catch(f){dalert(f)}};this.scrollTo=function(a){try{if(a){for(var c=this.nEditNumber,b=g_objCommonUtil,d=g_objNodeUtil,f=g_objEditorDocument[c].body,e=this.DEFAULT_SCROLL_MARGIN;a.nodeType!=ID_SELECTION_ELEMENT_NODE;)a=a.parentNode;var g=g_objEditObject[c].offsetHeight,
m=f.scrollTop;c=m+g;for(var k=a.offsetTop,h=a.offsetParent;h&&!d.checkTagName(h,"body");){var l=h.offsetTop;b.IS_VALID_VALUE(l)||(l=0);k+=l;h=h.offsetParent}var q=k+Math.max(a.offsetHeight,15);k>c?f.scrollTop=q-g+e:q<m&&(f.scrollTop=k-e)}}catch(r){dalert(r)}}};

var g_objWrapperOutlineUtil=new function(){var b=this;this.objOutlineUtil=null;this.nExtOutlineRectangleMouseDown=DZE_CTRL_PT_NONE;this.arrResizeExtOutlineRectangle=[];this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT_TOP]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT_TOP]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT_BOTTOM]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT_BOTTOM]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_TOP]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT]=
!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_BOTTOM]=!0;this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_LEFT]=!0;this.initializeExtOutline=function(c){try{this.objOutlineUtil=new outlineUtil,this.objOutlineUtil.initializeExtOutline(c),this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT_TOP,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT_TOP,
a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT_BOTTOM,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT_BOTTOM,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_TOP,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].onmousedown=
function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_BOTTOM,a)},this.objOutlineUtil.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].onmousedown=function(a){b.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT,a)}}catch(a){g_objCommonUtil.displayErrorAlert(a,"initializeExtOutline")}};this.showExtOutline=function(b,a,d,g,m){try{if(null!=this.objOutlineUtil){var c=0,h=
0,k=0,l=0,n=this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT_BOTTOM],p=this.arrResizeExtOutlineRectangle[DZE_CTRL_PT_RIGHT];if(a){if(null==b||null==g_objWrapperOutlineResize.objExtSelectedInfo)return!1;var e=null;if(1==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType)e=g_objPositionUtil.getElementPosClientRect(b);else if(2==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType)e=g_objPositionUtil.getElementPosClientRect(b);else return!1;var f=g_objPositionUtil.getElementPosition(g_objEditObject[m],
!1);c=f.left+e.left;h=f.top+e.top;k=f.left+e.right;l=f.top+e.bottom}this.objOutlineUtil.showExtOutline(a,d,g,c,h,k,l,n,p);a||g_objTransparentViewUtil.showTransparentView(!1,null)}}catch(q){g_objCommonUtil.displayErrorAlert(q,"wrapperOutlineUtil.showExtOutline")}};this.outlineRectangle_onmousedown=function(c,a){try{if(null!=g_objWrapperOutlineResize.objExtSelectedInfo&&b.arrResizeExtOutlineRectangle[c]){TBCancelBubbleEvent(a);g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=
!0);b.nExtOutlineRectangleMouseDown=c;if(1==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType)g_objWrapperOutlineResize.newExtDragPosInfo(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,a,g_nActiveEditNumber);else if(2==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType)g_objWrapperOutlineResize.newExtDragPosInfo(g_objWrapperOutlineResize.objExtSelectedInfo.objTableCell,a,g_nActiveEditNumber);else return;g_bTableResizingYN&&g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,
0);g_objTransparentViewUtil.showTransparentView(!0,1);window.attachEvent?(document.attachEvent("onmousemove",b.outlineRectangle_onmousemove),document.attachEvent("onmouseup",b.outlineRectangle_onmouseup)):(document.addEventListener("mousemove",b.outlineRectangle_onmousemove,!1),document.addEventListener("mouseup",b.outlineRectangle_onmouseup,!1))}}catch(d){g_objCommonUtil.displayErrorAlert(d,"outlineRectangle_onmousedown")}};this.outlineRectangle_onmousemove=function(c){try{-1!=b.nExtOutlineRectangleMouseDown&&
(1==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType?g_objWrapperOutlineResize.resizePositionByDragForExtMode(1,g_objWrapperOutlineResize.objExtSelectedInfo.objElement,c,b.nExtOutlineRectangleMouseDown,g_nActiveEditNumber):2==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType&&g_objWrapperOutlineResize.resizePositionByDragForExtMode(2,g_objWrapperOutlineResize.objExtSelectedInfo.objTableCell,c,b.nExtOutlineRectangleMouseDown,g_nActiveEditNumber))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"outlineRectangle_onmousemove")}};this.outlineRectangle_onmouseup=function(c){try{g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!1);2==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType&&g_objWrapperOutlineResize.afterResizeTargetElement(b.nExtOutlineRectangleMouseDown,g_nActiveEditNumber);var a=g_objTableUtil.getEditorFrameWidth();if(g_objWrapperOutlineResize.objExtSelectedInfo.objElement.offsetWidth>a){alert(ID_RES_DIALOG_ALERT_MAX_VALUE+a);var d=g_objWrapperOutlineResize.objExtDragPosInfo.rcArea;
g_objWrapperOutlineResize.objExtSelectedInfo.objElement.style.width=d.right-d.left;g_objWrapperOutlineResize.objExtSelectedInfo.objElement.style.height=d.bottom-d.top}b.nExtOutlineRectangleMouseDown=-1;g_objWrapperOutlineResize.objExtDragPosInfo=null;g_objTransparentViewUtil.showTransparentView(!1,null);window.detachEvent?(document.detachEvent("onmousemove",b.outlineRectangle_onmousemove),document.detachEvent("onmouseup",b.outlineRectangle_onmouseup)):(document.removeEventListener("mousemove",b.outlineRectangle_onmousemove,
!1),document.removeEventListener("mouseup",b.outlineRectangle_onmouseup,!1));1==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType?(b.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!0,!1,g_nActiveEditNumber),!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&"img"==g_objWrapperOutlineResize.objExtSelectedInfo.objElement.nodeName.toLowerCase()&&dze_menu_control.setTBImageSizeInfo(g_nActiveEditNumber)):2==g_objWrapperOutlineResize.objExtSelectedInfo.nSelectedType&&
b.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objTableCell,!0,!0,!1,g_nActiveEditNumber);g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}catch(g){g_objCommonUtil.displayErrorAlert(g,"outlineRectangle_onmouseup")}}};

var handlerUI={arrCommandUpdateIndex:[],arrContextUpdateIndex:[],arrMenuTableUpdateIndex:[],getCommandUpdateIndex:function(b,a){try{if("undefined"==typeof this.arrCommandUpdateIndex[b]||"undefined"==typeof this.arrCommandUpdateIndex[b][a])return-1;var c=this.arrCommandUpdateIndex[b][a];return null==c?-1:c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getCommandUpdateIndex")}return-1},setCommandUpdateIndex:function(b,a,c){try{fnObjectCheckNull(this.arrCommandUpdateIndex[b])&&(this.arrCommandUpdateIndex[b]=
[]),this.arrCommandUpdateIndex[b][a]=c}catch(f){g_objCommonUtil.displayErrorAlert(f,"setCommandUpdateIndex")}},getContextUpdateIndex:function(b,a){try{var c=this.arrContextUpdateIndex[b][a];return null==c?-1:c}catch(f){g_objCommonUtil.displayErrorAlert(f,"getContextUpdateIndex")}return-1},setContextUpdateIndex:function(b,a,c){try{fnObjectCheckNull(this.arrContextUpdateIndex[b])&&(this.arrContextUpdateIndex[b]=[]),this.arrContextUpdateIndex[b][a]=c}catch(f){g_objCommonUtil.displayErrorAlert(f,"setContextUpdateIndex")}},
getMenuTableUpdateIndex:function(b){try{var a=this.arrCommandUpdateIndex[b];return null==a?-1:a}catch(c){g_objCommonUtil.displayErrorAlert(c,"getMenuTableUpdateIndex")}return-1},setMenuTableUpdateIndex:function(b,a){try{this.arrCommandUpdateIndex[b]=a}catch(c){g_objCommonUtil.displayErrorAlert(c,"setMenuTableUpdateIndex")}},queryCommandStatus:function(b,a,c,f,k,g){try{var e=!1,d=!1;if(a==ID_COMMAND_BOLD||a==ID_COMMAND_ITALIC||a==ID_COMMAND_UNDERLINE||a==ID_COMMAND_INSERT_ORDERED_LIST||a==ID_COMMAND_INSERT_UNORDERED_LIST||
a==ID_COMMAND_STRIKE||a==ID_COMMAND_SUBSCRIPT||a==ID_COMMAND_SUPERSCRIPT||a==ID_COMMAND_CUT||a==ID_COMMAND_COPY||a==ID_COMMAND_DELETE||a==ID_COMMAND_SELECT_ALL||a==ID_COMMAND_HORIZONTAL_RULE||a==ID_CUSTOM_COPY_EXT)try{e=b.queryCommandState(c),d=b.queryCommandEnabled(c)}catch(l){d=e=!1}else if(a==ID_COMMAND_PASTE||a==ID_COMMAND_PASTE_EXT)if(g_bBrowserType_IE)try{e=b.queryCommandState(c),d=b.queryCommandEnabled(c)}catch(l){d=e=!1}else{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)e=!1,
d=!0}else if(a==ID_COMMAND_OUTDENT||a==ID_COMMAND_INDENT||a==ID_COMMAND_FORE_COLOR||a==ID_COMMAND_BACK_COLOR||a==ID_COMMAND_HYPERLINK_INSERT||a==ID_COMMAND_HYPERLINK_REMOVE||a==ID_COMMAND_INSERT_IMAGE)if(g_bBrowserType_IE){if(e=b.queryCommandState(c),d=b.queryCommandEnabled(c),a==ID_COMMAND_HYPERLINK_INSERT&&d&&ID_STRING_NAME_CONTROL!=g){var n=getSelectionTextValue(f);if(""==n)if(window.attachEvent){var p=g_objEditorDocument[f].selection;if(null==p)d=!1;else{var q=p.createRange().parentElement(),
h=g_objNodeUtil.getLoopParentElement(q,"a");d=h?!0:!1}}else d=(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,f))?!0:!1}}else{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){try{e=b.queryCommandState(c)}catch(l){e=!1}a==ID_COMMAND_HYPERLINK_INSERT||a==ID_COMMAND_HYPERLINK_REMOVE?ID_STRING_NAME_NONE==g||ID_STRING_NAME_TEXT==g||null==g?(n=getSelectionTextValue(f),d=""==n?(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,f))?g_bBrowserType_WK||g_bBrowserType_OP?!0:b.queryCommandEnabled(c):
!1:ID_STRING_COMMAND_UNLINK==c?(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,f))?b.queryCommandEnabled(c):!1:b.queryCommandEnabled(c)):ID_STRING_NAME_CONTROL==g&&("img"==getSelectionElementNode(f).nodeName.toLowerCase()?ID_STRING_COMMAND_CREATELINK==c?(e=!1,d=!0):ID_STRING_COMMAND_UNLINK==c&&((h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,f))?(e=!1,d=!0):d=e=!1):d=e=!1):d=b.queryCommandEnabled(c)}}else if(a==ID_COMMAND_JUSTIFY_LEFT||a==ID_COMMAND_JUSTIFY_CENTER||a==ID_COMMAND_JUSTIFY_RIGHT||
a==ID_COMMAND_JUSTIFY_JUSTIFY)e=!1,d=!0,1==k&&a==ID_COMMAND_JUSTIFY_LEFT?e=!0:2==k&&a==ID_COMMAND_JUSTIFY_CENTER?e=!0:3==k&&a==ID_COMMAND_JUSTIFY_RIGHT?e=!0:4==k&&a==ID_COMMAND_JUSTIFY_JUSTIFY&&(e=!0);else{if(a==ID_COMMAND_UNDO||a==ID_COMMAND_REDO){var m=g_objUndoRedo.arrUndoRedoStruct[f];return null==m?ID_STRING_NAME_GRAY:a==ID_COMMAND_UNDO?0==m.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:m.nUndoRedoStack_LastEventPos<=m.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED}if(a==
ID_COMMAND_FORM_TABLE||a==ID_COMMAND_DRAW_TABLE)return ID_STRING_NAME_UNCHECKED;if(a==ID_COMMAND_FORM_TAG_SWITCH)return g_objTagUtil.bFormTagSwitch?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED;if(a==ID_COMMAND_FORM_TAG_CHECKBOX||a==ID_COMMAND_FORM_TAG_SELECT||a==ID_COMMAND_EDIT_REPLACE_CASE||a==ID_COMMAND_EDIT_PASTESPECIAL||a==ID_COMMAND_EDIT_SEARCH||a==ID_COMMAND_EDIT_REPLACE||a==ID_COMMAND_INSERT_SPECIALCHARS||a==ID_COMMAND_INSERT_EMOTICONS||a==ID_COMMAND_INSERT_OBJECT_MOVIE||a==ID_COMMAND_INSERT_OBJECT_FILE||
a==ID_COMMAND_INSERT_OBJECT_HR||a==ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT||a==ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT||a==ID_COMMAND_STYLE_INCREASE_FONTSIZE||a==ID_COMMAND_STYLE_DECREASE_FONTSIZE||a==ID_COMMAND_INSERT_BOOKMARK||a==ID_COMMAND_INSERT_OBJECT||a==ID_COMMAND_INSERT_PARAGRAPH||a==ID_COMMAND_STYLE_INCREASEORDER||a==ID_COMMAND_STYLE_DECREASEORDER||a==ID_COMMAND_FILE_NEW||a==ID_COMMAND_FILE_OPEN||a==ID_COMMAND_FILE_LAYOUT||a==ID_COMMAND_EDIT_REPLACE_CASE||a==ID_COMMAND_STYLE_FONT||a==ID_COMMAND_STYLE_PARAGRAPH||
a==ID_COMMAND_IMAGE_PROPERTY||a==ID_COMMAND_IMAGE_RESET_PICTURE||a==ID_COMMAND_IMAGE_TO_TABLE)return ID_STRING_NAME_UNCHECKED;if(a==ID_COMMAND_HELP)return ID_STRING_NAME_GRAY;if(a==ID_COMMAND_VIEW_RULERBAR)return isShowedRulerBar()?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED;if(a==ID_COMMAND_FULLSCREEN)return!0===g_bFullScreenMode?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED;if(a==ID_COMMAND_EDIT_PRIINT_PAGE_BREAK){if(g_objTable)return ID_STRING_NAME_GRAY;g_objTableSelection.setTableObjectOnCaret(f);
return g_objTable?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED}return null}if(e&&d)return ID_STRING_NAME_CHECKED;if(!e&&d)return ID_STRING_NAME_UNCHECKED;if(!d)return ID_STRING_NAME_GRAY}catch(l){g_objCommonUtil.displayErrorAlert(l,"queryCommandStatus")}return null},setDisableMenu:function(b){var a=!0;g_objTable&&(a=g_objTableFunction.hasLockedEditCell(g_objTable,!1));"number"!=typeof b&&(b=Number(b));switch(b){case ID_COMMAND_CUT:case ID_COMMAND_PASTE:case ID_COMMAND_EDIT_PASTESPECIAL:case ID_COMMAND_DELETE:case ID_COMMAND_STYLE_FONT:case ID_COMMAND_STYLE_PARAGRAPH:case ID_COMMAND_STYLE_STYLE:case ID_COMMAND_STYLE_UNORDEREDLIST:case ID_COMMAND_STYLE_ORDEREDLIST:case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_JUSTIFY_LEFT:case ID_COMMAND_JUSTIFY_CENTER:case ID_COMMAND_JUSTIFY_RIGHT:case ID_COMMAND_JUSTIFY_JUSTIFY:case ID_COMMAND_OUTDENT:case ID_COMMAND_INDENT:case ID_COMMAND_INSERT_IMAGE:case ID_COMMAND_INSERT_OBJECT:case ID_COMMAND_INSERT_OBJECT_MOVIE:case ID_COMMAND_INSERT_OBJECT_FILE:case ID_COMMAND_INSERT_OBJECT_HR:case ID_COMMAND_INSERT_SPECIALCHARS:case ID_COMMAND_HYPERLINK_INSERT:case ID_COMMAND_IMAGE_PROPERTY:case ID_COMMAND_STYLE_INCREASE_FONTSIZE:case ID_COMMAND_STYLE_DECREASE_FONTSIZE:case ID_COMMAND_BOLD:case ID_COMMAND_ITALIC:case ID_COMMAND_UNDERLINE:case ID_COMMAND_STRIKE:case ID_COMMAND_SUPERSCRIPT:case ID_COMMAND_SUBSCRIPT:case ID_COMMAND_FORE_COLOR:case ID_COMMAND_BACK_COLOR:case ID_COMMAND_HEADING_SIZE:case ID_COMMAND_FONT_NAME:case ID_COMMAND_FONT_SIZE:case ID_COMMAND_LINE_HEIGHT:case ID_COMMAND_LETTER_SPACING:case ID_COMMAND_TABLE_CELL_PROPERTY:case ID_COMMAND_TABLE_CREATE:case ID_COMMAND_DRAW_TABLE:case ID_COMMAND_TABLE_CELL_STYLE:if(b===
ID_COMMAND_TABLE_CELL_STYLE&&!0===GetMultiCellSelection())return!1;case ID_COMMAND_TABLE_CELL_ALIGN:case ID_COMMAND_TABLE_CELL_BACKCOLOR:case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SPLIT_CELL:case ID_COMMAND_TABLE_FORMULA:case ID_COMMAND_TABLE_SELECT_FORMULA:return a?!0:!1;case ID_COMMAND_TABLE_DELETE_ROW:return g_objTableFunction.isIncludedProtectedCellInRow();case ID_COMMAND_TABLE_DELETE_COL:return g_objTableFunction.isIncludedProtectedCellInColumn();case ID_COMMAND_TABLE_DELETE_TABLE:case ID_COMMAND_TABLE_CONVERT_TEXT:return!0;
default:return!1}}};

var updateHandlerUI={update_toolbar_button:function(b,a){try{var e=g_objEditorDocument[a];if(ID_STRING_NAME_CONTROL==b){var d=getSelectionControl(a);if(1==d.rangeLength){for(var f=d.controlObject.tagName.toLowerCase(),c=0;c<g_TBButton[a].length;c++){var g=g_TBButton[a][c].command_id,l=g_TBButton[a][c].element,k=g_TBButton[a][c].element.command;if(ID_SUPPORT_CONTROL_TYPE_NO==g_TBButton[a][c].support_control_type)TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type);
else if(ID_SUPPORT_CONTROL_TYPE_YES==g_TBButton[a][c].support_control_type)if(ID_COMMAND_HYPERLINK_INSERT==g||ID_COMMAND_HYPERLINK_REMOVE==g)if("img"==f){var h=handlerUI.queryCommandStatus(e,g,k,a,-1,b);null!=h&&TBSetState(l,h,g_TBButton[a][c].button_type)}else TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type);else ID_COMMAND_INSERT_IMAGE==g||ID_COMMAND_IMAGE_PROPERTY==g||ID_COMMAND_IMAGE_RESET_PICTURE==g?"img"==f?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_UNCHECKED,
g_TBButton[a][c].button_type):TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type):ID_COMMAND_FORM_TAG_CHECKBOX==g?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type):ID_COMMAND_FORM_TAG_SELECT==g&&("select"==f?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_UNCHECKED,g_TBButton[a][c].button_type):TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type))}for(c=0;c<g_TBDropDown[a].length;c++)if(g=g_TBDropDown[a][c].command_id,
ID_COMMAND_IMAGE_BORDER_TYPE==g||ID_COMMAND_IMAGE_BORDER_THICKNESS==g||ID_COMMAND_IMAGE_BORDER_COLOR==g)"img"==f?TBSetState(g_TBDropDown[a][c].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[a][c].button_type):TBSetState(g_TBDropDown[a][c].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][c].button_type)}else for(c=0;c<g_TBButton[a].length;c++)ID_SUPPORT_CONTROL_TYPE_INDEPENDENT!=g_TBButton[a][c].support_control_type&&TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type)}else{var m=
getAlignValueForSelectionArea(a);for(c=0;c<g_TBButton[a].length;c++)g=g_TBButton[a][c].command_id,l=g_TBButton[a][c].element,k=g_TBButton[a][c].element.command,h=handlerUI.queryCommandStatus(e,g,k,a,m,b),d=null,dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(d=handlerUI.setDisableMenu(g)),h=1==d?ID_STRING_NAME_GRAY:h,null!=h&&TBSetState(l,h,g_TBButton[a][c].button_type)}}catch(n){g_objCommonUtil.displayErrorAlert(n,"update_toolbar_button")}},update_toolbar_combobox:function(b,a){try{var e=
!1;if(ID_STRING_NAME_CONTROL==b)for(var d=0;d<g_TBComboBox[a].length;d++){if(ID_SUPPORT_CONTROL_TYPE_NO==g_TBComboBox[a][d].support_control_type){TBSetState(g_TBComboBox[a][d].element,ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);var f=g_objNodeUtil.getChildrenCollection(g_TBComboBoxLabel[a][d].element);if(null==f)break;for(var c=0;c<f.length;c++)f[c].style.display="none"}}else{b=null;var g=!1;GetMultiCellSelection()?(g=!0,b=g_objPropertyUtil.getSelectionAttributeValue_MultiCell(a)):b=g_objPropertyUtil.getSelectionAttributeValue(a);
if("undefined"!=typeof b&&null!=b)for(duzon_dialog.initSelectionFontStyleList(b),d=0;d<g_TBComboBox[a].length;d++){var l=g_TBComboBox[a][d].element,k=g_TBComboBox[a][d].element.command,h=g_TBComboBox[a][d].element.command_id;if(h==ID_COMMAND_FONT_NAME||h==ID_COMMAND_FONT_SIZE||h==ID_COMMAND_HEADING_SIZE)if(g)e=!0;else try{e=g_objEditorDocument[a].queryCommandEnabled(k)}catch(n){e=!1}else if(h==ID_COMMAND_LETTER_SPACING||h==ID_COMMAND_LINE_HEIGHT)if(g)e=!0;else try{e=g_objEditorDocument[a].queryCommandEnabled("FontName")}catch(n){e=
!1}else break;var m=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(m=handlerUI.setDisableMenu(h));if(e=1==m?!1:e)TBSetState(l,ID_STRING_NAME_UNCHECKED,g_TBComboBox[a][d].button_type),m=-1,h==ID_COMMAND_FONT_NAME?g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.fontFamily?"<span>"+ID_RES_CONST_STRING_FONT_NAME+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontFamily.replace(/["']/g,"")+"</span>":h==ID_COMMAND_FONT_SIZE?g_TBComboBoxLabel[a][d].element.innerHTML=
""==duzon_dialog.selectionFontStyleList.fontSize?"<span>"+ID_RES_CONST_STRING_FONT_SIZE+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontSize+"</span>":h==ID_COMMAND_HEADING_SIZE?(m=this.getMappingIndex_Heading(a),-1==m&&(m=0),g_TBComboBoxLabel[a][d].element.innerHTML=0==m?"<span>"+ID_RES_CONST_STRING_HEADING_SIZE+"</span>":"<span>"+g_objComboBoxWin.arrHeadingText[m]+"</span>"):h==ID_COMMAND_LETTER_SPACING?g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.letterSpacing?
"<span>"+ID_RES_CONST_STRING_LETTER_SPACING+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.letterSpacing+"</span>":h==ID_COMMAND_LINE_HEIGHT&&(null==b[5]&&(b[5]=""),g_TBComboBoxLabel[a][d].element.innerHTML=null==b[5]||""==b[5]?"<span>"+ID_RES_CONST_STRING_LINE_HEIGHT+"</span>":"<span>"+parseInt(100*parseFloat(b[5],10),10)+"%</span>");else{TBSetState(l,ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);f=g_objNodeUtil.getChildrenCollection(g_TBComboBoxLabel[a][d].element);if(null==f)break;
for(c=0;c<f.length;c++)ID_SELECTION_ELEMENT_NODE==f[c].nodeType&&(f[c].style.display="none")}}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"update_toolbar_combobox")}},getMappingIndex_FontName:function(b,a){try{for(a=0;a<g_arrFontName.length;a++){if("undefined"==typeof b||null==b||""==b)return 0;if(b.toLowerCase()==g_arrFontName[a])return a}return-1}catch(e){g_objCommonUtil.displayErrorAlert(e,"getMappingIndex_FontName")}},getMappingIndex_FontSize:function(b,a){try{if(null==b)return-1;for(a=0;a<
g_objComboBoxWin.arrFontSize.length;a++)if(b==g_objComboBoxWin.arrFontSize[a])return a;b=b.toLowerCase();a=-1;"11px"==b?a=1:"12px"==b?a=2:"13px"==b?a=3:"15px"==b?a=4:"16px"==b?a=5:"17px"==b?a=6:"19px"==b?a=7:"21px"==b?a=8:"22px"==b?a=9:"23px"==b?a=10:"24px"==b?a=11:"25px"==b?a=12:"26px"==b?a=13:"32px"==b?a=14:"40px"==b?a=15:"48px"==b&&(a=16);return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"getMappingIndex_FontSize")}},getMappingIndex_LetterSpacing:function(b,a){try{if(null==b)return-1;b=b.toLowerCase();
for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)if(b==g_objLetterSpacingWin.arrLetterSpacing[a])return a;return-1}catch(e){g_objCommonUtil.displayErrorAlert(e,"getMappingIndex_LetterSpacing")}},getMappingIndex_LineHeight:function(b,a){try{if(null==b)return-1;for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)if(b==g_objLineHeightWin.arrLineHeight[a])return a;return-1}catch(e){g_objCommonUtil.displayErrorAlert(e,"getMappingIndex_LineHeight")}},getMappingIndex_Heading:function(b){try{var a=
-1;if(window.attachEvent){var e=g_objEditorDocument[b].selection,d=e.createRange(),f=d.parentElement();""==d.text?a=this.getLoop_ParentHeadingBlock(f):this.is_Include_heading_block(f)||(a=this.getLoop_ParentHeadingBlock(f))}else{e=g_objEditWindow[b].getSelection();if(1!=e.rangeCount)return-1;d=e.getRangeAt(0);f=d.commonAncestorContainer;ID_SELECTION_TEXT_NODE==f.nodeType?(f=g_objNodeUtil.getParentElement(f),a=this.getLoop_ParentHeadingBlock(f)):this.is_Include_heading_block(f)||(a=this.getLoop_ParentHeadingBlock(f))}return a}catch(c){g_objCommonUtil.displayErrorAlert(c,
"getMappingIndex_Heading")}return-1},getLoop_ParentHeadingBlock:function(b){try{if(fnObjectCheckNull(b)||ID_SELECTION_ELEMENT_NODE!=b.nodeType)return-1;var a=b.nodeName.toLowerCase();if("body"==a)return-1;var e=this.checkIsHeadingBlock(a);if(-1!=e)return e;for(;;){var d=g_objNodeUtil.getParentElement(b);if(fnObjectCheckNull(d))break;a=d.nodeName.toLowerCase();if("body"==a)break;e=this.checkIsHeadingBlock(a);if(-1!=e)return e;b=d}}catch(f){g_objCommonUtil.displayErrorAlert(f,"getLoop_ParentHeadingBlock")}return-1},
checkIsHeadingBlock:function(b){try{for(var a=1;a<g_objComboBoxWin.arrHeadingBlock.length;a++)if(b==g_objComboBoxWin.arrHeadingBlock[a])return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkIsHeadingBlock")}return-1},is_Include_heading_block:function(b){try{if(null==b)return!1;for(var a=0;a<b.childNodes.length;a++){var e=b.childNodes[a];if(ID_SELECTION_ELEMENT_NODE==e.nodeType){var d=e.nodeName.toLowerCase();if(-1!=updateHandlerUI.checkIsHeadingBlock(d)||this.is_Include_heading_block(e))return!0}}}catch(f){g_objCommonUtil.displayErrorAlert(f,
"is_Include_heading_block")}return!1},update_toolbar_dropdown:function(b,a){try{var e=g_objEditorDocument[a];if(ID_STRING_NAME_CONTROL==b)for(var d=0;d<g_TBDropDown[a].length;d++)ID_SUPPORT_CONTROL_TYPE_NO==g_TBDropDown[a][d].support_control_type&&TBSetState(g_TBDropDown[a][d].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][d].button_type);else for(d=0;d<g_TBDropDown[a].length;d++){var f=g_TBDropDown[a][d].element,c=g_TBDropDown[a][d].element.command,g=g_TBDropDown[a][d].element.command_id;if(""!=c){var l=
handlerUI.queryCommandStatus(e,g,c,a,-1,b),k=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(k=handlerUI.setDisableMenu(g));l=1==k?ID_STRING_NAME_GRAY:l;null!=l&&TBSetState(f,l,g_TBDropDown[a][d].button_type)}else dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(k=handlerUI.setDisableMenu(g),1==k&&TBSetState(f,ID_STRING_NAME_GRAY,g_TBDropDown[a][d].button_type))}}catch(h){g_objCommonUtil.displayErrorAlert(h,"update_toolbar_dropdown")}},setStateButton:function(b,a,e,d){try{var f=
handlerUI.getCommandUpdateIndex(b,a);if(-1!=f){var c=null;ID_TB_QUERY_STATUS_BUTTON==e?(c=g_TBButton[b][f].element,ID_COMMAND_WRITE_AREA_SET==a&&(d=g_objEditMode.arrWriteAreaSet[b]?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED)):ID_TB_QUERY_STATUS_COMBOBOX==e?c=g_TBComboBox[b][f].element:ID_TB_QUERY_STATUS_DROPDOWN==e&&(c=g_TBDropDown[b][f].element);TBSetState(c,d,e)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"setStateButton")}},update_toolbar_manual:function(b,a,e){try{var d=[[ID_COMMAND_TABLE_CREATE,
ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_DOC_TEMPLETE,ID_TB_QUERY_STATUS_BUTTON],[ID_COMMAND_STYLE_CASCADE_ORDERLIST,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_INSERT_EMOTICONS,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SELECT_PARAGRAPH,ID_TB_QUERY_STATUS_DROPDOWN]];if(ID_STRING_NAME_CONTROL===b||a)var f=ID_STRING_NAME_GRAY;else d[5]=[ID_COMMAND_IMAGE_BORDER_TYPE,ID_TB_QUERY_STATUS_DROPDOWN],d[6]=[ID_COMMAND_IMAGE_BORDER_THICKNESS,ID_TB_QUERY_STATUS_DROPDOWN],d[7]=[ID_COMMAND_IMAGE_BORDER_COLOR,ID_TB_QUERY_STATUS_DROPDOWN];
for(b=0;b<d.length;b++){if(!0===fnObjectCheckNull(f)){var c=null;dzeUiConfig.bUseLockEditCellFunction&&g_objTableFunction.hasLockedEditCell(g_objTable,!1)&&(c=handlerUI.setDisableMenu(d[b][0]));c=!0===c?c:a;f=!0===c?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED}this.setStateButton(e,d[b][0],d[b][1],f)}this.setStateButton(e,ID_COMMAND_HIDE_MINIBAR,ID_TB_QUERY_STATUS_BUTTON,null);this.setStateButton(e,ID_COMMAND_WRITE_AREA_SET,ID_TB_QUERY_STATUS_BUTTON,null)}catch(g){g_objCommonUtil.displayErrorAlert(g,
"update_toolbar_manual")}},update_context_menu:function(b,a,e,d){try{for(var f=g_objEditorDocument[d],c=0;c<g_objContextMenuWin.arrTBContextMenuItem[b].length;c++){var g=g_objContextMenuWin.arrTBContextMenuItem[b][c],l=g_objContextMenuWin.arrTBContextMenuItem[b][c].command,k=g_objContextMenuWin.arrTBContextMenuItem[b][c].command_id;if("img"==e&&ID_COMMAND_INSERT_IMAGE==k)g_objMenuWin.TBSubMenuSetState(g,ID_STRING_NAME_UNCHECKED);else{var h=handlerUI.queryCommandStatus(f,k,l,d,-1,a);null==h&&g.TBSTATE==
ID_STRING_NAME_UNCHECKED&&(h=ID_STRING_NAME_UNCHECKED);null!=h&&g_objMenuWin.TBSubMenuSetState(g,h);k==ID_COMMAND_HYPERLINK_INSERT&&getSelectionTextValue(d)}}}catch(m){g_objCommonUtil.displayErrorAlert(m,"update_context_menu")}},update_toolbar_for_locked_cell_option:function(b){try{for(var a,e,d,f=0;f<g_TBButton[b].length;f++)a=g_TBButton[b][f].command_id,e=g_TBButton[b][f].element,(d=handlerUI.setDisableMenu(a))&&TBSetState(e,ID_STRING_NAME_GRAY,g_TBButton[b][f].button_type);for(f=0;f<g_TBDropDown[b].length;f++)a=
g_TBDropDown[b][f].command_id,e=g_TBDropDown[b][f].element,(d=handlerUI.setDisableMenu(a))&&TBSetState(e,ID_STRING_NAME_GRAY,g_TBDropDown[b][f].button_type)}catch(c){g_objCommonUtil.displayErrorAlert(c,"update_toolbar_for_locked_cell_option")}}};

var updateTableHandlerUI={setStateTableButton:function(c,d,f,e){try{var a=e;"undefined"==typeof e&&(a=ID_TB_QUERY_STATUS_BUTTON);var b=handlerUI.getCommandUpdateIndex(c,d);if(-1!=b){e=null;f=f?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var g=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(g=handlerUI.setDisableMenu(d));f=1==g?ID_STRING_NAME_GRAY:f;ID_TB_QUERY_STATUS_DROPDOWN==a?(e=g_TBDropDown[c][b].element,TBSetState(e,f,ID_TB_QUERY_STATUS_DROPDOWN)):(e=g_TBButton[c][b].element,TBSetState(e,
f,ID_TB_QUERY_STATUS_BUTTON))}}catch(h){g_objCommonUtil.displayErrorAlert(h,"setStateTableButton")}},updateTableUIHandler:function(c,d,f,e,a){try{this.setStateTableButton(a,ID_COMMAND_LOCK_EDIT_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_FORMULA_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);switch(c){case UI_TABLE_SELECT_TYPE_NONE:this.setStateTableButton(a,
ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);1==f?this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!0):this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1);1==e?this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!0):this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,
!1);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,
ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,
!0);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!0);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,
ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,
!0);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ONE_CELL:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,
ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ENTIRE_ROW:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,
!1);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!0);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_ENTIRE_COL:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!1);this.setStateTableButton(a,
ID_COMMAND_TABLE_COPY_ROW_DOWN,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!0);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,
ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;case UI_TABLE_SELECT_TYPE_GENERAL:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,
!1);this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!0);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_UNCHECKED);this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!0);this.setStateTableButton(a,
ID_COMMAND_TABLE_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!0);this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,
ID_COMMAND_TABLE_BORDER_THICKNESS,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!0,ID_TB_QUERY_STATUS_DROPDOWN);this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!0,ID_TB_QUERY_STATUS_DROPDOWN);break;default:this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,
!1),this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_ROW,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_COL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_MERGE_CELL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,!1),updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,
ID_STRING_NAME_GRAY),updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_GRAY),this.setStateTableButton(a,ID_COMMAND_LOCK_EDIT_CELL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_CONVERT_TEXT,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_PROPERTY,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_PROPERTY,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_CELL_STYLE,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_DELETE_EXT,!1,ID_TB_QUERY_STATUS_DROPDOWN),
this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT,!1,ID_TB_QUERY_STATUS_DROPDOWN),this.setStateTableButton(a,ID_COMMAND_TABLE_SELECT_FORMULA,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_NUMBER_FORMAT,!1,ID_TB_QUERY_STATUS_DROPDOWN),this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_THICKNESS,!1,ID_TB_QUERY_STATUS_DROPDOWN),this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_TYPE,!1,ID_TB_QUERY_STATUS_DROPDOWN),this.setStateTableButton(a,ID_COMMAND_TABLE_BORDER_COLOR,!1,ID_TB_QUERY_STATUS_DROPDOWN),
this.setStateTableButton(a,ID_CUSTOM_TABLE_STYLE,!1,ID_TB_QUERY_STATUS_DROPDOWN),this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_CELL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_ROW,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_SPLIT_COL,!1),this.setStateTableButton(a,ID_COMMAND_TABLE_FORMULA_EXT,!1,ID_TB_QUERY_STATUS_DROPDOWN)}this.updateTableUICommand(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"updateTableUIHandler")}},updateTableUICommand:function(c){try{if(GetMultiCellSelection()){for(var d=
0;d<g_TBButton[c].length;d++)if(ID_SUPPORT_TYPE_MULTI_CELL==g_TBButton[c][d].support_type){var f=g_TBButton[c][d].command_id;if(f==ID_COMMAND_UNDO||f==ID_COMMAND_REDO){var e=g_objUndoRedo.arrUndoRedoStruct[c];null==e?TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_GRAY,g_TBButton[c][d].button_type):f==ID_COMMAND_UNDO?0==e.nUndoRedoStackPos?TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_GRAY,g_TBButton[c][d].button_type):TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_UNCHECKED,g_TBButton[c][d].button_type):
e.nUndoRedoStack_LastEventPos<=e.nUndoRedoStackPos?TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_GRAY,g_TBButton[c][d].button_type):TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_UNCHECKED,g_TBButton[c][d].button_type)}else TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_UNCHECKED,g_TBButton[c][d].button_type)}else ID_SUPPORT_TYPE_PERSISTENCE!=g_TBButton[c][d].support_type&&ID_SUPPORT_TYPE_TABLE_OPERATION!=g_TBButton[c][d].support_type&&TBSetState(g_TBButton[c][d].element,ID_STRING_NAME_GRAY,
g_TBButton[c][d].button_type);for(d=0;d<g_TBDropDown[c].length;d++)ID_SUPPORT_TYPE_MULTI_CELL==g_TBDropDown[c][d].support_type?TBSetState(g_TBDropDown[c][d].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[c][d].button_type):ID_SUPPORT_TYPE_PERSISTENCE!=g_TBDropDown[c][d].support_type&&TBSetState(g_TBDropDown[c][d].element,ID_STRING_NAME_GRAY,g_TBDropDown[c][d].button_type);for(d=0;d<g_TBComboBox[c].length;d++)ID_SUPPORT_TYPE_MULTI_CELL==g_TBComboBox[c][d].support_type?TBSetState(g_TBComboBox[c][d].element,
ID_STRING_NAME_UNCHECKED,g_TBComboBox[c][d].button_type):ID_SUPPORT_TYPE_PERSISTENCE!=g_TBComboBox[c][d].support_type&&TBSetState(g_TBComboBox[c][d].element,ID_STRING_NAME_GRAY,g_TBComboBox[c][d].button_type)}}catch(a){g_objCommonUtil.displayErrorAlert(a,"updateTableUICommand")}},setStateTableContextMenu:function(c,d,f,e){try{var a=handlerUI.getContextUpdateIndex(c,d);-1!=a&&(c=e?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY,e=null,dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(e=handlerUI.setDisableMenu(d)),
c=1==e?ID_STRING_NAME_GRAY:c,g_objMenuWin.TBSubMenuSetState(f[a],c))}catch(b){g_objCommonUtil.displayErrorAlert(b,"setStateTableContextMenu")}},updateTableContextMenuUIHandler:function(c,d,f,e,a,b){try{switch(this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_CELL,b,!0),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_ROW,b,!0),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_COL,b,!0),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_FORMULA,b,!0),c){case UI_TABLE_SELECT_TYPE_NONE:this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);a==g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_TABLE_ONE?(1==f?this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!0):this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1),1==e?this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_DELETE_COL,b,!0):this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!1)):a==g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_TABLE_MULTI&&(this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!1));this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!1);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,
b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!0);
this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,
!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,
b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!1);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_ROW:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,
b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_COL:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!1);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;case UI_TABLE_SELECT_TYPE_GENERAL:this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_ADD_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,b,!1);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!0);this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,
b,!1);this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!0);break;default:this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,b,!1),this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_DELETE_COL,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_PROPERTY,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_PROPERTY,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_TABLE,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,
b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_FORMULA,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,b,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_ALIGN,b,!0),this.setStateTableContextMenu(a,ID_COMMAND_COPY,b,!1)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"updateTableContextMenuUIHandler")}},setStateTableMenu:function(c,d,f){try{var e=handlerUI.getMenuTableUpdateIndex(c);if(-1!=e){f=
f?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var a=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(a=handlerUI.setDisableMenu(c));f=1==a?ID_STRING_NAME_GRAY:f;g_objMenuWin.TBSubMenuSetState(d[e],f)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setStateTableMenu")}},updateTableMenuUIHandler:function(c,d,f,e){try{var a=g_objMenuWin.objSubMenuItem[ID_COMMAND_MENU_TABLE_INDEX];this.setStateTableMenu(ID_COMMAND_LOCK_EDIT_CELL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SPLIT_CELL,a,
!0);this.setStateTableMenu(ID_COMMAND_TABLE_FORMULA,a,!0);switch(c){case UI_TABLE_SELECT_TYPE_NONE:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1);1==f?this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,
a,!0):this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1);1==e?this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!0):this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,
a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,
a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ONE_CELL:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,
a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_ROW:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_COL:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,
a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,
a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);break;case UI_TABLE_SELECT_TYPE_GENERAL:this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!0);this.setStateTableMenu(ID_COMMAND_LOCK_EDIT_CELL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,
a,!1);this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!0);this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1);break;default:this.setStateTableMenu(ID_COMMAND_TABLE_MERGE_CELL,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_PROPERTY,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_PROPERTY,
a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_STYLE,a,!1),this.setStateTableMenu(ID_COMMAND_LOCK_EDIT_CELL,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_ROW,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_DELETE_COL,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_ADD_ROW_COL,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_SPLIT_CELL,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,
a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_VERTICALALIGN,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CONVERT_TEXT,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_FORMULA,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_SELECT_FORMULA,a,!1),this.setStateTableMenu(ID_COMMAND_TABLE_CREATE,a,!0),this.setStateTableMenu(ID_COMMAND_TABLE_CELL_ALIGN,a,!1)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"updateTableMenuUIHandler")}}};

var UI_TABLE_SELECT_TYPE_NONE=1,UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE=2,UI_TABLE_SELECT_TYPE_ENTIRE_TABLE=3,UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW=4,UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL=5,UI_TABLE_SELECT_TYPE_ONE_CELL=6,UI_TABLE_SELECT_TYPE_ENTIRE_ROW=7,UI_TABLE_SELECT_TYPE_ENTIRE_COL=8,UI_TABLE_SELECT_TYPE_GENERAL=9,g_objTableSelection=new function(){this.ID_TABLE_CELL_SELECTED_COLOR="#ddeeff";this.CheckTableSelection=function(a,b,c){try{return fnObjectCheckNull(a)||fnObjectCheckNull(b)?null:g_objTableCase.CheckSelectedCellCase(b,
!1,c)}catch(d){g_objCommonUtil.displayErrorAlert(d,"CheckTableSelection")}return null};this.doAllTable=function(a,b){try{if(a){var c=g_objTableUtil.getSplitTables(b?b:g_objTable);b=0;for(var d=c.length;b<d;b++)a(c[b])}}catch(f){dalert(f)}};this.doAllSelectedCell=function(a,b){try{if(a)for(var c=g_objTableUtil.getSplitTables(b?b:g_objTable),d=b=null,f=null,g=0,h=0,m=c.length;h<m;h++){b=c[h];for(var l=0,k=b.rows.length;l<k;l++,g++){d=b.rows[l];for(var e=0,n=d.cells.length;e<n;e++)(f=d.cells[e])&&f.hasAttribute("cusflag")&&
a(f,g,e,l,e,b,n)}}}catch(v){dalert(v)}};this.doAllCell=function(a,b){try{if(a)for(var c=g_objTableUtil.getSplitTables(b?b:g_objTable),d=b=null,f=null,g=0,h=0,m=c.length;h<m;h++){b=c[h];for(var l=0,k=b.rows.length;l<k;l++,g++){d=b.rows[l];for(var e=0,n=d.cells.length;e<n;e++)(f=d.cells[e])&&a(f,g,e,l,e,b,n)}}}catch(v){dalert(v)}};this.CheckTableSelectionPos=function(a,b){return g_nStartClick_X<=a&&g_nStartClick_Y<=b&&a<=g_nEndClick_X&&b<=g_nEndClick_Y?!0:!1};this.table_OnEventMouseDown=function(a,
b,c){try{if(!g_bTableOperationYN||fnObjectCheckNull(a))return!1;fnObjectCheckNull(g_objTable)||g_objTableFlag.ResetTableInfo(!1);var d=g_objNodeUtil.getEventSrcElement(a,b);if(fnObjectCheckNull(d)||this.IsEditContainerLoopParentElement(d))return!1;var f=g_objNodeUtil.getElementTagName(d);if(fnObjectCheckNull(f)||"table"==f.toLowerCase())return!1;var g=g_objNodeUtil.getLoopParentElement(d,"td");if(fnObjectCheckNull(g))return!1;var h=g_objNodeUtil.getLoopParentElement(g,"tr");if(fnObjectCheckNull(h))return!1;
var m=g_bBrowserType_WK?h.sectionRowIndex:h.rowIndex,l=g.cellIndex,k=g_objNodeUtil.getLoopParentElement(h,"table");if(fnObjectCheckNull(k))return!1;g_objTableFlag.tagTableInfo.nZIndex=k.style.zIndex;var e=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(k,c);g_objTableFlag.tagTableInfo.nTableLeft=e.left;g_objTableFlag.tagTableInfo.nTableTop=e.top;g_objTableFlag.tagTableInfo.nTableRight=e.right;g_objTableFlag.tagTableInfo.nTableBottom=e.bottom;g_objTable=k;g_nStartClick_Row=m;g_nStartClick_Col=
l;g_nEndClick_Col=g_nEndClick_Row=-1;dzeUiConfig.bUseLockEditCellFunction&&(g_bHasLockedCell=g_objTableFunction.hasLockedEditCell(g_objTable,!0));return!0}catch(n){g_objCommonUtil.displayErrorAlert(n,"table_OnEventMouseDown")}return!1};this.IsEditContainerLoopParentElement=function(a){try{if(null==a)return!1;var b=g_strEditContainerName+"_"+g_nActiveEditNumber;if(a.id==b)return!0;for(;;){var c=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(c))break;if("body"==g_objNodeUtil.getElementTagName(c).toLowerCase())break;
if(c.id==b)return!0;a=c;if(fnObjectCheckNull(a))break}}catch(d){g_objCommonUtil.displayErrorAlert(d,"IsEditContainerLoopParentElement")}return!1};this.table_SelectTableCell=function(a,b,c){try{if(!g_bTableOperationYN||fnObjectCheckNull(a)||fnObjectCheckNull(g_objTable))return 0;var d=g_objNodeUtil.getEventSrcElement(a,b);if(fnObjectCheckNull(d)||"table"==g_objNodeUtil.getElementTagName(d).toLowerCase())return 0;var f=g_objNodeUtil.getLoopParentElement(d,"td");if(fnObjectCheckNull(f))return 0;var g=
g_objNodeUtil.getLoopParentElement(f,"table");if(fnObjectCheckNull(g)||g_objTableFlag.tagTableInfo.nZIndex!=g.style.zIndex)return 0;var h=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(g,c);if(g_objTableFlag.tagTableInfo.nTableLeft!=h.left||g_objTableFlag.tagTableInfo.nTableTop!=h.top||g_objTableFlag.tagTableInfo.nTableRight!=h.right||g_objTableFlag.tagTableInfo.nTableBottom!=h.bottom)return 0;var m=g_objNodeUtil.getLoopParentElement(f,"tr");if(fnObjectCheckNull(m))return 0;var l=g_bBrowserType_WK?
m.sectionRowIndex:m.rowIndex,k=f.cellIndex;if(-1==g_nEndClick_Row&&-1==g_nEndClick_Col){var e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(f,g,l,c);g_nStartClick_X=e.left;g_nStartClick_Y=e.top;g_nEndClick_X=e.right;g_nEndClick_Y=e.bottom}else if(g_nEndClick_Row!=l||g_nEndClick_Col!=k){g_objTableFlag.bOneCell=!1;var n=g_objTableUtil.getTableCellElement(g,g_nStartClick_Row,g_nStartClick_Col),v=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(n,g,g_nStartClick_Row,c),x=v.left,z=v.top,
A=v.right,B=v.bottom,p=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(f,g,l,c),C=p.left,E=p.top,F=p.right,G=p.bottom;g_nStartClick_X=x>C?C:x;g_nStartClick_Y=z>E?E:z;g_nEndClick_X=A<F?F:A;g_nEndClick_Y=B<G?G:B;var H=g.rows.length;for(a=0;a<H;a++)for(var D=g_objTableUtil.getTableCellsLength(g,a),w=0;w<D;w++)if(!(a==g_nStartClick_Row&&w==g_nStartClick_Col||a==l&&w==k)){var y=g_objTableUtil.getTableCellElement(g,a,w);e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(y,g,a,c);var q=
e.left,r=e.top,u=e.right,t=e.bottom;g_nStartClick_X>=q&&g_nEndClick_X<=u&&g_nStartClick_Y<=r&&g_nEndClick_Y>=t&&(g_nStartClick_X=q,g_nEndClick_X=u);g_nStartClick_X<=q&&g_nEndClick_X>=u&&g_nStartClick_Y>=r&&g_nEndClick_Y<=t&&(g_nStartClick_Y=r,g_nEndClick_Y=t);g_nStartClick_X<=q&&g_nEndClick_X>=u&&g_nStartClick_Y>r&&g_nStartClick_Y<t&&g_nEndClick_Y>=t&&(g_nStartClick_Y=r);g_nStartClick_X<=q&&g_nEndClick_X>q&&g_nEndClick_X<=u&&g_nStartClick_Y>r&&g_nStartClick_Y<t&&g_nEndClick_Y>=t&&(g_nStartClick_Y=
r);g_nStartClick_X<=q&&g_nEndClick_X>=u&&g_nStartClick_Y<=r&&g_nEndClick_Y>r&&g_nEndClick_Y<t&&(g_nEndClick_Y=t);g_nStartClick_X>q&&g_nStartClick_X+2<u&&g_nEndClick_X>=u&&g_nStartClick_Y<=r&&g_nEndClick_Y>=t&&(g_nStartClick_X=q);g_nStartClick_X<=q&&g_nEndClick_X>q+2&&g_nEndClick_X<u&&g_nStartClick_Y<=r&&g_nEndClick_Y>=t&&(g_nEndClick_X=u)}for(a=0;a<H;a++)for(D=g_objTableUtil.getTableCellsLength(g,a),w=0;w<D;w++)y=g_objTableUtil.getTableCellElement(g,a,w),e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(y,
g,a,c),q=e.left,r=e.top,u=e.right,t=e.bottom,g_nStartClick_X<=q&&g_nStartClick_Y<=r&&g_nEndClick_X>=u&&g_nEndClick_Y>=t?g_objTableFlag.AddCellAfterCheckExist(y):g_objTableFlag.RemoveCellAfterCheckExist(y)}g_nEndClick_Row=l;g_nEndClick_Col=k;return g_nStartClick_Row==g_nEndClick_Row&&g_nStartClick_Col==g_nEndClick_Col?1:2}catch(I){g_objCommonUtil.displayErrorAlert(I,"table_SelectTableCell")}return 0};this.table_EndSelectionCell=function(a,b){try{if(!g_bTableOperationYN)return null;var c=0,d=0,f=0,
g=0;if(fnObjectCheckNull(a)||fnObjectCheckNull(g_objTable))return null;if(-1==g_nEndClick_Row&&-1==g_nEndClick_Col){c=1;d=4;g_objTableFlag.SetCellAttribute_Flag(g_objTable,g_nStartClick_Row,g_nStartClick_Col,1);var h=g_objTableCase.CheckNoSelectedCellCase_Row_Col(a,g_objTable,g_nStartClick_Row,g_nStartClick_Col,b);f=h[0];g=h[1]}else{a=!0;for(var m=h=-1,l=g_objTable.rows.length,k=0;k<l;k++)for(var e=g_objTableUtil.getTableCellsLength(g_objTable,k),n=0;n<e;n++){var v=g_objTableUtil.getTableCellElement(g_objTable,
k,n),x=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(v,g_objTable,k,b),z=x.top,A=x.right,B=x.bottom;g_nStartClick_X<=x.left&&g_nStartClick_Y<=z&&g_nEndClick_X>=A&&g_nEndClick_Y>=B&&(a?(a=!1,g_objTableFlag.SetCellAttribute_Flag(g_objTable,k,n,2),g_nStartClick_Row=k,g_nStartClick_Col=n):g_objTableFlag.SetCellAttribute_Flag(g_objTable,k,n,3),h=k,m=n)}-1==h||-1==m||g_nStartClick_Row==h&&g_nStartClick_Col==m||(g_objTableFlag.SetCellAttribute_Flag(g_objTable,h,m,4),g_nEndClick_Row=h,g_nEndClick_Col=
m);var p=g_objTableCase.CheckSelectedCellCase(g_objTable,!0,b);if(null==p)return null;c=p[0];d=p[1];p=null}p=Array(4);p[0]=c;p[1]=d;p[2]=f;p[3]=g;return p}catch(C){g_objCommonUtil.displayErrorAlert(C,"table_EndSelectionCell")}return null};this.setTableObjectOnCaret=function(a){try{if(-1!=a&&!g_objTable){var b=!1;if(window.addEventListener){var c=g_objEditWindow[a].getSelection();if(fnObjectCheckNull(c))return;if(1==c.rangeCount){var d=c.getRangeAt(0);if(fnObjectCheckNull(d))return;b=d.collapsed}}else{c=
g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return;d=c.createRange();if(fnObjectCheckNull(d))return;""==d.htmlText&&(b=!0)}if(b){var f="commonAncestorContainer"in d?d.commonAncestorContainer:d.parentElement().childNodes[0];if("undefined"!=typeof f&&null!=f){var g=g_objNodeUtil.getLoopParentElement(f,"td");if(null!=g){var h=g_objNodeUtil.getLoopParentElement(g,"tr");if(null!=h){var m=g_bBrowserType_WK?h.sectionRowIndex:h.rowIndex,l=g.cellIndex,k=g_objNodeUtil.getLoopParentElement(f,"table");
null!=k&&(g_objTable=k,g_nStartClick_Row=m,g_nStartClick_Col=l,g_nEndClick_Col=g_nEndClick_Row=-1,g_objTableFlag.SetCellAttribute_Flag(g_objTable,g_nStartClick_Row,g_nStartClick_Col,1),g_objTableFlag.bOneCell=!0)}}}}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"setTableObjectOnCaret")}};this.table_SelectionCaretCell=function(a){try{if(!GetMultiCellSelection()){if(!g_objTable&&(g_objTableSelection.setTableObjectOnCaret(a),!g_objTable))return;g_objTableSelection.table_SelectionOneCell(a,g_nStartClick_Row,
g_nStartClick_Col)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"table_SelectionCaretCell")}};this.table_SelectionOneCell=function(a,b,c){try{if(g_objTable){var d=g_objTableUtil.getTableCellElement(g_objTable,b,c);if(null!=d){d.setAttribute("cusSelYN","0");g_objTableFlag.AddCellAfterCheckExist(d);g_objTableFlag.SetCellAttribute_Flag(g_objTable,b,c,2);g_nStartClick_Row=b;g_nStartClick_Col=c;g_nEndClick_Row=b;g_nEndClick_Col=c;g_objTableFlag.bOneCell=!1;var f=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(d,
g_objTable,b,a);g_nStartClick_X=f.left;g_nStartClick_Y=f.top;g_nEndClick_X=f.right;g_nEndClick_Y=f.bottom}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"table_SelectionOneCell")}};this.table_checkBlankOnTableCell=function(a){try{if(!GetMultiCellSelection()){if(!g_objTable&&(g_objTableSelection.setTableObjectOnCaret(a),!g_objTable))return;var b=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col);if(null!=b){var c=b.innerText.replace(/\u200B/g,"");return b.innerHTML&&
0<b.innerHTML.length&&0===c.length?-1!=b.innerHTML.indexOf("<br>")?!1:!0:!1}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"table_checkBlankOnTableCell")}};this.isTableSelected=function(a){try{if(!g_objTable)return!1;var b=g_objTable,c=g_objWrapperOutlineResize.objExtSelectedInfo,d=this.CheckTableSelection(b.ownerDocument,b,a)[0];return c&&c.objElement&&c.objElement.nodeType==ID_SELECTION_ELEMENT_NODE&&"table"==c.objElement.tagName.toLowerCase()&&d==UI_TABLE_SELECT_TYPE_ENTIRE_TABLE?!0:!1}catch(f){g_objCommonUtil.displayErrorAlert(f,
"table_selection.isTableSelected")}};this.selectTable=function(a){try{if(g_objTable){var b=g_objTable;g_objTableMiniMenu.prepareTableSelectAll(a);g_objTableMiniMenu.table_selectAll(b,a);g_objTableMiniMenu.updateManualTableUIHandler(a);showExtOutline_ObjectElement(b,!0,!1,a)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"table_selection.selectTable")}}};

var g_objTable=null,g_nStartClick_Row=-1,g_nStartClick_Col=-1,g_nEndClick_Row=-1,g_nEndClick_Col=-1,g_nStartClick_X=0,g_nStartClick_Y=0,g_nEndClick_X=0,g_nEndClick_Y=0,g_bHasLockedCell=!1,g_objTableFlag=new function(){this.tagTableInfo=null;this.bOneCell=!0;this.arrDecreaseRowCol=null;this.initTableInfo=function(){try{this.tagTableInfo=this.initTableInfoItem()}catch(a){g_objCommonUtil.displayErrorAlert(a,"initTableInfo")}};this.initTableInfoItem=function(){return{nZIndex:0,nTableLeft:-1,nTableTop:-1,
nTableRight:-1,nTableBottom:-1}};this.ResetTableInfo=function(a,c){try{!0===duzon_dialog.dialogStatus||(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&-1!=g_objWrapperOutlineUtil.nExtOutlineRectangleMouseDown||(this.initTableInfo(),g_nEndClick_Col=g_nEndClick_Row=g_nStartClick_Col=g_nStartClick_Row=-1,"undefined"==typeof c?g_objWrapperOutlineResize.resetExtOutlineInfo():c&&g_objWrapperOutlineResize.resetExtOutlineInfo(),fnObjectCheckNull(g_objTable)||(a||this.removeFlagInfo(g_objTable),
this.bOneCell=!0,g_objTable=null,g_bHasLockedCell=!1,this.arrDecreaseRowCol=null))}catch(b){this.arrDecreaseRowCol=g_objTable=null,g_objCommonUtil.displayErrorAlert(b,"ResetTableInfo")}};this.removeFlagInfo=function(a){try{for(var c=0;c<a.rows.length;c++)for(var b=g_objTableUtil.getTableCellsLength(a,c),d=0;d<b;d++){var e=g_objTableUtil.getTableCellElement(a,c,d);this.RemoveCellAfterCheckExist(e)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"removeFlagInfo")}};this.setFlagInfo=function(a){try{if(fnObjectCheckNull(a))return!1;
g_nEndClick_Y=g_nEndClick_X=g_nStartClick_Y=g_nStartClick_X=-1;for(var c=a.rows.length,b=0;b<c;b++)for(var d=g_objTableUtil.getTableCellsLength(a,b),e=0;e<d;e++){var f=this.GetCellAttribute_Flag(a,b,e);1==f?(g_nStartClick_Row=b,g_nStartClick_Col=e,g_nEndClick_Col=g_nEndClick_Row=-1):2==f?(g_nStartClick_Row=b,g_nStartClick_Col=e,g_nEndClick_Row=b,g_nEndClick_Col=e):3!=f&&4==f&&(g_nEndClick_Row=b,g_nEndClick_Col=e)}return!0}catch(g){g_objCommonUtil.displayErrorAlert(g,"setFlagInfo")}};this.SetCellAttribute_Custom=
function(a,c,b,d,e){try{fnObjectCheckNull(a)||(a.setAttribute("cusSelYN",c),a.setAttribute("cusFlag",e),a.setAttribute("cusBGStyleYN",b),a.setAttribute("cusOriBGColor",d))}catch(f){g_objCommonUtil.displayErrorAlert(f,"SetCellAttribute_Custom")}};this.AddCellAfterCheckExist=function(a){try{if("1"!=a.getAttribute("cusSelYN")){a.setAttribute("cusSelYN","1");var c=!0,b=a.style.backgroundColor;""==b&&(c=!1,b=a.bgColor);c?(a.style.backgroundColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR,a.setAttribute("cusBGStyleYN",
"1")):(a.bgColor=g_objTableSelection.ID_TABLE_CELL_SELECTED_COLOR,a.setAttribute("cusBGStyleYN","0"));""==b&&(b="transparent");a.setAttribute("cusOriBGColor",b)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"AddCellAfterCheckExist")}};this.RemoveCellAfterCheckExist=function(a){try{if("1"==a.getAttribute("cusSelYN")){var c=a.getAttribute("cusBGStyleYN"),b=a.getAttribute("cusOriBGColor");"transparent"==b&&(b="");"1"==c?(a.bgColor="",a.style.backgroundColor=b):"0"==c&&(a.bgColor=b);a.removeAttribute("cusSelYN");
a.removeAttribute("cusBGStyleYN");a.removeAttribute("cusOriBGColor");a.removeAttribute("cusFlag");""==a.bgColor&&a.removeAttribute("bgColor")}}catch(d){g_objCommonUtil.displayErrorAlert(d,"RemoveCellAfterCheckExist")}};this.GetCellAttribute_Flag=function(a,c,b){try{var d=g_objTableUtil.getTableCellElement(a,c,b).getAttribute("cusFlag");null==d&&(d=0);return parseInt(d)}catch(e){g_objCommonUtil.displayErrorAlert(e,"GetCellAttribute_Flag")}return 0};this.SetCellAttribute_Flag=function(a,c,b,d){try{var e=
g_objTableUtil.getTableCellElement(a,c,b);"1"!=e.getAttribute("cusSelYN")&&e.setAttribute("cusSelYN","1");e.setAttribute("cusFlag",d)}catch(f){g_objCommonUtil.displayErrorAlert(f,"SetCellAttribute_Flag")}}};

var g_objTableCase=new function(){this.CheckSelectedCellCase=function(b,a,c){try{var k=0,p=0,h=0,d=!0,e=0,l=0;if(a&&!this.CheckValidCase(b,c))return null;var f=b.rows.length;for(a=0;a<f;a++){var q=c=0,n=g_objTableUtil.getTableCellsLength(b,a),m=0;if(0==a)for(m=0;m<n;m++){var g=g_objTableUtil.getTableCellElement(b,a,m),r=g.colSpan;l+=r}for(m=0;m<n;m++){p++;var t=g_objTableFlag.GetCellAttribute_Flag(b,a,m);if(2==t||3==t||4==t){h++;c++;g=g_objTableUtil.getTableCellElement(b,a,m);var u=g.rowSpan;r=g.colSpan;
q+=r;a==e&&(e+=u)}}0<c&&c<m&&(d=!1);h==c&&0!=h&&l!=q&&(d=!1)}k=0==h?UI_TABLE_SELECT_TYPE_NONE:1==p?UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:p==h?UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:1!=p&&1==h?d?UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:e==f?UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:UI_TABLE_SELECT_TYPE_ONE_CELL:d?UI_TABLE_SELECT_TYPE_ENTIRE_ROW:e==f?UI_TABLE_SELECT_TYPE_ENTIRE_COL:UI_TABLE_SELECT_TYPE_GENERAL;var v=Array(2);v[0]=k;v[1]=4;return v}catch(w){g_objCommonUtil.displayErrorAlert(w,"CheckSelectedCellCase")}return null};
this.CheckValidCase=function(b,a){try{if(fnObjectCheckNull(b))return!1;for(var c=!0,k=!1,p=b.rows.length,h=0;h<p;h++)for(var d=g_objTableUtil.getTableCellsLength(b,h),e=0;e<d;e++)if(0==g_objTableFlag.GetCellAttribute_Flag(b,h,e)){var l=g_objTableUtil.getTableCellElement(b,h,e),f=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(l,b,h,a),q=f.left,n=f.top,m=f.right,g=f.bottom;if(g_nStartClick_X>q&&g_nStartClick_X<m&&g_nStartClick_Y<=n&&g_nEndClick_Y>=g){k=!0;break}if(g_nEndClick_X>q&&g_nEndClick_X<
m&&g_nStartClick_Y<=n&&g_nEndClick_Y>=g){k=!0;break}if(g_nStartClick_X<=q&&g_nEndClick_X>=m&&g_nStartClick_Y>n&&g_nStartClick_Y<g){k=!0;break}if(g_nStartClick_X<=q&&g_nEndClick_X>=m&&g_nEndClick_Y>n&&g_nEndClick_Y<g){k=!0;break}if(g_nStartClick_X>q&&g_nStartClick_X<m&&g_nEndClick_X>=m&&g_nStartClick_Y<=n&&g_nEndClick_Y>=g){k=!0;break}if(g_nStartClick_X<=q&&g_nEndClick_X>q&&g_nEndClick_X<m&&g_nStartClick_Y<=n&&g_nEndClick_Y>=g){k=!0;break}if(g_nStartClick_X<=q&&g_nEndClick_X>=m&&g_nStartClick_Y>n&&
g_nStartClick_Y<g&&g_nEndClick_Y>=g){k=!0;break}if(g_nStartClick_X<=q&&g_nEndClick_X>=m&&g_nStartClick_Y<=n&&g_nEndClick_Y>n&&g_nEndClick_Y<g){k=!0;break}}k&&(c=!1);return c}catch(r){g_objCommonUtil.displayErrorAlert(r,"CheckValidCase")}return!1};this.CheckNoSelectedCellCase_Row_Col=function(b,a,c,k,p){try{b=[0,0];var h=g_objTableUtil.getTableCellElement(a,c,k),d=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(h,a,c,p),e=d.top,l=d.bottom,f=d.left,q=d.right,n=d=!0;1!=h.rowSpan&&(d=!1);1!=
h.colSpan&&(n=!1);for(h=0;h<a.rows.length&&(d||n);h++){var m=g_objTableUtil.getTableCellsLength(a,h);for(j=0;j<m;j++)if(h!=c||j!=k){if(d){var g=this.CheckCrossCell_Row(a,e,l,h,j,p);0!=g&&6!=g&&2!=g&&3!=g&&(d=!1)}n&&(g=this.CheckCrossCell_Col(a,f,q,h,j,p),0!=g&&6!=g&&2!=g&&3!=g&&(n=!1))}}d&&(b[0]=1);n&&(b[1]=1);return b}catch(r){g_objCommonUtil.displayErrorAlert(r,"CheckNoSelectedCellCase_Row_Col")}return[0,0]};this.ForceSetting_NoSelectedCellCase_Row_Col=function(b,a,c,k,p,h){try{var d=g_objTableUtil.getTableCellElement(a,
c,k),e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(d,a,c,p),l=e.top,f=e.bottom,q=e.left,n=e.right;if(h){if(1!=d.rowSpan)return!1}else if(1!=d.colSpan)return!1;b=!0;k=c=-1;for(d=0;d<a.rows.length;d++){var m=g_objTableUtil.getTableCellsLength(a,d);for(j=0;j<m;j++){var g=h?this.CheckCrossCell_Row(a,l,f,d,j,p):this.CheckCrossCell_Col(a,q,n,d,j,p);if(0!=g&&6!=g)if(2==g||3==g)null==g_objTableFlag.arrDecreaseRowCol&&(g_objTableFlag.arrDecreaseRowCol=[]),g_objTableFlag.arrDecreaseRowCol.push([d,
j]);else return!1;6==g&&(b?(b=!1,g_objTableFlag.SetCellAttribute_Flag(a,d,j,2),g_nStartClick_Row=d,g_nStartClick_Col=j):g_objTableFlag.SetCellAttribute_Flag(a,d,j,3),c=d,k=j)}}-1==c||-1==k||g_nStartClick_Row==c&&g_nStartClick_Col==k||(g_objTableFlag.SetCellAttribute_Flag(a,c,k,4),g_nEndClick_Row=c,g_nEndClick_Col=k);return!0}catch(r){g_objCommonUtil.displayErrorAlert(r,"ForceSetting_NoSelectedCellCase_Row_Col")}return!1};this.CheckCrossCell_Row=function(b,a,c,k,p,h){try{var d=g_objTableUtil.getTableCellElement(b,
k,p),e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(d,b,k,h),l=e.top,f=e.bottom;a=parseInt(a);c=parseInt(c);l=parseInt(l);f=parseInt(f);b=0;a>l&&a<f&&c>f?b=1:a>l&&c==f?b=2:a>l&&c<f?b=3:a==l&&c<f?b=4:a<l&&c>l&&c<f?b=5:a==l&&c==f?b=6:a==l&&c>f?b=7:a<l&&c==f&&(b=8);return b}catch(q){g_objCommonUtil.displayErrorAlert(q,"CheckCrossCell_Row")}return 0};this.CheckCrossCell_Col=function(b,a,c,k,p,h){try{var d=g_objTableUtil.getTableCellElement(b,k,p),e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(d,
b,k,h),l=e.left,f=e.right;a=parseInt(a);c=parseInt(c);l=parseInt(l);f=parseInt(f);b=0;a>l&&a<f&&c>f?b=1:a>l&&c==f?b=2:a>l&&c<f?b=3:a==l&&c<f?b=4:a<l&&c>l&&c<f?b=5:a==l&&c==f?b=6:a==l&&c>f?b=7:a<l&&c==f&&(b=8);return b}catch(q){g_objCommonUtil.displayErrorAlert(q,"CheckCrossCell_Col")}return 0};this.CheckAddType_Row=function(b,a,c,k,p,h,d){try{for(var e=1,l=b.rows.length,f=0;f<l;f++)for(var q=g_objTableUtil.getTableCellsLength(b,f),n=0;n<q;n++){var m=this.CheckCrossCell_Row(b,a,c,f,n,d);if(0!=m){var g=
k.length;k[g]=f;p[g]=n;h[g]=m;e=2}}return e}catch(r){g_objCommonUtil.displayErrorAlert(r,"CheckAddType_Row")}};this.CheckAddType_Col=function(b,a,c,k,p,h,d){try{for(var e=1,l=b.rows.length,f=0;f<l;f++)for(var q=g_objTableUtil.getTableCellsLength(b,f),n=0;n<q;n++){var m=this.CheckCrossCell_Col(b,a,c,f,n,d);if(0!=m){var g=k.length;k[g]=f;p[g]=n;h[g]=m;6!=m&&(e=2)}}return e}catch(r){g_objCommonUtil.displayErrorAlert(r,"CheckAddType_Col")}};this.GetCellType_Row=function(b,a,c,k,p){try{for(var h=0,d=0;d<
b.length;d++)if(k==b[d]&&p==a[d]){h=c[d];break}return h}catch(e){g_objCommonUtil.displayErrorAlert(e,"GetCellType_Row")}};this.checkCrossType_Row=function(b,a,c,k,p,h,d){try{var e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(a,b,c,d),l=e.left,f=e.top,q=e.bottom,n=b.rows.length;for(a=0;a<n;a++){var m=g_objTableUtil.getTableCellsLength(b,a);for(e=0;e<m;e++)if(a!=c||e!=k){var g=g_objTableUtil.getTableCellElement(b,a,e);if(fnObjectCheckNull(g))return;var r=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g,
b,a,d).left;if(!(l<=r)){var t=this.CheckCrossCell_Row(b,f,q,a,e,d);if(2==t||3==t||4==t||6==t||7==t||8==t){var u=p.length;p[u]=a;h[u]=e}}}}}catch(v){g_objCommonUtil.displayErrorAlert(v,"checkCrossType_Row")}};this.checkCrossType_Col=function(b,a,c,k,p,h,d){try{var e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(a,b,c,d),l=e.left,f=e.top,q=e.right,n=b.rows.length;for(a=0;a<n;a++){var m=g_objTableUtil.getTableCellsLength(b,a);for(e=0;e<m;e++)if(a!=c||e!=k){var g=g_objTableUtil.getTableCellElement(b,
a,e);if(fnObjectCheckNull(g))return;var r=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g,b,a,d).top;if(!(f<=r)){var t=this.CheckCrossCell_Col(b,l,q,a,e,d);if(2==t||3==t||4==t||6==t||7==t||8==t){var u=p.length;p[u]=a;h[u]=e}}}}}catch(v){g_objCommonUtil.displayErrorAlert(v,"checkCrossType_Col")}}};

var g_objTableOperation=new function(){this.RET_FALSE=0;this.RET_TRUE=1;this.RET_DELETE_TABLE=2;this.FORMULA_SUM=0;this.FORMULA_AVERAGE=1;this.FORMULA_MULTIPLY=2;this.table_AddTableRow=function(b,a,c,d,f){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;var h=0,e=-1;b=0;var k=g_objTableCase.CheckSelectedCellCase(a,!1,f);if(null==k)return!1;b=k[0];switch(b){case UI_TABLE_SELECT_TYPE_NONE:case UI_TABLE_SELECT_TYPE_ONE_CELL:var l=g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,g_nStartClick_Col),
m=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(l,a,g_nStartClick_Row,f);k=[];var p=[],t=[];h=g_objTableCase.CheckAddType_Row(a,m.top,m.bottom,k,p,t,f);if(1!=h){var g=l.rowSpan;g_objTableUtil.getTableRowElement(a,g_nStartClick_Row);var w=g_objTableUtil.getTableCellsLength(a,g_nStartClick_Row),q=null;q=c?a.insertRow(g_nStartClick_Row):a.insertRow(g_nStartClick_Row+g);for(var v=0;v<w;v++){var u=g_objTableCase.GetCellType_Row(k,p,t,g_nStartClick_Row,v);f=!1;if(c){if(4==u||6==u||7==u)f=!0}else if(6==
u||7==u)f=!0;if(f){var n=q.insertCell(-1);d||(n.innerHTML=window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>");var r=null;r=c?g_objTableUtil.getTableCellElement(a,g_nStartClick_Row+1,v):g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,v);d&&(n.innerHTML=r.innerHTML);1!=r.colSpan&&(n.colSpan=r.colSpan);null!=r.style.width&&""!=r.style.width?n.style.width=r.style.width:n.width=r.width;n.height=r.offsetHeight/r.rowSpan;var x=g_objTableFunction.GetTableCellAttribute(r);if(null==x)return!1;g_objTableFunction.SetTableCellAttribute(n,
x)}}for(f=0;f<k.length;f++)if(u=t[f],!(1!=u&&2!=u&&3!=u&&4!=u||c&&4==u)){var z=k[f],A=p[f],C=g_objTableUtil.getTableCellElement(a,z,A);if(c||2!=u)C.rowSpan+=1;else{n=null;n=q.cells.length<A?q.insertCell(q.cells.length):q.insertCell(A);d||(n.innerHTML=window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>");r=g_objTableUtil.getTableCellElement(a,z,A);1!=r.colSpan&&(n.colSpan=r.colSpan);null!=r.style.width&&""!=r.style.width?n.style.width=r.style.width:n.width=r.width;n.height=r.offsetHeight/r.rowSpan;d&&
(n.innerHTML=r.innerHTML);x=g_objTableFunction.GetTableCellAttribute(r);if(null==x)return!1;g_objTableFunction.SetTableCellAttribute(n,x)}}}break;case UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:case UI_TABLE_SELECT_TYPE_ENTIRE_ROW:h=1}if(1==h){g=0;var B=a.rows.length;for(u=0;u<B;u++)for(z=!0,w=g_objTableUtil.getTableCellsLength(a,u),v=0;v<w;v++){var y=g_objTableFlag.GetCellAttribute_Flag(a,
u,v);if(1==y||2==y||3==y||4==y){if(1==y||2==y)e=u;if(z&&u==e+g){z=!1;var D=g_objTableUtil.getTableCellElement(a,u,v).rowSpan;g+=D}}}B=e;for(u=0;u<g;u++){g_objTableUtil.getTableRowElement(a,e);q=null;q=c?a.insertRow(B):a.insertRow(B+g);y=0;y=c?e+1:e;w=g_objTableUtil.getTableCellsLength(a,y);for(v=0;v<w;v++){n=q.insertCell(-1);r=g_objTableUtil.getTableCellElement(a,y,v);n.innerHTML=d?r.innerHTML:window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>";1!=r.rowSpan&&(n.rowSpan=r.rowSpan);1!=r.colSpan&&(n.colSpan=
r.colSpan);null!=r.style.width&&""!=r.style.width?n.style.width=r.style.width:n.width=r.width;n.height=r.offsetHeight;x=g_objTableFunction.GetTableCellAttribute(g_objTableUtil.getTableCellElement(a,y,v));if(null==x)return!1;g_objTableFunction.SetTableCellAttribute(n,x)}B++;e=c?e+2:e+1}}g_objTableFlag.setFlagInfo(a);1==b&&g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,g_nStartClick_Col).focus();return!0}catch(E){g_objCommonUtil.displayErrorAlert(E,"table_AddTableRow")}};this.table_DeleteTableRow=
function(b,a,c){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;var d=g_objTableCase.CheckSelectedCellCase(a,!1,c);if(null==d)return!1;var f=d[0];if(1==f){if(!g_objTableCase.ForceSetting_NoSelectedCellCase_Row_Col(b,a,g_nStartClick_Row,g_nStartClick_Col,c,!0))return g_objTableFlag.ResetTableInfo(!1),!1;if(null!=g_objTableFlag.arrDecreaseRowCol){for(var h=0;h<g_objTableFlag.arrDecreaseRowCol.length;h++){var e=g_objTableUtil.getTableCellElement(a,g_objTableFlag.arrDecreaseRowCol[h][0],g_objTableFlag.arrDecreaseRowCol[h][1]);
--e.rowSpan;e.style.height="";e.height=""}g_objTableFlag.arrDecreaseRowCol=null}}d=!0;b=-1;var k=e=0,l=0,m=a.rows.length;for(h=0;h<m;h++)for(var p=!0,t=g_objTableUtil.getTableCellsLength(a,h),g=0;g<t;g++){var w=g_objTableFlag.GetCellAttribute_Flag(a,h,g);2==w||3==w||4==w?(d&&(d=!1,b=h),p&&h==b+e&&(p=!1,e+=g_objTableUtil.getTableCellElement(a,h,g).rowSpan,k+=g_objTableUtil.getTableRowElement(a,h).offsetHeight)):p&&(p=!1,g_objTableUtil.getTableRowElement(a,h),l++)}g_nEndClick_Col=g_nEndClick_Row=g_nStartClick_Col=
g_nStartClick_Row=-1;if(2==f||3==f)return g_objNodeUtil.getParentElement(a).removeChild(a),g_objTableFlag.ResetTableInfo(!0),!0;g_bBrowserType_IE&&(window.attachEvent?g_objEditorDocument[c].selection.empty():g_objEditWindow[c].getSelection().removeAllRanges());c=e;for(h=0;h<c;h++)a.deleteRow(b);g_objTableFlag.ResetTableInfo(!0);return!0}catch(q){g_objCommonUtil.displayErrorAlert(q,"table_DeleteTableRow")}return!1};this.table_AddTableCol=function(b,a,c,d){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;
b=0;var f=g_objTableCase.CheckSelectedCellCase(a,!1,d);if(null==f)return!1;b=f[0];switch(b){case UI_TABLE_SELECT_TYPE_NONE:case UI_TABLE_SELECT_TYPE_ONE_CELL:var h=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,g_nStartClick_Col),a,g_nStartClick_Row,d),e=[],k=[],l=[];g_objTableCase.CheckAddType_Col(a,h.left,h.right,e,k,l,d);d=-1;for(var m=0;m<e.length;m++)if(c){if(d<=e[m]){d=e[m];var p=k[m],t=l[m],g=g_objTableUtil.getTableCellElement(a,
d,p),w=g.rowSpan;if(1==t||2==t||3==t){var q=g.colSpan,v=g.offsetWidth;q++;g.colSpan=q;g.width=v+ID_TABLE_INSERT_CELL_WIDTH}else if(4==t||6==t||7==t){var u=g.rowSpan,n=g_objTableUtil.getTableRowElement(a,d).insertCell(p);1!=u&&(n.rowSpan=u);null!=g.style.width&&""!=g.style.width?n.style.width=g.style.width:n.width=null!=g.width&&""!=g.width?g.width:ID_TABLE_INSERT_CELL_WIDTH;null!=g.style.height&&""!=g.style.height?n.style.height=g.style.height:null!=g.height&&""!=g.height&&(n.height=g.height);n.innerHTML=
window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>";var r=g_objTableFunction.GetTableCellAttribute(g);if(null==r)return!1;g_objTableFunction.SetTableCellAttribute(n,r)}d+=w}}else if(!(m+1<e.length&&e[m]==e[m+1]))if(d=e[m],p=k[m],t=l[m],g=g_objTableUtil.getTableCellElement(a,d,p),w=g.rowSpan,3==t||4==t||5==t)q=g.colSpan,v=g.offsetWidth,q++,g.colSpan=q,g.width=v+ID_TABLE_INSERT_CELL_WIDTH;else if(2==t||6==t||8==t){u=g.rowSpan;n=g_objTableUtil.getTableRowElement(a,d).insertCell(p+1);1!=u&&(n.rowSpan=
u);null!=g.style.width&&""!=g.style.width?n.style.width=g.style.width:n.width=null!=g.width&&""!=g.width?g.width:ID_TABLE_INSERT_CELL_WIDTH;null!=g.style.height&&""!=g.style.height?n.style.height=g.style.height:null!=g.height&&""!=g.height&&(n.height=g.height);n.innerHTML=window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>";r=g_objTableFunction.GetTableCellAttribute(g);if(null==r)return!1;g_objTableFunction.SetTableCellAttribute(n,r)}break;case UI_TABLE_SELECT_TYPE_ONE_CELL_TABLE:case UI_TABLE_SELECT_TYPE_ENTIRE_TABLE:case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_ROW:case UI_TABLE_SELECT_TYPE_ONE_CELL_ONE_COL:case UI_TABLE_SELECT_TYPE_ENTIRE_COL:for(e=
a.rows.length,m=0;m<e;m++)for(v=w=t=p=0;v<g_objTableUtil.getTableCellsLength(a,m);v++){k=g_objTableFlag.GetCellAttribute_Flag(a,m,v);if(!c&&0==v)for(d=0;d<g_objTableUtil.getTableCellsLength(a,m);d++)l=g_objTableFlag.GetCellAttribute_Flag(a,m,d),1!=l&&2!=l&&3!=l&&4!=l||w++;if(1==k||2==k||3==k||4==k){t=c?v-p:v+w;g=g_objTableUtil.getTableCellElement(a,m,v);u=g.rowSpan;q=g.colSpan;n=g_objTableUtil.getTableRowElement(a,m).insertCell(t);1!=u&&(n.rowSpan=u);1!=q&&(n.colSpan=q);null!=g.style.width&&""!=g.style.width?
n.style.width=g.style.width:n.width=null!=g.width&&""!=g.width?g.width:ID_TABLE_INSERT_CELL_WIDTH;null!=g.style.height&&""!=g.style.height?n.style.height=g.style.height:null!=g.height&&""!=g.height&&(n.height=g.height);n.innerHTML=window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>";r=g_objTableFunction.GetTableCellAttribute(g);if(null==r)return!1;g_objTableFunction.SetTableCellAttribute(n,r);c&&(p++,v++)}}}g_objTableFlag.setFlagInfo(a);1==b&&g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,g_nStartClick_Col).focus();
return!0}catch(x){g_objCommonUtil.displayErrorAlert(x,"table_AddTableCol")}return!1};this.table_DeleteTableCol=function(b,a,c){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;var d=g_objTableCase.CheckSelectedCellCase(a,!1,c);if(null==d)return!1;var f=d[0];if(1==f){if(!g_objTableCase.ForceSetting_NoSelectedCellCase_Row_Col(b,a,g_nStartClick_Row,g_nStartClick_Col,c,!1))return g_objTableFlag.ResetTableInfo(!1),!1;if(null!=g_objTableFlag.arrDecreaseRowCol)for(var h=0;h<g_objTableFlag.arrDecreaseRowCol.length;h++){var e=
g_objTableFlag.arrDecreaseRowCol[h][0],k=g_objTableFlag.arrDecreaseRowCol[h][1],l=g_objTableUtil.getTableCellElement(a,e,k);--l.colSpan;l.style.width="";l.width=""}}g_nEndClick_Col=g_nEndClick_Row=g_nStartClick_Col=g_nStartClick_Row=-1;if(2==f||3==f)return g_objNodeUtil.getParentElement(a).removeChild(a),g_objTableFlag.ResetTableInfo(!0),!0;g_bBrowserType_IE&&(window.attachEvent?g_objEditorDocument[c].selection.empty():g_objEditWindow[c].getSelection().removeAllRanges());for(d=b=0;d<g_objTableUtil.getTableCellsLength(a,
0);d++){var m=g_objTableFlag.GetCellAttribute_Flag(a,0,d);if(2==m||3==m||4==m)b+=g_objTableUtil.getTableCellElement(a,0,d).offsetWidth}for(h=0;h<a.rows.length;h++)for(d=0;d<g_objTableUtil.getTableCellsLength(a,h);d++)if(m=g_objTableFlag.GetCellAttribute_Flag(a,h,d),2==m||3==m||4==m)g_objTableUtil.getTableRowElement(a,h).deleteCell(d),d=-1;if(null!=g_objTableFlag.arrDecreaseRowCol){for(h=0;h<g_objTableFlag.arrDecreaseRowCol.length;h++){e=g_objTableFlag.arrDecreaseRowCol[h][0];k=g_objTableFlag.arrDecreaseRowCol[h][1];
l=g_objTableUtil.getTableCellElement(a,e,k);var p=l.offsetWidth;l.style.width=p;l.width=p}g_objTableFlag.arrDecreaseRowCol=null}g_objTableFunction.UpdateGarbageTableRow(a,c);g_objTableFlag.ResetTableInfo(!0);return!0}catch(t){g_objCommonUtil.displayErrorAlert(t,"table_DeleteTableCol")}return!1};this.table_MergeTableCell=function(b,a,c){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return null;var d=g_objTableCase.CheckSelectedCellCase(a,!1,c);if(null==d)return null;var f=d[0];d=b=-1;var h=0,e=
0,k=0,l="",m=!0,p="",t=0;if(g_bBrowserType_IE)if(window.attachEvent)g_objEditorDocument[c].selection.empty();else{var g=g_objEditWindow[c].getSelection();g.removeAllRanges()}for(var w=a.rows.length,q=0;q<w;q++)for(var v=!0,u=g_objTableUtil.getTableCellsLength(a,q),n=0;n<u;n++){var r=g_objTableFlag.GetCellAttribute_Flag(a,q,n);if(2==r||3==r||4==r){2==r&&(b=q,d=n);var x=g_objTableUtil.getTableCellElement(a,q,n),z=g_objPropertyUtil.getTextContent(x);z=z.trim();""!=z&&(p+=x.innerHTML);v&&q==b+h&&(v=!1,
h+=x.rowSpan);if(q==b){e+=x.colSpan;var A=g_objNodeUtil.getNodeWidthHeight(x,!0);0==t?(k+=A.nValue,l=A.strUnit):l!=A.strUnit?m=!1:k+=A.nValue;t++}}}for(q=0;q<w;q++)for(n=0;n<g_objTableUtil.getTableCellsLength(a,q);n++)if(r=g_objTableFlag.GetCellAttribute_Flag(a,q,n),3==r||4==r)g_objTableUtil.getTableRowElement(a,q).deleteCell(n),n=-1;switch(f){case 3:for(q=e=h=1;q<w;q++)a.deleteRow(1);break;case 7:h=1;w=!0;do for(w=!0,q=0;q<a.rows.length;q++)if(0==g_objTableUtil.getTableCellsLength(a,q)){a.deleteRow(q);
w=!1;break}while(!w);break;case 8:e=1}g_objTableUtil.getTableCellElement(a,b,d).rowSpan=h;g_objTableUtil.getTableCellElement(a,b,d).colSpan=e;if(3==f||7==f||9==f)3==f||7==f?m&&g_objTableUtil.setNodeValue_Width(g_objTableUtil.getTableCellElement(a,b,d),k,l):9==f&&1!=t&&m&&g_objTableUtil.setNodeValue_Width(g_objTableUtil.getTableCellElement(a,b,d),k,l);8==f&&1!=t&&m&&g_objTableUtil.setNodeValue_Width(g_objTableUtil.getTableCellElement(a,b,d),k,l);""==p?(f="<p><br /></p>",window.attachEvent&&(f="<p>&nbsp;</p>"),
g_objTableUtil.getTableCellElement(a,b,d).innerHTML=f):g_objTableUtil.getTableCellElement(a,b,d).innerHTML=p;g_objTableFunction.UpdateGarbageTableRow(a,c);g_objTableFlag.setFlagInfo(a);var C=g_objTableCase.CheckSelectedCellCase(a,!1,c);if(null==C)return null;if(g_bBrowserType_IE)if(window.attachEvent)g_objEditorDocument[c].selection.empty();else{g=g_objEditWindow[c].getSelection();var B=g_objEditorDocument[c].createRange(),y=g_objTableUtil.getTableCellElement(a,b,d);B.selectNode(y);g.addRange(B);
g.removeAllRanges()}return C}catch(D){g_objCommonUtil.displayErrorAlert(D,"table_MergeTableCell")}return null};this.table_SplitTableRow=function(b,a,c){try{if(!a)return!1;if(1==c)return!0;0<g_objNodeUtil.getImmediateChildNodesByTagName(a,"colgroup").length&&g_objTableUtil.addColgroup(a,d);var d=g_objTableUtil.getMatrix(a),f=d.getSelection();if(!f||1<f.length)return!1;f=f[0];var h=f.arrCell.slice();h.sort(function(a,b){return a.rowSpan-b.rowSpan});b=0;for(var e=h.length;b<e;b++)d.divideCellRow(h[b],
c);f=d.getSelection()[0];b=0;for(e=f.arrCell.length;b<e;b++)f.arrCell[b].setAttribute("cusFlag",3);d.getCell(f.nStartRow,f.nStartCol).setAttribute("cusFlag",2);d.getCell(f.nEndRow,f.nEndCol).setAttribute("cusFlag",4);g_objTableFlag.setFlagInfo(a);g_objCaretUtil.moveCaret(d.getCell(f.nStartRow,f.nStartCol));return!0}catch(k){g_objCommonUtil.displayErrorAlert(k,"table_SplitTableRow")}};this.table_SplitTableCol=function(b,a,c){try{if(!a)return!1;if(1==c)return!0;0<g_objNodeUtil.getImmediateChildNodesByTagName(a,
"colgroup").length&&g_objTableUtil.addColgroup(a,d);var d=g_objTableUtil.getMatrix(a),f=d.getSelection();if(!f||1<f.length)return!1;f=f[0];var h=f.arrCell.slice();h.sort(function(a,b){return a.colSpan-b.colSpan});b=0;for(var e=h.length;b<e;b++)d.divideCellCol(h[b],c);f=d.getSelection()[0];b=0;for(e=f.arrCell.length;b<e;b++)f.arrCell[b].setAttribute("cusFlag",3);d.getCell(f.nStartRow,f.nStartCol).setAttribute("cusFlag",2);d.getCell(f.nEndRow,f.nEndCol).setAttribute("cusFlag",4);g_objTableFlag.setFlagInfo(a);
g_objCaretUtil.moveCaret(d.getCell(f.nStartRow,f.nStartCol));return!0}catch(k){g_objCommonUtil.displayErrorAlert(k,"table_SplitTableCol")}};this.table_TableCellSameHeight=function(b,a,c){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;var d=a.rows.length;for(b=0;b<d;b++){var f=g_objTableUtil.getTableRowElement(a,b),h=g_objNodeUtil.getNodeWidthHeight(f,!1);if(null!=h.nValue){for(var e=g_objTableUtil.getTableCellsLength(a,b),k=0;k<e;k++){var l=g_objTableUtil.getTableCellElement(a,b,k);null==
g_objNodeUtil.getNodeWidthHeight(l,!1).nValue&&(l.height=h.nValue)}f.height="";f.style.height=""}}h=f=-1;for(b=c=0;b<d;b++)for(e=g_objTableUtil.getTableCellsLength(a,b),k=0;k<e;k++){var m=g_objTableFlag.GetCellAttribute_Flag(a,b,k);if(2==m||3==m||4==m)2==m&&(f=b),h=b}if(f==h)return!1;for(b=f;b<=h;b++)for(e=g_objTableUtil.getTableCellsLength(a,b),k=0;k<e;){l=g_objTableUtil.getTableCellElement(a,b,k);c+=l.offsetHeight;1<l.rowSpan&&(b+=l.rowSpan-1);break}var p=parseInt(c/(h-f+1));for(b=f;b<=h;b++)for(e=
g_objTableUtil.getTableCellsLength(a,b),k=0;k<e;k++)l=g_objTableUtil.getTableCellElement(a,b,k),g_objTableUtil.setNodeValue_Height(l,p*l.rowSpan,"px");return!0}catch(t){g_objCommonUtil.displayErrorAlert(t,"table_TableCellSameHeight")}return!1};this.table_TableCellSameWidth=function(b,a,c){try{if(fnObjectCheckNull(b)||fnObjectCheckNull(a))return!1;g_objTableUtil.removeTableColGroupAll(a);for(var d=-1,f=-1,h=0,e=0,k=a.rows.length,l=0;l<k;l++){for(var m=g_objTableUtil.getTableCellsLength(a,l),p=0;p<
m;p++){var t=g_objTableFlag.GetCellAttribute_Flag(a,l,p);if(2==t||3==t||4==t){2==t&&(d=p);f=p;var g=g_objTableUtil.getTableCellElement(a,l,p);h+=g.colSpan;e+=g.offsetWidth}}if(-1!=d)break}if(d==f)return!1;d=[];f=[];var w=[];k=a.rows.length;for(l=0;l<k;l++)for(m=g_objTableUtil.getTableCellsLength(a,l),p=0;p<m;p++)if(t=g_objTableFlag.GetCellAttribute_Flag(a,l,p),2==t||3==t||4==t){g=g_objTableUtil.getTableCellElement(a,l,p);var q=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g,a,l,c).right;
inArray(q,w)||(d[d.length]=l,f[f.length]=p,w[w.length]=q)}var v=parseInt(e/h);for(l=0;l<d.length;l++){var u=d[l],n=f[l];g_objTableResize.prepareResizeOperation(b,a,!1,u,n,c);g=g_objTableUtil.getTableCellElement(a,u,n);g_objTableResize.doResizeTable(a,!1,v*g.colSpan-g.offsetWidth,0,u,n)}return!0}catch(r){g_objCommonUtil.displayErrorAlert(r,"table_TableCellSameWidth")}return!1};this.table_TableCellHorizontalAlign=function(b,a,c,d){try{if(!(fnObjectCheckNull(b)||fnObjectCheckNull(a)||"left"!=c&&"center"!=
c&&"right"!=c)){var f=a.rows.length;for(b=0;b<f;b++){var h=g_objTableUtil.getTableCellsLength(a,b);for(d=0;d<h;d++){var e=g_objTableFlag.GetCellAttribute_Flag(a,b,d);if(1==e||2==e||3==e||4==e)g_objTableUtil.getTableCellElement(a,b,d).style.textAlign=c}}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"table_TableCellHorizontalAlign")}};this.table_TableCellVerticalAlign=function(b,a,c,d){try{if(!(fnObjectCheckNull(b)||fnObjectCheckNull(a)||"top"!=c&&"middle"!=c&&"bottom"!=c)){var f=a.rows.length;for(b=
0;b<f;b++){var h=g_objTableUtil.getTableCellsLength(a,b);for(d=0;d<h;d++){var e=g_objTableFlag.GetCellAttribute_Flag(a,b,d);if(1==e||2==e||3==e||4==e)g_objTableUtil.getTableCellElement(a,b,d).style.verticalAlign=c}}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"table_TableCellVerticalAlign")}};this.table_TableFormula=function(b,a,c,d){try{if(fnObjectCheckNull(b)||!b.ownerDocument)return!1;var f=g_objTableUtil,h=f.getMatrix(b),e=h?h.getSelection():null;if(!e||1<e.length)return!1;e=e[0];var k=0,l=
g_objTableFunction.getCurrentCell(d),m=l?l.cell:null;e.arrCell.forEach(function(b){var d=h.getMatrixIndex(b);if(d){var g=h.getRowRange(d[0].row,d[0].col);d=h.getColRange(d[0].row,d[0].col);if(a==DZE_DIR.HORIZONTAL){var l=g.start;g=g.end;var q=0;var p=h.colLength-1}else if(a==DZE_DIR.VERTICAL)l=0,g=h.rowLength-1,q=d.start,p=d.end;else return;for(d=[];l<=g;l++)for(var u=q;u<=p;u++)if(h.isShow(l,u)){var n=h.getCell(l,u);inArray(n,e.arrCell)||d.push(n)}if(0!=d.length){g=[];for(q=0;q<d.length;q++)p=g_objPropertyUtil.getTextContent(d[q]),
p=p.trim(),p=p.removeComma(),p=removeZeroWidthSpaceFromString(p),""==p?g[q]=null:isNaN(p)?g[q]=null:g[q]=parseFloat(p);d=g_objTableFunction.doFormulaData(g,c);if(null!=d){if(1==c||2==c)d=toFloat(d,3);g=!1;b==m&&(g=!0);f.setCellInnerText(""+d,b);g&&g_objCaretUtil.moveCaret(m,!1,!1);k++}}}});return 0<k?!0:!1}catch(p){dalert(p)}};this.table_SetTableStyle=function(b,a,c){try{var d=a.rows.length,f=g_objTableUtil.getTableCellsLength(a,0);for(b=0;b<d;b++)for(var h=0;h<f;h++){var e=g_objTableUtil.getTableCellElement(a,
b,h);if("undefined"!=e&&null!=e)if(0==b){var k=""==c.firstRow_seperateColor?c.firstRow_borderColor[1]:c.firstRow_seperateColor;var l=""==c.firstRow_seperateColor?c.firstRow_borderColor[3]:c.firstRow_seperateColor;""==c.firstRow_seperateColor?(e.style.borderRightWidth=0,e.style.borderLeftWidth=0):(e.style.borderRightWidth=1,e.style.borderLeftWidth=1);0==h&&(e.style.borderLeftWidth=1,c.firstRow_backgroundColor!=c.firstRow_borderColor[3]&&(l=c.firstRow_borderColor[3]));h==f-1&&(e.style.borderRightWidth=
1,c.firstRow_backgroundColor!=c.firstRow_borderColor[1]&&(k=c.firstRow_borderColor[1]));e.style.borderColor=c.firstRow_borderColor[0]+" "+l+" "+c.firstRow_borderColor[2]+" "+k;e.style.backgroundColor=c.firstRow_backgroundColor;e.style.color=c.firstRow_fontColor}else if(0==h){k=c.firstCol_borderColor[1];var m=c.firstCol_backgroundColor;""==m&&(m=1==b%2?c.evenRow_backgroundColor:c.oddRow_backgroundColor);""==c.firstCol_borderColor[1]?(e.style.borderRightWidth=0,k="#ffffff"):e.style.borderRightWidth=
1;e.style.borderColor=c.firstCol_borderColor[0]+" "+k+" "+c.firstCol_borderColor[2]+" "+c.firstCol_borderColor[3];e.style.backgroundColor=m;e.style.color=c.firstCol_fontColor}else 1==b%2?(k=""==c.etcRow_seperateColor?c.evenRow_borderColor[1]:c.etcRow_seperateColor,""==c.etcRow_seperateColor?(e.style.borderRightWidth=0,e.style.borderLeftWidth=0):(e.style.borderRightWidth=1,e.style.borderLeftWidth=1),h==f-1&&(e.style.borderRightWidth=1,c.evenRow_backgroundColor!=c.evenRow_borderColor[1]&&(k=c.evenRow_borderColor[1])),
e.style.borderColor=c.evenRow_borderColor[0]+" "+k+" "+c.evenRow_borderColor[2]+" "+c.evenRow_borderColor[3],e.style.backgroundColor=c.evenRow_backgroundColor,e.style.color=c.evenRow_fontColor):0==b%2&&(k=""==c.etcRow_seperateColor?c.oddRow_borderColor[1]:c.etcRow_seperateColor,""==c.etcRow_seperateColor?(e.style.borderRightWidth=0,e.style.borderLeftWidth=0):(e.style.borderRightWidth=1,e.style.borderLeftWidth=1),h==f-1&&(e.style.borderRightWidth=1,c.evenRow_backgroundColor!=c.oddRow_borderColor[1]&&
(k=c.oddRow_borderColor[1])),e.style.borderColor=c.oddRow_borderColor[0]+" "+k+" "+c.oddRow_borderColor[2]+" "+c.oddRow_borderColor[3],e.style.backgroundColor=c.oddRow_backgroundColor,e.style.color=c.oddRow_fontColor)}}catch(p){g_objCommonUtil.displayErrorAlert(p,"table_SetTableStyle")}};this.insertTableRowForTest=function(b,a,c){try{if(!b||!a||!c)return!1;var d=g_objNodeUtil,f=g_objTableUtil,h=g_objTableResize,e=b.DZE_TEMP;b.calculateRowHeight();for(var k=a.nEndRow,l=k+1,m=0;m<a.nStartCol;m++)b.equalCell(a.nStartRow,
m,a.nEndRow,m)&&d.setAttribute(b.getCell(a.nStartRow,m),e,"");for(m=a.nEndCol+1;m<b.colLength;m++)b.equalCell(a.nStartRow,m,a.nEndRow,m)&&d.setAttribute(b.getCell(a.nStartRow,m),e,"");b.splitRow(l);insertAfter(b.trs[k],c);b.makeMatrix();var p=a.nStartRow-1,t=a.nEndRow+(a.nEndRow-a.nStartRow+1)+1;for(m=a.nStartCol-1;0<=m;m--){c=a=null;for(k=p;k<=t;k=b.getRowRange(k,m).end+1)a=b.getCell(k,m),a=d.hasAttribute(a,e)?a:null,d.removeAttribute(a,e),a&&(c=c||[],c.push(a));if(c&&0!=c.length){a=c[0];l=k=0;for(var g=
c.length;l<g;l++)k+=b.getRowspan(c[l]);l=1;for(g=c.length;l<g;l++)c[l].parentNode.removeChild(c[l]);b.setRowspan(a,k);var w=h.offsetHeightToStyleHeight(a.offsetHeight,a);f.setNodeValue_Height(a,w,"px")}}b.makeMatrix();return!0}catch(q){dalert(q)}};this.autoInsertNewRow=function(b,a,c,d){try{var f=d.ownerDocument,h=d.rows,e=h.length,k=b.getRowRange(a,c).end;for(a=0;a<c;a++)if(!b.isHideForColspan(k,a)){var l=b.getCell(k,a),m=b.getRowspan(l);m+=e;b.setRowspan(l,m)}var p=f.createDocumentFragment();for(c=
0;c<e;c++)p.appendChild(h[0]);insertAfter(b.trs[k],p);b.makeMatrix()}catch(t){dalert(t)}}};

var g_objTableFunction=new function(){this.createTable=function(a,b){try{g_bActivate[b]||g_objInsertUtil.activeSaveRangeFocus(0,b);var c=!1;if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[g_nActiveEditNumber].selection.type.toLowerCase()&&(c=!0);else{var d=getSelectionType();if(d.nodeType==ID_SELECTION_ELEMENT_NODE||d.nodeType==ID_SELECTION_TEXT_NODE)c=!0}if(!c)return!1;var f=a[0],g=a[1],e=a[2],h=a[3],l=a[6],q=a[7],z=a[8],p=a[9],r=a[10],u=a[11],w=a[12],t=a[13],x=a[14],v=a[15],y=
a[16];"%"==h?null==e&&(e=100):null==e&&(e=g_objEditObject[b].offsetWidth-26);a=ID_TABLE_INSERT_CELL_WIDTH;c=ID_TABLE_INSERT_CELL_HEIGHT;d="";null!=e&&(d='width="'+e+h+'"',a="%"==h?parseInt(g_objEditObject[b].offsetWidth/g):parseInt(e/g)+h);e="";null!=l&&(e='cellpadding="'+l+'"');l=!1;q==z&&q==p&&q==r&&q==u&&q==w&&(l=!0);h="";null!=t&&(h="background-color:"+t+";");t="";null!=x&&(t="background-image:url("+x+");",t+="background-repeat:"+v+";");v="";""!=y&&("left"==y?v="margin-left:0px;margin-right:auto;":
"center"==y?v="margin-left:auto;margin-right:auto;":"right"==y&&(v="margin-left:auto;margin-right:0px;"));y="<p><br /></p>";window.attachEvent&&(y="<p>&nbsp;</p>");x="";x+="<table "+d+' cellspacing="0" '+e+' style="border-collapse:collapse;'+h+t+v+'">';for(v=0;v<f;v++){x+="<tr>";for(d=0;d<g;d++)t="",l?t='style="border:'+q+';"':(e="",2<=f?0==v?e+="border-top:"+q+";":v==f-1?e+="border-bottom:"+p+";":(e+="border-top:"+z+";",e+="border-bottom:"+z+";"):(e+="border-top:"+q+";",e+="border-bottom:"+p+";"),
2<=g&&(0==d?e+="border-left:"+r+";":d==g-1?e+="border-right:"+w+";":(e+="border-left:"+u+";",e+="border-right:"+u+";")),""!=e&&(t='style="'+e+'"')),x+='<td width="'+a+'" height="'+c+'" '+t+">",x+=y,x+="</td>";x+="</tr>"}g_objInsertUtil.insertTableCodeAtSelection(x+"</table>"+y,b);return!0}catch(E){g_objCommonUtil.displayErrorAlert(E,"createTable")}return!1};this.deleteTable=function(a){try{if(fnObjectCheckNull(a))return!1;g_objNodeUtil.getParentElement(a).removeChild(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,
"deleteTable")}};this.DeleteSelectedCellContent=function(a){try{for(var b=!1,c=0;c<a.rows.length;c++){var d=g_objTableUtil.getTableCellsLength(a,c);for(j=0;j<d;j++){var f=g_objTableFlag.GetCellAttribute_Flag(a,c,j);if(2==f||3==f||4==f){b=!0;var g=g_objTableUtil.getTableCellElement(a,c,j);!0!==this.isCellLocked(g)&&(g.innerHTML=window.attachEvent?"&nbsp;":"<p><br /></p>")}}}return b}catch(e){g_objCommonUtil.displayErrorAlert(e,"DeleteSelectedCellContent")}return!1};this.UpdateGarbageTableRow=function(a,
b){try{if(fnObjectCheckNull(a))return!1;for(var c=!0,d=a.rows.length,f=0;f<d;f++){var g=g_objTableUtil.getTableCellsLength(a,f);if(0!=g){c=!1;break}}if(c)return g_objNodeUtil.getParentElement(a).removeChild(a),!0;c=!0;do for(c=!0,d=a.rows.length,f=0;f<d;f++)if(g=g_objTableUtil.getTableCellsLength(a,f),0==g){var e=[],h=[],l=[];if(0<=f-1){var q=g_objTableUtil.getTableCellElement(a,f-1,0);if(!fnObjectCheckNull(q)){var z=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(q,a,f-1,b);g_objTableCase.CheckAddType_Row(a,
z.top,z.bottom,e,h,l,b);for(var p=0,r=0;r<e.length;r++){var u=l[r];if(1==u||2==u||3==u||4==u||6==u||7==u){var w=e[r],t=h[r],x=g_objTableUtil.getTableCellElement(a,w,t).rowSpan,v=1;1==u&&(v=2);if(x>v)p++;else break}else break}if(p==e.length){for(r=0;r<e.length;r++)w=e[r],t=h[r],x=g_objTableUtil.getTableCellElement(a,w,t).rowSpan,g_objTableUtil.getTableCellElement(a,w,t).rowSpan=x-1;a.deleteRow(f);c=!1;break}}}}while(!c);return!0}catch(y){g_objCommonUtil.displayErrorAlert(y,"UpdateGarbageTableRow")}return!1};
this.GetTableCellAttribute=function(a){try{if(fnObjectCheckNull(a))return null;var b={},c=a.getAttribute("cusOriBGColor");if(""==c||null==c)c=g_objPropertyUtil.getElement_BGColor(a);b.strBGColor=c;b.strAlign=g_objPropertyUtil.getElement_Align(a);b.strTextAlign=g_objPropertyUtil.getElement_TextAlign(a);b.strBorderLeftStyle=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-left-style",g_nActiveEditNumber);b.strBorderTopStyle=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-top-style",
g_nActiveEditNumber);b.strBorderRightStyle=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-right-style",g_nActiveEditNumber);b.strBorderBottomStyle=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-bottom-style",g_nActiveEditNumber);var d=g_objPropertyUtil.getElement_BorderWidth_With_Unit(a,"left");null!=d&&(b.nBorderLeftWidth=d.nValue,b.strBorderLeftWidth_Unit=d.strUnit);var f=g_objPropertyUtil.getElement_BorderWidth_With_Unit(a,"top");null!=f&&(b.nBorderTopWidth=f.nValue,b.strBorderTopWidth_Unit=
f.strUnit);var g=g_objPropertyUtil.getElement_BorderWidth_With_Unit(a,"right");null!=g&&(b.nBorderRightWidth=g.nValue,b.strBorderRightWidth_Unit=g.strUnit);var e=g_objPropertyUtil.getElement_BorderWidth_With_Unit(a,"bottom");null!=e&&(b.nBorderBottomWidth=e.nValue,b.strBorderBottomWidth_Unit=e.strUnit);b.strBorderLeftColor=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-left-color",g_nActiveEditNumber);b.strBorderTopColor=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-top-color",
g_nActiveEditNumber);b.strBorderRightColor=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-right-color",g_nActiveEditNumber);b.strBorderBottomColor=g_objPropertyUtil.getElementStyleAttributeValue(a,"border-bottom-color",g_nActiveEditNumber);b.className=a.className;b.paddingLeft=a.style.paddingLeft;b.paddingTop=a.style.paddingTop;b.paddingRight=a.style.paddingRight;b.paddingBottom=a.style.paddingBottom;b.verticalAlign=a.style.verticalAlign;return b}catch(h){g_objCommonUtil.displayErrorAlert(h,
"GetTableCellAttribute")}return null};this.SetTableCellAttribute=function(a,b){try{fnObjectCheckNull(a)||("transparent"==b.strBGColor&&(b.strBGColor=""),g_objPropertyUtil.setElement_BGColor(a,b.strBGColor),g_objPropertyUtil.setElement_Align(a,b.strAlign),g_objPropertyUtil.setElement_TextAlign(a,b.strTextAlign),""==b.strBorderLeftWidth_Unit&&(b.strBorderLeftWidth_Unit="px"),""==b.strBorderTopWidth_Unit&&(b.strBorderTopWidth_Unit="px"),""==b.strBorderRightWidth_Unit&&(b.strBorderRightWidth_Unit="px"),
""==b.strBorderBottomWidth_Unit&&(b.strBorderBottomWidth_Unit="px"),0!=b.nBorderLeftWidth&&(a.style.borderLeftWidth=b.nBorderLeftWidth+b.strBorderLeftWidth_Unit,g_objPropertyUtil.setElement_BorderStyle(a,b.strBorderLeftStyle,"left"),g_objPropertyUtil.setElement_BorderLeftColor(a,b.strBorderLeftColor)),0!=b.nBorderTopWidth&&(a.style.borderTopWidth=b.nBorderTopWidth+b.strBorderTopWidth_Unit,g_objPropertyUtil.setElement_BorderStyle(a,b.strBorderTopStyle,"top"),g_objPropertyUtil.setElement_BorderTopColor(a,
b.strBorderTopColor)),0!=b.nBorderRightWidth&&(a.style.borderRightWidth=b.nBorderRightWidth+b.strBorderRightWidth_Unit,g_objPropertyUtil.setElement_BorderStyle(a,b.strBorderRightStyle,"right"),g_objPropertyUtil.setElement_BorderRightColor(a,b.strBorderRightColor)),0!=b.nBorderBottomWidth&&(a.style.borderBottomWidth=b.nBorderBottomWidth+b.strBorderBottomWidth_Unit,g_objPropertyUtil.setElement_BorderStyle(a,b.strBorderBottomStyle,"bottom"),g_objPropertyUtil.setElement_BorderBottomColor(a,b.strBorderBottomColor)),
null!=b.className&&""!=b.className&&(a.className=b.className),b.paddingLeft&&(a.style.paddingLeft=b.paddingLeft),b.paddingTop&&(a.style.paddingTop=b.paddingTop),b.paddingRight&&(a.style.paddingRight=b.paddingRight),b.paddingBottom&&(a.style.paddingBottom=b.paddingBottom),b.verticalAlign&&(a.style.verticalAlign=b.verticalAlign))}catch(c){g_objCommonUtil.displayErrorAlert(c,"SetTableCellAttribute")}};this.doFormulaData=function(a,b){try{for(var c=null,d=null,f=0,g=0;g<a.length;g++)if(null!=a[g]){var e=
a[g].toString(),h=e.split(".");if(0==b||1==b){null==c&&(c=0);null==d&&(d=0);if(2==h.length){c+=parseInt(h[0]);var l="0."+h[1];d+=parseFloat(l)}else c+=parseInt(e);1==b&&f++}else if(2==b)if(null==c&&(c=1),2==h.length){var q=null,z=null;q=c*parseInt(h[0]);l="0."+h[1];z=c*parseFloat(l);c=q+z}else c*=parseInt(e)}if(null!=c){if(0==b)return c+d;if(1==b)return(c+d)/f;if(2==b)return c}}catch(p){g_objCommonUtil.displayErrorAlert(p,"doFormulaData")}return null};this.getSelectedCellAttribute=function(a,b,c){try{if(fnObjectCheckNull(a)||
fnObjectCheckNull(b))return null;var d=[];d[ID_PROP_NODE_BACKGROUND_COLOR]=[];d[ID_PROP_NODE_BACKGROUND_IMAGE]=[];for(var f=0,g=b.rows.length,e=0;e<g;e++)for(var h=g_objTableUtil.getTableCellsLength(b,e),l=0;l<h;l++){var q=g_objTableFlag.GetCellAttribute_Flag(b,e,l);if(1==q||2==q||3==q||4==q){var z=g_objTableUtil.getTableCellElement(b,e,l),p=null;if(1==q)p=z.style.backgroundColor,null!=p&&""!=p?p=g_objCommonUtil.getHexColorCode(p):(p=z.bgColor,p=null!=p&&""!=p?g_objCommonUtil.getHexColorCode(p):null);
else{var r=z.getAttribute("cusOriBGColor");null!=r&&""!=r&&"transparent"!=r&&(p=g_objCommonUtil.getHexColorCode(r))}d[ID_PROP_NODE_BACKGROUND_COLOR][f]=p;var u=g_objPropertyUtil.getBackgroundImageURL(z);if(null==u||""==u)u=null;var w=z.style.backgroundRepeat;if(null==w||""==w)w=null;d[ID_PROP_NODE_BACKGROUND_IMAGE][f]=[u,w];f++}}if(0==f)return null;g=[];g[ID_PROP_NODE_BORDER]=this.getCellBorderAttribute(a,b,!0,c);g[ID_PROP_NODE_BACKGROUND_COLOR]=d[ID_PROP_NODE_BACKGROUND_COLOR][0];g[ID_PROP_NODE_BACKGROUND_IMAGE]=
d[ID_PROP_NODE_BACKGROUND_IMAGE][0];if(1<f)for(e=1;e<f;e++)d[ID_PROP_NODE_BACKGROUND_COLOR][0]!=d[ID_PROP_NODE_BACKGROUND_COLOR][e]&&(g[ID_PROP_NODE_BACKGROUND_COLOR]=null),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][0]!=d[ID_PROP_NODE_BACKGROUND_IMAGE][e][0]&&(g[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][1]!=d[ID_PROP_NODE_BACKGROUND_IMAGE][e][1]&&(g[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]);return g}catch(t){g_objCommonUtil.displayErrorAlert(t,"getSelectedCellAttribute")}return null};
this.getCellBorderAttribute=function(a,b,c,d){try{a=[];for(var f=[],g=[],e=-1,h=-1,l=-1,q=-1,z=b.rows.length,p=0;p<z;p++)for(var r=g_objTableUtil.getTableCellsLength(b,p),u=0;u<r;u++){var w=1;c&&(w=g_objTableFlag.GetCellAttribute_Flag(b,p,u));if(1==w||2==w||3==w||4==w){var t=g_objTableUtil.getTableCellElement(b,p,u),x=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(t,b,p,d),v=x.left,y=x.top,E=x.right,m=x.bottom;-1==e&&(e=v);-1==h&&(h=y);l<E&&(l=E);q<m&&(q=m);inArray(v,f)||(f[f.length]=v);
inArray(y,g)||(g[g.length]=y)}}var K=!1,C=!1;1<f.length&&(C=!0);1<g.length&&(K=!0);a[0]=[K,C];a[1]=[];a[1][0]=null;a[1][1]=null;a[1][2]=null;a[1][3]=null;a[1][4]=null;a[1][5]=null;z=b.rows.length;for(p=0;p<z;p++)for(r=g_objTableUtil.getTableCellsLength(b,p),u=0;u<r;u++)if(w=1,c&&(w=g_objTableFlag.GetCellAttribute_Flag(b,p,u)),1==w||2==w||3==w||4==w){t=g_objTableUtil.getTableCellElement(b,p,u);x=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(t,b,p,d);v=x.left;y=x.top;E=x.right;m=x.bottom;
if(h==y){var D=t.style.borderTop;this.assignMappingBorderValue(a[1],0,D)}if(h<y&&y<q)D=t.style.borderTop,this.assignMappingBorderValue(a[1],1,D);else if(h<m&&m<q){var A=t.style.borderBottom;this.assignMappingBorderValue(a[1],1,A)}q==m&&(A=t.style.borderBottom,this.assignMappingBorderValue(a[1],2,A));if(e==v){var F=t.style.borderLeft;this.assignMappingBorderValue(a[1],3,F)}if(e<v&&v<l)F=t.style.borderLeft,this.assignMappingBorderValue(a[1],4,F);else if(e<E&&E<l){var G=t.style.borderRight;this.assignMappingBorderValue(a[1],
4,G)}l==E&&(G=t.style.borderRight,this.assignMappingBorderValue(a[1],5,G))}else E==e&&h<=y&&m<=q&&(G=t.style.borderRight,this.assignMappingBorderValue(a[1],3,G)),m==h&&e<=v&&E<=l&&(A=t.style.borderBottom,this.assignMappingBorderValue(a[1],0,A)),v==l&&h<=y&&m<=q&&(F=t.style.borderLeft,this.assignMappingBorderValue(a[1],5,F)),y==q&&e<=v&&E<=l&&(D=t.style.borderTop,this.assignMappingBorderValue(a[1],2,D));return a}catch(H){g_objCommonUtil.displayErrorAlert(H,"getCellBorderAttribute")}return null};this.assignMappingBorderValue=
function(a,b,c){try{ID_PROP_BORDER_DUPLICATED!=a[b]&&(null==a[b]?a[b]=c:c!=a[b]&&(a[b]=ID_PROP_BORDER_DUPLICATED))}catch(d){g_objCommonUtil.displayErrorAlert(d,"assignMappingBorderValue")}};this.setSelectedCellAttribute=function(a,b,c,d){try{if(!fnObjectCheckNull(b)&&!fnObjectCheckNull(c)){this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],b,c,!0,d);var f=a[ID_PROP_NODE_BACKGROUND_COLOR][0],g=c.rows.length;for(b=0;b<g;b++){var e=g_objTableUtil.getTableCellsLength(c,b);for(d=0;d<e;d++){var h=g_objTableUtil.getTableCellElement(c,
b,d);if(null===h||!0!==this.isCellLocked(h)){var l=g_objTableFlag.GetCellAttribute_Flag(c,b,d);if(f)2==l||3==l||4==l?this.setSelectedCellAttribute_BackgroundColor(h,!0,a[ID_PROP_NODE_BACKGROUND_COLOR][2],l):this.setSelectedCellAttribute_BackgroundColor(h,!0,a[ID_PROP_NODE_BACKGROUND_COLOR][2],1),this.setSelectedCellAttribute_BackgroundImage(h,!0,a[ID_PROP_NODE_BACKGROUND_IMAGE][2],a[ID_PROP_NODE_BACKGROUND_IMAGE][3]);else if(1==l||2==l||3==l||4==l)this.setSelectedCellAttribute_BackgroundColor(h,a[ID_PROP_NODE_BACKGROUND_COLOR][1],
a[ID_PROP_NODE_BACKGROUND_COLOR][2],l),this.setSelectedCellAttribute_BackgroundImage(h,a[ID_PROP_NODE_BACKGROUND_IMAGE][1],a[ID_PROP_NODE_BACKGROUND_IMAGE][2],a[ID_PROP_NODE_BACKGROUND_IMAGE][3])}}}}}catch(q){g_objCommonUtil.displayErrorAlert(q,"setSelectedCellAttribute")}};this.setLockEditCell=function(a,b){try{if(!fnObjectCheckNull(a)){for(var c=a.rows.length,d,f,g,e=!1,h=0;h<c;h++){d=g_objTableUtil.getTableCellsLength(a,h);for(var l=0;l<d;l++)if(f=g_objTableFlag.GetCellAttribute_Flag(a,h,l),1==
f||2==f||3==f||4==f)g=g_objTableUtil.getTableCellElement(a,h,l),this.controlBackgroundImage(g,b,"false"===g.getAttribute("contenteditable")),"false"===g.getAttribute("contenteditable")?g.removeAttribute("contenteditable"):g.setAttribute("contenteditable",!1),e=!0}e&&g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(q){g_objCommonUtil.displayErrorAlert(q,"setLockEditCell")}};this.controlBackgroundImage=function(a,b,c){try{var d=g_objEditWindow[b].getComputedStyle(a,null);if(null===d||"none"===d)d=a.style;
var f=d.backgroundImage;if(!1===c){var g="url('"+dzeEnvConfig.strPath_Image+"toolbar/ico_incell_lock.png')";if(null!==f&&"none"!==f&&0<f.length){if(!(0<=f.indexOf("ico_incell_lock.png"))){var e=d.backgroundRepeat,h=d.backgroundPosition,l=a.style.backgroundImage;null!==l&&"none"!==l&&0<l.length?a.setAttribute("origin_bg_style",!0):a.setAttribute("origin_bg_style",!1);a.style.backgroundImage=g+", "+f;a.style.backgroundRepeat="no-repeat, "+e;a.style.backgroundPosition="right 2px bottom 2px, "+h}}else a.style.backgroundImage=
g,a.style.backgroundRepeat="no-repeat",a.style.backgroundPosition="right 2px bottom 2px"}else{b=!1;if(1===f.split(",").length||"false"===a.getAttribute("origin_bg_style"))b=!0;a.removeAttribute("origin_bg_style");!0===b?(g_objPropertyUtil.removeStyleAttribute(a,"background-image"),g_objPropertyUtil.removeStyleAttribute(a,"background-repeat"),g_objPropertyUtil.removeStyleAttribute(a,"background-position")):(e=d.backgroundRepeat,h=d.backgroundPosition,a.style.backgroundImage=f.substring(f.indexOf(",")+
2,f.length),a.style.backgroundRepeat=e.substring(e.indexOf(",")+2,e.length),a.style.backgroundPosition=h.substring(h.indexOf(",")+2,h.length))}}catch(q){g_objCommonUtil.displayErrorAlert(q,"controlBackgroundImage")}};this.hasLockedEditCell=function(a,b){try{if(fnObjectCheckNull(a))return!1;for(var c=a.rows.length,d,f,g,e=0;e<c;e++){d=g_objTableUtil.getTableCellsLength(a,e);for(var h=0;h<d;h++)if(1==b){if(g=g_objTableUtil.getTableCellElement(a,e,h),"false"==g.getAttribute("contenteditable"))return!0}else if(f=
g_objTableFlag.GetCellAttribute_Flag(a,e,h),1==f||2==f||3==f||4==f)if(g=g_objTableUtil.getTableCellElement(a,e,h),"false"==g.getAttribute("contenteditable"))return!0}return!1}catch(l){g_objCommonUtil.displayErrorAlert(l,"hasLockedEditCell")}};this.isCellLocked=function(a){try{return!1===dzeUiConfig.bUseLockEditCellFunction||fnObjectCheckNull(a)?!1:"td"===g_objNodeUtil.getElementTagName(a).toLowerCase()&&"false"==a.getAttribute("contenteditable")?!0:!1}catch(b){g_objCommonUtil.displayErrorAlert(b,
"isCellLocked")}};this.isNeighborCellLocked=function(a,b){try{if(fnObjectCheckNull(a)||"td"!=g_objNodeUtil.getElementTagName(a).toLowerCase())return!1;var c=g_objNodeUtil.getLoopParentElement(a,"table"),d=g_objNodeUtil.getParentElement(a).rowIndex,f=this.getFindCell(c,d,a.cellIndex,b);if(f){var g=g_objTableUtil.getTableCellElement(c,f.nextRow,f.nextCol);if(this.isCellLocked(g))return!0}return!1}catch(e){g_objCommonUtil.displayErrorAlert(e,"isNeighborCellLocked")}};this.isIncludedProtectedCellInColumn=
function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);if(null===a||null===a.table)return!1;for(var b=a.table.rows,c,d=0;d<b.length;d++)if(c=b[d].cells[a.col],null!==c&&!0===this.isCellLocked(c))return!0;return!1}catch(f){g_objCommonUtil.displayErrorAlert(f,"isIncludedProtectedCellInColumn")}};this.isIncludedProtectedCellInRow=function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);if(null===a||null===a.table)return!1;var b=a.table.rows[a.row].cells;for(a=
0;a<b.length;a++){var c=b[a];if(null!==c&&!0===this.isCellLocked(c))return!0}return!1}catch(d){g_objCommonUtil.displayErrorAlert(d,"isIncludedProtectedCellInRow")}};this.setCellBorderAttribute=function(a,b,c,d,f){try{if(a[0]){for(var g=a[1],e=a[2],h=a[3],l=a[4],q=a[5],z=a[6],p=a[7],r=a[8],u=a[9],w=a[10],t=a[11],x=a[12],v=b=a=-1,y=-1,E=c.rows.length,m=0;m<E;m++)for(var K=g_objTableUtil.getTableCellsLength(c,m),C=0;C<K;C++){var D=1;d&&(D=g_objTableFlag.GetCellAttribute_Flag(c,m,C));if(1==D||2==D||3==
D||4==D){var A=g_objTableUtil.getTableCellElement(c,m,C),F=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(A,c,m,f),G=F.left,H=F.top,I=F.right,J=F.bottom;-1==a&&(a=G);-1==b&&(b=H);v<I&&(v=I);y<J&&(y=J)}}var B=[],k=[];E=c.rows.length;for(m=0;m<E;m++)for(K=g_objTableUtil.getTableCellsLength(c,m),C=0;C<K;C++)if(D=1,d&&(D=g_objTableFlag.GetCellAttribute_Flag(c,m,C)),A=g_objTableUtil.getTableCellElement(c,m,C),F=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(A,c,m,f),G=F.left,H=F.top,
I=F.right,J=F.bottom,1==D||2==D||3==D||4==D){var n=B.length;B[n]=[];B[n][0]=m;B[n][1]=C;B[n][2]=a==G?l?w:"":q?t:"";B[n][3]=b==H?g?p:"":e?r:"";B[n][4]=v==I?z?x:"":q?t:"";B[n][5]=y==J?h?u:"":e?r:""}else I==a&&b<=H&&J<=y&&(n=k.length,k[n]=[],k[n][0]=m,k[n][1]=C,k[n][2]=!1,k[n][3]=!1,k[n][4]=!0,k[n][5]=!1,k[n][6]="",k[n][7]="",k[n][8]=l?w:"",k[n][9]=""),J==b&&a<=G&&I<=v&&(n=k.length,k[n]=[],k[n][0]=m,k[n][1]=C,k[n][2]=!1,k[n][3]=!1,k[n][4]=!1,k[n][5]=!0,k[n][6]="",k[n][7]="",k[n][8]="",k[n][9]=g?p:""),
G==v&&b<=H&&J<=y&&(n=k.length,k[n]=[],k[n][0]=m,k[n][1]=C,k[n][2]=!0,k[n][3]=!1,k[n][4]=!1,k[n][5]=!1,k[n][6]=z?x:"",k[n][7]="",k[n][8]="",k[n][9]=""),H==y&&a<=G&&I<=v&&(n=k.length,k[n]=[],k[n][0]=m,k[n][1]=C,k[n][2]=!1,k[n][3]=!0,k[n][4]=!1,k[n][5]=!1,k[n][6]="",k[n][7]=h?u:"",k[n][8]="",k[n][9]="");for(m=0;m<B.length;m++){var L=B[m][0],M=B[m][1];A=g_objTableUtil.getTableCellElement(c,L,M);""!=B[m][2]&&(A.style.borderLeft=B[m][2]);""!=B[m][3]&&(A.style.borderTop=B[m][3]);""!=B[m][4]&&(A.style.borderRight=
B[m][4]);""!=B[m][5]&&(A.style.borderBottom=B[m][5])}for(m=0;m<k.length;m++)L=k[m][0],M=k[m][1],A=g_objTableUtil.getTableCellElement(c,L,M),k[m][2]&&""!=k[m][6]&&(A.style.borderLeft=k[m][6]),k[m][3]&&""!=k[m][7]&&(A.style.borderTop=k[m][7]),k[m][4]&&""!=k[m][8]&&(A.style.borderRight=k[m][8]),k[m][5]&&""!=k[m][9]&&(A.style.borderBottom=k[m][9])}}catch(N){g_objCommonUtil.displayErrorAlert(N,"setCellBorderAttribute")}};this.setSelectedCellAttribute_BackgroundColor=function(a,b,c,d){try{b&&(null==c||
""==c?1==d?(a.removeAttribute("bgColor"),g_objPropertyUtil.removeStyleAttribute(a,"background-color")):a.setAttribute("cusOriBGColor","transparent"):1==d?(a.removeAttribute("bgColor"),a.style.backgroundColor=c):(a.setAttribute("cusBGStyleYN","1"),a.setAttribute("cusOriBGColor",c)))}catch(f){g_objCommonUtil.displayErrorAlert(f,"setSelectedCellAttribute_BackgroundColor")}};this.setSelectedCellAttribute_BackgroundImage=function(a,b,c,d){try{b&&(null==c||""==c?(g_objPropertyUtil.removeStyleAttribute(a,
"background-image"),g_objPropertyUtil.removeStyleAttribute(a,"background-repeat")):(a.style.backgroundImage="url("+c+")",a.style.backgroundRepeat=d))}catch(f){g_objCommonUtil.displayErrorAlert(f,"setSelectedCellAttribute_BackgroundImage")}};this.setTableAttribute=function(a,b,c,d){try{if(!fnObjectCheckNull(b)&&!fnObjectCheckNull(c)){if(a[ID_PROP_NODE_BORDER][0]){var f=a[ID_PROP_NODE_BORDER][2],g=a[ID_PROP_NODE_BORDER][5],e=a[ID_PROP_NODE_BORDER][7],h=a[ID_PROP_NODE_BORDER][8],l=a[ID_PROP_NODE_BORDER][10],
q=a[ID_PROP_NODE_BORDER][11],z=a[ID_PROP_NODE_BORDER][12],p=!1;e==a[ID_PROP_NODE_BORDER][9]&&e==l&&e==z&&(f&&g?e==h&&e==q&&(p=!0):f&&!g?e==h&&(p=!0):!f&&g?e==q&&(p=!0):p=!0);if(p){var r=c.rows.length;for(b=0;b<r;b++){var u=g_objTableUtil.getTableCellsLength(c,b);for(d=0;d<u;d++)g_objTableUtil.getTableCellElement(c,b,d).style.border=e}}else this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],b,c,!1,d)}if(a[ID_PROP_NODE_BACKGROUND_COLOR][0]){var w=a[ID_PROP_NODE_BACKGROUND_COLOR][1];null==w||""==w?g_objPropertyUtil.removeStyleAttribute(c,
"background-color"):c.style.backgroundColor=w}this.setSelectedCellAttribute_BackgroundImage(c,a[ID_PROP_NODE_BACKGROUND_IMAGE][0],a[ID_PROP_NODE_BACKGROUND_IMAGE][1],a[ID_PROP_NODE_BACKGROUND_IMAGE][2]);var t=a[ID_PROP_NODE_GENERAL][0],x=a[ID_PROP_NODE_GENERAL][1];null==t||""==t?(c.width="",c.style.width=""):g_objNodeUtil.getNodeWidthHeight(c,!0).styleValue?(c.width="",c.style.width=t+x):(c.width=t+x,c.style.width="");g_objTableUtil.setTableCellPadding(c,a[ID_PROP_NODE_GENERAL][2]);var v=a[ID_PROP_NODE_GENERAL][3];
e=!1;""==v&&(e=!0);g_objTableUtil.setAlignTableByStyleProperty(c,v,e);g_objTableUtil.setID(c,a[ID_PROP_NODE_GENERAL][4]);g_objTableUtil.setClass(c,a[ID_PROP_NODE_GENERAL][5])}}catch(y){g_objCommonUtil.displayErrorAlert(y,"setTableAttribute")}};this.moveStartClickRowCol=function(a,b){try{var c=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,g_nStartClick_Col);g_objTableFlag.RemoveCellAfterCheckExist(c);g_objTableFlag.SetCellAttribute_Flag(g_objTable,a,b,1);g_nStartClick_Row=a;g_nStartClick_Col=
b}catch(d){g_objCommonUtil.displayErrorAlert(d,"moveStartClickRowCol")}};this.moveFocusNextCell=function(a,b){try{var c=null,d=null;if(null==a){var f=this.getCurrentCell(b);if(null==f)return!1;c=this.getFindNextCell(f.table,f.row,f.col);d=g_objTableUtil.getTableCellElement(f.table,c.nextRow,c.nextCol)}else c=this.getFindNextCell(a,g_nStartClick_Row,g_nStartClick_Col),d=g_objTableUtil.getTableCellElement(a,c.nextRow,c.nextCol);this.setFocusNextCell(d,b);null!=a&&this.moveStartClickRowCol(c.nextRow,
c.nextCol);return!0}catch(g){g_objCommonUtil.displayErrorAlert(g,"moveFocusNextCell")}return!1};this.moveFocusUpDownCell=function(a,b,c){try{var d=!0;ID_KEYCODE_ARROW_BOTTOM==b&&(d=!1);var f=b=null;if(null==a){var g=this.getCurrentCell(c);if(null==g)return!1;b=this.getFindUpDownCell(g.table,g.row,g.col,d,c);if(null==b)return this.setFocusSiblingNode(g.table,d,c);f=g_objTableUtil.getTableCellElement(g.table,b.nextRow,b.nextCol)}else{b=this.getFindUpDownCell(a,g_nStartClick_Row,g_nStartClick_Col,d,
c);if(null==b)return this.setFocusSiblingNode(a,d,c);f=g_objTableUtil.getTableCellElement(a,b.nextRow,b.nextCol)}this.setFocusNextCell(f,c,d);return!0}catch(e){g_objCommonUtil.displayErrorAlert(e,"moveFocusUpDownCell")}return!1};this.moveFocusCell=function(a,b){try{var c=!0;if(ID_KEYCODE_ARROW_BOTTOM==a||ID_KEYCODE_ARROW_RIGHT==a||ID_KEYCODE_TAB==a)c=!0;else if(ID_KEYCODE_ARROW_TOP==a||ID_KEYCODE_ARROW_LEFT==a)c=!1;else return!1;var d=this.getCurrentCell(b);if(null==d)return!1;var f=d.table,g={nextRow:d.row,
nextCol:d.col};for(d=null;;){g=this.getFindCell(f,g.nextRow,g.nextCol,a);if(null==g){d=null;break}d=g_objTableUtil.getTableCellElement(f,g.nextRow,g.nextCol);if(!this.isCellLocked(d))break}if(null==d)return ID_KEYCODE_TAB===a?!1:this.setFocusSiblingNode(f,!c,b);var e=this.setFocusNextCell(d,b,!c);e&&g_objTable&&this.moveStartClickRowCol(g.nextRow,g.nextCol);return e}catch(h){g_objCommonUtil.displayErrorAlert(h,"moveFocusUpDownCell")}};this.getCurrentCell=function(a){try{var b=null,c=-1,d=-1;if(window.attachEvent){var f=
g_objEditorDocument[a].selection;if(null==f)return null;var g=f.createRange();if(null==g)return null;var e=g.parentElement(),h=g_objNodeUtil.getLoopParentElement(e,"td");if(fnObjectCheckNull(h)||g_objTableSelection.IsEditContainerLoopParentElement(h))return null;var l=g_objNodeUtil.getLoopParentElement(h,"tr")}else{f=g_objEditWindow[a].getSelection();if(null==f||1!=f.rangeCount)return null;g=f.getRangeAt(0);e=g.commonAncestorContainer;h=g_objNodeUtil.getLoopParentElement(e,"td");if(fnObjectCheckNull(h)||
g_objTableSelection.IsEditContainerLoopParentElement(h))return null;l=g_objNodeUtil.getLoopParentElement(h,"tr")}if(fnObjectCheckNull(l))return null;b=g_objNodeUtil.getLoopParentElement(l,"table");if(fnObjectCheckNull(b))return null;c=g_bBrowserType_WK?l.sectionRowIndex:l.rowIndex;d=h.cellIndex;return{table:b,cell:h,row:c,col:d}}catch(q){g_objCommonUtil.displayErrorAlert(q,"getCurrentCell")}return null};this.getFindNextCell=function(a,b,c){try{for(var d=!1,f=a.rows.length,g=0;g<f;g++)for(var e=g_objTableUtil.getTableCellsLength(a,
g),h=0;h<e;h++)if(g==b&&h==c)d=!0;else if(d)return{nextRow:g,nextCol:h};return null}catch(l){g_objCommonUtil.displayErrorAlert(l,"getFindNextCell")}return{nextRow:0,nextCol:0}};this.getFindPrevCell=function(a,b,c){try{c--;if(0>c){b--;if(0>b)return null;c=g_objTableUtil.getTableCellsLength(a,b)-1}return 0>c?null:{nextRow:b,nextCol:c}}catch(d){g_objCommonUtil.displayErrorAlert(d,"getFindPrevCell")}return firstIdx};this.getFindUpDownCell=function(a,b,c,d,f){try{var g=g_objTableUtil.getTableCellElement(a,
b,c),e=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g,a,b,f),h=a.rows.length;for(g=0;g<h;g++)for(var l=g_objTableUtil.getTableCellsLength(a,g),q=0;q<l;q++)if(g!=b||q!=c){var z=g_objTableUtil.getTableCellElement(a,g,q),p=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(z,a,g,f);if(d){if(p.bottom<=e.top&&e.top<=p.bottom+1){var r=g_objTableCase.CheckCrossCell_Col(a,e.left,e.right,g,q,f);if(1==r||2==r||3==r||4==r||6==r||7==r){var u=g_objPositionUtil.getOverlapRange(p.left,p.right,
e.left,e.right);if(3<u)return{nextRow:g,nextCol:q}}}}else if(e.bottom<=p.top&&p.top<=e.bottom+1&&(r=g_objTableCase.CheckCrossCell_Col(a,e.left,e.right,g,q,f),1==r||2==r||3==r||4==r||6==r||7==r)&&(u=g_objPositionUtil.getOverlapRange(p.left,p.right,e.left,e.right),3<u))return{nextRow:g,nextCol:q}}}catch(w){g_objCommonUtil.displayErrorAlert(w,"getFindUpDownCell")}return null};this.getFindCell=function(a,b,c,d){switch(d){case ID_KEYCODE_ARROW_LEFT:return this.getFindPrevCell(a,b,c);case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_TAB:return this.getFindNextCell(a,
b,c);case ID_KEYCODE_ARROW_TOP:return this.getFindUpDownCell(a,b,c,!0,g_nActiveEditNumber);case ID_KEYCODE_ARROW_BOTTOM:return this.getFindUpDownCell(a,b,c,!1,g_nActiveEditNumber)}return null};this.setFocusNextCell=function(a,b,c){try{if(window.attachEvent){var d=g_objEditorDocument[b].selection;if(null==d)return!1;var f=d.createRange();if(null==f)return!1;f.moveToElementText(a);f.collapse(!0);f.select()}else{d=g_objEditWindow[b].getSelection();if(null==d)return!1;d.removeAllRanges();f=g_objEditorDocument[b].createRange();
if(null==f)return!1;if(0<a.childNodes.length)if("undefined"==typeof c||null==c||!0!==c){var g=a.childNodes[0];g.nodeType==ID_SELECTION_TEXT_NODE&&""==g.nodeValue.trim()&&g.nextSibling&&g.nextSibling.nodeType==ID_SELECTION_ELEMENT_NODE&&(g=g.nextSibling);"br"==g.nodeName.toLowerCase()?f.selectNodeContents(a):f.selectNodeContents(g);f.collapse(!0)}else{var e=a.childNodes[a.childNodes.length-1];e.nodeType==ID_SELECTION_TEXT_NODE&&""==e.nodeValue.trim()&&e.previousSibling&&e.previousSibling.nodeType==
ID_SELECTION_ELEMENT_NODE&&(e=e.previousSibling);"br"==e.nodeName.toLowerCase()?f.selectNodeContents(a):f.selectNodeContents(e);f.collapse(!1);f.selectNodeContents(e);f.collapse(!1)}else f.selectNodeContents(a),f.collapse(!0);d.addRange(f)}return!0}catch(h){g_objCommonUtil.displayErrorAlert(h,"setFocusNextCell")}return!1};this.setFocusSiblingNode=function(a,b,c){try{if(b){for(;;){a=a.previousSibling;if(null==a||"undefined"==typeof a)return!1;if(ID_SELECTION_ELEMENT_NODE==a.nodeType)break}if("table"==
g_objNodeUtil.getElementTagName(a).toLowerCase()){var d=a.rows.length;if(0>=d)return!1;var f=g_objTableUtil.getTableCellsLength(a,d-1);if(0>=f)return!1;var g=g_objTableUtil.getTableCellElement(a,d-1,f-1);if(null==g)return!1;a=g}this.setFocusNextCell(a,c)}else{for(d=a;;){d=d.nextSibling;if(null==d||"undefined"==typeof d)return!1;if(ID_SELECTION_ELEMENT_NODE==d.nodeType)break}if("table"==g_objNodeUtil.getElementTagName(d).toLowerCase()){g=g_objTableUtil.getTableCellElement(d,0,0);if(null==g)return!1;
d=g}this.setFocusNextCell(d,c)}return!0}catch(e){g_objCommonUtil.displayErrorAlert(e,"setFocusSiblingNode")}return!1};this.getTableSelectedCellHTML=function(a){try{var b=[];if(GetMultiCellSelection())for(var c=0;c<a.rows.length;c++){var d=g_objTableUtil.getTableCellsLength(a,c);for(j=0;j<d;j++){var f=g_objTableFlag.GetCellAttribute_Flag(a,c,j);if(2==f||3==f||4==f){var g=g_objTableUtil.getTableCellElement(a,c,j);b.push(g.innerHTML)}}}else g=g_objTableUtil.getTableCellElement(g_objTable,g_nStartClick_Row,
g_nStartClick_Col),b.push(g.innerHTML);return b}catch(e){g_objCommonUtil.displayErrorAlert(e,"getTableSelectedCellHTML")}return null};this.setTableSelectedCellHTML=function(a,b){try{if(GetMultiCellSelection())for(var c=0,d=0;d<a.rows.length;d++){var f=g_objTableUtil.getTableCellsLength(a,d);for(j=0;j<f;j++){var g=g_objTableFlag.GetCellAttribute_Flag(a,d,j);if(2==g||3==g||4==g){if(c>=b.length)return;var e=g_objTableUtil.getTableCellElement(a,d,j);e.innerHTML=b[c++]}}}else e=g_objTableUtil.getTableCellElement(g_objTable,
g_nStartClick_Row,g_nStartClick_Col),e.innerHTML=b[0]}catch(h){g_objCommonUtil.displayErrorAlert(h,"setTableSelectedCellHTML")}}};

var g_objTableResize=new function(){var m=this;this.objResizeLineLayer=null;this.bResizeLineDisplay=!1;this.nResizeLineStartPos_Y=this.nResizeLineStartPos_X=this.nResizeStart_Y=this.nResizeStart_X=0;this.bResizeMouseDown=!1;this.objResizeTable=null;this.nCellIndex=this.nRowIndex=-1;this.nResizeTableHeight=this.nResizeTableWidth=0;this.objTableEnterLine=this.arrResizeCol=this.arrResizeRow=null;this.bTableEnterLine=!1;this.ID_TABLE_LINE_NOTHING=0;this.ID_TABLE_LINE_TOP=1;this.initializeResizeLineLayer=
function(){try{if(null==this.objResizeLineLayer){var b="";b+='<div id="divResizeLine" class="tbResizeLineContainer" style="display:none;">';b+='<div id="divTableEnterLine" style="position:absolute;width:60px;height:12px;text-align:center;margin:0px;padding:0px;display:none;">';b+='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_table_enter.png" alt="" border="0" />';b+="</div>";b+='<div class="tbResizeLine">';b+='<img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1"  height="1" border="0" style="width:1px;height:1px;vertical-align:baseline;" />';
g_objInsertUtil.insertLayerHTML(b+"</div></div>",!1)&&(this.objResizeLineLayer=document.getElementById("divResizeLine"),this.objResizeLineLayer.onmousedown=function(b){m.resizeLine_onmousedown(b)},this.objTableEnterLine=document.getElementById("divTableEnterLine"),this.objTableEnterLine.onclick=function(b){m.tableEnterLineClick(b,m.objResizeTable)},g_objNodeUtil.initFalsePropagationEvent(this.objResizeLineLayer))}}catch(f){g_objCommonUtil.displayErrorAlert(f,"initializeResizeLineLayer")}};this.tableEnterLineClick=
function(b,f){try{if(dzeUiConfig.bCustomTableEnterLineYN&&!fnObjectCheckNull(f)&&this.bTableEnterLine&&ID_TABLE_EVENT_NOTHING==g_nTableEventID){TBCancelBubbleEvent(b);var c=g_objNodeUtil.getParentElement(f),d=document.createElement("p");d.innerHTML=window.attachEvent?"&nbsp;":"<br />";c.insertBefore(d,f);this.setTableMoveLine(!1,!1,0,0,0,0,0)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"tableEnterLineClick")}};this.resizeLine_onmousedown=function(b){try{if(g_bTableResizingYN&&-1!=g_nActiveEditNumber&&
null!=m.objResizeLineLayer&&null==g_objWrapperOutlineResize.objExtSelectedInfo)if(dzeUiConfig.bCustomTableEnterLineYN&&this.bTableEnterLine)this.tableEnterLineClick(b,m.objResizeTable);else if(ID_TABLE_EVENT_NOTHING!=g_nTableEventID&&(TBCancelBubbleEvent(b),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!0),ID_TABLE_EVENT_ROW_RESIZE==g_nTableEventID||ID_TABLE_EVENT_COL_RESIZE==g_nTableEventID)){m.bResizeMouseDown=!0;g_objTransparentViewUtil.showTransparentView(!0,1);var f=
g_objPositionUtil.GetDocumentClientPos_XY(b);m.nResizeStart_X=f.nPos_X;m.nResizeStart_Y=f.nPos_Y;b=!1;ID_TABLE_EVENT_ROW_RESIZE==g_nTableEventID&&(b=!0);this.nResizeTableHeight=this.nResizeTableWidth=0;this.arrResizeCol=this.arrResizeRow=null;m.prepareResize(g_objEditorDocument[g_nActiveEditNumber],this.objResizeTable,b,g_nActiveEditNumber);updateTableHandlerUI.updateTableUIHandler(0,0,0,0,g_nActiveEditNumber);window.attachEvent?(document.attachEvent("onmousemove",m.resizeLine_onmousemove),document.attachEvent("onmouseup",
m.resizeLine_onmouseup)):(document.addEventListener("mousemove",m.resizeLine_onmousemove,!1),document.addEventListener("mouseup",m.resizeLine_onmouseup,!1))}}catch(c){g_objCommonUtil.displayErrorAlert(c,"resizeLine_onmousedown")}};this.resizeLine_onmousemove=function(b){try{g_bTableResizingYN&&-1!=g_nActiveEditNumber&&null!=m.objResizeLineLayer&&null==g_objWrapperOutlineResize.objExtSelectedInfo&&m.moveResizeLineLayer(b)}catch(f){g_objCommonUtil.displayErrorAlert(f,"resizeLine_onmousemove")}};this.resizeLine_onmouseup=
function(b){try{if(g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!1),g_bTableResizingYN&&null==g_objWrapperOutlineResize.objExtSelectedInfo){m.bResizeMouseDown=!1;g_objTransparentViewUtil.showTransparentView(!1,null);window.attachEvent?(document.detachEvent("onmousemove",m.resizeLine_onmousemove),document.detachEvent("onmouseup",m.resizeLine_onmouseup)):(document.removeEventListener("mousemove",m.resizeLine_onmousemove,!1),document.removeEventListener("mouseup",m.resizeLine_onmouseup,
!1));if(ID_TABLE_EVENT_ROW_RESIZE==g_nTableEventID||ID_TABLE_EVENT_COL_RESIZE==g_nTableEventID){m.setTableMoveLine(!1,!1,0,0,0,0,0);var f=!1;ID_TABLE_EVENT_ROW_RESIZE==g_nTableEventID&&(f=!0);var c=g_objPositionUtil.GetDocumentClientPos_XY(b),d=c.nPos_X-m.nResizeStart_X,e=c.nPos_Y-m.nResizeStart_Y;g_objTableUtil.removeTableColGroupAll(m.objResizeTable);m.doResizeTable(m.objResizeTable,f,d,e,m.nRowIndex,m.nCellIndex);g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}g_nTableEventID=ID_TABLE_EVENT_NOTHING}}catch(g){g_objCommonUtil.displayErrorAlert(g,
"resizeLine_onmouseup")}};this.setTableMoveLine=function(b,f,c,d,e,g,a){try{g_bTableResizingYN&&null==g_objWrapperOutlineResize.objExtSelectedInfo&&(b||this.bResizeLineDisplay)&&null!=this.objResizeLineLayer&&(this.bTableEnterLine=!1,b?(this.bResizeLineDisplay=!0,this.objResizeLineLayer.style.display="",f?this.ID_TABLE_LINE_NOTHING==a?(dzeUiConfig.bCustomTableEnterLineYN&&(this.objTableEnterLine.style.display="none"),this.objResizeLineLayer.style.cursor="row-resize",this.objResizeLineLayer.style.left=
c+"px",this.objResizeLineLayer.style.top=d-1+"px",this.objResizeLineLayer.style.width=e-c-4+"px",this.objResizeLineLayer.style.height="8px"):this.ID_TABLE_LINE_TOP==a&&dzeUiConfig.bCustomTableEnterLineYN&&(this.bTableEnterLine=!0,this.objTableEnterLine.style.display="",this.objTableEnterLine.style.left=e-c-60+"px",this.objResizeLineLayer.style.cursor="pointer",this.objResizeLineLayer.style.left=c+"px",this.objResizeLineLayer.style.top=d-1+"px",this.objResizeLineLayer.style.width=e-c-4+"px",this.objResizeLineLayer.style.height=
"8px"):(this.objResizeLineLayer.style.cursor="col-resize",this.objResizeLineLayer.style.left=c-1+"px",this.objResizeLineLayer.style.top=d+"px",this.objResizeLineLayer.style.width="8px",this.objResizeLineLayer.style.height=g-d-4+"px")):(this.bResizeLineDisplay=!1,this.objResizeLineLayer.style.display="none",dzeUiConfig.bCustomTableEnterLineYN&&(this.objTableEnterLine.style.display="none")))}catch(h){g_objCommonUtil.displayErrorAlert(h,"setTableMoveLine")}};this.moveResizeLineLayer=function(b){try{if(g_bTableResizingYN&&
!fnObjectCheckNull(this.objResizeLineLayer)&&this.bResizeMouseDown){var f=g_objPositionUtil.GetDocumentClientPos_XY(b);if(ID_TABLE_EVENT_ROW_RESIZE==g_nTableEventID){var c=this.nResizeLineStartPos_Y+(f.nPos_Y-this.nResizeStart_Y);this.objResizeLineLayer.style.top=g_bDocType_XHTML?g_bBrowserType_IE&&7>=g_bBrowserVerInfo?c-2+"px":c+"px":c-2+"px"}else if(ID_TABLE_EVENT_COL_RESIZE==g_nTableEventID){var d=this.nResizeLineStartPos_X+(f.nPos_X-this.nResizeStart_X);this.objResizeLineLayer.style.left=g_bDocType_XHTML?
g_bBrowserType_IE&&7>=g_bBrowserVerInfo?d-2+"px":d+"px":d-2+"px"}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"moveResizeLineLayer")}};this.checkResizeLineLayer=function(b,f,c){try{if(g_bTableResizingYN&&-1!=g_nActiveEditNumber&&g_nActiveEditNumber==c&&ID_STRING_NAME_CONTROL!=g_strSelectionType){var d=null;d=window.attachEvent?b.parentWindow.event:f;var e=g_objNodeUtil.getEventSrcElement(b,f);if(!fnObjectCheckNull(e)&&(e=g_objNodeUtil.getLoopParentElement(e,"td"),!fnObjectCheckNull(e))){var g=g_objNodeUtil.getElementTagName(e);
if("string"==typeof g)if("td"!=g.toLowerCase())g_nTableEventID=ID_TABLE_EVENT_NOTHING,this.setTableMoveLine(!1,!1,0,0,0,0,0);else{this.objResizeTable=null;this.nCellIndex=this.nRowIndex=-1;var a=g=0,h=0,w=0,p=0,u=g_objPositionUtil.getDocumentScrollPosition(!1),r=u.nScrollLeft,q=u.nScrollTop,k=u=0;if(g_bBrowserType_IE){var m=d.clientX,y=d.clientY;g=m+r;a=y+q;var l=g_objPositionUtil.getElementPosition(e,!1);h=l.right;w=l.bottom;p=l.top}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){m=
f.clientX;y=f.clientY;var n=g_objPositionUtil.getEditDocScrollPosition(b,c);u=n.nScrollLeft;k=n.nScrollTop;g=m+u;a=y+k;if(g_bBrowserType_WK){var v=g_objNodeUtil.getLoopParentElement(e,"tr");if(fnObjectCheckNull(v))return;this.objResizeTable=g_objNodeUtil.getLoopParentElement(v,"table");if(fnObjectCheckNull(this.objResizeTable))return;this.nRowIndex=g_bBrowserType_WK?v.sectionRowIndex:v.rowIndex;this.nCellIndex=e.cellIndex}l=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(e,this.objResizeTable,
this.nRowIndex,c);h=l.right;w=l.bottom;p=l.top}var B=g_objPositionUtil.getElementPosition(g_objEditObject[c],!1),C=B.left,x=B.top,z=B.left+b.body.offsetWidth,t=B.bottom;f=b=!1;if(h-4<=g&&g<=h+4)b=!0;else if(w-4<=a&&a<=w+4)f=!0;else{var G=g_objNodeUtil.getLoopParentElement(e,"table"),D=g_objPositionUtil.getElementPosition(G,!1).top;if(p-4<=a&&a<=p+4){if(g_bBrowserType_FF||g_bBrowserType_WK)D=D-q+k;if(p-4<=D&&D<=p+4){dzeUiConfig.bCustomTableEnterLineYN&&(g_bBrowserType_IE?this.setTableMoveLine(!0,!0,
C,x+p-q-4,z,0,1):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&this.setTableMoveLine(!0,!0,C,x+p-k-4,z,0,1),this.objResizeTable=G,this.nCellIndex=this.nRowIndex=-1,g_nTableEventID=ID_TABLE_EVENT_NOTHING);return}}this.objResizeTable=null;this.nCellIndex=this.nRowIndex=-1;g_nTableEventID=ID_TABLE_EVENT_NOTHING;this.setTableMoveLine(!1,!1,0,0,0,0,0);return}if(g_bBrowserType_IE||g_bBrowserType_FF){v=g_objNodeUtil.getLoopParentElement(e,"tr");if(fnObjectCheckNull(v))return;this.objResizeTable=
g_objNodeUtil.getLoopParentElement(v,"table");if(fnObjectCheckNull(this.objResizeTable))return;this.nRowIndex=g_bBrowserType_WK?v.sectionRowIndex:v.rowIndex;this.nCellIndex=e.cellIndex}if(b)if(g_nTableEventID=ID_TABLE_EVENT_COL_RESIZE,g_bBrowserType_IE)this.nResizeLineStartPos_X=C+h-r-4,this.nResizeLineStartPos_Y=0,this.setTableMoveLine(!0,!1,C+h-r-4,x,0,t,0);else{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)this.nResizeLineStartPos_X=C+h-u-4,this.nResizeLineStartPos_Y=0,this.setTableMoveLine(!0,
!1,C+h-u-4,x,0,t,0)}else if(f)if(g_nTableEventID=ID_TABLE_EVENT_ROW_RESIZE,g_bBrowserType_IE)this.nResizeLineStartPos_X=0,this.nResizeLineStartPos_Y=x+w-q-4,this.setTableMoveLine(!0,!0,C,x+w-q-4,z,0,0);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)this.nResizeLineStartPos_X=0,this.nResizeLineStartPos_Y=x+w-k-4,this.setTableMoveLine(!0,!0,C,x+w-k-4,z,0,0)}}}}catch(E){g_objCommonUtil.displayErrorAlert(E,"checkResizeLineLayer")}};this.checkResizeCellWidthUnit=function(b){try{for(var f=
!1,c=b.rows.length,d=0;d<c;d++)for(var e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++){var a=g_objTableUtil.getTableCellElement(b,d,g),h=a.style.width;if(""!=h&&null!=h&&(f=!0,-1!=h.indexOf("pt"))){var w=a.clientWidth;a.style.width="";a.width=w}var p=a.width;""!=p&&null!=p&&(f=!0)}if(!f)for(d=0;d<c;d++)for(e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++)a=g_objTableUtil.getTableCellElement(b,d,g),w=a.clientWidth,a.width=w}catch(u){g_objCommonUtil.displayErrorAlert(u,"checkResizeCellWidthUnit")}};
this.prepareResize=function(b,f,c,d){try{fnObjectCheckNull(b)||fnObjectCheckNull(f)||0>this.nRowIndex||0>this.nCellIndex||(fnObjectCheckNull(g_objTable)||g_objTableFlag.ResetTableInfo(!1),this.prepareResizeOperation(b,f,c,this.nRowIndex,this.nCellIndex,d))}catch(e){g_objCommonUtil.displayErrorAlert(e,"prepareResize")}};this.prepareResizeOperation=function(b,f,c,d,e,g){try{this.nResizeTableWidth=f.offsetWidth;this.nResizeTableHeight=f.offsetHeight;var a=g_objTableUtil.getTableCellElement(f,d,e),h=
g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(a,f,d,g),w=h.bottom,p=h.right;null!=this.arrResizeRow&&(this.arrResizeRow=null);null!=this.arrResizeCol&&(this.arrResizeCol=null);this.arrResizeRow=[];this.arrResizeCol=[];c?this.getResizeCell(f,w,!0,this.arrResizeRow,this.arrResizeCol,g):this.getResizeCell(f,p,!1,this.arrResizeRow,this.arrResizeCol,g)}catch(u){g_objCommonUtil.displayErrorAlert(u,"prepareResizeOperation")}};this.getResizeCell=function(b,f,c,d,e,g){try{if(!fnObjectCheckNull(b))for(var a=
b.rows.length,h=0;h<a;h++)for(var w=g_objTableUtil.getTableCellsLength(b,h),p=0;p<w;p++){var m=g_objTableUtil.getTableCellElement(b,h,p),r=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(m,b,h,g),q=r.right,k=r.bottom;c?f==k&&(d[d.length]=h,e[e.length]=p):f==q&&(d[d.length]=h,e[e.length]=p)}}catch(A){g_objCommonUtil.displayErrorAlert(A,"getResizeCell")}};this.doResizeTable=function(b,f,c,d,e,g){try{if(g_bEditMode[g_nActiveEditNumber]&&!fnObjectCheckNull(b)){if(f){var a=!1,h=g_objNodeUtil.getNodeWidthHeight(b,
!1);if(""==h.strUnit||"px"==h.strUnit)""!=h.nValue&&null!=h.nValue&&(a=!0);else if("%"==h.strUnit)""!=h.nValue&&null!=h.nValue&&(a=!0);else return;a&&(this.resetTableCellOffsetHeight(b),b.removeAttribute("height"),g_objPropertyUtil.removeStyleAttribute(b,"height"));if(0>=this.nResizeTableHeight+d)return;var w=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g_objTableUtil.getTableCellElement(b,e,g),b,e,g_nActiveEditNumber),p=[],u=[],r=[];g_objTableCase.CheckAddType_Row(b,w.top,w.bottom,p,
u,r,g_nActiveEditNumber);var q=[];for(a=0;a<r.length;a++)if(3==r[a]||4==r[a]||5==r[a]){var k=g_objTableUtil.getTableCellElement(b,p[a],u[a]);q[a]=k.offsetHeight}else q[a]=null;var A=[],y=[];for(a=0;a<this.arrResizeRow.length;a++){var l=this.arrResizeRow[a],n=this.arrResizeCol[a];k=g_objTableUtil.getTableCellElement(b,l,n);A[a]=k.offsetHeight;y[a]=g_objNodeUtil.getNodeWidthHeight(k,!1)}var v=d;if(0>d)for(a=0;a<A.length;a++)if(0>=A[a]+d-10){var B=-1*(A[a]-10);v<B&&(v=B)}for(a=0;a<this.arrResizeRow.length;a++){l=
this.arrResizeRow[a];n=this.arrResizeCol[a];k=g_objTableUtil.getTableCellElement(b,l,n);g_objTableUtil.setNodeValue_Height(k,A[a]+v,"px");var C=g_objTableUtil.getTableRowElement(b,l);C.height="";C.style.height=""}for(a=0;a<r.length;a++)if(3==r[a]||4==r[a]||5==r[a])k=g_objTableUtil.getTableCellElement(b,p[a],u[a]),g_objTableUtil.setNodeValue_Height(k,q[a]+v,"px");if(0!=v){var x=!1;for(a=0;a<this.arrResizeRow.length;a++)if(l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,
l,n),A[a]==k.offsetHeight){x=!0;break}if(x){for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Height(k,y[a].nValue,y[a].strUnit);return}}x=!1;for(a=0;a<r.length;a++)if(3==r[a]||4==r[a]||5==r[a])if(k=g_objTableUtil.getTableCellElement(b,p[a],u[a]),q[a]-1<=k.offsetHeight&&k.offsetHeight<=q[a]+1){x=!0;break}if(x){for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],
k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Height(k,y[a].nValue,y[a].strUnit);this.resetTableCellOffsetHeight(b);x=[];for(a=0;a<b.rows.length;a++){x[a]=[];for(var z=g_objTableUtil.getTableCellsLength(b,a),t=0;t<z;t++)k=g_objTableUtil.getTableCellElement(b,a,t),x[a][t]=k.offsetHeight}u="";for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Height(k,x[l][n]+v,"px"),u+=
"["+l+"_"+n+"]";r=[];for(a=0;a<b.rows.length;a++)for(r[a]=[],z=g_objTableUtil.getTableCellsLength(b,a),t=0;t<z;t++)k=g_objTableUtil.getTableCellElement(b,a,t),r[a][t]=k.offsetHeight;p=[];for(a=0;a<r.length;a++)for(t=0;t<r[a].length;t++)x[a][t]!=r[a][t]&&-1==u.indexOf("["+a+"_"+t+"]")&&p.push([a,t]);t=null;0<this.arrResizeRow.length&&(l=this.arrResizeRow[0],n=this.arrResizeCol[0],k=g_objTableUtil.getTableCellElement(b,l,n),t=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(k,b,l,g_nActiveEditNumber));
if(!t)return;u=[];for(a=0;a<p.length;a++)l=p[a][0],n=p[a][1],k=g_objTableUtil.getTableCellElement(b,l,n),rcTargetCell=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(k,b,l,g_nActiveEditNumber),t.bottom<=rcTargetCell.top&&rcTargetCell.top<=t.bottom+3&&u.push([l,n]);for(a=0;a<u.length;a++)l=u[a][0],n=u[a][1],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Height(k,x[l][n]-v,"px")}}else{t=!1;v=g_objNodeUtil.getNodeWidthHeight(b,!0);if(""==v.strUnit||"px"==v.strUnit)""!=
v.nValue&&null!=v.nValue&&(t=!0);else if("%"==v.strUnit)""!=v.nValue&&null!=v.nValue&&(t=!0);else return;if(0>=this.nResizeTableWidth+c)return;w=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(g_objTableUtil.getTableCellElement(b,e,g),b,e,g_nActiveEditNumber);var G=w.left,D=w.right;p=[];u=[];r=[];g_objTableCase.CheckAddType_Col(b,G,D,p,u,r,g_nActiveEditNumber);B=[];for(a=0;a<r.length;a++)3==r[a]||4==r[a]||5==r[a]?(k=g_objTableUtil.getTableCellElement(b,p[a],u[a]),B[a]=k.offsetWidth):B[a]=
null;z=[];for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),z[a]=k.offsetWidth;d=c;if(0>c)for(a=0;a<z.length;a++)if(0>=z[a]+c-10){var E=-1*(z[a]-10);d<E&&(d=E)}if(t){q=this.getNextCellOffsetWidth(b,D,g_nActiveEditNumber);if(null==q&&dzeUiConfig.bLimitTableWidthSize){var H=g_objTableUtil.getEditorFrameWidth();if(m.nResizeTableWidth+c>H){alert(ID_RES_DIALOG_ALERT_MAX_VALUE+H);return}}if(0<c&&null!=q)for(a=0;a<q.length;a++)0>=
q[a][2]-c-10&&(E=q[a][2]-10,d>E&&(d=E));y=this.resetTableCellPixelWidth(b);for(a=0;a<y.length;a++)y[a].slice(0);t=[];for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),t[a]=g_objNodeUtil.getNodeWidthHeight(k,!0);p=[];if(null!=q)for(a=0;a<q.length;a++){l=q[a][0];n=q[a][1];A=q[a][2];var F=g_objTableUtil.getTableCellElement(b,l,n);p[a]=g_objNodeUtil.getNodeWidthHeight(F,!0)}b.width="";b.style.width="";for(a=0;a<this.arrResizeRow.length;a++)l=
this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Width(k,z[a]+d,"px"),y[l][n]=z[a]+d;if(null==q)this.adjustOffsetWidthTableCell(b,y),g_objTableUtil.setNodeValue_Width(b,this.nResizeTableWidth+d,"px");else{for(a=0;a<q.length;a++)l=q[a][0],n=q[a][1],A=q[a][2],F=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Width(F,A-d,"px"),y[l][n]=A-d;x=!1;for(a=0;a<q.length;a++)if(l=q[a][0],n=q[a][1],A=q[a][2],F=g_objTableUtil.getTableCellElement(b,
l,n),A==F.offsetWidth){x=!0;break}if(x){b.width=v.nValue+v.strUnit;for(a=0;a<this.arrResizeRow.length;a++)l=this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Width(k,t[a].nValue,"px");if(null!=q)for(a=0;a<q.length;a++)l=q[a][0],n=q[a][1],A=q[a][2],F=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Width(F,p[a].nValue,"px");return}b.width=v.nValue+v.strUnit;this.adjustOffsetWidthTableCell(b,y)}}else{for(a=0;a<this.arrResizeRow.length;a++)l=
this.arrResizeRow[a],n=this.arrResizeCol[a],k=g_objTableUtil.getTableCellElement(b,l,n),g_objTableUtil.setNodeValue_Width(k,z[a]+d,"px");for(a=0;a<r.length;a++)if(3==r[a]||4==r[a]||5==r[a])k=g_objTableUtil.getTableCellElement(b,p[a],u[a]),g_objTableUtil.setNodeValue_Width(k,B[a]+d,"px")}}setTimeout(function(){try{g_objEditMode.doChangeCellCallback(g_nActiveEditNumber)}catch(I){}},10)}}catch(I){g_objCommonUtil.displayErrorAlert(I,"doResizeTable")}};this.getNextCellOffsetWidth=function(b,f,c){try{for(var d=
null,e=0;e<b.rows.length;e++)for(var g=g_objTableUtil.getTableCellsLength(b,e),a=0;a<g;a++){var h=g_objTableUtil.getTableCellElement(b,e,a),m=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(h,b,e,c).left;if(f==m||g_browserCHK.edge&&3>Math.abs(f-m))null==d&&(d=[]),d.push([e,a,h.offsetWidth]);else if(g_bBrowserType_WK){strBorderValue=g_objPropertyUtil.getElementStyleAttributeValue(h,"border-left-width",g_nActiveEditNumber);var p=g_objCommonUtil.extractNumberValueUnit(strBorderValue);""!=p.nValue&&
null!=p.nValue&&m-p.nValue-1<=f&&f<=m&&(null==d&&(d=[]),d.push([e,a,h.offsetWidth]))}}return d}catch(u){g_objCommonUtil.displayErrorAlert(u,"getNextCellOffsetWidth")}return null};this.resetTableCellOffsetHeight=function(b){try{for(var f=[],c=0;c<b.rows.length;c++){f[c]=[];for(var d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++){var g=g_objTableUtil.getTableCellElement(b,c,e);f[c][e]=g.offsetHeight}}for(c=0;c<b.rows.length;c++)for(d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)g=g_objTableUtil.getTableCellElement(b,
c,e),g_objTableUtil.setNodeValue_Height(g,f[c][e],"px");var a=[];for(c=0;c<b.rows.length;c++)for(a[c]=[],d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)g=g_objTableUtil.getTableCellElement(b,c,e),a[c][e]=g.offsetHeight;for(c=0;c<b.rows.length;c++)for(d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)if(f[c][e]!=a[c][e]){var h=f[c][e]+f[c][e]-a[c][e];g=g_objTableUtil.getTableCellElement(b,c,e);g_objTableUtil.setNodeValue_Height(g,h,"px")}}catch(w){g_objCommonUtil.displayErrorAlert(w,"resetTableCellOffsetHeight")}};
this.resetTableCellPercentageWidth=function(b){try{for(var f=b.offsetWidth,c=[],d=0;d<b.rows.length;d++){c[d]=[];for(var e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++){var a=g_objTableUtil.getTableCellElement(b,d,g),h=!1,m=g_objNodeUtil.getNodeWidthHeight(a,!0);"%"==m.strUnit&&""!=m.nValue&&null!=m.nValue&&(h=!0,c[d][g]=null);h||(c[d][g]=100*a.offsetWidth/f)}}for(d=0;d<b.rows.length;d++)for(e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++)null!=c[d][g]&&(a=g_objTableUtil.getTableCellElement(b,
d,g),g_objTableUtil.setNodeValue_Width(a,c[d][g],"%"));return!0}catch(p){g_objCommonUtil.displayErrorAlert(p,"resetTableCellPercentageWidth")}return!1};this.resetTableCellPixelWidth=function(b){try{for(var f=[],c=0;c<b.rows.length;c++){f[c]=[];for(var d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++){var g=g_objTableUtil.getTableCellElement(b,c,e);f[c][e]=parseInt(g.offsetWidth)}}for(c=0;c<b.rows.length;c++)for(d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)null!=f[c][e]&&(g=g_objTableUtil.getTableCellElement(b,
c,e),g_objTableUtil.setNodeValue_Width(g,f[c][e],"px"));var a=[];for(c=0;c<b.rows.length;c++)for(a[c]=[],d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)g=g_objTableUtil.getTableCellElement(b,c,e),a[c][e]=g.offsetWidth;for(c=0;c<b.rows.length;c++)for(d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)if(f[c][e]<a[c][e]){var h=f[c][e]+f[c][e]-a[c][e]-1;g=g_objTableUtil.getTableCellElement(b,c,e);g_objTableUtil.setNodeValue_Width(g,h,"px")}else f[c][e]>a[c][e]&&(h=f[c][e]+f[c][e]-a[c][e]+1,
g=g_objTableUtil.getTableCellElement(b,c,e),g_objTableUtil.setNodeValue_Width(g,h,"px"));for(c=0;c<b.rows.length;c++)for(d=g_objTableUtil.getTableCellsLength(b,c),e=0;e<d;e++)g=g_objTableUtil.getTableCellElement(b,c,e),f[c][e]=parseInt(g.offsetWidth);return f}catch(w){g_objCommonUtil.displayErrorAlert(w,"resetTableCellPixelWidth")}return null};this.adjustOffsetWidthTableCell=function(b,f){try{for(var c=[],d=0;d<b.rows.length;d++){c[d]=[];for(var e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++){var a=
g_objTableUtil.getTableCellElement(b,d,g);c[d][g]=a.offsetWidth}}for(d=0;d<b.rows.length;d++)for(e=g_objTableUtil.getTableCellsLength(b,d),g=0;g<e;g++)a=g_objTableUtil.getTableCellElement(b,d,g),g_objTableUtil.setNodeValue_Width(a,f[d][g]+f[d][g]-c[d][g],"px")}catch(h){g_objCommonUtil.displayErrorAlert(h,"adjustOffsetWidthTableCell")}};this.getRoundOffValue=function(b){try{var f=parseInt(b);b=100*b%100;0<=b&&10>=b||90<=b&&(f+=1);return f}catch(c){g_objCommonUtil.displayErrorAlert(c,"getRoundOffValue")}};
this.getPercentageValue=function(b,f){try{return b=100*b/f,b=this.getRoundOffValue(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,"getPercentageValue")}};this.offsetWidthToStyleWidth=function(b,f){try{if(!b||!f)return 0;var c=g_objNodeUtil.getLoopParentElement(f,"table");if(!c)return 0;var d=g_objPropertyUtil,e=parseFloat(d.getElement_BorderWidth_With_Unit(f,"left").nValue)+parseFloat(d.getElement_BorderWidth_With_Unit(f,"right").nValue);"collapse"==c.style.borderCollapse&&(e/=2);var g=d.getPadding(f,
d.LEFT)+d.getPadding(f,d.RIGHT),a=c.cellPadding?parseFloat(c.cellPadding):0;b-=e;b-=g;b-=2*a;return b=Math.max(b,0)}catch(h){g_objCommonUtil.displayErrorAlert(h,"table_resize.offsetWidthToStyleWidth")}};this.offsetHeightToStyleHeight=function(b,f){try{if(!b||!f)return 0;var c=g_objNodeUtil.getLoopParentElement(f,"table");if(!c)return 0;var d=g_objPropertyUtil,e=parseFloat(d.getElement_BorderWidth_With_Unit(f,"top").nValue)+parseFloat(d.getElement_BorderWidth_With_Unit(f,"bottom").nValue);"collapse"==
c.style.borderCollapse&&(e/=2);var g=d.getPadding(f,d.TOP)+d.getPadding(f,d.BOTTOM),a=c.cellPadding?parseFloat(c.cellPadding):0;b-=e;b-=g;b-=2*a;return b=Math.max(b,0)}catch(h){g_objCommonUtil.displayErrorAlert(h,"table_resize.offsetHeightToStyleHeight")}}};

var g_objTableMiniMenu=new function(){var l=this;this.objTableNode=this.objTableMiniMenuLayer=null;this.initializeTableMiniMenuLayer=function(){try{if(null==this.objTableMiniMenuLayer){var a="";a+='<div id="divTableMiniMenu" class="tbResizeLineContainer" style="display:none;background-color:#dedede;cursor:pointer;z-index:20008;">';a+='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/minibar_btn_plus.gif" alt="" style="width:14px;height:14px;border:1px solid #000000;" />';g_objInsertUtil.insertLayerHTML(a+
"</div>",!1)&&(this.objTableMiniMenuLayer=document.getElementById("divTableMiniMenu"),this.objTableMiniMenuLayer.onmousedown=function(a){TBCancelBubbleEvent(a)},this.objTableMiniMenuLayer.onclick=function(a){l.tableMiniMenuClick(a,l.objTableNode)},g_objNodeUtil.initFalsePropagationEvent(this.objTableMiniMenuLayer))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"initializeTableMiniMenuLayer")}};this.showTableMiniMenu=function(a,e,f){try{if(dzeUiConfig.bUseTableMiniMenu)if(null==this.objTableMiniMenuLayer&&
this.initializeTableMiniMenuLayer(),a){this.objTableNode=e;this.objTableMiniMenuLayer.style.display="";var g=g_objPositionUtil.getElementPosition(g_objEditObject[f],!1),b=g_objPositionUtil.getElementPosClientRect(e),c=g.top+b.top;this.objTableMiniMenuLayer.style.left=g.left+b.left+"px";this.objTableMiniMenuLayer.style.top=c-7+"px"}else this.objTableNode=null,this.objTableMiniMenuLayer.style.display="none"}catch(d){g_objCommonUtil.displayErrorAlert(d,"showTableMiniMenu")}};this.tableMiniMenuClick=
function(a,e){try{if(!fnObjectCheckNull(e)){g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);var f={nContextMenuType:g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU,nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:""},g=e.getBoundingClientRect(),b=g_objPositionUtil.getOuterRect(g_objEditObject[g_nActiveEditNumber]),c=g_objPositionUtil.getOuterRect(window.frameElement);g_objContextMenuWin.showContextMenuLayer(f,c.left+g.left+14+1,c.top+b.top+g.top-
7,g_nActiveEditNumber)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"tableMiniMenuClick")}};this.prepareTableSelectAll=function(a){try{window.attachEvent?g_objEditorDocument[a].selection.empty():g_objEditWindow[a].getSelection().removeAllRanges()}catch(e){g_objCommonUtil.displayErrorAlert(e,"prepareTableSelectAll")}};this.table_selectAll=function(a,e){try{for(var f=!0,g=a.rows.length,b=0;b<a.rows.length;b++)for(var c=g_objTableUtil.getTableCellsLength(a,b),d=0;d<c;d++){var h=g_objTableUtil.getTableCellElement(a,
b,d),k=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(h,a,b,e);f?(f=!1,g_nStartClick_Row=b,g_nStartClick_Col=d,g_nStartClick_X=k.left,g_nStartClick_Y=k.top,g_objTableFlag.RemoveCellAfterCheckExist(h),g_objTableFlag.AddCellAfterCheckExist(h),g_objTableFlag.SetCellAttribute_Flag(a,b,d,2)):(g_objTableFlag.RemoveCellAfterCheckExist(h),g_objTableFlag.AddCellAfterCheckExist(h),g_objTableFlag.SetCellAttribute_Flag(a,b,d,3));b==g-1&&d==c-1&&(g_nEndClick_Row=b,g_nEndClick_Col=d,g_nEndClick_X=k.right,
g_nEndClick_Y=k.bottom,g_objTableFlag.SetCellAttribute_Flag(a,b,d,4))}g_objTableFlag.bOneCell=!1;g_objTableFlag.arrDecreaseRowCol=null}catch(m){g_objCommonUtil.displayErrorAlert(m,"table_selectAll")}};this.table_selectRow=function(a,e){try{for(var f=!0,g=g_objTableUtil.getTableCellsLength(a,g_nStartClick_Row),b=0;b<g;b++){var c=g_objTableUtil.getTableCellElement(a,g_nStartClick_Row,b),d=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(c,a,g_nStartClick_Row,e);f?(f=!1,g_nStartClick_Col=b,g_nStartClick_X=
d.left,g_nStartClick_Y=d.top,g_objTableFlag.RemoveCellAfterCheckExist(c),g_objTableFlag.AddCellAfterCheckExist(c),g_objTableFlag.SetCellAttribute_Flag(a,g_nStartClick_Row,b,2)):(g_objTableFlag.RemoveCellAfterCheckExist(c),g_objTableFlag.AddCellAfterCheckExist(c),g_objTableFlag.SetCellAttribute_Flag(a,g_nStartClick_Row,b,3));b==g-1&&(g_nEndClick_Row=g_nStartClick_Row,g_nEndClick_Col=b,g_nEndClick_X=d.right,g_nEndClick_Y=d.bottom,g_objTableFlag.SetCellAttribute_Flag(a,g_nStartClick_Row,b,4))}g_objTableFlag.bOneCell=
!1;g_objTableFlag.arrDecreaseRowCol=null}catch(h){g_objCommonUtil.displayErrorAlert(h,"table_selectRow")}};this.table_selectCol=function(a,e){try{for(var f=!0,g=a.rows.length,b=0;b<a.rows.length;b++)if(!(g_objTableUtil.getTableCellsLength(a,b)<g_nStartClick_Col)){var c=g_objTableUtil.getTableCellElement(a,b,g_nStartClick_Col),d=g_objPositionUtil.getTableCellPosInEditAreaWithScrollPos(c,a,b,e);f?(f=!1,g_nStartClick_Row=b,g_nStartClick_X=d.left,g_nStartClick_Y=d.top,g_objTableFlag.RemoveCellAfterCheckExist(c),
g_objTableFlag.AddCellAfterCheckExist(c),g_objTableFlag.SetCellAttribute_Flag(a,b,g_nStartClick_Col,2)):(g_objTableFlag.RemoveCellAfterCheckExist(c),g_objTableFlag.AddCellAfterCheckExist(c),g_objTableFlag.SetCellAttribute_Flag(a,b,g_nStartClick_Col,3));b==g-1&&(g_nEndClick_Row=b,g_nEndClick_Col=g_nStartClick_Col,g_nEndClick_X=d.right,g_nEndClick_Y=d.bottom,g_objTableFlag.SetCellAttribute_Flag(a,b,g_nStartClick_Col,4))}g_objTableFlag.bOneCell=!1;g_objTableFlag.arrDecreaseRowCol=null}catch(h){g_objCommonUtil.displayErrorAlert(h,
"table_selectCol")}};this.updateManualTableUIHandler=function(a){try{var e=0,f=0,g=0,b=0,c=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[a],a);null!=c&&(e=c[0],f=c[1],g=c[2],b=c[3],updateTableHandlerUI.updateTableUIHandler(e,f,g,b,a),GetMultiCellSelection()&&updateHandlerUI.update_toolbar_combobox("",a))}catch(d){g_objCommonUtil.displayErrorAlert(d,"updateManualTableUIHandler")}}};

var letterSpacingWin=function(){var e=this;this.objLetterSpacingLayer=null;this.bLetterSpacingDisplay=!1;this.arrLetterSpacing=" 1pt 2pt 4pt 6pt 8pt 10pt".split(" ");letterSpacingWin.prototype.initializeLetterSpacingLayer=function(){try{if(null==this.objLetterSpacingLayer){"undefined"!=typeof dzeUiConfig.arrCustomLetterSpacing&&0<dzeUiConfig.arrCustomLetterSpacing.length&&(this.arrLetterSpacing=dzeUiConfig.arrCustomLetterSpacing);var a='<div id="divLetterSpacingSelWin" style="position:absolute; display:none; z-index:20031">';
a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var b=0;b<this.arrLetterSpacing.length;b++)a+='<tr><td style="line-height:normal;padding:0">',a+='<table id="ComboBoxItem_LetterSpacing_Sub_'+b+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',
a=0==b?a+('<td style="line-height:normal;text-align:left;padding-left:10px"><span>'+ID_RES_COMBOBOX_REMOVE_LETTER_SPACING+"</span></td>"):a+('<td style="line-height:normal;text-align:left;padding-left:10px"><span>'+this.arrLetterSpacing[b]+"</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";if(g_objLayerKit.getElementById("divLetterSpacingSelWin")||g_objInsertUtil.insertLayerHTML(a,!0))this.objLetterSpacingLayer=g_objLayerKit.getElementById("divLetterSpacingSelWin"),
this.initLetterSpacingSubItem("ComboBoxItem_LetterSpacing"),g_objNodeUtil.initFalsePropagationEvent(this.objLetterSpacingLayer)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeLetterSpacingLayer")}};letterSpacingWin.prototype.initLetterSpacingSubItem=function(a){try{for(var b=0;b<this.arrLetterSpacing.length;b++){var c=g_objLayerKit.getElementById(a+"_Sub_"+b);c.onmouseout=function(a){e.fnLetterSpacingCellOut(this)};c.onmousedown=TBCancelBubbleEvent;c.onmouseup=TBCancelBubbleEvent;(function(){var a=
e.arrLetterSpacing[b];c.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&(e.objLetterSpacingLayer.onmouseleave=function(){});e.fnLetterSpacingCellClick(a)};c.onmouseover=function(b){e.fnLetterSpacingCellOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&e.fnLetterSpacingCellClick(a,!1)}})()}}catch(f){g_objCommonUtil.displayErrorAlert(f,"initLetterSpacingSubItem")}return null};letterSpacingWin.prototype.initLetterSpacingLayerEvent=function(){try{null!=this.objLetterSpacingLayer&&
this.bLetterSpacingDisplay&&(this.objLetterSpacingLayer.style.display="none",this.bLetterSpacingDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objLetterSpacingLayer=null)}catch(a){g_objCommonUtil.displayErrorAlert(a,"initLetterSpacingLayerEvent")}};letterSpacingWin.prototype.showLetterSpacingLayer=function(a,b,c){try{if(g_objCommonUtil.log("showLetterSpacingLayer"),this.initializeLetterSpacingLayer(),!fnObjectCheckNull(a)&&null!=this.objLetterSpacingLayer)if(g_nActiveEditNumber=c,this.bLetterSpacingDisplay)g_objLayerEventUtil.initHideDynamicLayer();
else{this.bLetterSpacingDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLetterSpacingLayer,a,b,dzeUiConfig.bTBPreviewLetterOperation);var f=g_objPropertyUtil.getSelectionAttributeValue(c);if("undefined"!=typeof f&&null!=f){var d=f[4];if("undefined"==typeof d||null==d)d="";var e=updateHandlerUI.getMappingIndex_LetterSpacing(d);for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)a==e?g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:
g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;g_objTableSelection.setTableObjectOnCaret(c);!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objUndoRedo.registerUndoRedoStack(0,c),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),this.objLetterSpacingLayer.onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):(g_objUndoRedo.registerUndoRedoStack(0,c),g_objUndoRedo.operateUndoRedoStack(!0,
!0,c))})}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"showLetterSpacingLayer")}};letterSpacingWin.prototype.fnLetterSpacingCellOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(b){g_objCommonUtil.displayErrorAlert(b,"fnLetterSpacingCellOver")}};letterSpacingWin.prototype.fnLetterSpacingCellOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(b){g_objCommonUtil.displayErrorAlert(b,
"fnLetterSpacingCellOut")}};letterSpacingWin.prototype.fnLetterSpacingCellClick=function(a,b){try{var c=!0;"undefined"!=typeof b&&(c=b);if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,a,g_nActiveEditNumber);else if(window.attachEvent){var f=g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(f))return;var d=f.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=f.createRange();if(fnObjectCheckNull(e))return;
g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,a,e,g_nActiveEditNumber,!0)}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){f=g_objEditWindow[g_nActiveEditNumber].getSelection();var g=f.getRangeAt(0);g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,a,g,g_nActiveEditNumber,!0)}GetMultiCellSelection()?setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",g_nActiveEditNumber)}catch(h){}},10):setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(d,
g_nActiveEditNumber)}catch(h){}},10);0!=c&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(g_nActiveEditNumber);0!=c&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}catch(h){g_objCommonUtil.displayErrorAlert(h,"fnLetterSpacingCellClick")}}},g_objLetterSpacingWin=new letterSpacingWin;

var lineHeightWin=function(){var e=this;this.objLineHeightLayer=null;this.bLineHeightDisplay=!1;this.arrLineHeight=" 1 1.2 1.5 1.8 2 2.5 3".split(" ");lineHeightWin.prototype.initializeLineHeightLayer=function(){try{if(null==this.objLineHeightLayer){"undefined"!=typeof dzeUiConfig.arrCustomLineHeight&&0<dzeUiConfig.arrCustomLineHeight.length&&(this.arrLineHeight=dzeUiConfig.arrCustomLineHeight);var a='<div id="divLineHeightSelWin" style="position:absolute; display:none; z-index:20031">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+
g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var b=0;b<this.arrLineHeight.length;b++)a+='<tr><td style="line-height:normal;padding:0;">',a+='<table id="ComboBoxItem_LineHeight_Sub_'+b+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',a=0==b?a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:10px"><span>'+
ID_RES_COMBOBOX_REMOVE_LINE_HEIGHT+"</span></td>"):a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:10px"><span>'+100*parseFloat(this.arrLineHeight[b],10)+" %</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";if(g_objLayerKit.getElementById("divLineHeightSelWin")||g_objInsertUtil.insertLayerHTML(a,!0))this.objLineHeightLayer=g_objLayerKit.getElementById("divLineHeightSelWin"),this.initLineHeightSubItem("ComboBoxItem_LineHeight"),
g_objNodeUtil.initFalsePropagationEvent(this.objLineHeightLayer)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeLineHeightLayer: "+c)}};lineHeightWin.prototype.initLineHeightSubItem=function(a){try{for(var b=0;b<this.arrLineHeight.length;b++){var c=g_objLayerKit.getElementById(a+"_Sub_"+b);c.onmouseout=function(a){e.fnLineHeightCellOut(this)};c.onmousedown=TBCancelBubbleEvent;c.onmouseup=TBCancelBubbleEvent;(function(){var a=e.arrLineHeight[b];c.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&
(e.objLineHeightLayer.onmouseleave=function(){});e.fnLineHeightCellClick(a)};c.onmouseover=function(b){e.fnLineHeightCellOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&e.fnLineHeightCellClick(a,!1)}})()}}catch(f){g_objCommonUtil.displayErrorAlert(f,"initLineHeightSubItem")}return null};lineHeightWin.prototype.initLineHeightLayerEvent=function(){try{null!=this.objLineHeightLayer&&this.bLineHeightDisplay&&(this.objLineHeightLayer.style.display="none",this.bLineHeightDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),
this.objLineHeightLayer=null)}catch(a){g_objCommonUtil.displayErrorAlert(a,"initLineHeightLayerEvent")}};lineHeightWin.prototype.showLineHeightLayer=function(a,b,c){try{if(this.initializeLineHeightLayer(),!fnObjectCheckNull(a)&&null!=this.objLineHeightLayer)if(g_nActiveEditNumber=c,this.bLineHeightDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{this.bLineHeightDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLineHeightLayer,a,b,dzeUiConfig.bTBPreviewLetterOperation);var f=g_objPropertyUtil.getSelectionAttributeValue(c);
if("undefined"!=typeof f&&null!=f){var d=f[5];if("undefined"==typeof d||null==d)d="";var e=updateHandlerUI.getMappingIndex_LineHeight(d);for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)a==e?g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;g_objTableSelection.setTableObjectOnCaret(c);!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objUndoRedo.registerUndoRedoStack(0,
c),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),this.objLineHeightLayer.onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):(g_objUndoRedo.registerUndoRedoStack(0,c),g_objUndoRedo.operateUndoRedoStack(!0,!0,c))})}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"showLineHeightLayer")}};lineHeightWin.prototype.fnLineHeightCellOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(b){g_objCommonUtil.displayErrorAlert(b,
"fnLineHeightCellOver")}};lineHeightWin.prototype.fnLineHeightCellOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(b){g_objCommonUtil.displayErrorAlert(b,"fnLineHeightCellOut")}};lineHeightWin.prototype.fnLineHeightCellClick=function(a,b){try{var c=!0;"undefined"!=typeof b&&(c=b);if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(ID_LETTER_OPERATION_LINE_HEIGHT,a,g_nActiveEditNumber);else if(window.attachEvent){var f=
g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(f))return;var d=f.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=f.createRange();if(fnObjectCheckNull(e))return;g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LINE_HEIGHT,a,e,g_nActiveEditNumber,!0)}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){f=g_objEditWindow[g_nActiveEditNumber].getSelection();var g=f.getRangeAt(0);g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LINE_HEIGHT,
a,g,g_nActiveEditNumber,!0)}GetMultiCellSelection()?setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",g_nActiveEditNumber)}catch(h){}},10):setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(d,g_nActiveEditNumber)}catch(h){}},10);0!=c&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(g_nActiveEditNumber);0!=c&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}catch(h){g_objCommonUtil.displayErrorAlert(h,"fnLineHeightCellClick")}}},g_objLineHeightWin=
new lineHeightWin;

var ID_TABLE_INSERT_CELL_WIDTH=100,ID_TABLE_INSERT_CELL_HEIGHT=20,g_objTableSizeBoxWin=new function(){var k=this;this.nTBLimitSizeBox_Col=this.nTBLimitSizeBox_Row=this.nTBMinSizeBox_Col=this.nTBMinSizeBox_Row=15;this.nTBSizeCell_Height=this.nTBSizeCell_Width=18;this.nTBChangePos_Y=this.nTBChangePos_X=this.nTBLimitPos_Y=this.nTBLimitPos_X=this.nTBMinPos_Y=this.nTBMinPos_X=this.nTBMenuPos_Y=this.nTBMenuPos_X=0;this.objTBSizeBox={};this.objTBSizeBox.objBackWin=null;this.objTBSizeBox.objBG=null;this.objTBSizeBox.objWindow=
null;this.objTBSizeBox.objStatus=null;this.bTBSizeBoxCancel=this.bTBSizeBoxDisplay=!1;this.nTBStatusSpan_Col=this.nTBStatusSpan_Row=-1;this.initializeTableSizeBoxLayer=function(){try{if(null==this.objTBSizeBox.objBackWin){var e=this.drawTableSize(this.nTBLimitSizeBox_Row,this.nTBLimitSizeBox_Col,this.nTBMinSizeBox_Row,this.nTBMinSizeBox_Col);if(g_objLayerKit.getElementById("TB_Size_Box_Back_Win")||g_objInsertUtil.insertLayerHTML(e,!0)){var a=this.objTBSizeBox;a.objBackWin=g_objLayerKit.getElementById("TB_Size_Box_Back_Win");
a.objBG=g_objLayerKit.getElementById("TB_Size_Box_BG");a.objWindow=g_objLayerKit.getElementById("TB_Size_Box_Window");a.objStatus=g_objLayerKit.getElementById("TB_Size_Box_Status");a.objStatus.objStatusText=g_objLayerKit.getElementById("TB_Size_Box_Status_Text");a.objBackWin.style.display="none";a.objBG.style.display="none";a.objWindow.style.display="none";a.objStatus.style.display="none";this.initTableSizeBoxSubItem();g_objNodeUtil.initFalsePropagationEvent(a.objBackWin);g_objNodeUtil.initFalsePropagationEvent(a.objBG);
g_objNodeUtil.initFalsePropagationEvent(a.objWindow);g_objNodeUtil.initFalsePropagationEvent(a.objStatus)}}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeTableSizeBoxLayer")}};this.drawTableSize=function(e,a,c,b){try{var d="<div id='TB_Size_Box_Back_Win' class='"+g_strSkin_SizeBoxBackWin+"'>";d+="<div id='TB_Size_Box_BG' class='"+g_strSkin_SizeBoxBG+"'></div>";d+="</div>";d+="<div id='TB_Size_Box_Window' class='tbSizeBoxWindow'>";d+="<table cellSpacing='0' cellPadding='0' border='0'>";for(var f=
0;f<e;f++){d+="<tr>";d+="<td style='text-align:left;'>";d+="<table cellSpacing='0' cellPadding='0' border='0' style='width:18px;height:18px;table-layout:auto;'>";d+="<tr>";for(var h=0;h<a;h++)d=f<c&&h<b?g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>"):
g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>");d+="</tr>";d+="</table>";
d+="</td>";d+="</tr>"}d+="</table>";d+="</div>";d+="<div id='TB_Size_Box_Status' class='"+g_strSkin_SizeBoxStatus+"'>";d+="<table cellSpacing='0' cellPadding='0' style='margin-top:3' align='center' border='0'>";d+="<tr>";d+="<td align='center' class='"+g_strSkin_SizeBoxStatusText+"' style='line-height:normal;'><span id='TB_Size_Box_Status_Text'>";d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_SELECT+"</span>";for(f=0;f<e;f++)d+="<span style='display:none'>"+(f+1)+"</span>";d+="<span style='display:none'> X </span>";
for(h=0;h<a;h++)d+="<span style='display:none'>"+(h+1)+"</span>";d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_CANCEL+"</span>";d+="</span></td>";d+="</tr>";return d+"</table></div>"}catch(g){}};this.initTableSizeBoxSubItem=function(){try{for(var e=0;e<this.nTBLimitSizeBox_Row;e++)for(var a=0;a<this.nTBLimitSizeBox_Col;a++){var c=g_objLayerKit.getElementById("tbSizeBoxCell_"+e+"_"+a);(function(){var b=e,d=a;c.onmouseover=function(){k.changeBGSizeBox(b,d)}})();c.onmousedown=TBCancelBubbleEvent;
c.onmouseup=TBCancelBubbleEvent;(function(){var b=e,d=a;c.onclick=function(){k.createNewTable(b,d)}})()}}catch(b){}};this.changeBGSizeBox=function(e,a){try{g_objTableSizeBoxWin.objTBSizeBox.objBG.style.width=(a+1)*g_objTableSizeBoxWin.nTBSizeCell_Width+"px",g_objTableSizeBoxWin.objTBSizeBox.objBG.style.height=(e+1)*g_objTableSizeBoxWin.nTBSizeCell_Height+"px",g_objTableSizeBoxWin.setTableSizeBoxStatus(e+1,a+1,!1)}catch(c){}};this.resizeTableSizeBox=function(e){try{var a=g_objPositionUtil.GetDocumentClientPos_XY(e),
c=a.nPos_X,b=a.nPos_Y;if(dzeEnvConfig.iFrameLayer){var d=g_objPositionUtil.getElementPosition(window.frameElement,!0);c+=d.left;b+=d.top}var f=k.objTBSizeBox.objBackWin,h=f.offsetWidth,g=f.offsetHeight;null!=f&&g_objTableSizeBoxWin.bTBSizeBoxDisplay?f.offsetLeft<c&&f.offsetTop<b&&c<f.offsetLeft+h&&b<f.offsetTop+g?(k.bTBSizeBoxCancel=!1,k.nTBMinPos_X-k.nTBSizeCell_Width<c&&c<k.nTBLimitPos_X&&k.changeTBSizeBox_X(c),k.nTBMinPos_Y-k.nTBSizeCell_Height<b&&b<k.nTBLimitPos_Y&&k.changeTBSizeBox_Y(b)):k.bTBSizeBoxCancel||
(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0):k.bTBSizeBoxCancel||(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0)}catch(l){g_objCommonUtil.displayErrorAlert(l,"resizeTableSizeBox")}};this.setTableSizeBoxStatus=function(e,a,c){try{var b=g_objNodeUtil.getChildrenCollection(this.objTBSizeBox.objStatus.objStatusText);-1!=this.nTBStatusSpan_Row&&(b[this.nTBStatusSpan_Row].style.display="none");-1!=this.nTBStatusSpan_Col&&(b[this.nTBLimitSizeBox_Row+this.nTBStatusSpan_Col+1].style.display=
"none");this.nTBStatusSpan_Row=e;this.nTBStatusSpan_Col=a;-1==e&&-1==a?(c?(b[0].style.display="none",b[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="",b[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.lineHeight="normal"):(b[0].style.display="",b[0].style.lineHeight="normal",b[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none"),b[this.nTBLimitSizeBox_Row+1].style.display="none"):(b[0].style.display="none",b[e].style.display="",b[e].style.lineHeight=
"normal",b[this.nTBLimitSizeBox_Row+1].style.display="",b[this.nTBLimitSizeBox_Row+1].style.lineHeight="normal",b[this.nTBLimitSizeBox_Row+a+1].style.display="",b[this.nTBLimitSizeBox_Row+a+1].style.lineHeight="normal",b[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none")}catch(d){g_objCommonUtil.displayErrorAlert(d,"setTableSizeBoxStatus")}};this.changeTBSizeBox_X=function(e){try{if(e<this.nTBChangePos_X){if(e<this.nTBChangePos_X-this.nTBSizeCell_Width){var a=(this.nTBChangePos_X-
this.nTBMenuPos_X-6)/this.nTBSizeCell_Width;this.nTBChangePos_X=this.nTBMenuPos_X+(a-1)*this.nTBSizeCell_Width+6;this.objTBSizeBox.objBackWin.style.width=(a-1)*this.nTBSizeCell_Width+10+"px";this.objTBSizeBox.objBG.style.width=(a-1)*this.nTBSizeCell_Width+"px";this.objTBSizeBox.objStatus.style.width=(a-1)*this.nTBSizeCell_Width+10+"px";for(var c=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,b=0;b<c;b++)document.getElementById("tbSizeBoxCell_"+b+"_"+(a-1)).style.display="none"}}else if(e>
this.nTBChangePos_X)for(a=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,this.nTBChangePos_X=this.nTBMenuPos_X+(a+1)*this.nTBSizeCell_Width+6,this.objTBSizeBox.objBackWin.style.width=(a+1)*this.nTBSizeCell_Width+10+"px",this.objTBSizeBox.objBG.style.width=(a+1)*this.nTBSizeCell_Width+"px",this.objTBSizeBox.objStatus.style.width=(a+1)*this.nTBSizeCell_Width+10+"px",c=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,b=0;b<c;b++)document.getElementById("tbSizeBoxCell_"+
b+"_"+a).style.display=""}catch(d){g_objCommonUtil.displayErrorAlert(d,"changeTBSizeBox_X")}};this.changeTBSizeBox_Y=function(e){try{if(e<this.nTBChangePos_Y){if(e<this.nTBChangePos_Y-this.nTBSizeCell_Height){var a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height;this.nTBChangePos_Y=this.nTBMenuPos_Y+(a-1)*this.nTBSizeCell_Height+6;this.objTBSizeBox.objBackWin.style.height=(a-1)*this.nTBSizeCell_Height+10+"px";this.objTBSizeBox.objBG.style.height=(a-1)*this.nTBSizeCell_Height+"px";
this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+(a-1)*this.nTBSizeCell_Height+6+4+"px";for(var c=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,b=0;b<c;b++)document.getElementById("tbSizeBoxCell_"+(a-1)+"_"+b).style.display="none"}}else if(e>this.nTBChangePos_Y)for(a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,this.nTBChangePos_Y=this.nTBMenuPos_Y+(a+1)*this.nTBSizeCell_Height+6,this.objTBSizeBox.objBackWin.style.height=(a+1)*this.nTBSizeCell_Height+
10+"px",this.objTBSizeBox.objBG.style.height=(a+1)*this.nTBSizeCell_Height+"px",this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+(a+1)*this.nTBSizeCell_Height+6+4+"px",c=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,b=0;b<c;b++)document.getElementById("tbSizeBoxCell_"+a+"_"+b).style.display=""}catch(d){g_objCommonUtil.displayErrorAlert(d,"changeTBSizeBox_Y")}};this.initTableSizeLayerEvent=function(){try{if(null!=this.objTBSizeBox&&null!=this.objTBSizeBox.objBackWin){var e=
this.objTBSizeBox;this.bTBSizeBoxDisplay&&(e.objBackWin.style.display="none",e.objBG.style.display="none",e.objWindow.style.display="none",e.objStatus.style.display="none",this.bTBSizeBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objTBSizeBox.objBackWin=null,this.objTBSizeBox.objBG=null,this.objTBSizeBox.objWindow=null,this.objTBSizeBox.objStatus=null)}}catch(a){g_objCommonUtil.displayErrorAlert(a,"initTableSizeLayerEvent")}};this.showTableSizeBoxLayer=function(e,a){try{if(this.initializeTableSizeBoxLayer(),
!fnObjectCheckNull(e)&&null!=this.objTBSizeBox.objBackWin){g_nActiveEditNumber=a;for(a=0;a<this.nTBLimitSizeBox_Row;a++)for(var c=0;c<this.nTBLimitSizeBox_Col;c++)a<this.nTBMinSizeBox_Row&&c<this.nTBMinSizeBox_Col||(g_objLayerKit.getElementById("tbSizeBoxCell_"+a+"_"+c).style.display="none");this.setTableSizeBoxStatus(-1,-1,!1);var b=g_objPositionUtil.getOuterRect(e),d=g_objPositionUtil.getOuterRect(window.frameElement),f=d.left+b.left,h=d.top+b.top+b.height;g_bBrowserType_FF?(f=f-g_nFireFoxLayerSetting_X+
1,h=h-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(f+=2,h+=2):g_bBrowserType_OP?(f+=1,h+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(f+=2,h+=2);if(this.bTBSizeBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{this.nTBMenuPos_X=f-2+g_nIframeBorderSetting;this.nTBMenuPos_Y=h-3+g_nIframeBorderSetting;var g=this.objTBSizeBox;g.objBackWin.style.left=this.nTBMenuPos_X+"px";g.objBackWin.style.top=this.nTBMenuPos_Y+"px";g.objBackWin.style.width=this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+
10+"px";g.objBackWin.style.height=this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+10+"px";g.objBackWin.style.display="";g.objWindow.style.left=this.nTBMenuPos_X+6+"px";g.objWindow.style.top=this.nTBMenuPos_Y+6+"px";g.objWindow.style.display="";g.objBG.style.width=0;g.objBG.style.height=0;g.objBG.style.display="";g.objStatus.style.left=this.nTBMenuPos_X+"px";g.objStatus.style.top=this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6+4+"px";g.objStatus.style.width=this.nTBMinSizeBox_Col*
this.nTBSizeCell_Width+10+"px";g.objStatus.style.display="";this.nTBMinPos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Row*this.nTBSizeCell_Width+6;this.nTBMinPos_Y=this.nTBMenuPos_Y+this.nTBMinSizeBox_Col*this.nTBSizeCell_Height+6;this.nTBLimitPos_X=this.nTBMenuPos_X+this.nTBLimitSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBLimitPos_Y=this.nTBMenuPos_Y+this.nTBLimitSizeBox_Row*this.nTBSizeCell_Height+6;this.nTBChangePos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBChangePos_Y=
this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6;this.bTBSizeBoxDisplay=!0;g_objLayerEventUtil.objCurrentLayer=g.objBackWin;duzon_dialog.animateDlg(g.objBackWin,"down");duzon_dialog.animateDlg(g.objWindow,"down");duzon_dialog.animateDlg(g.objBG,"down");duzon_dialog.animateDlg(g.objStatus,"down");detachMouseEvent();g_objLayerEventUtil.addLayerEvent()}}}catch(l){g_objCommonUtil.displayErrorAlert(l,"showTableSizeBoxLayer")}};this.createNewTable=function(e,a){try{var c=[];c[0]=e+1;c[1]=
a+1;c[2]=100;c[3]="%";c[4]=null;c[5]=null;c[6]=1;c[7]="1px solid #000000";c[8]="1px solid #000000";c[9]="1px solid #000000";c[10]="1px solid #000000";c[11]="1px solid #000000";c[12]="1px solid #000000";c[13]=null;c[14]=null;c[15]=null;c[16]="";g_objTableFunction.createTable(c,g_nActiveEditNumber)&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber);g_objLayerEventUtil.initHideDynamicLayer()}catch(b){g_objCommonUtil.displayErrorAlert(b,"createNewTable")}}};

var g_objMenuWin=new function(){this.arrTBMenu=[];this.ID_MENU_ITEM_SEGMENT=6;this.bMenuLayerShow=this.bMenuDisplayToggle=!1;this.arrMenuMember=[];this.arrMenuMember.push([ID_COMMAND_FILE_NEW,ID_COMMAND_FILE_OPEN,-1,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,-1,ID_COMMAND_SAVEAS,-1,ID_COMMAND_PRINT]);this.arrMenuMember.push([ID_COMMAND_UNDO,ID_COMMAND_REDO,-1,ID_COMMAND_CUT,ID_COMMAND_COPY,ID_COMMAND_PASTE,ID_COMMAND_EDIT_PASTESPECIAL,ID_COMMAND_DELETE,-1,ID_COMMAND_SELECT_ALL,-1,ID_COMMAND_EDIT_SEARCH,
ID_COMMAND_EDIT_REPLACE,ID_COMMAND_EDIT_REPLACE_CASE]);this.arrMenuMember.push([ID_COMMAND_VIEW_EDIT,ID_COMMAND_VIEW_HTML,ID_COMMAND_PREVIEW]);this.arrMenuMember.push([ID_COMMAND_INSERT_IMAGE,ID_COMMAND_INSERT_OBJECT,-1,ID_COMMAND_INSERT_SPECIALCHARS,-1,ID_COMMAND_INSERT_BOOKMARK,ID_COMMAND_HYPERLINK_INSERT,ID_COMMAND_INSERT_PARAGRAPH]);this.arrMenuMember.push([ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,-1,ID_COMMAND_STYLE_STYLE,-1,ID_COMMAND_STYLE_UNORDEREDLIST,ID_COMMAND_STYLE_ORDEREDLIST,
-1,ID_COMMAND_STYLE_INCREASEORDER,ID_COMMAND_STYLE_DECREASEORDER]);this.arrMenuMember.push([ID_COMMAND_TABLE_CREATE,-1,ID_COMMAND_TABLE_PROPERTY,ID_COMMAND_TABLE_CELL_PROPERTY,ID_COMMAND_TABLE_CELL_STYLE,ID_COMMAND_LOCK_EDIT_CELL,-1,ID_COMMAND_TABLE_ADD_ROW_COL,ID_COMMAND_TABLE_DELETE_ROW,ID_COMMAND_TABLE_DELETE_COL,-1,ID_COMMAND_TABLE_SPLIT_CELL,ID_COMMAND_TABLE_MERGE_CELL,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,ID_COMMAND_TABLE_CELL_SAME_WIDTH,-1,ID_COMMAND_TABLE_CELL_ALIGN,-1,ID_COMMAND_TABLE_CONVERT_TEXT,
ID_COMMAND_TABLE_FORMULA,ID_COMMAND_TABLE_SELECT_FORMULA]);this.arrMenuMember.push([ID_COMMAND_HELP_SHORTCUTS,ID_COMMAND_HELP,ID_COMMAND_HELP_IMAGE_TO_TABLE,ID_COMMAND_HELP_INFO]);this.twoDepthMenu=[];this.twoDepthMenu[ID_COMMAND_INSERT_OBJECT]=[ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_FILE,ID_COMMAND_INSERT_OBJECT_HR];this.twoDepthMenu[ID_COMMAND_INSERT_PARAGRAPH]=[ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT];this.twoDepthMenu[ID_COMMAND_STYLE_STYLE]=
[ID_COMMAND_STYLE_STYLE_BASIC,ID_COMMAND_STYLE_STYLE_SUBJECT1,ID_COMMAND_STYLE_STYLE_SUBJECT2,ID_COMMAND_STYLE_STYLE_SUBJECT3,ID_COMMAND_STYLE_STYLE_SUBJECT4,ID_COMMAND_STYLE_STYLE_SUBJECT5];this.twoDepthMenu[ID_COMMAND_TABLE_CELL_ALIGN]=[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM,
ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM];this.twoDepthMenu[ID_COMMAND_TABLE_FORMULA]=[ID_COMMAND_TABLE_HORIZONTAL_SUM,ID_COMMAND_TABLE_VERTICAL_SUM,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE,ID_COMMAND_TABLE_VERTICAL_AVERAGE,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY,ID_COMMAND_TABLE_VERTICAL_MULTIPLY];this.arrMenuLayer=[];this.objSubMenuItem=[];this.openMenuList=[ID_COMMAND_FILE_OPEN,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,ID_COMMAND_SAVEAS,ID_COMMAND_PRINT,ID_COMMAND_EDIT_PASTESPECIAL,
ID_COMMAND_EDIT_SEARCH,ID_COMMAND_EDIT_REPLACE,ID_COMMAND_EDIT_REPLACE_CASE,ID_COMMAND_INSERT_IMAGE,ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_FILE,ID_COMMAND_INSERT_SPECIALCHARS,ID_COMMAND_INSERT_BOOKMARK,ID_COMMAND_HYPERLINK_INSERT,ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,ID_COMMAND_STYLE_UNORDEREDLIST,ID_COMMAND_STYLE_ORDEREDLIST,ID_COMMAND_TABLE_CREATE,ID_COMMAND_TABLE_PROPERTY,ID_COMMAND_TABLE_CELL_PROPERTY,ID_COMMAND_TABLE_CELL_STYLE,ID_COMMAND_TABLE_ADD_ROW_COL,ID_COMMAND_TABLE_SPLIT_CELL,
ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,ID_COMMAND_TABLE_CELL_VERTICALALIGN,ID_COMMAND_TABLE_SELECT_FORMULA];this.initializeMenuLayer=function(){try{g_objCommonUtil.log("initializeMenuLayer");if(dzeEnvConfig.iFrameLayer){var b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10);g_objCommonUtil.log("dzeditor_frame_no:"+b)}for(var a=0;a<this.arrMenuMember.length;a++){if(fnObjectCheckNull(g_objLayerKit.getElementById("divMenuSelect_"+a))){var c=null;dzeEnvConfig.iFrameLayer?(b=parseInt(window.frameElement.getAttribute("dzeditor_no"),
10),isNaN(b)&&(b=0),c=this.arrTBMenu[b][a].element):c=this.arrTBMenu[0][a].element;if(null==c)break;c="";c+="<div id='divMenuSelect_"+a+"' class='MenuContainer' style='text-align:left;'>";c+="<div class='duzon_menubar_select_container'>";c+=this.buildMenuContent(a);c+="</div>";c+="</div>";if(!g_objInsertUtil.insertLayerHTML(c,!0))break}this.arrMenuLayer[a]=g_objLayerKit.getElementById("divMenuSelect_"+a);this.objSubMenuItem[a]=[];this.setupMenuEvent(a);this.arrMenuLayer[a].style.display="none"}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"initializeMenuLayer")}};this.buildMenuContent=function(b){try{var a="";a+='<table class="MenuContent" cellpadding="0" cellspacing="0" style="border-collapse:separate;">';a+=this.buildMenuItem_Margin();for(var c=0,d=0;d<this.arrMenuMember[b].length;d++)if(g_arrMenuBar[b][d])if(-1==this.arrMenuMember[b][d])a+=this.buildMenuItem_Garbage(),a+=this.buildMenuItem_Separator(),a+=this.buildMenuItem_Garbage();else if(this.arrMenuMember[b][d]!=ID_COMMAND_LOCK_EDIT_CELL||!1!==dzeUiConfig.bUseLockEditCellFunction&&
!1!==g_bLockEditCellMode)a+=this.buildMenuItem(this.arrMenuMember[b][d],!1),b==ID_COMMAND_MENU_TABLE_INDEX&&handlerUI.setMenuTableUpdateIndex(this.arrMenuMember[b][d],c),c++;a+=this.buildMenuItem_Margin();return a+"</table>"}catch(e){g_objCommonUtil.displayErrorAlert(e,"buildMenuContent")}};this.buildMenuItem=function(b,a){try{var c="";c+='<tr class="MenuItem" MBCODE='+b+">";c+='<td width="8" class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;vertical-align:middle;"></td>';c=""==g_arrIcon[b]?
c+('<td width="16" class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div></td>'):c+('<td width="16" class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+
g_arrIcon[b]+'" alt="'+g_arrConst[b][1]+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div></td>');c+='<td width="6" class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;vertical-align:middle;"></td>';var d="",e;for(e in shortcutsMenuList)if(e==b){d="<span class='shortcuts_text'>("+shortcutsMenuList[e]+")</span>";break}var f=g_arrConst[b][1];inArray(b,this.openMenuList)&&(f+="...");!a||ID_COMMAND_JUSTIFY_LEFT!=b&&ID_COMMAND_JUSTIFY_CENTER!=b&&ID_COMMAND_JUSTIFY_RIGHT!=
b&&ID_COMMAND_JUSTIFY_JUSTIFY!=b&&ID_COMMAND_OUTDENT!=b&&ID_COMMAND_INDENT!=b&&ID_COMMAND_SELECT_ALL!=b||(f+=" ("+ID_RES_TOOL_STRING_MENU_TABLE+")",d="");c+='<td class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;text-align:left;vertical-align:middle;">'+f+d+"</td>";a=!1;for(e in this.twoDepthMenu)if(b==e){a=!0;break}c=1==a?c+('<td width="3" class="'+g_strSkin_MenuItem_Default+'"><img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_sub_arrow.png" alt="view submenu" width="3" height="5" style="border:none;"></td>'):
c+('<td width="3" class="'+g_strSkin_MenuItem_Default+'"></td>');c+='<td width="6" class="'+g_strSkin_MenuItem_Default+'" style="line-height:1;vertical-align:middle;"></td>';return c+"</tr>"}catch(g){g_objCommonUtil.displayErrorAlert(g,"buildMenuItem")}};this.buildMenuItem_Margin=function(){try{var b="";b+='<tr class="MenuItem_Garbage">';return b+'<td colspan="6" height="5"></td></tr>'}catch(a){g_objCommonUtil.displayErrorAlert(a,"buildMenuItem_Margin")}};this.buildMenuItem_Garbage=function(){try{var b=
"";b+='<tr class="MenuItem_Garbage">';return b+'<td colspan="6" height="2"></td></tr>'}catch(a){g_objCommonUtil.displayErrorAlert(a,"buildMenuItem_Garbage")}};this.buildMenuItem_Separator=function(){try{var b="";b+='<tr class="MenuSeparator">';return b+'<td colspan="6" class="MenuItem_Separator" style="line-height:normal;"></td></tr>'}catch(a){g_objCommonUtil.displayErrorAlert(a,"buildMenuItem_Separator")}};this.setupMenuEvent=function(b){try{var a=g_objLayerKit.getElementById("divMenuSelect_"+b);
this.setupMenuItemEvent(b,a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setupMenuEvent")}};this.setupMenuItemEvent=function(b,a){try{switch(a.className){case "MenuItem":var c=a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmouseout=function(a){g_objMenuWin.setMenuItemMouseOut(this)};a.onmousedown=function(a){TBCancelBubbleEvent(a)};a.onmouseup=function(a){TBCancelBubbleEvent(a)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;
a.onselect=TBCancelBubbleEvent;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1);var d=!1;for(idx in this.twoDepthMenu)if(c==idx){d=!0;break}1!=d&&(a.onclick=function(a){eval(g_arrConst[c][3])(a,this,-1)});a.command=g_arrConst[c][0];a.commandtype=ID_COMMAND_TYPE_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=c;a.support_type=g_arrConst[c][4];a.support_control_type=g_arrConst[c][5];this.objSubMenuItem[b][this.objSubMenuItem[b].length]=
a}var e=g_objNodeUtil.getChildrenCollection(a);if(null!=e&&0!=e.length)for(a=0;a<e.length;a++)this.setupMenuItemEvent(b,e[a])}catch(f){g_objCommonUtil.displayErrorAlert(f,"setupMenuItemEvent")}};this.initMenuLayerEvent=function(){try{this.closeMenuLayer(),g_objLayerEventUtil.removeLayerEvent()}catch(b){g_objCommonUtil.displayErrorAlert(b,"initMenuLayerEvent")}};this.closeMenuLayer=function(b){try{for(var a=0;a<this.arrMenuMember.length;a++)fnObjectCheckNull(this.arrMenuLayer[a])||(this.arrMenuLayer[a].style.display=
"none");if("undefined"==typeof b||"hide"!=b)for(a=0;a<this.arrMenuMember.length;a++)fnObjectCheckNull(this.arrMenuLayer[a])||(this.arrMenuLayer[a]=null);duzon_menubar.hideTwoDepthMenu();duzon_menubar.closeHiddenTbContainerTool()}catch(c){g_objCommonUtil.displayErrorAlert(c,"closeMenuLayer")}};this.showMenuLayer=function(b,a){try{g_objCommonUtil.log("showMenuLayer nIndex : "+b+", nEditNumber:"+a);this.initializeMenuLayer();g_objCommonUtil.log(this.arrMenuLayer[b]);g_objWrapperOutlineResize.resetExtOutlineInfo();
g_nActiveEditNumber=a;var c=this.arrTBMenu[a][b].element;null!=c&&(this.closeMenuLayer("hide"),this.update_menuItem(a),g_objLayerEventUtil.showLayerWin(this.arrMenuLayer[b],c,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,!1))}catch(d){g_objCommonUtil.displayErrorAlert(d,"showMenuLayer")}};this.update_menuItem=function(b){try{var a=g_objEditorDocument[b],c="";c=window.attachEvent?g_objEditorDocument[b].selection.type:getSelectionTypeForUpdateUI();c=c.toLowerCase();if(ID_STRING_NAME_CONTROL==c)if(1==getSelectionControl(b).rangeLength)for(var d=
0;d<this.objSubMenuItem.length;d++)for(var e=0;e<this.objSubMenuItem[d].length;e++){var f=this.objSubMenuItem[d][e];ID_SUPPORT_CONTROL_TYPE_NO==f.support_control_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY)}else for(d=0;d<this.objSubMenuItem.length;d++)for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY);else if(GetMultiCellSelection())for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==d)this.update_table_menuItem_queryStatus(g_objEditorDocument[b]);
else for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],ID_SUPPORT_TYPE_MULTI_CELL==f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED):ID_SUPPORT_TYPE_PERSISTENCE!=f.support_type&&ID_SUPPORT_TYPE_TABLE_OPERATION!=f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY):ID_SUPPORT_TYPE_PERSISTENCE==f.support_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED);else for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==d)this.update_table_menuItem_queryStatus(g_objEditorDocument[b]);
else for(e=0;e<this.objSubMenuItem[d].length;e++){var g=this.objSubMenuItem[d][e],h=handlerUI.queryCommandStatus(a,this.objSubMenuItem[d][e].command_id,this.objSubMenuItem[d][e].command,b,-1,c);null==h&&g.TBSTATE==ID_STRING_NAME_UNCHECKED&&(h=ID_STRING_NAME_UNCHECKED);null!=h&&this.TBSubMenuSetState(g,h)}}catch(k){g_objCommonUtil.displayErrorAlert(k,"update_menuItem")}};this.update_table_menuItem_queryStatus=function(b){try{var a=g_objTableSelection.CheckTableSelection(b,g_objTable,g_nActiveEditNumber);
if(null==a)updateTableHandlerUI.updateTableMenuUIHandler(0,0,0,0);else{var c=b=0;if(1==a[0]){var d=g_objTableCase.CheckNoSelectedCellCase_Row_Col(g_objEditorDocument[g_nActiveEditNumber],g_objTable,g_nStartClick_Row,g_nStartClick_Col,g_nActiveEditNumber);b=d[0];c=d[1]}updateTableHandlerUI.updateTableMenuUIHandler(a[0],a[1],b,c)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"update_table_menuItem_queryStatus")}};this.setMenuItemMouseOver=function(b){try{if(b.TBSTATE!=ID_STRING_NAME_GRAY){var a=g_objNodeUtil.getChildrenCollection(b);
if(null!=a&&this.ID_MENU_ITEM_SEGMENT==a.length){g_strSkin_MenuItem_Default==a[0].className&&(a[0].className=g_strSkin_MenuItem_Blank_Over,a[1].className=g_strSkin_MenuItem_Icon_Over,a[2].className=g_strSkin_MenuItem_Caption_Over,a[3].className=g_strSkin_MenuItem_Caption_Over,a[4].className=g_strSkin_MenuItem_Icon_Over,a[5].className=g_strSkin_MenuItem_Blank_Over);a=!1;for(idx in this.twoDepthMenu)if(b.getAttribute("mbcode")==idx){a=!0;break}1==a?(setWindowResizeEvent(!1),duzon_menubar.viewTwoDepthMenu(b,
b.getAttribute("mbcode"),this.twoDepthMenu[b.getAttribute("mbcode")]),setWindowResizeEvent(!0)):duzon_menubar.hideTwoDepthMenu(b.getAttribute("mbcode"))}}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setMenuItemMouseOver")}};this.setMenuItemMouseOut=function(b){try{if(b.TBSTATE!=ID_STRING_NAME_GRAY){var a=g_objNodeUtil.getChildrenCollection(b);null!=a&&this.ID_MENU_ITEM_SEGMENT==a.length&&a[0].className==g_strSkin_MenuItem_Blank_Over&&(a[0].className=g_strSkin_MenuItem_Default,a[1].className=g_strSkin_MenuItem_Default,
a[2].className=g_strSkin_MenuItem_Default,a[3].className=g_strSkin_MenuItem_Default,a[4].className=g_strSkin_MenuItem_Default,a[5].className=g_strSkin_MenuItem_Default)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setMenuItemMouseOut")}};this.TBSubMenuSetState=function(b,a){try{var c=g_objNodeUtil.getChildrenCollection(b);if(null!=c&&this.ID_MENU_ITEM_SEGMENT==c.length&&g_strSkin_MenuItem_Default==c[0].className){a=a.toLowerCase();var d=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&
(d=handlerUI.setDisableMenu(b.command_id));a=1==d?ID_STRING_NAME_GRAY:a;switch(b.className){case "MenuItem":if(a==ID_STRING_NAME_GRAY||a==ID_STRING_NAME_CHECKED||a==ID_STRING_NAME_UNCHECKED)a==ID_STRING_NAME_CHECKED?(c[0].className=g_strSkin_MenuItem_Default,c[1].className=g_strSkin_MenuItem_Default,c[2].className=g_strSkin_MenuItem_Default,c[3].className=g_strSkin_MenuItem_Default,c[4].className=g_strSkin_MenuItem_Default,c[5].className=g_strSkin_MenuItem_Default,g_objPropertyUtil.setFilterOpacityStyle(c[0],
!1),g_objPropertyUtil.setFilterOpacityStyle(c[1],!1),g_objPropertyUtil.setFilterOpacityStyle(c[2],!1),g_objPropertyUtil.setFilterOpacityStyle(c[3],!1),g_objPropertyUtil.setFilterOpacityStyle(c[4],!1),g_objPropertyUtil.setFilterOpacityStyle(c[5],!1)):a==ID_STRING_NAME_UNCHECKED?(c[0].className=g_strSkin_MenuItem_Default,c[1].className=g_strSkin_MenuItem_Default,c[2].className=g_strSkin_MenuItem_Default,c[3].className=g_strSkin_MenuItem_Default,c[4].className=g_strSkin_MenuItem_Default,c[5].className=
g_strSkin_MenuItem_Default,g_objPropertyUtil.setFilterOpacityStyle(c[0],!1),g_objPropertyUtil.setFilterOpacityStyle(c[1],!1),g_objPropertyUtil.setFilterOpacityStyle(c[2],!1),g_objPropertyUtil.setFilterOpacityStyle(c[3],!1),g_objPropertyUtil.setFilterOpacityStyle(c[4],!1),g_objPropertyUtil.setFilterOpacityStyle(c[5],!1)):a==ID_STRING_NAME_GRAY&&(g_objPropertyUtil.setFilterOpacityStyle(c[0],!0),g_objPropertyUtil.setFilterOpacityStyle(c[1],!0),g_objPropertyUtil.setFilterOpacityStyle(c[2],!0),g_objPropertyUtil.setFilterOpacityStyle(c[3],
!0),g_objPropertyUtil.setFilterOpacityStyle(c[4],!0),g_objPropertyUtil.setFilterOpacityStyle(c[5],!0)),b.TBSTATE=a}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"TBSubMenuSetState")}};this.TBMenuSetState=function(b,a){try{switch(a=a.toLowerCase(),b.className){case g_strSkin_Menu_Area:case g_strSkin_Menu_AreaOver:case g_strSkin_Menu_AreaDown:case g_strSkin_Menu_AreaUp:if(a==ID_STRING_NAME_GRAY||a==ID_STRING_NAME_CHECKED||a==ID_STRING_NAME_UNCHECKED){var c=b.TBSTATE;a!=c&&(a==ID_STRING_NAME_CHECKED?
(b.className=g_strSkin_Menu_AreaUp,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_UNCHECKED?(b.className=g_strSkin_Menu_Area,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_GRAY&&(b.className=g_strSkin_Menu_Area,g_objPropertyUtil.setFilterOpacityStyle(b,!0)),b.TBSTATE=a)}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"TBMenuSetState")}};this.TBMenuSetStateAllEnable=function(b,a){try{for(var c=0;c<this.arrTBMenu[a].length;c++)b?
this.TBMenuSetState(this.arrTBMenu[a][c].element,ID_STRING_NAME_UNCHECKED):this.TBMenuSetState(this.arrTBMenu[a][c].element,ID_STRING_NAME_GRAY);!0===dzeUiConfig.bUseUiMode&&!0===dze_menu_control.ribbon_menu_created[a]&&dze_menu_control.RibbonMenuSetStateAllEnable(b,a)}catch(d){g_objCommonUtil.displayErrorAlert(d,"TBMenuSetStateAllEnable")}};this.TBMenuShowMenuState=function(b,a,c){try{var d=this.arrTBMenu[c][b].element;if(d.TBSTATE!=ID_STRING_NAME_GRAY)if(a&&(this.bMenuDisplayToggle=!this.bMenuDisplayToggle),
this.bMenuDisplayToggle)for(a=0;a<this.arrTBMenu[c].length;a++)a==b?ID_STRING_NAME_CHECKED!=this.arrTBMenu[c][a].element.TBSTATE&&(this.TBMenuSetState(d,ID_STRING_NAME_CHECKED),this.showMenuLayer(b,c),g_bDynamicLayer=this.bMenuLayerShow=!0):ID_STRING_NAME_CHECKED==this.arrTBMenu[c][a].element.TBSTATE&&this.TBMenuSetState(this.arrTBMenu[c][a].element,ID_STRING_NAME_UNCHECKED);else this.bMenuLayerShow&&(g_objLayerEventUtil.initHideDynamicLayer(),d.className=g_strSkin_Menu_AreaOver)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"TBMenuShowMenuState")}};this.TBMenuCloseMenuState=function(){try{if(this.bMenuLayerShow)for(var b=0;b<this.arrTBMenu[g_nActiveEditNumber].length;b++)ID_STRING_NAME_CHECKED==this.arrTBMenu[g_nActiveEditNumber][b].element.TBSTATE&&this.TBMenuSetState(this.arrTBMenu[g_nActiveEditNumber][b].element,ID_STRING_NAME_UNCHECKED);this.bMenuLayerShow=this.bMenuDisplayToggle=!1}catch(a){g_objCommonUtil.displayErrorAlert(a,"TBMenuCloseMenuState")}};this.TBMenuButtonMouseOver=function(b,a,c,d){try{d&&TBCancelBubbleEvent(b);
var e=this.arrTBMenu[c][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:g_strSkin_Menu_AreaOver,this.TBMenuShowMenuState(a,!1,c))}catch(f){g_objCommonUtil.displayErrorAlert(f,"TBMenuButtonMouseOver")}};this.TBMenuButtonMouseOut=function(b,a,c,d){try{d&&TBCancelBubbleEvent(b);var e=this.arrTBMenu[c][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:g_strSkin_Menu_Area)}catch(f){g_objCommonUtil.displayErrorAlert(f,
"TBMenuButtonMouseOut")}};this.TBMenuButtonMouseDown=function(b,a,c,d){try{d&&TBCancelBubbleEvent(b);var e=this.arrTBMenu[c][a].element;if(e.TBSTATE!=ID_STRING_NAME_GRAY){if(e.TBSTATE==ID_STRING_NAME_CHECKED)e.className=g_strSkin_Menu_AreaUp;else if(e.TBSTATE==ID_STRING_NAME_UNCHECKED){if(e.className=g_strSkin_Menu_AreaDown,g_bDynamicLayer){g_objLayerEventUtil.initHideDynamicLayer();g_objCommonUtil.log("g_bDynamicLayer:"+g_bDynamicLayer);return}}else e.className=g_strSkin_Menu_AreaDown;this.TBMenuShowMenuState(a,
!0,c)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"TBMenuButtonMouseDown")}};this.TBMenuButtonMouseUp=function(b,a,c,d){try{d&&TBCancelBubbleEvent(b)}catch(e){g_objCommonUtil.displayErrorAlert(e,"TBMenuButtonMouseUp")}};this.queryStatusMenuItem=function(b,a){try{var c={};c.element=b;c.menuIndex=a;c.element.TBSTATE=ID_STRING_NAME_UNCHECKED;return c}catch(d){g_objCommonUtil.displayErrorAlert(d,"queryStatusMenuItem")}return null};this.TBInitMenuButton=function(b,a){try{if(g_bMenuBar_Display){this.arrTBMenu[a][this.arrTBMenu[a].length]=
this.queryStatusMenuItem(b,this.arrTBMenu[a].length);var c=this.arrTBMenu[a].length-1;b.onmouseover=function(b){g_objMenuWin.TBMenuButtonMouseOver(b,c,a,!0)};b.onmouseout=function(b){g_objMenuWin.TBMenuButtonMouseOut(b,c,a,!0)};b.onmousedown=function(b){g_objMenuWin.TBMenuButtonMouseDown(b,c,a,!0)};b.onmouseup=function(b){g_objMenuWin.TBMenuButtonMouseUp(b,c,a,!0)};b.ondragstart=TBCancelBubbleEvent;b.onselectstart=TBCancelBubbleEvent;b.onselect=TBCancelBubbleEvent;b.onclick=TBCancelBubbleEvent;b.className=
g_strSkin_Menu_Area;b.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!0)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"TBInitMenuButton")}}};

var comboBoxWin=function(){var k=this;this.objComboBoxLayer=null;this.objComboBoxLayerSub=[];this.bComboBoxDisplay=!1;this.arrFontSizeText=[];this.arrFontSize=" 8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 19pt 20pt 22pt 24pt 26pt 30pt 36pt".split(" ");this.arrHeadingText="\uae30\ubcf8;\uc81c\ubaa9 1;\uc81c\ubaa9 2;\uc81c\ubaa9 3;\uc81c\ubaa9 4;\uc81c\ubaa9 5".split(";");this.arrHeadingBlock=" h1 h2 h3 h4 h5 h6".split(" ");this.strComboBoxCommand="";comboBoxWin.prototype.initializeHeadingText=
function(){this.arrHeadingText[0]=ID_RES_CONST_STRING_STYLE_STYLE_BASIC;this.arrHeadingText[1]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1;this.arrHeadingText[2]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2;this.arrHeadingText[3]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3;this.arrHeadingText[4]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4;this.arrHeadingText[5]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5};comboBoxWin.prototype.initializeFontSizeText=function(){this.arrFontSizeText[0]=ID_RES_COMBOBOX_REMOVE_FONT_SIZE;
this.arrFontSizeText[1]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[2]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[3]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[4]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[5]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[6]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[7]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[8]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[9]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_24;
this.arrFontSizeText[10]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_36};comboBoxWin.prototype.initializeComboBoxLayer=function(){try{if(null==this.objComboBoxLayer){this.initializeFontSizeText();var b='<div id="divComboBoxSelect" style="position:absolute; display:none; z-index:20031">';b+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';for(var d='<table id="ComboBoxItem_FontName" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">',
c=0;c<g_arrFontName.length;c++)d+='<tr><td style="line-height:normal">',d+='<table id="ComboBoxItem_FontName_Sub_'+c+'"  cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',d=""==g_arrFontName[c]?d+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:10px;'>"+ID_RES_COMBOBOX_REMOVE_FONT_FAMILY+"</td>"):d+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:10px;font-family:"+
g_arrFontName[c]+";'>"+g_arrFontName[c].replace(/["']/g,"")+"</td>"),d+="</tr></table>",d+="</td></tr>";d+="</table>";"undefined"!=typeof dzeUiConfig.arrCustomFontSize&&0<dzeUiConfig.arrCustomFontSize.length&&(this.arrFontSize=dzeUiConfig.arrCustomFontSize);var a='<table id="ComboBoxItem_FontSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';for(c=0;c<this.arrFontSize.length;c++)a+='<tr><td style="line-height:normal;">',a+='<table id="ComboBoxItem_FontSize_Sub_'+
c+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',a=0==c?a+('<td style="line-height:normal;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrFontSizeText[c]+"</td>"):a+('<td style="line-height:normal;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrFontSize[c]+"</td>"),a+="</tr></table>",
a+="</td></tr>";a+="</table>";var f='<table id="ComboBoxItem_HeadingSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';this.initializeHeadingText();for(c=0;c<this.arrHeadingText.length;c++){f+='<tr><td style="line-height:normal;padding:0;">';f+='<table id="ComboBoxItem_HeadingSize_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>';var e=this.arrHeadingBlock[c];f=0==c?f+('<td style="line-height:0;text-align:left;font-family:'+
ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrHeadingText[c]+"</td>"):f+('<td style="line-height:0;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px"><'+e+">"+this.arrHeadingText[c]+"</"+e+"></td>");f+="</tr></table>";f+="</td></tr>"}f+="</table>";b+=d;b+=a;b+=f;b+="</td></tr></table>";b+="</div>";if(g_objLayerKit.getElementById("divComboBoxSelect")||g_objInsertUtil.insertLayerHTML(b,
!0))this.objComboBoxLayer=g_objLayerKit.getElementById("divComboBoxSelect"),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_FontName"),g_arrFontName.length,0),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_FontSize"),this.arrFontSize.length,1),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_HeadingSize"),
this.arrHeadingText.length,2)}}catch(h){g_objCommonUtil.displayErrorAlert(h,"initializeComboBoxLayer")}};comboBoxWin.prototype.initComboBoxSubItem=function(b,d,c){try{var a={};a.element=b;a.subItem=[];for(var f=b.id,e=0;e<d;e++){a.subItem[e]=g_objLayerKit.getElementById(f+"_Sub_"+e);a.subItem[e].onmouseout=function(a){k.fnComboBoxItemOut(this)};a.subItem[e].onmousedown=TBCancelBubbleEvent;a.subItem[e].onmouseup=TBCancelBubbleEvent;var h=a.subItem[e];(function(){var a="";0==c?a=g_arrFontName[e]:1==
c?a=k.arrFontSize[e]:2==c&&(a=e);h.onclick=function(b){!0===dzeUiConfig.bTBPreviewLetterOperation&&(k.objComboBoxLayer.onmouseleave=function(){});k.setComboBox(a)};h.onmouseover=function(){k.fnComboBoxItemOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&k.setComboBox(a,!1)}})()}window.attachEvent?a.element.oncontextmenu=fnReturnFalsePropagation:a.element.addEventListener("contextmenu",fnReturnFalsePropagation,!1);return a}catch(g){g_objCommonUtil.displayErrorAlert(g,"initComboBoxSubItem")}return null};
comboBoxWin.prototype.initComboBoxLayerEvent=function(){try{null!=this.objComboBoxLayer&&this.bComboBoxDisplay&&(this.objComboBoxLayerSub[0].element.style.display="none",this.objComboBoxLayerSub[1].element.style.display="none",this.objComboBoxLayerSub[2].element.style.display="none",this.objComboBoxLayer.style.display="none",this.strComboBoxCommand="",this.bComboBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objComboBoxLayer=null,this.objComboBoxLayerSub=[])}catch(b){g_objCommonUtil.displayErrorAlert(b,
"initComboBoxLayerEvent")}};comboBoxWin.prototype.showComboBoxLayer=function(b,d){try{if(this.initializeComboBoxLayer(),null!=this.objComboBoxLayer){g_nActiveEditNumber=d;g_nLetterOperationType=b;var c=0;if(0==b){var a=handlerUI.getCommandUpdateIndex(d,ID_COMMAND_FONT_NAME);-1!=a&&(c=a)}else if(1==b)a=handlerUI.getCommandUpdateIndex(d,ID_COMMAND_FONT_SIZE),-1!=a&&(c=a);else if(2==b)a=handlerUI.getCommandUpdateIndex(d,ID_COMMAND_HEADING_SIZE),-1!=a&&(c=a),g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE;
else return;var f=g_TBComboBox[d][c].element;if(null!=f)if(this.bComboBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{var e=g_objPropertyUtil.getSelectionAttributeValue(d);if("undefined"!=typeof e&&null!=e){if(0==b){if("undefined"==typeof e[0]||null==e[0])e[0]="";for(var h=updateHandlerUI.getMappingIndex_FontName(e[0],d),g=0;g<g_arrFontName.length;g++)this.objComboBoxLayerSub[b].subItem[g].className=h==g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out}else if(1==b){if("undefined"==
typeof e[1]||null==e[1])e[1]="";h=updateHandlerUI.getMappingIndex_FontSize(e[1],d);for(g=0;g<this.arrFontSize.length;g++)this.objComboBoxLayerSub[b].subItem[g].className=h==g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out}else if(2==b)for(h=updateHandlerUI.getMappingIndex_Heading(d),g=0;g<this.arrHeadingText.length;g++)this.objComboBoxLayerSub[b].subItem[g].className=h==g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out;this.strComboBoxCommand=g_TBComboBox[d][c].element.command;this.bComboBoxDisplay=
!0;this.objComboBoxLayerSub[b].element.style.display="";g_objLayerEventUtil.showLayerWin(this.objComboBoxLayer,f,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,dzeUiConfig.bTBPreviewLetterOperation);g_objTableSelection.setTableObjectOnCaret(d);!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objUndoRedo.registerUndoRedoStack(0,d),GetMultiCellSelection()&&g_objLayerEventUtil.saveTableSelectedCellHTML(g_objTable),this.objComboBoxLayer.onmouseleave=function(){GetMultiCellSelection()?g_objLayerEventUtil.restoreTableSelectedCellHTML(g_objTable):
(g_objUndoRedo.registerUndoRedoStack(0,d),g_objUndoRedo.operateUndoRedoStack(!0,!0,d))})}}}}catch(l){g_objCommonUtil.displayErrorAlert(l,"showComboBoxLayer")}};comboBoxWin.prototype.setupComboBoxLabel=function(b,d){try{this.initializeHeadingText();var c="";if(ID_COMMAND_FONT_NAME==d){for(var a=0;a<g_arrFontName.length;a++)c+="<span style='display:none;line-height:normal;'>"+g_arrFontName[a]+"</span>";b.innerHTML=c}else if(ID_COMMAND_FONT_SIZE==d){for(a=0;a<g_objComboBoxWin.arrFontSize.length;a++)c+=
"<span style='display:none;line-height:normal;'>"+g_objComboBoxWin.arrFontSize[a]+"</span>";b.innerHTML=c}else if(ID_COMMAND_HEADING_SIZE==d){for(a=0;a<g_objComboBoxWin.arrHeadingText.length;a++)c+="<span style='display:none;line-height:normal;'>"+g_objComboBoxWin.arrHeadingText[a]+"</span>";b.innerHTML=c}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setupComboBoxLabel")}};comboBoxWin.prototype.fnComboBoxItemOver=function(b){try{b.className!=g_strSkin_ComboBoxItem_Down&&(b.className=g_strSkin_ComboBoxItem_Over)}catch(d){g_objCommonUtil.displayErrorAlert(d,
"fnComboBoxItemOver")}};comboBoxWin.prototype.fnComboBoxItemOut=function(b){try{b.className!=g_strSkin_ComboBoxItem_Down&&(b.className=g_strSkin_ComboBoxItem_Out)}catch(d){g_objCommonUtil.displayErrorAlert(d,"fnComboBoxItemOut")}};comboBoxWin.prototype.setComboBox=function(b,d){try{var c=!0;"undefined"!=typeof d&&(c=d);if(""!=g_objComboBoxWin.strComboBoxCommand){if(GetMultiCellSelection())g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY?g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,
b,g_nActiveEditNumber):g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,b,g_nActiveEditNumber):g_nLetterOperationType==ID_LETTER_OPERATION_HEADING_SIZE&&g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,g_objComboBoxWin.arrHeadingBlock[b],g_nActiveEditNumber),setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",g_nActiveEditNumber)}catch(g){}},100);else if(window.attachEvent){var a=
g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(a))return;var f=a.type;f=f.toLowerCase();if(ID_STRING_NAME_NONE==f||ID_STRING_NAME_TEXT==f){var e=a.createRange();if(fnObjectCheckNull(e))return;g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY?g_objLetterFn.setLetterOperation(g_nLetterOperationType,b,e,g_nActiveEditNumber,!0):g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?g_objLetterFn.setLetterOperation(g_nLetterOperationType,b,e,g_nActiveEditNumber,!0):g_nLetterOperationType==
ID_LETTER_OPERATION_HEADING_SIZE&&g_objLetterFn.setLetterOperation_HeadingSize(0,g_objComboBoxWin.arrHeadingBlock[b],g_nActiveEditNumber)}setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(f,g_nActiveEditNumber)}catch(g){}},10)}else{f=getSelectionTypeForUpdateUI();if(ID_STRING_NAME_NONE==f||ID_STRING_NAME_TEXT==f)if(g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY){a=g_objEditWindow[g_nActiveEditNumber].getSelection();var h=a.getRangeAt(0);g_objLetterFn.setLetterOperation(g_nLetterOperationType,
b,h,g_nActiveEditNumber,!0)}else g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?(a=g_objEditWindow[g_nActiveEditNumber].getSelection(),h=a.getRangeAt(0),g_objLetterFn.setLetterOperation(g_nLetterOperationType,b,h,g_nActiveEditNumber,!0)):g_nLetterOperationType==ID_LETTER_OPERATION_HEADING_SIZE&&g_objLetterFn.setLetterOperation_HeadingSize(0,g_objComboBoxWin.arrHeadingBlock[b],g_nActiveEditNumber);setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(f,g_nActiveEditNumber)}catch(g){}},
10)}0!=c&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(g_nActiveEditNumber);0!=c&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}}catch(g){g_objCommonUtil.displayErrorAlert(g,"setComboBox")}}},g_objComboBoxWin=new comboBoxWin;

var g_objContextMenuWin=new function(){this.arrTBContextMenuItem=[];this.arrTBContextMenuItem[0]=[];this.arrTBContextMenuItem[1]=[];this.arrTBContextMenuItem[2]=[];this.arrTBContextMenuItem[3]=[];this.arrTBContextMenuItem[4]=[];this.ID_CONTEXT_TYPE_CASE_GENERAL=0;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE=1;this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI=2;this.ID_CONTEXT_TYPE_CASE_CONTROL=3;this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU=4;this.nContextMenuCount=5;this.nActiveContextMenu=0;this.objContextMenuLayer=[];
this.objContextMenuLayer[0]=null;this.objContextMenuLayer[1]=null;this.objContextMenuLayer[2]=null;this.objContextMenuLayer[3]=null;this.objContextMenuLayer[4]=null;this.bContextMenuAttachMouseEvent=!1;this.arrContextMenu_TableMiniMenu=[ID_COMMAND_SELECT_ALL,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_TABLE_DELETE_TABLE,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_OUTDENT,ID_COMMAND_INDENT];this.initializeContextMenuLayer=
function(){try{for(var b=0;b<this.nContextMenuCount&&null==this.objContextMenuLayer[b];b++){var a="<div id='divContextMenu_"+b+"' class='ContextMenuContainer'>";a+="<table cellpadding=0 cellspacing=0 border=0 width='100%'><tr><td>";a+="<table cellpadding=0 cellspacing=0 border=0 class='"+g_strSkin_MenuWin+"'><tr><td>";a+=this.buildContextMenuContent(b);a+="</td></tr></table>";a+="</td></tr></table>";a+="</div>";if(!g_objLayerKit.getElementById("divContextMenu_"+b)&&!g_objInsertUtil.insertLayerHTML(a,
!0))break;this.objContextMenuLayer[b]=g_objLayerKit.getElementById("divContextMenu_"+b);this.setupContextMenuEvent(b);this.objContextMenuLayer[b].style.display="none";g_objNodeUtil.initFalsePropagationEvent(this.objContextMenuLayer[b])}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initializeContextMenuLayer")}};this.buildContextMenuContent=function(b){try{var a="";a+='<table class="MenuContent" cellpadding=0 cellspacing=0 style="border-collapse:separate;">';a+=g_objMenuWin.buildMenuItem_Margin();
if(this.ID_CONTEXT_TYPE_CASE_GENERAL==b)for(var c=0;c<dzeUiConfig.arrContextMenu_General.length;c++)ID_TYPE_MENU_SEPARATOR==dzeUiConfig.arrContextMenu_General[c]?(a+=g_objMenuWin.buildMenuItem_Garbage(),a+=g_objMenuWin.buildMenuItem_Separator(),a+=g_objMenuWin.buildMenuItem_Garbage()):a+=g_objMenuWin.buildMenuItem(dzeUiConfig.arrContextMenu_General[c],!0);else if(this.ID_CONTEXT_TYPE_CASE_TABLE_ONE==b)for(c=0;c<dzeUiConfig.arrContextMenu_OneCell.length;c++)if(ID_TYPE_MENU_SEPARATOR==dzeUiConfig.arrContextMenu_OneCell[c])a+=
g_objMenuWin.buildMenuItem_Garbage(),a+=g_objMenuWin.buildMenuItem_Separator(),a+=g_objMenuWin.buildMenuItem_Garbage();else{if(dzeUiConfig.arrContextMenu_OneCell[c]!=ID_CUSTOM_LOCK_EDIT_CELL||!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode)if(dzeUiConfig.arrContextMenu_OneCell[c]!=ID_CUSTOM_EXTERNAL_DATA_AREA||!1!==dzeUiConfig.bUseDataBinding)a+=g_objMenuWin.buildMenuItem(dzeUiConfig.arrContextMenu_OneCell[c],!0)}else if(this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI==b)for(c=0;c<dzeUiConfig.arrContextMenu_MultiCell.length;c++)if(ID_TYPE_MENU_SEPARATOR==
dzeUiConfig.arrContextMenu_MultiCell[c])a+=g_objMenuWin.buildMenuItem_Garbage(),a+=g_objMenuWin.buildMenuItem_Separator(),a+=g_objMenuWin.buildMenuItem_Garbage();else{if(dzeUiConfig.arrContextMenu_OneCell[c]!=ID_CUSTOM_LOCK_EDIT_CELL||!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode)a+=g_objMenuWin.buildMenuItem(dzeUiConfig.arrContextMenu_MultiCell[c],!0)}else if(this.ID_CONTEXT_TYPE_CASE_CONTROL==b)for(c=0;c<dzeUiConfig.arrContextMenu_Control.length;c++)ID_TYPE_MENU_SEPARATOR==
dzeUiConfig.arrContextMenu_Control[c]?(a+=g_objMenuWin.buildMenuItem_Garbage(),a+=g_objMenuWin.buildMenuItem_Separator(),a+=g_objMenuWin.buildMenuItem_Garbage()):a+=g_objMenuWin.buildMenuItem(dzeUiConfig.arrContextMenu_Control[c],!0);else if(this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU==b)for(c=0;c<this.arrContextMenu_TableMiniMenu.length;c++)ID_TYPE_MENU_SEPARATOR==this.arrContextMenu_TableMiniMenu[c]?(a+=g_objMenuWin.buildMenuItem_Garbage(),a+=g_objMenuWin.buildMenuItem_Separator(),a+=g_objMenuWin.buildMenuItem_Garbage()):
a+=g_objMenuWin.buildMenuItem(this.arrContextMenu_TableMiniMenu[c],!0);a+=g_objMenuWin.buildMenuItem_Margin();return a+"</table>"}catch(f){g_objCommonUtil.displayErrorAlert(f,"buildContextMenuContent")}};this.setupContextMenuEvent=function(b){try{var a=g_objLayerKit.getElementById("divContextMenu_"+b);this.setupContextMenuItemEvent(b,a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setupContextMenuEvent")}};this.setupContextMenuItemEvent=function(b,a){try{switch(a.className){case "MenuItem":var c=
a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmouseout=function(a){g_objMenuWin.setMenuItemMouseOut(this)};a.onmousedown=TBCancelBubbleEvent;a.onmouseup=function(a){eval(g_arrConst[c][3])(a,this,-1)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBCancelBubbleEvent;a.command=g_arrConst[c][0];a.commandtype=ID_COMMAND_TYPE_CONTEXT_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=c;
a.support_type=g_arrConst[c][4];a.support_control_type=g_arrConst[c][5];var f=this.arrTBContextMenuItem[b].length;this.arrTBContextMenuItem[b][f]=a;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE==b?handlerUI.setContextUpdateIndex(b,c,f):this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI==b&&handlerUI.setContextUpdateIndex(b,c,f)}var e=g_objNodeUtil.getChildrenCollection(a);if(null!=e&&0!=e.length)for(a=0;a<e.length;a++)this.setupContextMenuItemEvent(b,e[a])}catch(m){g_objCommonUtil.displayErrorAlert(m,"setupContextMenuItemEvent")}};
this.initContextMenuLayerEvent=function(){try{if(g_objCommonUtil.log("initContextMenuLayerEvent"),duzon_menubar.hideTwoDepthMenu(),null!=this.objContextMenuLayer){for(var b=0;b<this.objContextMenuLayer.length;b++)fnObjectCheckNull(this.objContextMenuLayer[b])||(this.objContextMenuLayer[b].style.display="none");this.bContextMenuAttachMouseEvent&&(this.bContextMenuAttachMouseEvent=!1,g_objLayerEventUtil.removeLayerEvent());for(b=0;b<this.objContextMenuLayer.length;b++)fnObjectCheckNull(this.objContextMenuLayer[b])||
(this.objContextMenuLayer[b]=null)}}catch(a){g_objCommonUtil.displayErrorAlert(a,"initContextMenuLayerEvent")}};this.showContextMenuLayer=function(b,a,c,f){try{if(this.initializeContextMenuLayer(),null!=this.objContextMenuLayer){var e=b.nContextMenuType,m=b.nUICase,h=b.nUISplitCase,g=b.nUINoSelectedCaseRow,d=b.nUINoSelectedCaseCol,n=b.strSelectedTagName;if(this.bContextMenuAttachMouseEvent)g_objLayerEventUtil.initHideDynamicLayer();else for(this.display_context_menuItem(e,m,h,g,d,n,a,c,f),this.bContextMenuAttachMouseEvent=
g_bDynamicLayer=!0,b=0;b<this.objContextMenuLayer.length;b++)if(""==this.objContextMenuLayer[b].style.display){g_objLayerEventUtil.objCurrentLayer=this.objContextMenuLayer[b];g_objLayerEventUtil.addLayerEvent();break}}}catch(k){g_objCommonUtil.displayErrorAlert(k,"showContextMenuLayer")}};this.getContextMenuType=function(b,a){try{var c=null;c=window.attachEvent?g_objEditorDocument[a].parentWindow.event:b;if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[a].selection.type.toLowerCase()){var f=
g_objEditorDocument[a].selection.createRange();if(1==f.length){var e=f.item(0).tagName.toLowerCase();return"table"==e||"img"==e?{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_CONTROL,nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:e}:null}return null}}else{var m=getSelectionType();g_objCommonUtil.log("objNodeInfo.nodeType:"+m.nodeType);if(ID_SELECTION_ELEMENT_NODE==m.nodeType)if(1==m.length){f=!1;var h=getSelectionElementNode(a);if(fnObjectCheckNull(h))if(g_bBrowserType_WK||
g_bBrowserType_OP||g_bBrowserType_IE)f=!0;else return null;if(!f){e=h.nodeName.toLowerCase();g_objCommonUtil.log("strTagName:"+e);if("table"==e||"img"==e)return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_CONTROL,nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:e};if("br"!=e&&"#text"!=e&&"a"!=e)return null}}else{if("tr"!=m.nodeName.toLowerCase())return null}else if(ID_SELECTION_TEXT_NODE!=m.nodeType&&ID_SELECTION_DUPLICATE!=m.nodeType)return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,
nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:""}}if(2==g_nFormEditMode&&(null==g_objTable||!g_objEditMode.getLoopContentEditable(g_objTable)))return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:""};dzeUiConfig.bUseLockEditCellFunction&&!g_objTable&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(a));var g=g_objTableSelection.CheckTableSelection(g_objEditorDocument[a],
g_objTable,a);if(null==g){g_objTableSelection.table_OnEventMouseDown(g_objEditorDocument[a],b,a);var d=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[a],a);return null!=d?(updateTableHandlerUI.updateTableUIHandler(d[0],d[1],d[2],d[3],a),1==d[0]||6==d[0]?{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,nUICase:d[0],nUISplitCase:d[1],nUINoSelectedCaseRow:d[2],nUINoSelectedCaseCol:d[3],strSelectedTagName:""}:{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,nUICase:d[0],nUISplitCase:d[1],
nUINoSelectedCaseRow:d[2],nUINoSelectedCaseCol:d[3],strSelectedTagName:""}):{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,nUICase:0,nUISplitCase:0,nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:""}}if(1!=g[0]){e=!1;var n=g_objPositionUtil.getEditDocScrollPosition(g_objEditorDocument[a],a);if(e=g_objTableSelection.CheckTableSelectionPos(c.clientX+n.nScrollLeft,c.clientY+n.nScrollTop))return g_bForceNoSelectionChange=!0,updateTableHandlerUI.updateTableUIHandler(g[0],g[1],0,0,
a),{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,nUICase:g[0],nUISplitCase:g[1],nUINoSelectedCaseRow:0,nUINoSelectedCaseCol:0,strSelectedTagName:""};g_objTableSelection.table_OnEventMouseDown(g_objEditorDocument[a],b,a);d=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[a],a);null!=d&&updateTableHandlerUI.updateTableUIHandler(d[0],d[1],d[2],d[3],a)}else if(g_objTableSelection.table_OnEventMouseDown(g_objEditorDocument[a],b,a),d=g_objTableSelection.table_EndSelectionCell(g_objEditorDocument[a],
a),null!=d)return updateTableHandlerUI.updateTableUIHandler(d[0],d[1],d[2],d[3],a),1==d[0]||6==d[0]?{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,nUICase:d[0],nUISplitCase:d[1],nUINoSelectedCaseRow:d[2],nUINoSelectedCaseCol:d[3],strSelectedTagName:""}:{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,nUICase:d[0],nUISplitCase:d[1],nUINoSelectedCaseRow:d[2],nUINoSelectedCaseCol:d[3],strSelectedTagName:""}}catch(k){g_objCommonUtil.displayErrorAlert(k,"getContextMenuType")}return-1};this.display_context_menuItem=
function(b,a,c,f,e,m,h,g,d){try{if(b==this.ID_CONTEXT_TYPE_CASE_GENERAL){this.nActiveContextMenu=this.ID_CONTEXT_TYPE_CASE_GENERAL;g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo?(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].style.left=h+1+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].style.top=g+1+"px"):(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].style.left=h+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].style.top=g+
"px");this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].style.display="";this.set_context_menu_relative_position(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL]);g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,h,g,this.ID_CONTEXT_TYPE_CASE_GENERAL);updateHandlerUI.update_context_menu(b,null,null,d);var n=this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_GENERAL].getElementsByTagName("table");for(a=0;a<n.length;a++)if("MenuContent"==n[a].className)for(var k=
n[a].getElementsByTagName("tr"),l=0;l<k.length;l++)if(k[l].getAttribute("mbcode")&&k[l].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){k[l].style.display="none";k[l+1].style.display="none";k[l+2].style.display="none";k[l+3].style.display="none";break}else k[l].getAttribute("style")&&k[l].removeAttribute("style");c=!1;for(a=0;a<this.arrTBContextMenuItem[b].length;a++)if(this.arrTBContextMenuItem[b][a].command_id==ID_COMMAND_HYPERLINK_REMOVE&&"unchecked"==this.arrTBContextMenuItem[b][a].TBSTATE){c=
!0;break}if(1==c&&"dzeExtFile"==g_objPropContentLink.getPropContentParam(d).arrValue[3])for(a=0;a<n.length;a++)if("MenuContent"==n[a].className)for(k=n[a].getElementsByTagName("tr"),l=0;l<k.length;l++)if(k[l].getAttribute("mbcode")&&k[l].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){k[l].getAttribute("style")&&k[l].removeAttribute("style");k[l+1].getAttribute("style")&&k[l+1].removeAttribute("style");k[l+2].getAttribute("style")&&k[l+2].removeAttribute("style");k[l+3].getAttribute("style")&&k[l+
3].removeAttribute("style");break}}else b==this.ID_CONTEXT_TYPE_CASE_TABLE_ONE?(this.nActiveContextMenu=this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo?(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE].style.left=h+1+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE].style.top=g+1+"px"):(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE].style.left=h+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE].style.top=
g+"px"),this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE].style.display="",this.set_context_menu_relative_position(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE]),g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,h,g,this.ID_CONTEXT_TYPE_CASE_TABLE_ONE),updateHandlerUI.update_context_menu(b,null,null,d),updateTableHandlerUI.updateTableContextMenuUIHandler(a,c,f,e,this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,this.arrTBContextMenuItem[this.ID_CONTEXT_TYPE_CASE_TABLE_ONE])):
b==this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI?(this.nActiveContextMenu=this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo?(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI].style.left=h+1+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI].style.top=g+1+"px"):(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI].style.left=h+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI].style.top=g+"px"),this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI].style.display=
"",this.set_context_menu_relative_position(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI]),g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,h,g,this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI),updateHandlerUI.update_context_menu(b,null,null,d),updateTableHandlerUI.updateTableContextMenuUIHandler(a,c,0,0,this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,this.arrTBContextMenuItem[this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI])):b==this.ID_CONTEXT_TYPE_CASE_CONTROL?(this.nActiveContextMenu=
this.ID_CONTEXT_TYPE_CASE_CONTROL,g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo?(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL].style.left=h+1+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL].style.top=g+1+"px"):(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL].style.left=h+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL].style.top=g+"px"),this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL].style.display="",this.set_context_menu_relative_position(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_CONTROL]),
g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,h,g,this.ID_CONTEXT_TYPE_CASE_CONTROL),updateHandlerUI.update_context_menu(b,ID_STRING_NAME_CONTROL,m,d)):b==this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU&&(this.nActiveContextMenu=this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU,g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo?(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].style.left=h+1+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].style.top=
g+1+"px"):(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].style.left=h+"px",this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].style.top=g+"px"),this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].style.display="",this.set_context_menu_relative_position(this.objContextMenuLayer[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU]),g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,h,g,this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU),dzeUiConfig.bUseLockEditCellFunction&&
g_bHasLockedCell?g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU][1],ID_STRING_NAME_GRAY):g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU][1],ID_STRING_NAME_UNCHECKED))}catch(p){g_objCommonUtil.displayErrorAlert(p,"display_context_menuItem")}};this.ShowContextMenuDisplayInEditArea=function(b,a,c,f){try{var e=g_objPositionUtil.getElementPosition(g_objEditObject[b],!1),m=e.right,h=e.bottom,g=this.objContextMenuLayer[f].offsetWidth,
d=this.objContextMenuLayer[f].offsetHeight;a+g>m&&(this.objContextMenuLayer[f].style.left=m-g+"px");c+d>h&&(this.objContextMenuLayer[f].style.top=h-d+"px")}catch(n){g_objCommonUtil.displayErrorAlert(n,"ShowContextMenuDisplayInEditArea")}};this.set_context_menu_relative_position=function(b){var a=0,c=0;g_objLayerKit.getLayerWindow().innerWidth&&(a=g_objLayerKit.getLayerWindow().innerWidth);g_objLayerKit.getLayerWindow().innerHeight&&(c=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientWidth&&
(a=g_objLayerKit.getLayerDocument().documentElement.clientWidth);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&(c=g_objLayerKit.getLayerDocument().documentElement.clientHeight);var f=g_objLayerKit.getLayerDocument().documentElement.scrollLeft?g_objLayerKit.getLayerDocument().documentElement.scrollLeft:g_objLayerKit.getLayerDocument().body.scrollLeft;var e=g_objLayerKit.getLayerDocument().documentElement.scrollTop?g_objLayerKit.getLayerDocument().documentElement.scrollTop:g_objLayerKit.getLayerDocument().body.scrollTop;
c+=e;a+=f;f=parseInt(b.style.top.replace(/px/,""),10);e=b.offsetHeight;var m=parseInt(b.style.left.replace(/px/,""),10),h=b.offsetWidth;f+e>c&&(f-=f+e-c);m+h>a&&(m-=m+h-a);0>m&&(m=0);0>f&&(f=0);setWindowResizeEvent(!1);b.style.left=m+"px";b.style.top=f+"px";setWindowResizeEvent(!0)}};

var g_objPropForm=new function(){this.objTableInfo=this.objFormTableContainer=this.objFormTable=null;this.nDrawMaxRow=30;this.nDrawCellHeight=this.nDrawCellWidth=this.nDrawMaxCol=20;this.ID_DRAW_TYPE_20_COL=0;this.ID_DRAW_TYPE_100_COL=1;this.bShowPropForm=!1;this.bNewCreate=this.bGenerateColGroup=!0;this.buildPropForm=function(){try{var a="";a+='<table cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td colspan="3" style="height:5px"></td>';a+="</tr>";a+="<tr>";a+='<td colspan="3">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="10"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="2"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="propFormTableContainer" class="propSection_td" style="padding:10px;">';a+="</td>";a+='<td width="160" style="vertical-align:top;" class="propSection_td">';a+='<div style="margin:10px;border:0px">';a+=this.buildFormView();
a+="</div>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="2"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="10"></td>';a+="</tr>";a+="</table>";a+="</td>";return a+"</tr></table>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildPropForm")}};this.drawFormTable=function(a,b,c,f){try{var d="";d+='<table id="propFormTable" align="center" style="border-collapse:collapse;background-image: url('+dzeEnvConfig.strPath_Image+"dialog/bg_grid.gif);width:"+c*b+'px;" cellspacing="0" cellpadding="1">';
for(var e=0;e<a;e++){d+="<tr>";for(var g=0;g<b;g++){var h="border-left:",k="border-top:",l="border-right:",m="border-bottom:",n=e%5,p=g%5;0==n?(k+="1px dotted #888888;",m+="1px dotted #c0c0c0;"):4==n?(k+="1px dotted #c0c0c0;",m+="1px dotted #888888;"):(k+="1px dotted #c0c0c0;",m+="1px dotted #c0c0c0;");0==p?(h+="1px dotted #888888;",l+="1px dotted #c0c0c0;"):4==p?(h+="1px dotted #c0c0c0;",l+="1px dotted #888888;"):(h+="1px dotted #c0c0c0;",l+="1px dotted #c0c0c0;");d+='<td width="'+c+'" height="'+
f+'" style="'+(h+k+l+m)+'" posRow='+e+" posCol="+g+"></td>"}d+="</tr>"}return d+"</table>"}catch(q){g_objCommonUtil.displayErrorAlert(q,"drawFormTable")}};this.buildFormView=function(){try{var a="";a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_BASE_SIZE;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=ID_RES_DIALOG_STRING_SIZE+" (%) : ";a+='<select id="selFormDefineWidth" style="width:40px !important;background-color:#c0c0c0;"></select>';
a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=ID_RES_DIALOG_STRING_HEIGHT+" (px) : ";a+='<select id="selFormDefineHeight" style="width:40px !important;"></select>';a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<input id="chkKeepHeightYN" type="checkbox" value="1" />'+ID_RES_CONST_STRING_KEEP_ORG_HEIGHT+"<br />";a+=ID_RES_CONST_STRING_NEW_BLOCK_REFERENCE_HEIGHT;
a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_OUTLINE;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_SIZE+" : </td>";a+='<td width="6" style="border:0;"></td>';
a+='<td width="76" style="vertical-align:top;border:0;">';a+=duzon_dialog.makeSpinnerInputForm("txtFormBorderWidth","",10,0,"");a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_TYPE+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';
a+=g_objBorderComboBoxUtil.makeBorderComboBoxHTML("selFormBorderStyle",0,70,90);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtFormBorderColor",
70);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=g_objBorderSelectionUtil.makeBorderSelectionHTML(1,10,20,!1);a+="</div>";a+='<div style="margin:0;padding:0;height:10px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<img id="btnForm_Apply_Border" src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_strBrowserLanguage+'/prop_btn_apply.gif" alt="apply" border="0">';
a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_CONST_STRING_BACKGROUND_COLOR;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';
a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtFormBgColor",70);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<img id="btnForm_Apply_bgColor" src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_strBrowserLanguage+'/prop_btn_apply.gif" alt="apply" border="0">';a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_MULTI_SELECT;
a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_MULTI_OTHER_SELECT;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_COPY_PASTE;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_COPY_MOVE;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';
a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_RESIZE;a+="</div>";a+='<div style="margin:0;padding:0;height:50px;"></div>';a+='<div style="margin:0;padding:0;text-align:center;">';a+='<input type="button" id="btnForm_PreviewCreate" name="btnForm_PreviewCreate" value="'+ID_RES_DIALOG_STRING_FORM_PRE_APPLY+'" />';return a+"</div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildFormView")}};this.initPropForm=function(a){try{if(this.objFormTableContainer=g_objLayerKit.getElementById("propFormTableContainer"),
null!=this.objFormTableContainer){duzon_dialog.modifySpinnerValue("txtFormBorderWidth",10,0,0,"g_objPropForm.onChangeSpinnerValue");g_objBorderSelectionUtil.initBorderSelection();g_objBorderComboBoxUtil.initBorderComboBox("selFormBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a);g_objPropForm.updateBorderSelection()});g_objColorComboBoxUtil.initColorComboBox("txtFormBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a);g_objPropForm.updateBorderSelection()});g_objColorComboBoxUtil.initColorComboBox("txtFormBgColor");
this.objTableInfo=null;if(a){var b=g_objPropFormLoad.prepareLoadFormStructure(a);-1==b?(this.setFormDrawType(this.ID_DRAW_TYPE_20_COL),alert(ID_RES_CONST_STRING_CANNOT_READ_DOCUMENT_FORMAT+" - 1")):(this.setFormDrawType(b),this.objTableInfo=a,this.bNewCreate=!1)}else this.setFormDrawType(this.ID_DRAW_TYPE_20_COL);this.assignDrawFormTable(this.nDrawMaxRow,this.nDrawMaxCol,this.nDrawCellWidth,this.nDrawCellHeight);this.setPropFormEvent();null!=this.objTableInfo&&(g_objPropFormLoad.loadFormStructure(this.objTableInfo)?
window.setTimeout("g_objPropFormEvent.showAllAreaRectangle()",1E3):(this.objTableInfo=null,alert(ID_RES_CONST_STRING_CANNOT_READ_DOCUMENT_FORMAT+" - 2")));g_objPropFormSink.setupPropFormUI(null!=this.objTableInfo?!0:!1)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"initPropForm")}};this.onChangeSpinnerValue=function(a){try{g_objBorderSelectionUtil.setBorderWidth(a),g_objPropForm.updateBorderSelection()}catch(b){g_objCommonUtil.displayErrorAlert(b,"onChangeSpinnerValue")}};this.updateBorderSelection=
function(){try{g_objBorderSelectionUtil.getChecked("miniRec_v_0")&&g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0),g_objBorderSelectionUtil.getChecked("miniRec_h_0")&&g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0),g_objBorderSelectionUtil.getChecked("miniRec_v_2")&&g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0),g_objBorderSelectionUtil.getChecked("miniRec_h_2")&&g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0)}catch(a){g_objCommonUtil.displayErrorAlert(a,"onChangeSpinnerValue")}};
this.setPropFormEvent=function(){try{g_objPropFormEvent.resetFormInfo(),this.objFormTable.onmousedown=function(a){g_objPropFormEvent.propForm_onmousedown(a)},this.objFormTableContainer.onmousedown=function(a){g_objPropFormEvent.propFormContainer_onmousedown(a)}}catch(a){g_objCommonUtil.displayErrorAlert(a,"setPropFormEvent")}};this.assignDrawFormTable=function(a,b,c,f){try{if(null!=this.objFormTableContainer){var d=this.drawFormTable(a,b,c,f);this.objFormTableContainer.innerHTML=d;this.objFormTable=
g_objLayerKit.getElementById("propFormTable")}}catch(e){g_objCommonUtil.displayErrorAlert(e,"assignDrawFormTable")}};this.getFormDrawType=function(){try{if(20==this.nDrawMaxCol)return this.ID_DRAW_TYPE_20_COL;if(100==this.nDrawMaxCol)return this.ID_DRAW_TYPE_100_COL}catch(a){g_objCommonUtil.displayErrorAlert(a,"getFormDrawType")}return-1};this.setFormDrawType=function(a){try{a==this.ID_DRAW_TYPE_20_COL?(this.nDrawMaxRow=30,this.nDrawCellHeight=this.nDrawCellWidth=this.nDrawMaxCol=20,g_objPropFormCode.nBasisHeight=
25):a==this.ID_DRAW_TYPE_100_COL&&(this.nDrawMaxRow=80,this.nDrawMaxCol=100,this.nDrawCellHeight=this.nDrawCellWidth=6,g_objPropFormCode.nBasisHeight=14)}catch(b){g_objCommonUtil.displayErrorAlert(b,"setFormDrawType")}};this.applyGenerateFormCode=function(a,b,c){try{if(this.objTableInfo){g_objTableUtil.removeTableColGroupAll(this.objTableInfo);var f=g_objNodeUtil.getLoopChildNodeByTagName(this.objTableInfo,"tbody");if(f)this.objTableInfo.removeChild(f);else for(;;)if(0<this.objTableInfo.rows.length)this.objTableInfo.deleteRow(0);
else break;var d=a.codeTable,e=g_objNodeUtil.getLoopChildNodeByTagName(d,"colgroup");for(null!=e&&c&&this.objTableInfo.appendChild(e);;)if(0<d.rows.length){var g=g_objTableUtil.getTableRowElement(d,0);this.objTableInfo.appendChild(g)}else break}else if(g_objInsertUtil.insertTableCodeAtSelection(a.htmlCode,g_nActiveEditNumber),this.objTableInfo=g_objEditorDocument[g_nActiveEditNumber].getElementById(b))this.objTableInfo.removeAttribute("id"),c||g_objTableUtil.removeTableColGroupAll(this.objTableInfo)}catch(h){g_objCommonUtil.displayErrorAlert(h,
"applyGenerateFormCode")}};this.doApplyGenerateFormCode=function(){try{var a="newFormTable_"+g_objCommonUtil.getTimeCodeString(),b=g_objPropFormCode.generateFormCode(a,this.bNewCreate);null!=b&&this.applyGenerateFormCode(b,a,this.bGenerateColGroup)}catch(c){g_objCommonUtil.displayErrorAlert(c,"doApplyGenerateFormCode")}};this.hidePropForm=function(){try{g_objPropFormEvent.hideAllAreaRectangle(),this.bShowPropForm=!1}catch(a){g_objCommonUtil.displayErrorAlert(a,"hideFormTable")}};this.dummyAnchorFocus=
function(){try{var a=g_objLayerKit.getLayerDocument().createElement("a");a.href="";this.objFormTableContainer.appendChild(a);a.style.display="";a.focus();a.style.display="none"}catch(b){g_objCommonUtil.displayErrorAlert(b,"dummyAnchorFocus")}}};

var g_objPropFormEvent=new function(){this.arrEventPosInfo=this.objEventPosInfo=null;this.strSelectedColor="#ffffff";this.strGroupColor="#c0c0c0";this.nCurResizeIndex=this.nMoveIndex=-1;this.ID_SELECTED_COLOR=0;this.ID_GROUP_COLOR=1;this.ID_REMOVE_COLOR=2;this.resetFormInfo=function(){try{null!=this.arrEventPosInfo&&this.hideAllAreaRectangle(),this.arrEventPosInfo=[],this.objEventPosInfo=null}catch(a){g_objCommonUtil.displayErrorAlert(a,"resetFormInfo")}};this.newEventPosInfo=function(){try{var a=
{nStartClient_X:null,nStartClient_Y:null,bApplyEvent:!1,nStartRow:-1,nStartCol:-1,nEndRow:-1,nEndCol:-1,objOutlineUtil:null,nDragEventRow:-1,nDragEventCol:-1,nDragStartRow:-1,nDragStartCol:-1,nDragEndRow:-1,nDragEndCol:-1,bSelectedDown:!1,bDummyCell:!1,objDataCell:{}};a.objDataCell.innerHTML="";a.objDataCell.bChangeHeight=!0;a.objDataCell.width="";a.objDataCell.height="";a.objDataCell.align="";a.objDataCell.bgcolor="";a.objDataCell.arrBorderValue=null;a.objDataCell.strStyleString="";return a}catch(b){g_objCommonUtil.displayErrorAlert(b,
"newEventPosInfo")}};this.addDataPosInfo=function(a,b,c,d,e,f){try{c=a+c-1;d=b+d-1;var h=this.newEventPosInfo();h.nStartRow=a;h.nStartCol=b;h.nEndRow=c;h.nEndCol=d;h.objDataCell.innerHTML=e.innerHTML;h.objDataCell.bChangeHeight=!1;h.objDataCell.height=f;var k=e.getAttribute("align");h.objDataCell.align=null==k||""==k?"":k;var g=e.getAttribute("bgcolor");h.objDataCell.bgcolor=null==g||""==g?"":g;h.objDataCell.arrBorderValue=g_objPropertyUtil.getElementBorderStyleAttributeSet(e,g_nActiveEditNumber);
h.objDataCell.strStyleString=g_objPropertyUtil.getStyleStringByOption(e,!0,!0);this.initEventPosInfo(h,a,b,c,d);h.objOutlineUtil.setExtOutlineBorder(h.objDataCell.arrBorderValue);var l=this.getSelectedBackgroundColor(h);this.setAreaBackgroundColor(a,b,c,d,l);var p=this.arrEventPosInfo.length;this.arrEventPosInfo[p]=h;return p}catch(m){g_objCommonUtil.displayErrorAlert(m,"addDataPosInfo")}return null};this.initEventPosInfo=function(a,b,c,d,e){try{a.nStartRow=b;a.nStartCol=c;a.nEndRow=d;a.nEndCol=e;
var f=new outlineUtil;f.initializeExtOutline(!0);f.setZIndexExtOutline(20031);f.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_TOP].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT_TOP,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_TOP].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT_TOP,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT_BOTTOM].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT_BOTTOM,
a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT_BOTTOM].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT_BOTTOM,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_TOP].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_TOP,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_RIGHT].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_RIGHT,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_BOTTOM].onmousedown=
function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_BOTTOM,a)};f.arrObj_Outline_Rectangle[DZE_CTRL_PT_LEFT].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(DZE_CTRL_PT_LEFT,a)};a.objOutlineUtil=f}catch(h){g_objCommonUtil.displayErrorAlert(h,"initEventPosInfo")}};this.getEventPosInfo=function(a){try{var b=g_objNodeUtil.getEventSrcElement(document,a);if("td"!=g_objNodeUtil.getElementTagName(b).toLowerCase())return null;var c=b.getAttribute("posRow");
if(fnObjectCheckNull(c))return null;var d=b.getAttribute("posCol");if(fnObjectCheckNull(d))return null;c=parseInt(c);d=parseInt(d);return{posRow:c,posCol:d}}catch(e){g_objCommonUtil.displayErrorAlert(e,"getEventPosInfo")}return null};this.propFormContainer_onmousedown=function(a){try{null==this.getEventPosInfo(a)&&g_objPropFormKeyCode.keyDownEscape(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"propFormContainer_onmousedown")}};this.propForm_onmousedown=function(a){try{var b=this.getEventPosInfo(a);
if(null!=b)if(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),g_objPropFormKeyCode.bCtrlKeyDown){var c=this.checkInnerArea(b.posRow,b.posCol);if(-1!=c){if(-1!=this.nMoveIndex){var d=this.arrEventPosInfo[this.nMoveIndex];this.displayAreaRectangle(d.nStartRow,d.nStartCol,d.nEndRow,d.nEndCol,d.objOutlineUtil,!1,!0);this.nMoveIndex=-1}d=this.arrEventPosInfo[c];if(d.bSelectedDown){d.bSelectedDown=!1;var e=this.getSelectedBackgroundColor(d);this.setAreaBackgroundColor(d.nStartRow,
d.nStartCol,d.nEndRow,d.nEndCol,e)}else d.bSelectedDown=!0,this.setAreaBackgroundColor(d.nStartRow,d.nStartCol,d.nEndRow,d.nEndCol,this.strGroupColor);g_objPropFormSink.updatePropFormUI()}}else g_objPropFormKeyCode.bShiftKeyDown?-1==this.nCurResizeIndex||this.checkGroupSelected()||(c=this.checkInnerArea(b.posRow,b.posCol),-1!=c&&(this.arrEventPosInfo[this.nCurResizeIndex].bSelectedDown=!0,this.nCurResizeIndex=-1,this.arrEventPosInfo[c].bSelectedDown=!0,this.setSelectGroupInnerArea(),g_objPropFormSink.updatePropFormUI())):
(e=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,b.posRow,b.posCol).style.backgroundColor,null==e||""==e?(this.showAllAreaRectangle(),this.setGroupAreaBackgroundColor(!0,this.ID_SELECTED_COLOR,!1),g_objPropFormEventDraw.propForm_draw_onmousedown(a)):(c=this.checkInnerArea(b.posRow,b.posCol),-1!=c&&(this.arrEventPosInfo[c].bSelectedDown?(this.setGroupAreaBackgroundColor(!1,this.ID_SELECTED_COLOR,!1),g_objPropFormEventMove.propForm_move_onmousedown(a,b,c,!0)):(this.setGroupAreaBackgroundColor(!0,
this.ID_SELECTED_COLOR,!1),g_objPropFormEventMove.propForm_move_onmousedown(a,b,c,!1)))))}catch(f){g_objCommonUtil.displayErrorAlert(f,"propForm_onmousedown")}};this.checkSelectedArea=function(a,b,c,d,e){try{var f=this.getAdjustAreaPosRowCol(a,b,c,d);a=f.startRow;b=f.startCol;c=f.endRow;d=f.endCol;for(f=0;f<this.arrEventPosInfo.length;f++)if(f!=e){var h=this.arrEventPosInfo[f].nStartRow,k=this.arrEventPosInfo[f].nStartCol,g=this.arrEventPosInfo[f].nEndRow,l=this.arrEventPosInfo[f].nEndCol;if(h<=c&&
c<=g&&k<=d&&d<=l||h<=c&&c<=g&&k<=b&&b<=l||h<=a&&a<=g&&k<=d&&d<=l||h<=a&&a<=g&&k<=b&&b<=l||h<=c&&c<=g&&b<=k&&l<=d||h<=a&&a<=g&&b<=k&&l<=d||a<=h&&g<=c&&k<=d&&d<=l||a<=h&&g<=c&&k<=b&&b<=l||a<=h&&g<=c&&b<=k&&l<=d)return!0}return!1}catch(p){g_objCommonUtil.displayErrorAlert(p,"checkSelectedArea")}return!0};this.checkGroupSelectedArea=function(a,b){try{for(var c=0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.arrEventPosInfo[c];if(this.checkCellAreaBackgroundColor(d.nStartRow+
a,d.nStartCol+b,d.nEndRow+a,d.nEndCol+b))return!0}return!1}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkGroupSelectedArea")}return!0};this.checkCellAreaBackgroundColor=function(a,b,c,d){try{for(;a<=c;a++)for(var e=b;e<=d;e++){var f=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,e).style.backgroundColor;if(null!=f&&""!=f)return!0}return!1}catch(h){g_objCommonUtil.displayErrorAlert(h,"checkCellAreaBackgroundColor")}return!0};this.displayGroupAreaRectangle=function(a,b){try{for(var c=
0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.arrEventPosInfo[c];this.displayAreaRectangle(d.nStartRow+a,d.nStartCol+b,d.nEndRow+a,d.nEndCol+b,d.objOutlineUtil,!1,!0)}}catch(e){g_objCommonUtil.displayErrorAlert(e,"displayGroupAreaRectangle")}};this.displayAreaRectangle=function(a,b,c,d,e,f,h){try{if(null!=e){var k=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,b),g=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,c,d),l=g_objPositionUtil.getElementPosition(k,
dzeEnvConfig.iFrameLayer),p=g_objPositionUtil.getElementPosition(g,dzeEnvConfig.iFrameLayer),m=l.left<p.left?l.left:p.left,n=l.top<p.top?l.top:p.top,q=l.right<p.right?p.right:l.right,r=l.bottom<p.bottom?p.bottom:l.bottom;f?e.showExtOutline(!0,!0,!1,m,n,q,r,!0,!0):(h&&(this.nCurResizeIndex=-1),e.showExtOutline(!0,!1,!1,m,n,q,r,!1,!1))}}catch(t){g_objCommonUtil.displayErrorAlert(t,"displayAreaRectangle")}};this.convertAreaRectangle=function(){try{var a=this.getAreaPosRowCol();this.setAreaBackgroundColor(a.startRow,
a.startCol,a.endRow,a.endCol,this.strSelectedColor);this.objEventPosInfo.nStartRow=a.startRow;this.objEventPosInfo.nStartCol=a.startCol;this.objEventPosInfo.nEndRow=a.endRow;this.objEventPosInfo.nEndCol=a.endCol}catch(b){g_objCommonUtil.displayErrorAlert(b,"convertAreaRectangle")}};this.setAreaBackgroundColor=function(a,b,c,d,e){try{for(;a<=c;a++)for(var f=b;f<=d;f++)g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,f).style.backgroundColor=e}catch(h){g_objCommonUtil.displayErrorAlert(h,
"setAreaBackgroundColor")}};this.getAreaPosRowCol=function(){try{var a=this.getAdjustAreaPosRowCol(this.objEventPosInfo.nStartRow,this.objEventPosInfo.nStartCol,this.objEventPosInfo.nEndRow,this.objEventPosInfo.nEndCol);return{startRow:a.startRow,startCol:a.startCol,endRow:a.endRow,endCol:a.endCol}}catch(b){g_objCommonUtil.displayErrorAlert(b,"getAreaPosRowCol")}return null};this.getAdjustAreaPosRowCol=function(a,b,c,d){try{var e=-1,f=-1,h=-1,k=-1;a<c?(e=a,h=c):(e=c,h=a);b<d?(f=b,k=d):(f=d,k=b);return{startRow:e,
startCol:f,endRow:h,endCol:k}}catch(g){g_objCommonUtil.displayErrorAlert(g,"getAdjustAreaPosRowCol")}return null};this.showAllAreaRectangle=function(){try{for(var a=0;a<this.arrEventPosInfo.length;a++)this.displayAreaRectangle(this.arrEventPosInfo[a].nStartRow,this.arrEventPosInfo[a].nStartCol,this.arrEventPosInfo[a].nEndRow,this.arrEventPosInfo[a].nEndCol,this.arrEventPosInfo[a].objOutlineUtil,!1,!0)}catch(b){g_objCommonUtil.displayErrorAlert(b,"showAllAreaRectangle")}};this.hideAllAreaRectangle=
function(){try{if(null!=this.arrEventPosInfo)for(var a=0;a<this.arrEventPosInfo.length;a++)this.arrEventPosInfo[a].objOutlineUtil.showExtOutline(!1,!1,!1,0,0,0,0,!1,!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"hideAllAreaRectangle")}};this.setGroupAreaBackgroundColor=function(a,b,c){try{for(var d=0;d<this.arrEventPosInfo.length;d++)if(this.arrEventPosInfo[d].bSelectedDown){a&&(this.arrEventPosInfo[d].bSelectedDown=!1);var e=this.arrEventPosInfo[d].nStartRow,f=this.arrEventPosInfo[d].nStartCol,
h=this.arrEventPosInfo[d].nEndRow,k=this.arrEventPosInfo[d].nEndCol,g="";this.ID_SELECTED_COLOR==b?g=this.getSelectedBackgroundColor(this.arrEventPosInfo[d]):this.ID_GROUP_COLOR==b&&(g=this.strGroupColor);this.setAreaBackgroundColor(e,f,h,k,g);c&&(this.arrEventPosInfo[d].nDragStartRow=-1,this.arrEventPosInfo[d].nDragStartCol=-1,this.arrEventPosInfo[d].nDragEndRow=-1,this.arrEventPosInfo[d].nDragEndCol=-1)}}catch(l){g_objCommonUtil.displayErrorAlert(l,"setGroupAreaBackgroundColor")}};this.checkInnerArea=
function(a,b){try{for(var c=0;c<this.arrEventPosInfo.length;c++){var d=this.arrEventPosInfo[c].nStartCol,e=this.arrEventPosInfo[c].nEndRow,f=this.arrEventPosInfo[c].nEndCol;if(this.arrEventPosInfo[c].nStartRow<=a&&a<=e&&d<=b&&b<=f)return c}}catch(h){g_objCommonUtil.displayErrorAlert(h,"checkInnerArea")}return-1};this.checkAvailablePasteArea=function(a,b,c,d){try{var e=c-a+1,f=a+e;for(c+=e;!(c>g_objPropForm.nDrawMaxRow-1);){if(0==this.checkCellAreaBackgroundColor(f,b,c,d))return e=f-a,{posStartRow:f,
posStartCol:b,posEndRow:c,posEndCol:d,diffRow:e};f++;c++}}catch(h){g_objCommonUtil.displayErrorAlert(h,"checkAvailablePasteArea")}return null};this.checkAreaMinMax=function(a,b,c,d){try{return 0>a||0>b||c>g_objPropForm.nDrawMaxRow-1||d>g_objPropForm.nDrawMaxCol-1?!1:!0}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkAreaMinMax")}};this.checkGroupSelected=function(){try{for(var a=0;a<this.arrEventPosInfo.length;a++)if(this.arrEventPosInfo[a].bSelectedDown)return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,
"checkGroupSelected")}return!1};this.setSelectGroupInnerArea=function(){try{for(var a=-1,b=-1,c=-1,d=-1,e=0;e<this.arrEventPosInfo.length;e++)if(this.arrEventPosInfo[e].bSelectedDown){var f=this.arrEventPosInfo[e].nStartRow,h=this.arrEventPosInfo[e].nStartCol,k=this.arrEventPosInfo[e].nEndRow,g=this.arrEventPosInfo[e].nEndCol,l=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,f,h),p=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,k,g),m=g_objPositionUtil.getElementPosition(l,
!1),n=g_objPositionUtil.getElementPosition(p,!1),q=m.left<n.left?m.left:n.left,r=m.top<n.top?m.top:n.top,t=m.right<n.right?n.right:m.right,u=m.bottom<n.bottom?n.bottom:m.bottom;-1==a?(a=q,b=r,c=t,d=u):(a>q&&(a=q),b>r&&(b=r),c<t&&(c=t),d<u&&(d=u))}for(e=0;e<this.arrEventPosInfo.length;e++)this.arrEventPosInfo[e].bSelectedDown||(f=this.arrEventPosInfo[e].nStartRow,h=this.arrEventPosInfo[e].nStartCol,k=this.arrEventPosInfo[e].nEndRow,g=this.arrEventPosInfo[e].nEndCol,l=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,
f,h),p=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,k,g),m=g_objPositionUtil.getElementPosition(l,!1),n=g_objPositionUtil.getElementPosition(p,!1),q=m.left<n.left?m.left:n.left,r=m.top<n.top?m.top:n.top,t=m.right<n.right?n.right:m.right,u=m.bottom<n.bottom?n.bottom:m.bottom,a<=q&&b<=r&&c>=t&&d>=u&&(this.arrEventPosInfo[e].bSelectedDown=!0));this.showAllAreaRectangle();this.setGroupAreaBackgroundColor(!1,this.ID_GROUP_COLOR,!1)}catch(v){g_objCommonUtil.displayErrorAlert(v,"setSelectGroupInnerArea")}};
this.getSelectedBackgroundColor=function(a){try{if(null==a.objDataCell)return this.strSelectedColor;var b=a.objDataCell.bgcolor;return null==b||""==b||"undefined"==b?this.strSelectedColor:b}catch(c){g_objCommonUtil.displayErrorAlert(c,"getSelectedBackgroundColor")}return this.strSelectedColor};this.getFormBackgroundColor=function(a){try{return this.arrEventPosInfo[a].objDataCell.bgcolor}catch(b){g_objCommonUtil.displayErrorAlert(b,"getFormBackgroundColor")}return""};this.getFormGroupBackgroundColor=
function(){try{for(var a=!0,b="",c=0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.getFormBackgroundColor(c);a&&(a=!1,b=d);if(b!=d)return""}return b}catch(e){g_objCommonUtil.displayErrorAlert(e,"getFormGroupBackgroundColor")}return""};this.setFormBackgroundColor=function(a,b){try{var c=this.arrEventPosInfo[a];this.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,b);c.objDataCell.bgcolor=b}catch(d){g_objCommonUtil.displayErrorAlert(d,"setFormBackgroundColor")}};
this.setFormGroupBackgroundColor=function(a){try{for(var b=0;b<this.arrEventPosInfo.length;b++)this.arrEventPosInfo[b].bSelectedDown&&this.setFormBackgroundColor(b,a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setFormGroupBackgroundColor")}};this.getFormBorderValue=function(a){try{var b="",c="",d="",e=!0,f=!0,h=!0,k=!0,g=this.arrEventPosInfo[a].objDataCell.arrBorderValue;g[0]==g[3]&&g[0]==g[6]&&g[0]==g[9]&&(b=g[0]);g[1]==g[4]&&g[1]==g[7]&&g[1]==g[10]&&(c=g[1]);g[2]==g[5]&&g[2]==g[8]&&g[2]==g[11]&&
(d=g[2]);""==g[0]&&(e=!1);""==g[3]&&(f=!1);""==g[6]&&(h=!1);""==g[9]&&(k=!1);return{borderWidth:b,borderStyle:c,borderColor:d,borderApplyLeft:e,borderApplyTop:f,borderApplyRight:h,borderApplyBottom:k}}catch(l){g_objCommonUtil.displayErrorAlert(l,"getFormBorderValue")}return{borderWidth:"",borderStyle:"",borderColor:"",borderApplyLeft:!1,borderApplyTop:!1,borderApplyRight:!1,borderApplyBottom:!1}};this.getFormGroupBorderValue=function(){try{for(var a=!0,b=!1,c=!1,d=!1,e="",f="",h="",k=0;k<this.arrEventPosInfo.length;k++)if(this.arrEventPosInfo[k].bSelectedDown){var g=
this.getFormBorderValue(k);a&&(a=!1,e=g.borderWidth,f=g.borderStyle,h=g.borderColor);e!=g.borderWidth&&(b=!0);f!=g.borderStyle&&(c=!0);h!=g.borderColor&&(d=!0)}b&&(e="");c&&(f="");d&&(h="");return{borderWidth:e,borderStyle:f,borderColor:h}}catch(l){g_objCommonUtil.displayErrorAlert(l,"getFormGroupBorderValue")}return{borderWidth:"",borderStyle:"",borderColor:""}};this.setFormBorderValue=function(a,b){try{a.objDataCell.arrBorderValue=b,a.objOutlineUtil.setExtOutlineBorder(b)}catch(c){g_objCommonUtil.displayErrorAlert(c,
"setFormBorderValue")}};this.setFormGroupBorderValue=function(a){try{for(var b=0;b<this.arrEventPosInfo.length;b++)this.arrEventPosInfo[b].bSelectedDown&&this.setFormBorderValue(this.arrEventPosInfo[b],a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setFormBackgroundColor")}};this.copyEventPosInfo=function(a,b){try{b.objDataCell.innerHTML=a.objDataCell.innerHTML,b.objDataCell.align=a.objDataCell.align,b.objDataCell.bgcolor=a.objDataCell.bgcolor,this.setFormBorderValue(b,a.objDataCell.arrBorderValue),
b.objDataCell.strStyleString=a.objDataCell.strStyleString,b.objDataCell.bChangeHeight=a.objDataCell.bChangeHeight,b.objDataCell.height=a.objDataCell.height}catch(c){g_objCommonUtil.displayErrorAlert(c,"copyEventPosInfo")}}};

var g_objPropFormEventDraw=new function(){var f=this;this.propForm_draw_onmousedown=function(b){try{var a=g_objPropFormEvent.getEventPosInfo(b);if(null!=a){g_objPropFormEvent.objEventPosInfo=g_objPropFormEvent.newEventPosInfo();var c=null;c=dzeEnvConfig.iFrameLayer?g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(b):g_objPositionUtil.GetDocumentClientPos_XY(b);g_objPropFormEvent.objEventPosInfo.nStartClient_X=c.nPos_X;g_objPropFormEvent.objEventPosInfo.nStartClient_Y=c.nPos_Y;g_objPropFormEvent.initEventPosInfo(g_objPropFormEvent.objEventPosInfo,
a.posRow,a.posCol,-1,-1);var d=g_objPropFormSink.getFormUIBorderValue();g_objPropFormEvent.objEventPosInfo.objDataCell.arrBorderValue=d;g_objPropFormEvent.objEventPosInfo.objOutlineUtil.setExtOutlineBorder(d);window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",this.propForm_draw_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",this.propForm_draw_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",this.propForm_draw_onmousemove,
!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",this.propForm_draw_onmouseup,!1))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"propForm_draw_onmousedown")}};this.propForm_draw_onmousemove=function(b){try{var a=g_objPropFormEvent.getEventPosInfo(b);if(null!=a){var c=g_objPropFormEvent.objEventPosInfo.nStartRow,d=g_objPropFormEvent.objEventPosInfo.nStartCol;if(g_objPropFormEvent.checkSelectedArea(c,d,a.posRow,a.posCol,-1))g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed";
else{g_objLayerKit.getLayerDocument().body.style.cursor="default";var e=null;e=dzeEnvConfig.iFrameLayer?g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(b):g_objPositionUtil.GetDocumentClientPos_XY(b);if(g_objPropFormEvent.objEventPosInfo.nStartClient_X!=e.nPos_X||g_objPropFormEvent.objEventPosInfo.nStartClient_Y!=e.nPos_Y)g_objPropFormEvent.objEventPosInfo.nEndRow=a.posRow,g_objPropFormEvent.objEventPosInfo.nEndCol=a.posCol,g_objPropFormEvent.displayAreaRectangle(c,d,g_objPropFormEvent.objEventPosInfo.nEndRow,
g_objPropFormEvent.objEventPosInfo.nEndCol,g_objPropFormEvent.objEventPosInfo.objOutlineUtil,!1,!0),g_objPropFormEvent.objEventPosInfo.bApplyEvent=!0}}}catch(g){g_objCommonUtil.displayErrorAlert(g,"propForm_draw_onmousemove")}};this.propForm_draw_onmouseup=function(b){try{g_objLayerKit.getLayerDocument().body.style.cursor="default",window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",f.propForm_draw_onmousemove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",f.propForm_draw_onmouseup)):
(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",f.propForm_draw_onmousemove,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",f.propForm_draw_onmouseup,!1)),g_objPropFormEvent.objEventPosInfo.bApplyEvent&&(g_objPropFormEvent.convertAreaRectangle(),g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.arrEventPosInfo.length]=g_objPropFormEvent.objEventPosInfo,g_objPropFormEvent.objEventPosInfo=null),g_objPropFormSink.setAvailableButton(!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,
"propForm_draw_onmouseup")}}};

var g_objPropFormEventMove=new function(){var f=this;this.bGroupMove=!1;this.propForm_move_onmousedown=function(e,a,b,d){try{this.bGroupMove=d;var g=g_objPropFormEvent.nMoveIndex;g_objPropFormEvent.nMoveIndex=b;if(-1!=g&&g!=g_objPropFormEvent.nMoveIndex){var c=g_objPropFormEvent.arrEventPosInfo[g];if(c){var f=c.objOutlineUtil;g_objPropFormEvent.displayAreaRectangle(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,f,!1,!0)}}if(-1!=g_objPropFormEvent.nMoveIndex){c=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];
var k=c.nStartRow,l=c.nStartCol,m=c.nEndRow,n=c.nEndCol;c.nDragEventRow=a.posRow;c.nDragEventCol=a.posCol;c.nDragStartRow=-1;c.nDragStartCol=-1;c.nDragEndRow=-1;c.nDragEndCol=-1;f=c.objOutlineUtil;this.bGroupMove?(g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_REMOVE_COLOR,!0),g_objPropFormEvent.displayAreaRectangle(k,l,m,n,f,!1,!0)):(g_objPropFormEvent.nCurResizeIndex=b,g_objPropFormEvent.setAreaBackgroundColor(k,l,m,n,""),g_objPropFormEvent.displayAreaRectangle(k,l,m,n,
f,!0,!0));window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",this.propForm_move_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",this.propForm_move_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",this.propForm_move_onmousemove,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",this.propForm_move_onmouseup,!1))}}catch(p){g_objCommonUtil.displayErrorAlert(p,"propForm_move_onmousedown")}};this.propForm_move_onmousemove=
function(e){try{if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.getEventPosInfo(e);if(null!=a){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex],d=a.posRow-b.nDragEventRow,g=a.posCol-b.nDragEventCol,c=a=e=-1,h=-1;if(f.bGroupMove){if(!f.checkGroupStartEndPos(d,g))return}else if(e=b.nStartRow+d,a=b.nStartCol+g,c=b.nEndRow+d,h=b.nEndCol+g,!g_objPropFormEvent.checkAreaMinMax(e,a,c,h))return;if(f.bGroupMove){if(g_objPropFormEvent.checkGroupSelectedArea(d,g)){g_objLayerKit.getLayerDocument().body.style.cursor=
"not-allowed";return}}else if(g_objPropFormEvent.checkSelectedArea(e,a,c,h,g_objPropFormEvent.nMoveIndex)){g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed";return}g_objLayerKit.getLayerDocument().body.style.cursor="default";f.bGroupMove?(g_objPropFormEvent.displayGroupAreaRectangle(d,g),f.setGroupDragInfo_move(d,g)):(g_objPropFormEvent.displayAreaRectangle(e,a,c,h,b.objOutlineUtil,!1,!0),b.nDragStartRow=e,b.nDragStartCol=a,b.nDragEndRow=c,b.nDragEndCol=h)}}}catch(k){g_objCommonUtil.displayErrorAlert(k,
"propForm_move_onmousemove")}};this.propForm_move_onmouseup=function(e){try{g_objLayerKit.getLayerDocument().body.style.cursor="default";window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",f.propForm_move_onmousemove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",f.propForm_move_onmouseup)):(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",f.propForm_move_onmousemove,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",f.propForm_move_onmouseup,
!1));if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];-1!=a.nDragStartRow&&-1!=a.nDragStartCol&&(f.bGroupMove?f.setGroupDragInfo_up():(a.nStartRow=a.nDragStartRow,a.nStartCol=a.nDragStartCol,a.nEndRow=a.nDragEndRow,a.nEndCol=a.nDragEndCol));if(f.bGroupMove)g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_GROUP_COLOR,!1);else{var b=g_objPropFormEvent.getSelectedBackgroundColor(a);g_objPropFormEvent.setAreaBackgroundColor(a.nStartRow,
a.nStartCol,a.nEndRow,a.nEndCol,b)}}g_objPropFormSink.updatePropFormUI()}catch(d){g_objCommonUtil.displayErrorAlert(d,"propForm_move_onmouseup")}};this.checkGroupStartEndPos=function(e,a){try{for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)if(g_objPropFormEvent.arrEventPosInfo[b].bSelectedDown){var d=g_objPropFormEvent.arrEventPosInfo[b];if(!g_objPropFormEvent.checkAreaMinMax(d.nStartRow+e,d.nStartCol+a,d.nEndRow+e,d.nEndCol+a))return!1}return!0}catch(g){g_objCommonUtil.displayErrorAlert(g,
"checkGroupStartEndPos")}return!1};this.setGroupDragInfo_move=function(e,a){try{for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)if(g_objPropFormEvent.arrEventPosInfo[b].bSelectedDown){var d=g_objPropFormEvent.arrEventPosInfo[b],f=d.nStartCol+a,c=d.nEndRow+e,h=d.nEndCol+a;d.nDragStartRow=d.nStartRow+e;d.nDragStartCol=f;d.nDragEndRow=c;d.nDragEndCol=h}}catch(k){g_objCommonUtil.displayErrorAlert(k,"setGroupDragInfo_move")}};this.setGroupDragInfo_up=function(){try{for(var e=0;e<g_objPropFormEvent.arrEventPosInfo.length;e++)if(g_objPropFormEvent.arrEventPosInfo[e].bSelectedDown){var a=
g_objPropFormEvent.arrEventPosInfo[e];a.nStartRow=a.nDragStartRow;a.nStartCol=a.nDragStartCol;a.nEndRow=a.nDragEndRow;a.nEndCol=a.nDragEndCol}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setGroupDragInfo_up")}}};

var g_objPropFormEventResize=new function(){var c=this;this.nOutlineRectangleNumber=-1;this.outlineRectangle_onmousedown=function(d,a){try{dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),-1!=g_objPropFormEvent.nMoveIndex&&(this.nOutlineRectangleNumber=d,g_objPropFormEvent.setAreaBackgroundColor(g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nStartRow,g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nStartCol,g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nEndRow,
g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nEndCol,""),window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",c.outlineRectangle_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",c.outlineRectangle_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",c.outlineRectangle_onmousemove,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",c.outlineRectangle_onmouseup,!1)))}catch(b){g_objCommonUtil.displayErrorAlert(b,
"outlineRectangle_onmousedown")}};this.outlineRectangle_onmousemove=function(d){try{if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.getEventPosInfo(d);if(null!=a){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex],e=b.nStartRow,h=b.nStartCol,f=b.nEndRow,g=b.nEndCol,k=d=!1;(2==c.nOutlineRectangleNumber||6==c.nOutlineRectangleNumber)&&e<a.posRow+1&&a.posRow!=b.nEndRow&&(f=a.posRow,d=!0);(2==c.nOutlineRectangleNumber||5==c.nOutlineRectangleNumber)&&h<a.posCol+1&&a.posCol!=
b.nEndCol&&(g=a.posCol,k=!0);g_objPropFormEvent.checkSelectedArea(e,h,f,g,g_objPropFormEvent.nMoveIndex)?g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed":(g_objLayerKit.getLayerDocument().body.style.cursor="default",d&&(b.nEndRow=f),k&&(b.nEndCol=g),(d||k)&&g_objPropFormEvent.displayAreaRectangle(e,h,f,g,b.objOutlineUtil,!0,!0))}}}catch(l){g_objCommonUtil.displayErrorAlert(l,"outlineRectangle_onmousemove")}};this.outlineRectangle_onmouseup=function(d){try{g_objLayerKit.getLayerDocument().body.style.cursor=
"default";window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",c.outlineRectangle_onmousemove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",c.outlineRectangle_onmouseup)):(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",c.outlineRectangle_onmousemove,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",c.outlineRectangle_onmouseup,!1));if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];
a.objDataCell.bChangeHeight=!0;var b=g_objPropFormEvent.getSelectedBackgroundColor(a);g_objPropFormEvent.setAreaBackgroundColor(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,b)}g_objPropFormSink.updatePropFormUI()}catch(e){g_objCommonUtil.displayErrorAlert(e,"outlineRectangle_onmouseup")}}};

var g_objPropFormCode=new function(){this.indexFlagName="cusIndex";this.cusFlagName="cusFlag";this.nBasisWidth=100;this.nBasisHeight=25;this.strDummyCellClassName="dummyCell";this.generateFormCode=function(c,f){try{var a=this.getEventPosMaxRowColCount();if(null==a)return null;var d=g_objPropFormLoad.createSimpleFlag(a.maxRow+1,a.maxCol+1);if(null==d)return!1;for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b],g=e.nStartRow,k=e.nStartCol,h=e.nEndRow,
l=e.nEndCol;g_objPropFormLoad.setSimpleFlagPos(d,g,k,h-g+1,l-k+1,b)}var n=this.getDummyCellArray(d,a.maxRow+1,a.maxCol+1);if(null==n)return null;this.operateDummyCellArrayWithEventPosInfoArray(n,!0);var p=this.makeFormCode(a.maxRow+1,a.maxCol+1),m=document.createElement("div");m.innerHTML=p;a=null;"table"==m.childNodes[0].nodeName.toLowerCase()&&(a=m.childNodes[0]);if(null!=a){a.id=c;for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)e=g_objPropFormEvent.arrEventPosInfo[b],g=e.nStartRow,k=e.nStartCol,
h=e.nEndRow,l=e.nEndCol,this.prepareTargetCellFlag(b,a,g,k,h,l);var q=g_objPropFormSink.objCheck_KeepHeight.checked?!0:!1;for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)this.convertTargetCellFlag(b,a),this.simpleMergeCell(b,a,q);this.adjustRowSpan(a);this.adjustColSpan(a);this.mappingContent(a,f);this.releaseTargetCellFlag(a);this.operateDummyCellArrayWithEventPosInfoArray(n,!1);return{htmlCode:m.innerHTML,codeTable:a}}}catch(r){g_objCommonUtil.displayErrorAlert(r,"generateFormCode")}};this.getFormCodeWidthHeight=
function(){try{return{unitWidth:parseInt(this.nBasisWidth/g_objPropForm.nDrawMaxCol),unitHeight:this.nBasisHeight}}catch(c){g_objCommonUtil.displayErrorAlert(c,"getFormCodeWidthHeight")}};this.getBasisHeight=function(){try{return this.nBasisHeight}catch(c){g_objCommonUtil.displayErrorAlert(c,"getBasisHeight")}};this.setBasisHeight=function(c){try{this.nBasisHeight=c}catch(f){g_objCommonUtil.displayErrorAlert(f,"setBasisHeight")}};this.getEventPosMaxRowColCount=function(){try{for(var c=-1,f=-1,a=0;a<
g_objPropFormEvent.arrEventPosInfo.length;a++){var d=g_objPropFormEvent.arrEventPosInfo[a],b=d.nEndRow,e=d.nEndCol;b>c&&(c=b);e>f&&(f=e)}return{maxRow:c,maxCol:f}}catch(g){g_objCommonUtil.displayErrorAlert(g,"getEventPosMaxRowColCount")}return null};this.getDummyCellArray=function(c,f,a){try{for(var d=[],b=!1,e=-1,g=-1,k=-1,h=-1,l=0;l<f;l++){for(var n=0;n<a;n++){var p=c[l][n];b?-1==p?n==h+1&&(h=n):(d.push([e,g,k,h]),b=!1,h=k=g=e=-1):-1==p&&(b=!0,e=l,g=n,k=l,h=n)}-1!=e&&d.push([e,g,k,h]);b=!1;h=k=
g=e=-1}return this.mergeDummyCellArray(d)?d:null}catch(m){g_objCommonUtil.displayErrorAlert(m,"getDummyCellArray")}return null};this.mergeDummyCellArray=function(c){try{for(var f=0;!(c.length<=f);)this.compareDummyCellArray(c,f)||f++;return!0}catch(a){g_objCommonUtil.displayErrorAlert(a,"mergeDummyCellArray")}return!1};this.compareDummyCellArray=function(c,f){try{for(var a=-1,d=c[f][1],b=c[f][2],e=c[f][3],g=f+1;g<c.length;g++)if(b+1==c[g][2]&&d==c[g][1]&&e==c[g][3]){a=g;break}if(-1==a)return!1;c[f][2]=
b+1;c.splice(a,1);return!0}catch(k){g_objCommonUtil.displayErrorAlert(k,"compareDummyCellArray")}return!1};this.operateDummyCellArrayWithEventPosInfoArray=function(c,f){try{if(f)for(var a=0;a<c.length;a++){var d=c[a][0],b=c[a][1],e=c[a][2],g=c[a][3],k=g_objPropFormEvent.newEventPosInfo();k.nStartRow=d;k.nStartCol=b;k.nEndRow=e;k.nEndCol=g;k.bDummyCell=!0;g_objPropFormEvent.arrEventPosInfo.push(k)}else for(a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++)k=g_objPropFormEvent.arrEventPosInfo[a],
k.bDummyCell&&(g_objPropFormEvent.arrEventPosInfo.splice(a,1),a--)}catch(h){g_objCommonUtil.displayErrorAlert(h,"operateDummyCellArrayWithEventPosInfoArray")}};this.makeFormCode=function(c,f){try{var a=this.getFormCodeWidthHeight(),d=a.unitWidth+"%",b=a.unitHeight+"px";a="";a+='<table width="100%" cellpadding="0" cellspacing="0" style="font-size:9pt; border-collapse:collapse;">';a+="<colgroup>";for(var e=0;e<f;e++)a+='<col width="'+d+'" />';a+="</colgroup>";for(e=0;e<c;e++){a+="<tr>";for(var g=0;g<
f;g++)a+='<td width="'+d+'" height="'+b+'" style="border:0px;"></td>';a+="</tr>"}return a+"</table>"}catch(k){g_objCommonUtil.displayErrorAlert(k,"makeFormCode")}};this.prepareTargetCellFlag=function(c,f,a,d,b,e){try{for(;a<=b;a++)for(var g=d;g<=e;g++){var k=g_objTableUtil.getTableCellElement(f,a,g);g_objPropertyUtil.setTargetCellFlag(k,this.indexFlagName,c)}}catch(h){g_objCommonUtil.displayErrorAlert(h,"prepareTargetCellFlag")}};this.convertTargetCellFlag=function(c,f){try{for(var a=!1,d=f.rows.length,
b=0;b<d;b++)for(var e=g_objTableUtil.getTableCellsLength(f,b),g=0;g<e;g++){var k=g_objTableUtil.getTableCellElement(f,b,g),h=g_objPropertyUtil.getTargetCellFlag(k,this.indexFlagName);null!=h&&c==h&&(a?g_objPropertyUtil.setTargetCellFlag(k,this.cusFlagName,3):(a=!0,g_objPropertyUtil.setTargetCellFlag(k,this.cusFlagName,2)))}}catch(l){g_objCommonUtil.displayErrorAlert(l,"convertTargetCellFlag")}};this.simpleMergeCell=function(c,f,a){try{for(var d=-1,b=-1,e=0,g=0,k=f.rows.length,h=0;h<k;h++)for(var l=
!0,n=g_objTableUtil.getTableCellsLength(f,h),p=0;p<n;p++){var m=g_objTableUtil.getTableCellElement(f,h,p),q=g_objPropertyUtil.getTargetCellFlag(m,this.cusFlagName);null==q||2!=q&&3!=q&&4!=q||(2==q&&(d=h,b=p,m.removeAttribute(this.cusFlagName)),l&&h==d+e&&(l=!1,e+=m.rowSpan),h==d&&(g+=m.colSpan))}for(h=0;h<k;h++)for(p=0;p<g_objTableUtil.getTableCellsLength(f,h);p++)m=g_objTableUtil.getTableCellElement(f,h,p),q=g_objPropertyUtil.getTargetCellFlag(m,this.cusFlagName),null==q||3!=q&&4!=q||(g_objTableUtil.getTableRowElement(f,
h).deleteCell(p),p=-1);var r=g_objPropFormEvent.arrEventPosInfo[c],t=this.getFormCodeWidthHeight();m=g_objTableUtil.getTableCellElement(f,d,b);m.rowSpan=e;m.colSpan=g;m.width=t.unitWidth*g+"%";m.height=a?r.objDataCell.bChangeHeight?t.unitHeight*e:r.objDataCell.height:t.unitHeight*e;""!=r.objDataCell.strStyleString&&m.setAttribute("style",r.objDataCell.strStyleString);g_objPropertyUtil.setElementBorderStyleAttributeSet(m,r.objDataCell.arrBorderValue)}catch(u){g_objCommonUtil.displayErrorAlert(u,"simpleMergeCell")}};
this.adjustRowSpan=function(c){try{for(var f=g_objTableUtil.getTableMaxColSpanCount(c);;){for(var a=-1,d=c.rows.length,b=0;b<d;b++){var e=g_objTableUtil.getTableCellsLength(c,b);if(0==e){a=b;break}}if(-1==a)break;var g=a-1,k=g_objTableUtil.getTableRowColSpanCount(c,g);if(f==k){if(1>=this.getTableRowMinRowSpanCount(c,g))break;e=g_objTableUtil.getTableCellsLength(c,g);for(var h=0;h<e;h++){var l=g_objTableUtil.getTableCellElement(c,g,h),n=l.rowSpan;l.rowSpan=n-1}}else{var p=null,m=null;e=g_objTableUtil.getTableCellsLength(c,
g);for(h=0;h<e;h++)if(l=g_objTableUtil.getTableCellElement(c,g,h),p=g_objPropertyUtil.getTargetCellFlag(l,this.indexFlagName),null!=p){m=l;break}if(null==p)break;var q=this.getRelatedPosIndexForRowSpan(p);if(null==q)break;if(0==q.length)break;var r=this.getTableCellArray(c,q);if(null==r)break;for(b=0;b<r.length;b++)if(1>=r[b].rowSpan)return;for(b=0;b<r.length;b++)n=r[b].rowSpan,r[b].rowSpan=n-1;n=m.rowSpan;m.rowSpan=n-1}c.deleteRow(a)}}catch(t){g_objCommonUtil.displayErrorAlert(t,"adjustRowSpan")}};
this.getTableRowMinRowSpanCount=function(c,f){try{var a=g_objTableUtil.getTableCellsLength(c,f);if(0==a)return 0;for(var d=9999,b=0;b<a;b++){var e=g_objTableUtil.getTableCellElement(c,f,b);e.rowSpan<d&&(d=e.rowSpan)}return d}catch(g){g_objCommonUtil.displayErrorAlert(g,"getTableRowMinRowSpanCount")}};this.releaseTargetCellFlag=function(c){try{for(var f=c.rows.length,a=0;a<f;a++)for(var d=g_objTableUtil.getTableCellsLength(c,a),b=0;b<d;b++)g_objTableUtil.getTableCellElement(c,a,b).removeAttribute(this.indexFlagName)}catch(e){g_objCommonUtil.displayErrorAlert(e,
"releaseTargetCellFlag")}};this.getRelatedPosIndexForRowSpan=function(c){try{for(var f=[],a=g_objPropFormEvent.arrEventPosInfo[c].nStartRow,d=0;d<g_objPropFormEvent.arrEventPosInfo.length;d++)if(d!=c){var b=g_objPropFormEvent.arrEventPosInfo[d].nEndRow;g_objPropFormEvent.arrEventPosInfo[d].nStartRow<=a&&a<b&&(f[f.length]=d)}return f}catch(e){g_objCommonUtil.displayErrorAlert(e,"getRelatedPosIndexForRowSpan")}};this.getTableCellArray=function(c,f){try{for(var a=[],d=0;d<f.length;d++){var b=this.getTableCellByPosIndex(c,
f[d]);if(null==b||1==b.rowSpan)return null;a[a.length]=b}return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"getTableCellArray")}return null};this.getTableCellByPosIndex=function(c,f){try{for(var a=c.rows.length,d=0;d<a;d++)for(var b=g_objTableUtil.getTableCellsLength(c,d),e=0;e<b;e++){var g=g_objTableUtil.getTableCellElement(c,d,e),k=g_objPropertyUtil.getTargetCellFlag(g,this.indexFlagName);if(f==k)return g}}catch(h){g_objCommonUtil.displayErrorAlert(h,"getTableCellByPosIndex")}return null};this.adjustColSpan=
function(c){try{var f=c.rows.length;if(0!=f){var a=g_objNodeUtil.getLoopChildNodeByTagName(c,"colgroup");if(null!=a){for(var d=this.getFormCodeWidthHeight().unitWidth,b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol,g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol,k=this.getRelatedPosIndexForColSpan(!0,e,g);if(null==k)return;if(0!=k.length){var h=this.getColNoWithinColGroup(a,d,e);if(null==h)return;var l=this.doAdjustColSpan(c,f,k,a,h,d);if(0==
l)return}}for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol;g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol;k=this.getRelatedPosIndexForColSpan(!1,e,g);if(null==k)break;if(0!=k.length){h=this.getColNoWithinColGroup(a,d,e);if(null==h)break;l=this.doAdjustColSpan(c,f,k,a,h,d);if(0==l)break}}}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"adjustColSpan")}};this.mappingContent=function(c,f){try{for(var a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++){var d=
this.getTableCellByPosIndex(c,a);if(null!=d)if(g_objPropFormEvent.arrEventPosInfo[a].bDummyCell)d.className=this.strDummyCellClassName;else{var b=g_objPropFormEvent.arrEventPosInfo[a].objDataCell;null!=b&&(d.innerHTML=f?window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>":b.innerHTML,null!=b.align&&""!=b.align&&d.setAttribute("align",b.align),null!=b.bgcolor&&""!=b.bgcolor&&d.setAttribute("bgcolor",b.bgcolor))}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"mappingContent")}};this.doAdjustColSpan=function(c,
f,a,d,b,e){try{for(;;){for(var g=!0,k=0,h=0;h<a.length;h++){var l=this.getTableCellByPosIndex(c,a[h]);if(null==l)return!1;if(1==l.colSpan){g=!1;break}k+=l.rowSpan}g&&k!=f&&(g=!1);if(!g)break;for(h=0;h<a.length;h++)l=this.getTableCellByPosIndex(c,a[h]),--l.colSpan;var n=g_objNodeUtil.getChildrenCollection(d),p=n[b].getAttribute("width"),m=g_objCommonUtil.extractNumberValueUnit(p);if(null==m)return!1;var q=parseInt(m.nValue)+parseInt(e)+"%";n[b].setAttribute("width",q);d.removeChild(n[b+1])}return!0}catch(r){g_objCommonUtil.displayErrorAlert(r,
"doAdjustColSpan")}return!1};this.getRelatedPosIndexForColSpan=function(c,f,a){try{for(var d=[],b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol,g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol;c?f==e?d[d.length]=b:e<f&&a<=g&&(d[d.length]=b):e<f&&a==g?d[d.length]=b:f==e&&a==g&&(d[d.length]=b)}return d}catch(k){g_objCommonUtil.displayErrorAlert(k,"getRelatedPosIndexForColSpan")}return null};this.getColNoWithinColGroup=function(c,f,a){try{f*=
a;a=0;var d=g_objNodeUtil.getChildrenCollection(c);for(c=0;c<d.length;c++){var b=d[c].getAttribute("width"),e=g_objCommonUtil.extractNumberValueUnit(b);if(null==e)break;a+=parseInt(e.nValue);if(a>f)return c}}catch(g){g_objCommonUtil.displayErrorAlert(g,"getColNoWithinColGroup")}return null}};

var g_objPropFormLoad=new function(){this.prepareLoadFormStructure=function(a){try{if(null==a)return-1;var c=this.checkExistColGroupWidth(a);if(-1!=c){if(0==c){if(this.checkAllExistWidthPercentage(a))return this.getDrawTypeFromStructure(a);var b=this.convertLoadFormStructure(a);return b?this.getDrawTypeFromStructure(a):-1}if(1==c)return(b=this.mappingColGroupWidth(a))?this.getDrawTypeFromStructure(a):-1}}catch(e){g_objCommonUtil.displayErrorAlert(e,"prepareLoadFormStructure")}return-1};this.checkExistColGroupWidth=
function(a){try{if(0==a.rows.length)return-1;var c=g_objNodeUtil.getLoopChildNodeByTagName(a,"colgroup");if(null==c)return 0;var b=g_objTableUtil.getTableColGroupWidthValue(c);if(null==b)return-1;for(a=0;a<b.length;a++)if("%"!=b[a].strUnit)return 2;return 1}catch(e){g_objCommonUtil.displayErrorAlert(e,"checkExistColGroupWidth")}return-1};this.checkAllExistWidthPercentage=function(a){try{for(var c=a.rows.length,b=0;b<c;b++)for(var e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++){var g=g_objTableUtil.getTableCellElement(a,
b,d),m=g_objNodeUtil.getNodeWidthHeight(g,!0);if(null==m.nValue||"%"!=m.strUnit)return!1}return!0}catch(l){g_objCommonUtil.displayErrorAlert(l,"checkAllExistWidthPercentage")}return!1};this.mappingColGroupWidth=function(a){try{var c=a.rows.length;if(0==c)return!1;var b=g_objNodeUtil.getLoopChildNodeByTagName(a,"colgroup");if(null==b)return!1;var e=g_objTableUtil.getTableColGroupWidthValue(b);if(null==e)return!1;var d=g_objTableUtil.getTableMaxColSpanCount(a);if(0==d)return!1;var g=this.createSimpleFlag(c,
d);if(null==g)return!1;for(d=b=0;d<c;d++)for(var m=g_objTableUtil.getTableCellsLength(a,d),l=0;l<m;l++){var f=g_objTableUtil.getTableCellElement(a,d,l),h=f.rowSpan,p=f.colSpan,n=this.getSimpleFlagPos(g);this.setSimpleFlagPos(g,n.rowNo,n.colNo,h,p,b);var r=0;for(k=n.colNo;k<n.colNo+p;k++)r+=parseInt(e[k].nValue);f.style.removeAttribute?f.style.removeAttribute("width"):f.style.removeProperty&&f.style.removeProperty("width");f.setAttribute("width",r+"%");b++}return!0}catch(q){g_objCommonUtil.displayErrorAlert(q,
"mappingColGroupWidth")}return!1};this.getDrawTypeFromStructure=function(a){try{for(var c=a.rows.length,b=0;b<c;b++)for(var e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++){var g=g_objTableUtil.getTableCellElement(a,b,d),m=g_objNodeUtil.getNodeWidthHeight(g,!0);if(null==m.nValue||"%"!=m.strUnit)return-1;if(0!=m.nValue%5)return g_objPropForm.ID_DRAW_TYPE_100_COL}return g_objPropForm.ID_DRAW_TYPE_20_COL}catch(l){g_objCommonUtil.displayErrorAlert(l,"getDrawTypeFromStructure")}return-1};this.convertLoadFormStructure=
function(a){try{var c=this.getTablePosArrayBySort(a);if(null==c)return!1;var b=c.leftPos,e=c.topPos,d=c.rightPos,g=c.bottomPos,m=e.length,l=b.length,f=this.createSimpleFlag(m,l);if(null==f)return!1;var h=this.initSimpleRowColPos(a,f,b,e,d,g);if(null==h||!this.calculateColOffsetWidth(h,m,l,a,f))return!1;var p=this.getSumColOffsetWidth(h,f,m,l);if(null==p||0==p.length)return!1;var n=p[0];for(c=0;c<p.length;c++)if(p[0]!=p[c])return!1;for(c=p=0;c<m;c++){var r=g_objTableUtil.getTableCellsLength(a,c);for(b=
0;b<r;b++){var q=g_objTableUtil.getTableCellElement(a,c,b),t=parseInt(100*h[p][6]/n);g_objTableUtil.setNodeValue_Width(q,t,"%");p++}}return!0}catch(v){g_objCommonUtil.displayErrorAlert(v,"convertLoadFormStructure")}return!1};this.loadFormStructure=function(a){try{if(null==a)return!1;var c=this.getTablePosArrayBySort(a);if(null==c)return!1;var b=c.leftPos,e=c.topPos,d=c.rightPos,g=c.bottomPos,m=e.length,l=b.length,f=this.createSimpleFlag(m,l);if(null==f)return!1;var h=this.initSimpleRowColPos(a,f,
b,e,d,g);if(null==h)return!1;var p=g_objPropFormCode.getFormCodeWidthHeight();if(!this.calculateRowColUnitCount(h,m,l,a,p,f))return!1;var n=this.getSumRowColUnitCount(h,f,m,l);if(null==n)return!1;var r=n.sumRowUnitCount,q=n.sumColUnitCount;if(0==r.length||0==q.length)return!1;for(c=0;c<r.length;c++)if(r[0]!=r[c])return!1;for(c=0;c<q.length;c++)if(q[0]!=q[c])return!1;var t=r[0],v=q[0];if(t>g_objPropForm.nDrawMaxRow||v>g_objPropForm.nDrawMaxCol)return!1;var x=this.createSimpleFlag(t,v);if(null==x)return!1;
for(c=r=0;c<m;c++){var y=g_objTableUtil.getTableRowElement(a,c);q=0;var u=g_objNodeUtil.getNodeWidthHeight(y,!1);null!=u.nValue&&(q=u.nValue);var B=g_objTableUtil.getTableCellsLength(a,c);for(t=0;t<B;t++){var z=g_objTableUtil.getTableCellElement(a,c,t),C=g_objNodeUtil.getNodeWidthHeight(z,!1);null!=C.nValue&&(q=C.nValue);var D=h[r][4],w=h[r][5],A=this.getSimpleFlagPos(x);this.setSimpleFlagPos(x,A.rowNo,A.colNo,D,w,r);g_objPropertyUtil.element_hasClass(z,g_objPropFormCode.strDummyCellClassName)||g_objPropFormEvent.addDataPosInfo(A.rowNo,
A.colNo,D,w,z,q);r++}}return!0}catch(E){g_objCommonUtil.displayErrorAlert(E,"loadFormStructure")}return!1};this.getTablePosArrayBySort=function(a){try{for(var c=function(a,b){return a-b},b=[],e=[],d=[],g=[],m=a.rows.length,l=0;l<m;l++)for(var f=g_objTableUtil.getTableCellsLength(a,l),h=0;h<f;h++){var p=g_objTableUtil.getTableCellElement(a,l,h),n=g_objPositionUtil.getElementPosClientRect(p),r=n.left,q=n.top,t=n.right,v=n.bottom;inArray(r,b)||b.push(r);inArray(q,e)||e.push(q);inArray(t,d)||d.push(t);
inArray(v,g)||g.push(v)}b.sort(c);e.sort(c);d.sort(c);g.sort(c);return{leftPos:b,topPos:e,rightPos:d,bottomPos:g}}catch(x){g_objCommonUtil.displayErrorAlert(x,"getTablePosArrayBySort")}return null};this.createSimpleFlag=function(a,c){try{for(var b=[],e=0;e<a;e++)b[e]=this.initArrayValue(c,-1);return b}catch(d){g_objCommonUtil.displayErrorAlert(d,"createSimpleFlag")}return null};this.initArrayValue=function(a,c){try{for(var b=[],e=0;e<a;e++)b[e]=c;return b}catch(d){g_objCommonUtil.displayErrorAlert(d,
"initArrayValue")}return null};this.getSimpleFlagPos=function(a){try{for(var c=a.length,b=0;b<c;b++)for(var e=a[b].length,d=0;d<e;d++)if(-1==a[b][d])return{rowNo:b,colNo:d}}catch(g){g_objCommonUtil.displayErrorAlert(g,"getSimpleFlagPos")}};this.setSimpleFlagPos=function(a,c,b,e,d,g){try{for(var m=c;m<c+e;m++)for(var l=b;l<b+d;l++)a[m][l]=g}catch(f){g_objCommonUtil.displayErrorAlert(f,"setSimpleFlagPos")}};this.initSimpleRowColPos=function(a,c,b,e,d,g){try{for(var m=[],l=0,f=a.rows.length,h=0;h<f;h++)for(var p=
g_objTableUtil.getTableCellsLength(a,h),n=0;n<p;n++){var r=g_objTableUtil.getTableCellElement(a,h,n),q=g_objPositionUtil.getElementPosClientRect(r),t=q.left,v=q.top,x=q.right,y=q.bottom,u=-1,B=-1,z=-1,C=-1;"undefined"!=typeof b.indexOf?(u=b.indexOf(t),B=e.indexOf(v),z=d.indexOf(x)+1,C=g.indexOf(y)+1):(u=inArrayIndex(t,b),B=inArrayIndex(v,e),z=inArrayIndex(x,d)+1,C=inArrayIndex(y,g)+1);if(-1==u||-1==B||0==z||0==C)return null;B=C-B;u=z-u;var D=this.getSimpleFlagPos(c);this.setSimpleFlagPos(c,D.rowNo,
D.colNo,B,u,l);m[l]=[D.rowNo,D.colNo,D.rowNo+B-1,D.colNo+u-1,-1,-1,-1];l++}return m}catch(w){g_objCommonUtil.displayErrorAlert(w,"initSimpleRowColPos")}return null};this.calculateRowColUnitCount=function(a,c,b,e,d,g){try{for(var m=this.initArrayValue(c,-1),l=this.initArrayValue(b,-1),f=0,h=0;h<c;h++)for(var p=g_objTableUtil.getTableCellsLength(e,h),n=0;n<p;n++){var r=a[f][0],q=a[f][1],t=a[f][2],v=a[f][3];if(r==t)if(-1==m[r]){var x=g_objTableUtil.getTableCellElement(e,h,n);if(!g_objPropertyUtil.element_hasClass(x,
g_objPropFormCode.strDummyCellClassName)){var y=this.calculateCellRowUnitCount(e,h,n,d.unitHeight);if(-1==y)return!1;0==y&&(y=1);m[r]=y;a[f][4]=y}}else a[f][4]=m[r];if(q==v)if(-1==l[q]){var u=this.calculateCellColUnitCount(e,h,n,d.unitWidth);if(-1==u)return!1;l[q]=u;a[f][5]=u}else a[f][5]=l[q];f++}this.calculateOneMoreRowColUnitCount(a,m,l);if(this.findNoAssignRowCol(a)){x=[];var B=[],z=[],C=[];for(h=f=0;h<c;h++)for(p=g_objTableUtil.getTableCellsLength(e,h),n=0;n<p;n++){r=a[f][0];q=a[f][1];t=a[f][2];
v=a[f][3];var D=a[f][5];if(-1==a[f][4]){for(var w=!1,A=r;A<=t;A++)if(-1==m[A]){w=!0;break}if(w)if(w=r+"_"+t,inArray(w,x)){var E=x.indexOf(w);if(-1==E)return!1;a[f][4]=B[E]}else{y=this.calculateCellRowUnitCount(e,h,n,d.unitHeight);if(-1==y)return!1;a[f][4]=y;x.push(w);B.push(y)}}if(-1==D){w=!1;var I=0;for(A=q;A<=v;A++)if(-1==l[A]){w=!0;break}else I+=l[A];if(w)if(w=q+"_"+v,inArray(w,z)){E=z.indexOf(w);if(-1==E)return!1;a[f][5]=C[E]}else{u=this.calculateCellColUnitCount(e,h,n,d.unitWidth);if(-1==u)return!1;
a[f][5]=u;z.push(w);C.push(u);this.assignSkippedColUnitCount(q,v,u,l,z,C)}else a[f][5]=I}f++}if(this.findNoAssignRowCol(a))return!1}var H=this.getSumRowColUnitCount(a,g,c,b);if(null==H)return!1;var F=H.sumRowUnitCount,G=H.sumColUnitCount;if(0==F.length||0==G.length)return!1;for(h=0;h<F.length;h++)if(F[0]!=F[h])return!1;b=!1;for(h=0;h<G.length;h++)if(G[0]!=G[h]){b=!0;break}return b&&!this.reAssignColUnitCount(a,c,e,l)?!1:!0}catch(J){g_objCommonUtil.displayErrorAlert(J,"calculateRowColUnitCount")}return!1};
this.calculateCellRowUnitCount=function(a,c,b,e){try{var d=g_objTableUtil.getTableCellElement(a,c,b).clientHeight,g=parseInt(d/e);0!=d%e&&g++;return g}catch(m){g_objCommonUtil.displayErrorAlert(m,"calculateCellRowUnitCount")}return-1};this.calculateCellColUnitCount=function(a,c,b,e){try{var d=g_objTableUtil.getTableCellElement(a,c,b),g=g_objNodeUtil.getNodeWidthHeight(d,!0);if(null==g.nValue)return!1;var m=parseInt(g.nValue/e);return 0!=g.nValue%e?-1:m}catch(l){g_objCommonUtil.displayErrorAlert(l,
"calculateCellColUnitCount")}return-1};this.calculateOneMoreRowColUnitCount=function(a,c,b){try{for(var e=0;e<a.length;e++){var d=a[e][0],g=a[e][1],m=a[e][2],l=a[e][3],f=a[e][5];if(-1==a[e][4]){for(var h=!0,p=0,n=d;n<=m;n++){if(-1==c[n]){h=!1;break}h&&(p+=c[n])}h&&(a[e][4]=p)}if(-1==f){h=!0;p=0;for(n=g;n<=l;n++){if(-1==b[n]){h=!1;break}h&&(p+=b[n])}h&&(a[e][5]=p)}}}catch(r){g_objCommonUtil.displayErrorAlert(r,"calculateOneMoreRowColUnitCount")}};this.findNoAssignRowCol=function(a){try{for(var c=0;c<
a.length;c++)if(-1==a[c][4]||-1==a[c][5])return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"findNoAssignRowCol")}return!1};this.assignSkippedColUnitCount=function(a,c,b,e,d,g){try{if(!this.doAssignSkippedColUnitCount(a,c,b,e))return!1;for(a=0;a<d.length;a++){var m=d[a].split("_");this.doAssignSkippedColUnitCount(m[0],m[1],g[a],e)}return!0}catch(l){g_objCommonUtil.displayErrorAlert(l,"assignSkippedColUnitCount")}return!1};this.doAssignSkippedColUnitCount=function(a,c,b,e){try{for(var d=0,g=-1;a<=
c;a++)-1==e[a]?(d++,g=a):b-=e[a];if(1!=d)return!1;e[g]=b;return!0}catch(m){g_objCommonUtil.displayErrorAlert(m,"doAssignSkippedColUnitCount")}return!1};this.reAssignColUnitCount=function(a,c,b,e){try{for(var d=0,g=0;g<c;g++)for(var m=g_objTableUtil.getTableCellsLength(b,g),l=0;l<m;l++){for(var f=a[d][3],h=0,p=a[d][1];p<=f;p++){if(-1==e[p])return!1;h+=e[p]}a[d][5]=h;d++}return!0}catch(n){g_objCommonUtil.displayErrorAlert(n,"reAssignColUnitCount")}return!1};this.getSumRowColUnitCount=function(a,c,b,
e){try{for(var d=this.initArrayValue(e,-1),g=this.initArrayValue(e,0),m=-1,l=this.initArrayValue(b,0),f=0;f<b;f++){for(var h=0;h<e;h++){var p=c[f][h];d[h]!=a[p][2]&&(d[h]=a[p][2],g[h]+=a[p][4]);m!=a[p][3]&&(m=a[p][3],l[f]+=a[p][5])}m=-1}return{sumRowUnitCount:g,sumColUnitCount:l}}catch(n){g_objCommonUtil.displayErrorAlert(n,"getSumRowColUnitCount")}return null};this.calculateColOffsetWidth=function(a,c,b,e,d){try{var g=this.initArrayValue(b,-1);for(d=b=0;d<c;d++)for(var m=g_objTableUtil.getTableCellsLength(e,
d),l=0;l<m;l++){var f=a[b][1],h=a[b][3];if(f==h){var p=g_objTableUtil.getTableCellElement(e,d,l),n=p.offsetWidth;-1==g[f]?(g[f]=n,a[b][6]=n):a[b][6]=g[f]}b++}this.calculateOneMoreColOffsetWidth(a,g);if(this.findNoAssignColOffsetWidth(a))for(;;){var r=!1;for(d=0;d<g.length;d++)if(-1==g[d]&&0!=d&&-1!=g[d-1]){var q=this.getTargetCellOffsetWidth(a,e,c,d-1,d);if(-1!=q){g[d]=q-g[d-1];r=!0;break}}if(!r)break;this.calculateOneMoreColOffsetWidth(a,g)}if(this.findNoAssignColOffsetWidth(a)){q=[];r=[];for(d=
b=0;d<c;d++)for(m=g_objTableUtil.getTableCellsLength(e,d),l=0;l<m;l++){f=a[b][1];h=a[b][3];n=a[b][6];if(-1==n){for(var t=!1,v=f;v<=h;v++)if(-1==g[v]){t=!0;break}if(t)if(t=f+"_"+h,inArray(t,q)){var x=q.indexOf(t);if(-1==x)return!1;a[b][6]=r[x]}else{p=g_objTableUtil.getTableCellElement(e,d,l);var y=p.offsetWidth;a[b][6]=y;q.push(t);r.push(y)}}b++}if(this.findNoAssignColOffsetWidth(a))return!1}return!0}catch(u){g_objCommonUtil.displayErrorAlert(u,"calculateColOffsetWidth")}return!1};this.calculateOneMoreColOffsetWidth=
function(a,c){try{for(var b=0;b<a.length;b++){var e=a[b][1],d=a[b][3];if(-1==a[b][6]){for(var g=!0,m=0,l=e;l<=d;l++){if(-1==c[l]){g=!1;break}g&&(m+=c[l])}g&&(a[b][6]=m)}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"calculateOneMoreColOffsetWidth")}};this.findNoAssignColOffsetWidth=function(a){try{for(var c=0;c<a.length;c++)if(-1==a[c][6])return!0}catch(b){g_objCommonUtil.displayErrorAlert(b,"findNoAssignColOffsetWidth")}return!1};this.getSumColOffsetWidth=function(a,c,b,e){try{for(var d=-1,g=this.initArrayValue(b,
0),m=0;m<b;m++){for(var l=0;l<e;l++){var f=c[m][l];d!=a[f][3]&&(d=a[f][3],g[m]+=a[f][6])}d=-1}return g}catch(h){g_objCommonUtil.displayErrorAlert(h,"getSumColOffsetWidth")}return null};this.getTargetCellOffsetWidth=function(a,c,b,e,d){try{for(var g=0,m=0;m<b;m++)for(var l=g_objTableUtil.getTableCellsLength(c,m),f=0;f<l;f++){var h=a[g][3];if(a[g][1]==e&&h==d)return g_objTableUtil.getTableCellElement(c,m,f).offsetWidth;g++}}catch(p){g_objCommonUtil.displayErrorAlert(p,"getTargetCellOffsetWidth")}return-1};
this.getValidateSumColOffsetWidth=function(a,c,b,e){try{for(var d=!0,g=-1,m=0,l=0;l<b;l++){for(var f=0;f<e;f++){var h=c[l][f];if(g!=a[h][3]){g=a[h][3];if(-1==a[h][6]){d=!1;break}m+=a[h][6]}}if(d)return m;g=-1;m=0}}catch(p){g_objCommonUtil.displayErrorAlert(p,"getValidateSumColOffsetWidth")}return 0}};

var g_objPropFormKeyCode=new function(){this.bShiftKeyDown=this.bCtrlKeyDown=!1;this.keyDownPaste=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d);d=0;for(var a=!0,g=0,c=g_objPropFormEvent.arrEventPosInfo,b=0;b<c.length;b++)if(c[b].bSelectedDown&&(d++,a)){a=!1;var f=c[b],h=f.nStartRow,k=f.nStartCol,l=f.nEndRow,n=f.nEndCol,m=g_objPropFormEvent.checkAvailablePasteArea(h,k,l,n);if(null==m)return;g=m.diffRow}if(0<
d){m=0;a=[];c=g_objPropFormEvent.arrEventPosInfo;for(b=0;b<c.length;b++)if(c[b].bSelectedDown){f=c[b];h=f.nStartRow+g;k=f.nStartCol;l=f.nEndRow+g;n=f.nEndCol;if(l>g_objPropForm.nDrawMaxRow-1)return;if(0==g_objPropFormEvent.checkCellAreaBackgroundColor(h,k,l,n)){m++;var e=g_objPropFormEvent.newEventPosInfo();g_objPropFormEvent.initEventPosInfo(e,h,k,l,n);g_objPropFormEvent.copyEventPosInfo(f,e);a[a.length]=e;if(d==m)break}else a=[],m=0,g++,b=-1}for(b=0;b<a.length;b++){e=a[b];var p=g_objPropFormEvent.arrEventPosInfo.length;
g_objPropFormEvent.arrEventPosInfo[p]=e;g_objPropFormEvent.displayAreaRectangle(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,e.objOutlineUtil,!1,!0);var q=g_objPropFormEvent.getSelectedBackgroundColor(e);g_objPropFormEvent.setAreaBackgroundColor(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,q)}}else-1!=g_objPropFormEvent.nCurResizeIndex&&(f=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex],h=f.nStartRow,k=f.nStartCol,l=f.nEndRow,n=f.nEndCol,m=g_objPropFormEvent.checkAvailablePasteArea(h,
k,l,n),null!=m&&(e=g_objPropFormEvent.newEventPosInfo(),g_objPropFormEvent.initEventPosInfo(e,m.posStartRow,m.posStartCol,m.posEndRow,m.posEndCol),p=g_objPropFormEvent.arrEventPosInfo.length,g_objPropFormEvent.arrEventPosInfo[p]=e,g_objPropFormEvent.copyEventPosInfo(f,e),g_objPropFormEvent.displayAreaRectangle(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,e.objOutlineUtil,!1,!1),q=g_objPropFormEvent.getSelectedBackgroundColor(e),g_objPropFormEvent.setAreaBackgroundColor(e.nStartRow,e.nStartCol,e.nEndRow,
e.nEndCol,q)))}}catch(r){g_objCommonUtil.displayErrorAlert(r,"keyDownPaste")}};this.keyDownResizeArrow=function(d,a){try{if(!g_objPropFormSink.checkFocusPropFormUI()&&(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),!g_objPropFormEvent.checkGroupSelected()&&-1!=g_objPropFormEvent.nCurResizeIndex)){var g=a=0;ID_KEYCODE_ARROW_LEFT==d?g=-1:ID_KEYCODE_ARROW_RIGHT==d?g=1:ID_KEYCODE_ARROW_TOP==d?a=-1:ID_KEYCODE_ARROW_BOTTOM==d&&(a=1);var c=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];
c.objDataCell.bChangeHeight=!0;var b=c.nStartRow,f=c.nStartCol,h=c.nEndRow+a,k=c.nEndCol+g;if(!(b>h||f>k)){g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,"");var l=g_objPropFormEvent.getSelectedBackgroundColor(c);g_objPropFormEvent.checkAreaMinMax(b,f,h,k)?g_objPropFormEvent.checkSelectedArea(b,f,h,k,g_objPropFormEvent.nCurResizeIndex)?g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,l):(g_objPropFormEvent.displayAreaRectangle(b,
f,h,k,c.objOutlineUtil,!0,!1),c.nEndRow=h,c.nEndCol=k,g_objPropFormEvent.setAreaBackgroundColor(b,f,h,k,l)):g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,l)}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"keyDownResizeArrow")}};this.keyDownTab=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()&&(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d),g_objPropFormEvent.checkGroupSelected()&&(g_objPropFormEvent.showAllAreaRectangle(),
g_objPropFormEvent.setGroupAreaBackgroundColor(!0,g_objPropFormEvent.ID_SELECTED_COLOR,!1)),0!=g_objPropFormEvent.arrEventPosInfo.length)){if(-1!=g_objPropFormEvent.nCurResizeIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];g_objPropFormEvent.displayAreaRectangle(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,a.objOutlineUtil,!1,!1)}g_objPropFormEvent.nCurResizeIndex++;g_objPropFormEvent.nCurResizeIndex>=g_objPropFormEvent.arrEventPosInfo.length&&(g_objPropFormEvent.nCurResizeIndex=
0);a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];g_objPropFormEvent.displayAreaRectangle(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,a.objOutlineUtil,!0,!1);g_objPropFormEvent.nMoveIndex=g_objPropFormEvent.nCurResizeIndex}}catch(g){g_objCommonUtil.displayErrorAlert(g,"keyDownTab")}};this.keyDownEscape=function(d){try{g_objPropFormSink.checkFocusPropFormUI()||(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d),g_objPropFormEvent.showAllAreaRectangle(),
g_objPropFormEvent.setGroupAreaBackgroundColor(!0,g_objPropFormEvent.ID_SELECTED_COLOR,!1),g_objPropFormSink.updatePropFormUI())}catch(a){g_objCommonUtil.displayErrorAlert(a,"keyDownEscape")}};this.keyDownDelete=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d);if(!g_objPropFormEvent.checkGroupSelected()){if(-1==g_objPropFormEvent.nCurResizeIndex)return;g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex].bSelectedDown=
!0}g_objPropFormEvent.nMoveIndex=-1;g_objPropFormEvent.nCurResizeIndex=-1;d=[];for(var a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++){var g=g_objPropFormEvent.arrEventPosInfo[a];g_objPropFormEvent.arrEventPosInfo[a].bSelectedDown?(g_objPropFormEvent.setAreaBackgroundColor(g.nStartRow,g.nStartCol,g.nEndRow,g.nEndCol,""),g.objOutlineUtil.showExtOutline(!1,!1,!1,0,0,0,0,!1,!1)):d[d.length]=g}g_objPropFormEvent.arrEventPosInfo=d;g_objPropFormSink.updatePropFormUI()}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"keyDownDelete")}};this.keyDownMoveArrow=function(d,a){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a);var g=g_objPropFormEvent.checkGroupSelected(),c=a=0;ID_KEYCODE_ARROW_LEFT==d?c=-1:ID_KEYCODE_ARROW_RIGHT==d?c=1:ID_KEYCODE_ARROW_TOP==d?a=-1:ID_KEYCODE_ARROW_BOTTOM==d&&(a=1);if(g)g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_REMOVE_COLOR,!0),g_objPropFormEventMove.checkGroupStartEndPos(a,
c)&&!g_objPropFormEvent.checkGroupSelectedArea(a,c)&&(g_objPropFormEvent.displayGroupAreaRectangle(a,c),g_objPropFormEventMove.setGroupDragInfo_move(a,c),g_objPropFormEventMove.setGroupDragInfo_up()),g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_GROUP_COLOR,!1);else if(-1!=g_objPropFormEvent.nCurResizeIndex){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex],f=b.nStartRow+a,h=b.nStartCol+c,k=b.nEndRow+a,l=b.nEndCol+c;g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,
b.nStartCol,b.nEndRow,b.nEndCol,"");var n=g_objPropFormEvent.getSelectedBackgroundColor(b);g_objPropFormEvent.checkAreaMinMax(f,h,k,l)?g_objPropFormEvent.checkSelectedArea(f,h,k,l,g_objPropFormEvent.nCurResizeIndex)?g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,b.nStartCol,b.nEndRow,b.nEndCol,n):(g_objPropFormEvent.displayAreaRectangle(f,h,k,l,b.objOutlineUtil,!0,!1),b.nStartRow=f,b.nStartCol=h,b.nEndRow=k,b.nEndCol=l,g_objPropFormEvent.setAreaBackgroundColor(f,h,k,l,n)):g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,
b.nStartCol,b.nEndRow,b.nEndCol,n)}}}catch(m){g_objCommonUtil.displayErrorAlert(m,"keyDownMoveArrow")}}};

var g_objPropFormSink=new function(){var e=this;this.objButton_PreviewCreate=this.objButton_Apply_bgColor=this.objButton_Apply_Border=this.objTxtFormBorderWidth=this.objCheck_KeepHeight=this.objSelect_DefineHeight=this.objSelect_DefineWidth=null;this.bAvailableButton=!1;this.arrDefineWidth=["5","1"];this.arrDefineHeight="10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35".split(" ");this.setupPropFormUI=function(a){try{this.objSelect_DefineWidth=g_objLayerKit.getElementById("selFormDefineWidth");
for(var b=0;b<this.arrDefineWidth.length;b++)g_objNodeUtil.addOptionForSelectBox(this.objSelect_DefineWidth,b,this.arrDefineWidth[b]);this.objSelect_DefineWidth.onchange=function(a){e.applyDefineWidth()};a?this.objSelect_DefineWidth.disabled=!0:this.objSelect_DefineWidth.style.backgroundColor="";this.objSelect_DefineHeight=g_objLayerKit.getElementById("selFormDefineHeight");for(b=0;b<this.arrDefineHeight.length;b++)g_objNodeUtil.addOptionForSelectBox(this.objSelect_DefineHeight,this.arrDefineHeight[b],
this.arrDefineHeight[b]);this.objSelect_DefineHeight.onchange=function(a){e.applyDefineHeight()};this.updateDefineWidthHeight();this.objCheck_KeepHeight=g_objLayerKit.getElementById("chkKeepHeightYN");a?(this.objCheck_KeepHeight.disabled=!1,this.objCheck_KeepHeight.checked=!0):(this.objCheck_KeepHeight.disabled=!0,this.objCheck_KeepHeight.checked=!1);this.objTxtFormBorderWidth=g_objLayerKit.getElementById("txtFormBorderWidth");this.objTxtFormBorderWidth.value=1;g_objBorderComboBoxUtil.setSelectedIndex("selFormBorderStyle",
0,0);g_objColorComboBoxUtil.setColorValue("txtFormBorderColor","#000000");g_objBorderSelectionUtil.setBorderWidth(this.objTxtFormBorderWidth.value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selFormBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtFormBorderColor"));g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_2",
!0);g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0);this.objButton_Apply_Border=g_objLayerKit.getElementById("btnForm_Apply_Border");this.objButton_Apply_Border.onclick=function(a){e.applyFormBorderValue()};g_objColorComboBoxUtil.setColorValue("txtFormBgColor","");this.objButton_Apply_bgColor=g_objLayerKit.getElementById("btnForm_Apply_bgColor");this.objButton_Apply_bgColor.onclick=function(a){e.applyFormBackgroundColor()};this.setAvailableButton(!1);this.objButton_PreviewCreate=g_objLayerKit.getElementById("btnForm_PreviewCreate");
this.objButton_PreviewCreate.onclick=function(a){g_objPropForm.doApplyGenerateFormCode();g_objPropForm.dummyAnchorFocus()}}catch(d){g_objCommonUtil.displayErrorAlert(d,"setupPropFormUI")}};this.setAvailableButton=function(a){try{a?(g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_Border,!1,-1),g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_bgColor,!1,-1),this.objButton_Apply_Border.style.cursor="pointer",this.objButton_Apply_bgColor.style.cursor="pointer",this.bAvailableButton=
!0):(g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_Border,!0,2),g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_bgColor,!0,2),this.objButton_Apply_Border.style.cursor="default",this.objButton_Apply_bgColor.style.cursor="default",this.bAvailableButton=!1)}catch(b){g_objCommonUtil.displayErrorAlert(b,"setAvailableButton")}};this.getFormUIBorderValue=function(){try{var a=this.objTxtFormBorderWidth.value+"px",b=g_objBorderComboBoxUtil.getSelectedBorderValue("selFormBorderStyle",
0),d=g_objColorComboBoxUtil.getColorValue("txtFormBorderColor"),c=[];g_objBorderSelectionUtil.getChecked("miniRec_v_0")?(c[0]=a,c[1]=b,c[2]=d):(c[0]="",c[1]="",c[2]="");g_objBorderSelectionUtil.getChecked("miniRec_h_0")?(c[3]=a,c[4]=b,c[5]=d):(c[3]="",c[4]="",c[5]="");g_objBorderSelectionUtil.getChecked("miniRec_v_2")?(c[6]=a,c[7]=b,c[8]=d):(c[6]="",c[7]="",c[8]="");g_objBorderSelectionUtil.getChecked("miniRec_h_2")?(c[9]=a,c[10]=b,c[11]=d):(c[9]="",c[10]="",c[11]="");return c}catch(f){g_objCommonUtil.displayErrorAlert(f,
"getFormUIBorderValue")}};this.updatePropFormUI=function(){try{var a=!1;g_objPropFormEvent.checkGroupSelected()?a=!0:-1!=g_objPropFormEvent.nCurResizeIndex&&(a=!0);this.setAvailableButton(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"updatePropFormUI")}};this.updateDefineWidthHeight=function(){try{var a=g_objPropForm.getFormDrawType();-1!=a&&(this.objSelect_DefineWidth.selectedIndex=a);var b=g_objPropFormCode.getBasisHeight();for(a=0;a<this.arrDefineHeight.length;a++)if(b==this.arrDefineHeight[a]){this.objSelect_DefineHeight.selectedIndex=
a;break}}catch(d){g_objCommonUtil.displayErrorAlert(d,"updateDefineWidthHeight")}};this.updateColorValue=function(a,b){try{a.value=g_objCommonUtil.getHexColorCode(b)}catch(d){g_objCommonUtil.displayErrorAlert(d,"updateColorValue")}};this.updateBorderWidth=function(a){try{if(null==a||""==a)this.objTxtFormBorderWidth.value="";else{var b=g_objCommonUtil.extractNumberValueUnit(a);this.objTxtFormBorderWidth.value=null==b?"":b.nValue}}catch(d){g_objCommonUtil.displayErrorAlert(d,"updateBorderWidth")}};
this.applyFormBorderValue=function(){try{if(0!=this.bAvailableButton){var a=this.getFormUIBorderValue();if(g_objPropFormEvent.checkGroupSelected())g_objPropFormEvent.setFormGroupBorderValue(a),g_objPropFormEvent.displayGroupAreaRectangle(0,0);else if(-1!=g_objPropFormEvent.nCurResizeIndex){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];g_objPropFormEvent.setFormBorderValue(b,a);g_objPropFormEvent.displayAreaRectangle(b.nStartRow,b.nStartCol,b.nEndRow,b.nEndCol,b.objOutlineUtil,
!0,!1)}}}catch(d){g_objCommonUtil.displayErrorAlert(d,"applyFormBorderValue")}};this.applyFormBackgroundColor=function(){try{if(0!=this.bAvailableButton)if(g_objPropFormEvent.checkGroupSelected()){var a=g_objColorComboBoxUtil.getColorValue("txtFormBgColor");g_objPropFormEvent.setFormGroupBackgroundColor(a)}else-1!=g_objPropFormEvent.nCurResizeIndex&&(a=g_objColorComboBoxUtil.getColorValue("txtFormBgColor"),g_objPropFormEvent.setFormBackgroundColor(g_objPropFormEvent.nCurResizeIndex,a))}catch(b){g_objCommonUtil.displayErrorAlert(b,
"applyFormBackgroundColor")}};this.checkFocusPropFormUI=function(){try{var a=g_objLayerKit.getLayerDocument().activeElement;if(null==a)return!1;var b=g_objNodeUtil.getElementTagName(a).toLowerCase();if("input"==b||"select"==b||"checkbox"==b)return!0}catch(d){g_objCommonUtil.displayErrorAlert(d,"checkFocusPropFormUI")}return!1};this.applyDefineWidth=function(){try{if(confirm(ID_RES_CONST_STRING_LOSE_ALL_CONTINUE))0==this.objSelect_DefineWidth.value?g_objPropForm.setFormDrawType(g_objPropForm.ID_DRAW_TYPE_20_COL):
g_objPropForm.setFormDrawType(g_objPropForm.ID_DRAW_TYPE_100_COL),g_objPropForm.assignDrawFormTable(g_objPropForm.nDrawMaxRow,g_objPropForm.nDrawMaxCol,g_objPropForm.nDrawCellWidth,g_objPropForm.nDrawCellHeight),g_objPropForm.setPropFormEvent(),g_objPropForm.dummyAnchorFocus();else{var a=g_objPropForm.getFormDrawType();-1!=a&&(this.objSelect_DefineWidth.selectedIndex=a)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"applyDefineWidth")}};this.applyDefineHeight=function(){try{g_objPropFormCode.setBasisHeight(this.objSelect_DefineHeight.value)}catch(a){g_objCommonUtil.displayErrorAlert(a,
"applyDefineHeight")}}};

var g_strBackgroundImageURL=null,propTagCommon=function(){propTagCommon.prototype.buildTagTable_General=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_ROW_COL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_ROW_NUM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableRowCount",
"",20,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_COL_NUM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableColCount","",20,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SIZE_DEFINE+"</div>";a+=
"<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_WIDTH+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableWidth","",2E3,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_PROP_TAG_STRING_WIDTH_UNIT+
" : </td>";a+='<td><input type="radio" id="rdoWidthUnit_Px" name="rdoWidthUnit" value="0" /> px</td>';a+='<td width="10"></td>';a+='<td><input type="radio" id="rdoWidthUnit_Percentage" name="rdoWidthUnit" value="0" /> %</td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2" style="height:4px;"></td>';a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_HEIGHT+" : </td>";a+=
"<td>"+duzon_dialog.makeSpinnerInputForm("txtTableHeight","",3E3,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_ALL_CELL_INNER_MARGIN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_MARGIN+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableCellPadding","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN+" : </td>";a+="<td>";a+='<select id="selTableAlign" name="selTableAlign" style="width:100%;">';a+='<option value="">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN_NONE+"</option>";a+='<option value="left">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN_LEFT+"</option>";a+='<option value="center">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN_CENTER+"</option>";a+='<option value="right">'+
ID_RES_PROP_TAG_STRING_TABLE_ALIGN_RIGHT+"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ID_CLASS_DEFINE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_ID+" : </td>";a+='<td><input type="text" id= "txtTableId" name="txtTableId" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_CLASS+" : </td>";a+='<td><input type="text" id="txtTableClass" name="txtTableClass" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+
"</table></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTable_General")}};propTagCommon.prototype.buildTagCommon_Border=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_DIALOG_TAB_BORDER+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_SIZE+
" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtBorderWidth","px",10,0,"","g_objPropTagCommon.onChangeSpinnerValue")+"</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_TYPE+" : </td>";a+="<td>";a+=g_objBorderComboBoxUtil.makeBorderComboBoxHTML("selBorderStyle",0,70,90);a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';a+="</td>";a+=
"</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+="<td>";a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBorderColor",70);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td style="text-align:center;">';a+=g_objBorderSelectionUtil.makeBorderSelectionHTML(0,16,24,!0);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,
"buildTagCommon_Border")}};propTagCommon.prototype.buildTagCommon_Background=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_FILL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoBackgroundColorUseNo" name="rdoBackgroundColorUseYN" value="0" /></td>';
a+="<td>"+ID_RES_PROP_TAG_STRING_NO_COLOR_FILL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoBackgroundColorUseYes" name="rdoBackgroundColorUseYN" value="1" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_COLOR+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';
a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FACE_COLOR+"</td>";a+="<td>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBackgroundColor",150)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_IMAGE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="checkbox" id="chkBackgroundImageUseYN" name="chkBackgroundImageUseYN" value="0" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_USER_IMAGE+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<form name="frmImageFileUpload" method="post" enctype="multipart/form-data" target="ifrmImageFileUploadTarget" action="'+
dzeEnvConfig.strUploadImageURL+'">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_IMAGE_FILE+"</td>";a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<input type="file" id="fileBackgroundImage" name="dze_upimage_file" style="width:100%;" accept=".png,.jpg,.gif" value="" />';a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";
a+="</table>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<input type="text" id="txtReadBackgroundImageURL" name="txtReadBackgroundImageURL" style="width:100% !important;" disabled value="" />';a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</form>";a+='<iframe name="ifrmImageFileUploadTarget" id="ifrmImageFileUploadTarget" style="width:;height:;display:none;"></iframe>';
a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:4px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FILL_TYPE+"</td>";a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<select id="selBackgroundRepeat" name="selBackgroundRepeat" style="width:100%;">';
a+='<option value="repeat">'+ID_RES_PROP_TAG_STRING_REPEAT+"</option>";a+='<option value="repeat-x">'+ID_RES_PROP_TAG_STRING_REPEAT_HOR+"</option>";a+='<option value="repeat-y">'+ID_RES_PROP_TAG_STRING_REPEAT_VER+"</option>";a+='<option value="no-repeat">'+ID_RES_PROP_TAG_STRING_REPEAT_NO+"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagCommon_Background")}};
propTagCommon.prototype.uploadImageFile=function(){try{var a=g_objLayerKit.getLayerDocument().forms.frmImageFileUpload;g_strBackgroundImageURL=null;g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="";if(!0===dzeUiConfig.bUseImageExtUpload)g_objExtUploader.initWithUploadItem(a,!0);else{var b=g_objLayerKit.getElementById("ifrmImageFileUploadTarget");b.attachEvent?b.attachEvent("onload",g_objPropTagCommon.uploadImageFileDone):b.addEventListener("load",g_objPropTagCommon.uploadImageFileDone,
!1);a.submit()}}catch(c){g_objCommonUtil.displayErrorAlert(c,"uploadImageFile")}};propTagCommon.prototype.uploadImageFileDone=function(){try{var a=g_objLayerKit.getElementById("ifrmImageFileUploadTarget").contentWindow.document.body.innerHTML,b=duzon_http.parseJSON(a);"success"!=b.result?(alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),g_strBackgroundImageURL=null):(g_strBackgroundImageURL=b.url,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=b.url)}catch(c){g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=
"",g_objCommonUtil.displayErrorAlert(c,"uploadImageFileDone")}};propTagCommon.prototype.onChangeSpinnerValue=function(a){try{g_objBorderSelectionUtil.setBorderWidth(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"onChangeSpinnerValue")}}},g_objPropTagCommon=new propTagCommon;

var propTagSelect=function(){var g=this;this.objInputDisplayContainer=this.objSelectDisplayCount=this.objSelectElement=null;this.nMaxCount=50;propTagSelect.prototype.buildTagSelect=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<div class="duzon_dialog_label_title" style="margin-top:6px;">'+ID_RES_PROP_TAG_LIST_NUM+"</div>";a+="</td>";a+='<td width="50%" style="text-align:center;">';
a+='<select id="selectDisplayCount">';a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_LIST_CONTENT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="inputDisplayContainer" style="text-align:center;padding:0px;">';a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:280px;"></div>'}catch(c){g_objCommonUtil.displayErrorAlert(c,
"buildTagSelect")}};propTagSelect.prototype.initPropTagSelect=function(a){try{if(null!=a&&(this.objSelectElement=a,this.objSelectDisplayCount=g_objLayerKit.getElementById("selectDisplayCount"),null!=this.objSelectDisplayCount&&(this.objSelectDisplayCount.onchange=function(a){g.changeDisplayInfo()},this.objInputDisplayContainer=g_objLayerKit.getElementById("inputDisplayContainer"),null!=this.objInputDisplayContainer))){this.drawDisplayContent(this.nMaxCount,this.objSelectDisplayCount,this.objInputDisplayContainer);
var c=a.options.length;this.setupDisplayCount(c,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,c);this.assignDisplayContent(this.nMaxCount,a)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"initPropTagSelect")}};propTagSelect.prototype.drawDisplayContent=function(a,c,b){try{for(var d=0;d<a;d++)g_objNodeUtil.addOptionForSelectBox(c,d,d+1);for(d=0;d<a;d++){var e=document.createElement("div");e.style.marginTop="4px";e.style.marginBottom="4px";e.id="inputContainer_"+d;var f=document.createElement("input");
f.setAttribute("type","text");f.style.width="90%";f.id="inputContent_"+d;e.appendChild(f);b.appendChild(e)}}catch(h){g_objCommonUtil.displayErrorAlert(h,"drawDisplayContent")}};propTagSelect.prototype.setupDisplayCount=function(a,c){try{for(var b=0;b<c.options.length;b++)if(a-1==c.options[b].value){c.selectedIndex=b;break}}catch(d){g_objCommonUtil.displayErrorAlert(d,"setupDisplayCount")}};propTagSelect.prototype.setupDisplayContent=function(a,c){try{for(var b=0;b<a;b++)if(b<c){var d=g_objLayerKit.getElementById("inputContainer_"+
b);d.style.display=""}else d=g_objLayerKit.getElementById("inputContainer_"+b),d.style.display="none"}catch(e){g_objCommonUtil.displayErrorAlert(e,"setupDisplayContent")}};propTagSelect.prototype.assignDisplayContent=function(a,c){try{for(var b=0;b<c.options.length;b++)if(b<a)g_objLayerKit.getElementById("inputContent_"+b).value=c.options[b].text;else break}catch(d){g_objCommonUtil.displayErrorAlert(d,"assignDisplayContent")}};propTagSelect.prototype.changeDisplayInfo=function(){try{var a=this.objSelectDisplayCount.selectedIndex+
1;this.setupDisplayCount(a,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"changeDisplayInfo")}};propTagSelect.prototype.applyDisplayInfo=function(){try{for(;0<this.objSelectElement.options.length;)this.objSelectElement.removeChild(this.objSelectElement.options[0]);for(var a=this.objSelectDisplayCount.selectedIndex+1,c=0;c<a;c++){var b=g_objLayerKit.getElementById("inputContent_"+c).value;g_objNodeUtil.addOptionForSelectBox(this.objSelectElement,
"",b)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"applyDisplayInfo")}}},g_objPropTagSelect=new propTagSelect;

var propTagTableCreate=function(){var c=this;this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=this.objTxtBorderWidth=this.objSelTableAlign=this.objTxtTableCellPadding=this.objRdoWidthUnit_Percentage=this.objRdoWidthUnit_Px=this.objTxtTableHeight=this.objTxtTableWidth=this.objTxtTableColCount=this.objTxtTableRowCount=null;propTagTableCreate.prototype.buildTagTableCreate_General=function(){try{var a=
"";return a+=g_objPropTagCommon.buildTagTable_General()}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTable_General")}};propTagTableCreate.prototype.buildTagTableCreate_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTable_Border")}};propTagTableCreate.prototype.buildTagTableCreate_Background=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(b){g_objCommonUtil.displayErrorAlert(b,
"buildTagTableCreate_Background")}};propTagTableCreate.prototype.buildTagTableCreateCommon=function(){return'<div style="height:1px;width:380px;"></div>'};propTagTableCreate.prototype.initPropTagTableCreate=function(){try{g_strBackgroundImageURL=null;duzon_dialog.modifySpinnerValue("txtTableRowCount",100,1,"","");duzon_dialog.modifySpinnerValue("txtTableColCount",100,1,"","");var a=g_objTableUtil.getMaxTableWidth();0===a&&(a=2E3);duzon_dialog.modifySpinnerValue("txtTableWidth",a,0,"","");duzon_dialog.modifySpinnerValue("txtTableHeight",
3E3,0,"","");duzon_dialog.modifySpinnerValue("txtTableCellPadding",100,0,"","");duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"","g_objPropTagCommon.onChangeSpinnerValue");this.objTxtTableRowCount=g_objLayerKit.getElementById("txtTableRowCount");this.objTxtTableColCount=g_objLayerKit.getElementById("txtTableColCount");this.objTxtTableRowCount.value=5;this.objTxtTableColCount.value=4;this.objTxtTableWidth=g_objLayerKit.getElementById("txtTableWidth");this.objTxtTableHeight=g_objLayerKit.getElementById("txtTableHeight");
duzon_dialog.setEnableSpinner("txtTableHeight",!1);this.objTxtTableHeight.value="auto";this.objRdoWidthUnit_Px=g_objLayerKit.getElementById("rdoWidthUnit_Px");this.objRdoWidthUnit_Percentage=g_objLayerKit.getElementById("rdoWidthUnit_Percentage");this.objRdoWidthUnit_Percentage.checked=!0;this.objTxtTableCellPadding=g_objLayerKit.getElementById("txtTableCellPadding");this.objTxtTableCellPadding.value=1;this.objSelTableAlign=g_objLayerKit.getElementById("selTableAlign");this.objSelTableAlign.selectedIndex=
0;this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth");this.objTxtBorderWidth.value=1;g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,1);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();
g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_1",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_1",
!0);g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0);g_objBorderSelectionUtil.updateSelectRec();this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo");this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes");this.objRdoBackgroundColorUseNo.checked=!0;g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1);g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",
"#ffffff");this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)};this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)};this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN");this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage");this.objFileBackgroundImage.disabled=!0;this.objFileBackgroundImage.onchange=function(){g_objPropTagCommon.uploadImageFile()};
this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat");this.objSelBackgroundRepeat.disabled=!0;this.objChkBackgroundImageUseYN.onclick=function(a){this.checked?(c.objFileBackgroundImage.disabled=!1,c.objSelBackgroundRepeat.disabled=!1):(c.objFileBackgroundImage.disabled=!0,c.objSelBackgroundRepeat.disabled=!0)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"initPropTagTable")}};propTagTableCreate.prototype.checkValidateData=function(){try{return"%"==(this.objRdoWidthUnit_Px.checked?
"":"%")&&100<g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value)?(alert(ID_RES_PROP_TAG_ALERT_UNDER_100PER),!1):!0}catch(a){g_objCommonUtil.displayErrorAlert(a,"checkValidateData")}};propTagTableCreate.prototype.getPropSettingData=function(){try{var a=[],b=g_objCommonUtil.getNumberValue(this.objTxtTableRowCount.value);if(null==b)return null;var c=g_objCommonUtil.getNumberValue(this.objTxtTableColCount.value);if(null==c)return null;var f=g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value),
g=this.objRdoWidthUnit_Px.checked?"":"%",h=g_objCommonUtil.getNumberValue(this.objTxtTableCellPadding.value),k=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0"),l=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),m=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2"),n=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0"),p=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),q=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2"),d=null;this.objRdoBackgroundColorUseYes.checked&&(d=
g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));var e=null;this.objChkBackgroundImageUseYN.checked&&(e=g_strBackgroundImageURL);var r=this.objSelBackgroundRepeat.value,t=this.objSelTableAlign.value;a[0]=b;a[1]=c;a[2]=f;a[3]=g;a[4]=null;a[5]="";a[6]=h;a[7]=k;a[8]=l;a[9]=m;a[10]=n;a[11]=p;a[12]=q;a[13]=d;a[14]=e;a[15]=r;a[16]=t;return a}catch(u){g_objCommonUtil.displayErrorAlert(u,"getPropSettingData")}return null}},g_objPropTagTableCreate=new propTagTableCreate;

var g_objPropTagTable=new function(){var g=this;this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=this.objTxtBorderWidth=this.objTxtTableClass=this.objTxtTableId=this.objSelTableAlign=this.objTxtTableCellPadding=this.objRdoWidthUnit_Percentage=this.objRdoWidthUnit_Px=this.objTxtTableHeight=this.objTxtTableWidth=this.objTxtTableColCount=this.objTxtTableRowCount=this.arrInitBorderAttribute=this.arrInitTableAttribute=
this.objTableInfo=null;this.buildTagTable_General=function(){try{var a="";return a+=g_objPropTagCommon.buildTagTable_General()}catch(d){g_objCommonUtil.displayErrorAlert(d,"buildTagTable_General")}};this.buildTagTable_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(d){g_objCommonUtil.displayErrorAlert(d,"buildTagTable_Border")}};this.buildTagTable_Background=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(d){g_objCommonUtil.displayErrorAlert(d,
"buildTagTable_Background")}};this.buildTagTableCommon=function(){return'<div style="height:1px;width:380px;"></div>'};this.initPropTagTable=function(a,d){try{g_strBackgroundImageURL=null;this.objTableInfo=a;this.arrInitBorderAttribute=this.arrInitTableAttribute=null;duzon_dialog.modifySpinnerValue("txtTableRowCount",20,0,"","");duzon_dialog.modifySpinnerValue("txtTableColCount",20,0,"","");var e=g_objTableUtil.getMaxTableWidth();0===e&&(e=2E3);duzon_dialog.modifySpinnerValue("txtTableWidth",e,0,
"","");duzon_dialog.modifySpinnerValue("txtTableHeight",3E3,0,"","");duzon_dialog.modifySpinnerValue("txtTableCellPadding",100,0,"","");duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"","g_objPropTagCommon.onChangeSpinnerValue");this.objTxtTableRowCount=g_objLayerKit.getElementById("txtTableRowCount");this.objTxtTableColCount=g_objLayerKit.getElementById("txtTableColCount");this.objTxtTableWidth=g_objLayerKit.getElementById("txtTableWidth");this.objTxtTableHeight=g_objLayerKit.getElementById("txtTableHeight");
this.objRdoWidthUnit_Px=g_objLayerKit.getElementById("rdoWidthUnit_Px");this.objRdoWidthUnit_Percentage=g_objLayerKit.getElementById("rdoWidthUnit_Percentage");this.objRdoWidthUnit_Px.addEventListener("change",function(){g.onRadioChange(g.objRdoWidthUnit_Px)});this.objRdoWidthUnit_Percentage.addEventListener("change",function(){g.onRadioChange(g.objRdoWidthUnit_Percentage)});duzon_dialog.setEnableSpinner("txtTableHeight",!1);this.objTxtTableHeight.value="auto";this.objTxtTableCellPadding=g_objLayerKit.getElementById("txtTableCellPadding");
this.objSelTableAlign=g_objLayerKit.getElementById("selTableAlign");this.objTxtTableId=g_objLayerKit.getElementById("txtTableId");this.objTxtTableId.onblur=function(){var b=g_objPropTagTable.objTxtTableId.value;0<b.length&&(b=g_objEditorDocument[d].getElementById(b),!1===fnObjectCheckNull(b)&&b!==a&&(b=g_objTableUtil.getID(a),g_objPropTagTable.objTxtTableId.value=0<b.length?b:"",alert(ID_RES_DIALOG_ALERT_DUPLICATED_ID)))};this.objTxtTableClass=g_objLayerKit.getElementById("txtTableClass");this.objTxtBorderWidth=
g_objLayerKit.getElementById("txtBorderWidth");this.objTxtBorderWidth.value=1;g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",0,0);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value);
g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo");this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes");g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!1)};this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)};this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN");this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage");this.objFileBackgroundImage.onchange=function(){g_objPropTagCommon.uploadImageFile()};this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat");this.objChkBackgroundImageUseYN.onclick=function(a){this.checked?
(g.objFileBackgroundImage.disabled=!1,g.objSelBackgroundRepeat.disabled=!1):(g.objFileBackgroundImage.disabled=!0,g.objSelBackgroundRepeat.disabled=!0)};if(a){var f=a.rows.length,b=g_objTableUtil.getTableMaxColSpanCount(a);this.objTxtTableRowCount.value=f;this.objTxtTableColCount.value=b;duzon_dialog.setEnableSpinner("txtTableRowCount",!1);duzon_dialog.setEnableSpinner("txtTableColCount",!1);var c=g_objNodeUtil.getNodeWidthHeight(a,!0);e="";""==c.strUnit||"px"==c.strUnit?(""!=c.nValue&&null!=c.nValue&&
(this.objTxtTableWidth.value=c.nValue),this.objRdoWidthUnit_Px.checked=!0):"%"==c.strUnit?(""!=c.nValue&&null!=c.nValue&&(duzon_dialog.modifySpinnerValue("txtTableWidth",100,0,"",""),this.objTxtTableWidth.value=c.nValue),this.objRdoWidthUnit_Percentage.checked=!0,e="%"):this.objRdoWidthUnit_Px.checked=!0;var t=g_objTableUtil.getTableCellPadding(a);this.objTxtTableCellPadding.value=t;var m=g_objTableUtil.getAlignTableByStyleProperty(a);this.objSelTableAlign.selectedIndex=m;var h=g_objTableUtil.getID(a);
this.objTxtTableId.value=h;var n=g_objTableUtil.getClass(a);this.objTxtTableClass.value=n;this.arrInitBorderAttribute="     ".split(" ");var k=g_objTableFunction.getCellBorderAttribute(g_objEditorDocument[d],a,!1,d),p=k[0][0],r=k[0][1];p||r?!p&&r?g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"):p&&!r&&g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"):(g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"),g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"));g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_0",
!1,"");g_objBorderSelectionUtil.bHide_MiniRec_h_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_2",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_v_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_2",!1,"");g_objBorderSelectionUtil.updateSelectRec();var l=a.style.backgroundColor;
null==l||""==l?(l=null,this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff")):(l=g_objCommonUtil.getHexColorCode(l),this.objRdoBackgroundColorUseYes.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",l));var q=g_objPropertyUtil.getBackgroundImageURL(a);c=null;null==q||""==q?(q=null,this.objFileBackgroundImage.disabled=
!0,this.objSelBackgroundRepeat.disabled=!0):(this.objChkBackgroundImageUseYN.checked=!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=q,c=a.style.backgroundRepeat,"repeat"==c?this.objSelBackgroundRepeat.selectedIndex=0:"repeat-x"==c?this.objSelBackgroundRepeat.selectedIndex=1:"repeat-y"==c?this.objSelBackgroundRepeat.selectedIndex=2:"no-repeat"==c&&(this.objSelBackgroundRepeat.selectedIndex=3));this.arrInitTableAttribute=[];this.arrInitTableAttribute[ID_PROP_NODE_BORDER]=null;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]=
l;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE]=[q,c];this.arrInitTableAttribute[ID_PROP_NODE_GENERAL]=[this.objTxtTableWidth.value,e,t]}}catch(u){g_objCommonUtil.displayErrorAlert(u,"initPropTagTable")}};this.checkValidateData=function(){try{return"%"==(this.objRdoWidthUnit_Px.checked?"":"%")&&100<g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value)?(alert(ID_RES_PROP_TAG_ALERT_UNDER_100PER),!1):!0}catch(a){g_objCommonUtil.displayErrorAlert(a,"checkValidateData")}};this.getPropSettingData=
function(){try{var a=[],d=g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value),e=this.objRdoWidthUnit_Px.checked?"":"%",f=g_objCommonUtil.getNumberValue(this.objTxtTableCellPadding.value);a[ID_PROP_NODE_GENERAL]=[d,e,f,this.objSelTableAlign.value,this.objTxtTableId.value,this.objTxtTableClass.value];d=!0;var b=g_objBorderSelectionUtil.bHide_MiniRec_h_1?!1:!0,c=g_objBorderSelectionUtil.bHide_MiniRec_v_1?!1:!0,g=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");ID_PROP_BORDER_DUPLICATED_VALUE==
g&&(g=ID_PROP_BORDER_DUPLICATED);e="";b&&(e=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),ID_PROP_BORDER_DUPLICATED_VALUE==e&&(e=ID_PROP_BORDER_DUPLICATED));var m=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");ID_PROP_BORDER_DUPLICATED_VALUE==m&&(m=ID_PROP_BORDER_DUPLICATED);var h=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");ID_PROP_BORDER_DUPLICATED_VALUE==h&&(h=ID_PROP_BORDER_DUPLICATED);f="";c&&(f=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),ID_PROP_BORDER_DUPLICATED_VALUE==
f&&(f=ID_PROP_BORDER_DUPLICATED));var n=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");ID_PROP_BORDER_DUPLICATED_VALUE==n&&(n=ID_PROP_BORDER_DUPLICATED);g==this.arrInitBorderAttribute[0]&&e==this.arrInitBorderAttribute[1]&&m==this.arrInitBorderAttribute[2]&&h==this.arrInitBorderAttribute[3]&&f==this.arrInitBorderAttribute[4]&&h==this.arrInitBorderAttribute[5]&&(d=!1);a[ID_PROP_NODE_BORDER]=[d,!0,b,!0,!0,c,!0,g,e,m,h,f,n];b=null;this.objRdoBackgroundColorUseYes.checked&&(b=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));
a[ID_PROP_NODE_BACKGROUND_COLOR]=b==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?[!1,b]:[!0,b];b=null;this.objChkBackgroundImageUseYN.checked&&(b=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var k=this.objSelBackgroundRepeat.value;a[ID_PROP_NODE_BACKGROUND_IMAGE]=b==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?k==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[!1,b,k]:[!0,b,k]:[!0,b,k];return a}catch(p){g_objCommonUtil.displayErrorAlert(p,
"getPropSettingData")}return null};this.onRadioChange=function(a){try{if(a==this.objRdoWidthUnit_Px){var d=parseFloat(this.objTxtTableWidth.value)/100,e=g_objCommonUtil.convPercentToPx(this.objTableInfo,d),f=Math.round(e),b=g_objTableUtil.getMaxTableWidth();0===b&&(b=2E3);f=Math.max(Math.min(b,f),0);duzon_dialog.modifySpinnerValue("txtTableWidth",b,0,"","");this.objTxtTableWidth.value=f}else a==this.objRdoWidthUnit_Percentage&&(e=parseFloat(this.objTxtTableWidth.value),d=100*g_objCommonUtil.convPxToPercent(this.objTableInfo,
e),f=Math.round(d),b=100,f=Math.max(Math.min(b,f),0),duzon_dialog.modifySpinnerValue("txtTableWidth",b,0,"",""),this.objTxtTableWidth.value=f)}catch(c){g_objCommonUtil.displayErrorAlert(c,"prop_tag_table.onRadioChange")}}};

var g_objPropTagTableCell=new function(){this.objTxtCellClass=this.objTxtCellId=this.objSelVerticalAlign=this.objSelTextAlign=this.objTxtCellPaddingBottom=this.objTxtCellPaddingRight=this.objTxtCellPaddingTop=this.objTxtCellPaddingLeft=this.objTableNode=null;this.buildTagTableCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_SET_INNER_MARGIN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_LEFT+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingLeft","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TOP+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingTop",
"px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_RIGHT+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingRight","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_BOTTOM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingBottom","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_CONST_STRING_ALIGN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_ALIGN_HOR+" : </td>";a+="<td>";a+='<select id="selTextAlign" name="selTextAlign" style="width:100px;">';a+='<option value=""></option>';a+='<option value="left">'+ID_RES_CONST_STRING_JUSTIFYLEFT+"</option>";a+='<option value="center">'+ID_RES_CONST_STRING_JUSTIFYCENTER+"</option>";a+='<option value="right">'+ID_RES_CONST_STRING_JUSTIFYRIGHT+"</option>";a+="</select>";a+="</td>";a+="</tr>";
a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_ALIGN_VER+" : </td>";a+="<td>";a+='<select id="selVerticalAlign" name="selVerticalAlign" style="width:100px;">';a+='<option value=""></option>';a+='<option value="top">'+ID_RES_PROP_TAG_STRING_ALIGN_TOP+"</option>";a+='<option value="middle">'+ID_RES_PROP_TAG_STRING_ALIGN_MIDDLE+"</option>";a+='<option value="bottom">'+ID_RES_PROP_TAG_STRING_ALIGN_BOTTOM+
"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ID_CLASS_DEFINE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TABLE_ID+
" : </td>";a+='<td><input type="text" id= "txtCellId" name="txtCellId" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TABLE_CLASS+" : </td>";a+='<td><input type="text" id="txtCellClass" name="txtCellClass" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(u){g_objCommonUtil.displayErrorAlert(u,
"buildTagTableCell")}};this.buildTagTableCellCommon=function(){return'<div style="height:1px;width:380px;"></div>'};this.initPropTagTableCell=function(a,u){try{if(this.objTableNode=a,!fnObjectCheckNull(a)){duzon_dialog.modifySpinnerValue("txtCellPaddingLeft",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingTop",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingRight",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingBottom",100,0,"","");this.objTxtCellPaddingLeft=g_objLayerKit.getElementById("txtCellPaddingLeft");
this.objTxtCellPaddingTop=g_objLayerKit.getElementById("txtCellPaddingTop");this.objTxtCellPaddingRight=g_objLayerKit.getElementById("txtCellPaddingRight");this.objTxtCellPaddingBottom=g_objLayerKit.getElementById("txtCellPaddingBottom");this.objSelTextAlign=g_objLayerKit.getElementById("selTextAlign");this.objSelVerticalAlign=g_objLayerKit.getElementById("selVerticalAlign");this.objTxtCellId=g_objLayerKit.getElementById("txtCellId");this.objTxtCellId.onblur=function(){var a=g_objPropTagTableCell.objTxtCellId.value;
0<a.length&&(a=g_objEditorDocument[u].getElementById(a),!1===fnObjectCheckNull(a)&&a!==p&&(a=g_objTableUtil.getID(p),g_objPropTagTableCell.objTxtCellId.value=0<a.length?a:"",alert(ID_RES_DIALOG_ALERT_DUPLICATED_ID)))};!0===GetMultiCellSelection()&&(this.objTxtCellId.disabled=!0);this.objTxtCellClass=g_objLayerKit.getElementById("txtCellClass");for(var c=[],k=[],d=[],e=[],b=[],l=[],q=null,p=null,m=null,r=!1,v=a.rows.length,n=0;n<v;n++)for(var E=g_objTableUtil.getTableCellsLength(a,n),w=0;w<E;w++){var x=
g_objTableFlag.GetCellAttribute_Flag(a,n,w);if(1==x||2==x||3==x||4==x){var g=g_objTableUtil.getTableCellElement(a,n,w),y=g.style.paddingLeft;inArray(y,c)||(c[c.length]=y);var z=g.style.paddingTop;inArray(z,k)||(k[k.length]=z);var A=g.style.paddingRight;inArray(A,d)||(d[d.length]=A);var B=g.style.paddingBottom;inArray(B,e)||(e[e.length]=B);var h=g.style.textAlign;if(null==h||""==h)h=g.align;inArray(h,b)||(b[b.length]=h);var t=g.style.verticalAlign;inArray(t,l)||(l[l.length]=t);if(!1===this.objTxtCellId.disabled){var F=
g_objTableUtil.getID(g);p=g;q=F}if(!1===r){var C=g_objTableUtil.getClass(g);!1===fnObjectCheckNull(m)&&0<m.length&&m!==C?r=!0:m=C}}}if(1==c.length&&""!=c[0]){var f=g_objCommonUtil.extractNumberValueUnit(c[0]);null!=f&&(this.objTxtCellPaddingLeft.value=f.nValue)}1==k.length&&""!=k[0]&&(f=g_objCommonUtil.extractNumberValueUnit(k[0]),null!=f&&(this.objTxtCellPaddingTop.value=f.nValue));1==d.length&&""!=d[0]&&(f=g_objCommonUtil.extractNumberValueUnit(d[0]),null!=f&&(this.objTxtCellPaddingRight.value=
f.nValue));1==e.length&&""!=e[0]&&(f=g_objCommonUtil.extractNumberValueUnit(e[0]),null!=f&&(this.objTxtCellPaddingBottom.value=f.nValue));1==b.length?(h=b[0].toLowerCase(),this.objSelTextAlign.selectedIndex="left"==h?1:"center"==h?2:"right"==h?3:0):this.objSelTextAlign.selectedIndex=0;1==l.length?(t=l[0].toLowerCase(),this.objSelVerticalAlign.selectedIndex="top"==t?1:"middle"==t?2:"bottom"==t?3:0):this.objSelVerticalAlign.selectedIndex=0;null!==q&&(this.objTxtCellId.value=q);!1===r&&(this.objTxtCellClass.value=
m)}}catch(D){g_objCommonUtil.displayErrorAlert(D,"initPropTagTableCell")}};this.applyPropTagTableCell=function(){try{if(!fnObjectCheckNull(this.objTableNode))for(var a=this.objTableNode,u=a.rows.length,c=0;c<u;c++)for(var k=g_objTableUtil.getTableCellsLength(a,c),d=0;d<k;d++){var e=g_objTableFlag.GetCellAttribute_Flag(a,c,d);if(1==e||2==e||3==e||4==e){var b=g_objTableUtil.getTableCellElement(a,c,d),l=this.objTxtCellPaddingLeft.value;""!=l&&(b.style.paddingLeft=l+"px");var q=this.objTxtCellPaddingTop.value;
""!=q&&(b.style.paddingTop=q+"px");var p=this.objTxtCellPaddingRight.value;""!=p&&(b.style.paddingRight=p+"px");var m=this.objTxtCellPaddingBottom.value;""!=m&&(b.style.paddingBottom=m+"px");var r=this.objSelTextAlign.value;""!=r&&(b.style.textAlign=r,b.align="");var v=this.objSelVerticalAlign.value;""!=v&&(b.style.verticalAlign=v);g_objTableUtil.setID(b,this.objTxtCellId.value);g_objTableUtil.setClass(b,this.objTxtCellClass.value)}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"applyPropTagTableCell")}}};

var ID_PROP_NODE_BORDER=0,ID_PROP_NODE_BACKGROUND_COLOR=1,ID_PROP_NODE_BACKGROUND_IMAGE=2,ID_PROP_NODE_GENERAL=3,ID_PROP_BORDER_DUPLICATED="duplicated",ID_PROP_BORDER_DUPLICATED_VALUE="3px dotted #c5c6c7",propTagTableCellStyle=function(){var c=this;this.objRdoApplyBackground_All=this.objRdoApplyBackground_Selected=this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=this.objTxtBorderWidth=this.arrInitBorderAttribute=
this.arrInitCellAttribute=null;propTagTableCellStyle.prototype.buildTagTableCellStyle_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTableCellStyle_Border")}};propTagTableCellStyle.prototype.buildTagTableCellStyle_Background=function(){try{var a="";a+=g_objPropTagCommon.buildTagCommon_Background();a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_APPLY_RANGE+
"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoApplyBackground_Selected" name="rdoApplyBackground" value="0" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_SELECTED_CELL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="30"><input type="radio" id="rdoApplyBackground_All" name="rdoApplyBackground" value="1" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_ALL_CELL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTableCellStyle_Background")}};propTagTableCellStyle.prototype.buildTagTableCellStyleCommon=function(){return'<div style="height:1px;width:380px;"></div>'};propTagTableCellStyle.prototype.initPropTagTableCellStyle=
function(a,b){try{if(this.arrInitBorderAttribute=this.arrInitCellAttribute=g_strBackgroundImageURL=null,duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"","g_objPropTagCommon.onChangeSpinnerValue"),this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth"),this.objTxtBorderWidth.value=1,g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)}),g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,
1),g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)}),g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000"),g_objBorderSelectionUtil.initBorderSelection(),g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value),g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0)),g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor")),
this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo"),this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor"),this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)},this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)},this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN"),
this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage"),this.objFileBackgroundImage.onchange=function(){g_objPropTagCommon.uploadImageFile()},this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat"),this.objChkBackgroundImageUseYN.onclick=function(a){this.checked?(c.objFileBackgroundImage.disabled=!1,c.objSelBackgroundRepeat.disabled=!1):(c.objFileBackgroundImage.disabled=!0,c.objSelBackgroundRepeat.disabled=!0)},this.objRdoApplyBackground_All=g_objLayerKit.getElementById("rdoApplyBackground_All"),
this.objRdoApplyBackground_Selected=g_objLayerKit.getElementById("rdoApplyBackground_Selected"),this.objRdoApplyBackground_Selected.checked=!0,this.arrInitBorderAttribute="     ".split(" "),this.arrInitCellAttribute=g_objTableFunction.getSelectedCellAttribute(g_objEditorDocument[b],a,b),null!=this.arrInitCellAttribute){var f=this.arrInitCellAttribute[ID_PROP_NODE_BORDER][0][0],d=this.arrInitCellAttribute[ID_PROP_NODE_BORDER][0][1];f||d?!f&&d?g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"):f&&
!d&&g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"):(g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"),g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"));g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_h_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_2",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_v_1||
g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_2",!1,"");g_objBorderSelectionUtil.updateSelectRec();null==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?(this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff")):(this.objRdoBackgroundColorUseYes.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]));null==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?(this.objFileBackgroundImage.disabled=!0,this.objSelBackgroundRepeat.disabled=!0):(this.objChkBackgroundImageUseYN.checked=!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0],"repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?
this.objSelBackgroundRepeat.selectedIndex=0:"repeat-x"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?this.objSelBackgroundRepeat.selectedIndex=1:"repeat-y"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?this.objSelBackgroundRepeat.selectedIndex=2:"no-repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]&&(this.objSelBackgroundRepeat.selectedIndex=3))}}catch(e){g_objCommonUtil.displayErrorAlert(e,"initPropTagTableCellStyle")}};propTagTableCellStyle.prototype.getAssignedBorderValue=
function(a){return null==a||""==a?"":ID_PROP_BORDER_DUPLICATED==a?ID_PROP_BORDER_DUPLICATED_VALUE:a};propTagTableCellStyle.prototype.getPropSettingData=function(){try{var a=[],b=g_objBorderSelectionUtil.bHide_MiniRec_h_1?!1:!0,f=g_objBorderSelectionUtil.bHide_MiniRec_v_1?!1:!0,d=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");ID_PROP_BORDER_DUPLICATED_VALUE==d&&(d=ID_PROP_BORDER_DUPLICATED);var e="";b&&(e=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),ID_PROP_BORDER_DUPLICATED_VALUE==
e&&(e=ID_PROP_BORDER_DUPLICATED));var c=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");ID_PROP_BORDER_DUPLICATED_VALUE==c&&(c=ID_PROP_BORDER_DUPLICATED);var l=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");ID_PROP_BORDER_DUPLICATED_VALUE==l&&(l=ID_PROP_BORDER_DUPLICATED);var h="";f&&(h=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),ID_PROP_BORDER_DUPLICATED_VALUE==h&&(h=ID_PROP_BORDER_DUPLICATED));var m=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");ID_PROP_BORDER_DUPLICATED_VALUE==
m&&(m=ID_PROP_BORDER_DUPLICATED);a[ID_PROP_NODE_BORDER]=[!0,!0,b,!0,!0,f,!0,d,e,c,l,h,m];var g=this.objRdoApplyBackground_All.checked;b=null;this.objRdoBackgroundColorUseYes.checked&&(b=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));a[ID_PROP_NODE_BACKGROUND_COLOR]=b==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?[g,!1,b]:[g,!0,b];b=null;this.objChkBackgroundImageUseYN.checked&&(b=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var k=this.objSelBackgroundRepeat.value;
a[ID_PROP_NODE_BACKGROUND_IMAGE]=b==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?k==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[g,!1,b,k]:[g,!0,b,k]:[g,!0,b,k];return a}catch(n){g_objCommonUtil.displayErrorAlert(n,"getPropSettingData")}return null};propTagTableCellStyle.prototype.checkBorderDuplicatedValue=function(a){}},g_objPropTagTableCellStyle=new propTagTableCellStyle;

var propTagTableSplitCell=function(){var d=this;this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioCol=this.objRadioRow=null;propTagTableSplitCell.prototype.buildTagTableSplitCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SPLIT_ROW_COL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellRow" name="rdoSplitCell" value="0" /><label for="rdoSplitCellRow" style="background: none;">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellRow","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellCol" name="rdoSplitCell" value="1" /><label for="rdoSplitCellCol" style="background: none;">'+ID_RES_PROP_TAG_STRING_COL_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellCol","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:220px;"></div>'}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTableSplitCell")}};
propTagTableSplitCell.prototype.initPropTagTableSplitCell=function(){try{duzon_dialog.modifySpinnerValue("txtPropSplitCellRow",20,2,"","");duzon_dialog.modifySpinnerValue("txtPropSplitCellCol",20,2,"","");this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioRow=g_objLayerKit.getElementById("rdoSplitCellRow");this.objRadioRow.checked=!0;this.objRadioCol=g_objLayerKit.getElementById("rdoSplitCellCol");var a=g_objLayerKit.getElementById("txtPropSplitCellRow"),b=g_objLayerKit.getElementById("txtPropSplitCellCol");
a.value=2;b.value="";this.objRadioRow.onclick=function(c){d.switchSplitCell(!0);a.value=2;b.value=""};this.objRadioCol.onclick=function(c){d.switchSplitCell(!1);a.value="";b.value=2};this.switchSplitCell(!0)}catch(c){g_objCommonUtil.displayErrorAlert(c,"initPropTagTableSplitCell")}};propTagTableSplitCell.prototype.switchSplitCell=function(a){try{a?(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",!0),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!1)):(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",
!1),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!0))}catch(b){g_objCommonUtil.displayErrorAlert(b,"switchSplitCell")}};propTagTableSplitCell.prototype.getPropSettingData=function(){try{if(g_objLayerKit.getElementById("rdoSplitCellRow").checked){this.bSplitRow=!0;var a=g_objLayerKit.getElementById("txtPropSplitCellRow");this.nSplitCount=parseInt(a.value)}else{this.bSplitRow=!1;var b=g_objLayerKit.getElementById("txtPropSplitCellCol");this.nSplitCount=parseInt(b.value)}}catch(c){g_objCommonUtil.displayErrorAlert(c,
"getPropSettingData")}}},g_objPropTagTableSplitCell=new propTagTableSplitCell;

var propTagTableAddRowCol=function(){var c=this;this.objTxtColCount=this.objTxtRowCount=this.objRadioColRight=this.objRadioColLeft=this.objRadioCol=this.objRadioRowBottom=this.objRadioRowTop=this.objRadioRow=null;this.bAddRow=!0;this.nAddCount=this.nAddDirection=-1;propTagTableAddRowCol.prototype.buildTagTableAddRowCol=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"><input type="radio" id="rdoAddRow" name="rdoAddRowCol" value="0" /></td>';a+='<td width="70">'+ID_RES_PROP_TAG_ADD_ROW+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="50"></td>';a+='<td width="24"><input type="radio" id="rdoAddRowTop" name="rdoAddRowTopBottom" value="0" /></td>';
a+='<td width="50" height="22">'+ID_RES_PROP_TAG_UP+"</td>";a+='<td width="90"></td>';a+='<td width="40" rowspan="2">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</td>";a+='<td rowspan="2">'+duzon_dialog.makeSpinnerInputForm("txtAddRowCount","",10,1)+"</td>";a+="</tr>";a+="<tr>";a+='<td width="50"></td>';a+='<td width="24"><input type="radio" id="rdoAddRowBottom" name="rdoAddRowTopBottom" value="0" /></td>';a+='<td width="50" height="22">'+ID_RES_PROP_TAG_DOWN+"</td>";a+='<td width="90"></td>';a+="</tr>";a+=
"</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:20px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"><input type="radio" id="rdoAddCol" name="rdoAddRowCol" value="1" /></td>';a+='<td width="70">'+ID_RES_PROP_TAG_ADD_COL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';a+="</tr>";a+="<tr>";
a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="24"><input type="radio" id="rdoAddColLeft" name="rdoAddColLeftRight" value="0" /></td>';a+='<td width="40">'+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</td>";a+='<td width="24"><input type="radio" id="rdoAddColRight" name="rdoAddColLeftRight" value="0" /></td>';a+='<td width="40">'+ID_RES_DIALOG_STRING_ALIGN_RIGHT+"</td>";a+='<td width="56"></td>';a+='<td width="40">'+
ID_RES_PROP_TAG_STRING_COL_NUM+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtAddColCount","",10,1)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTableAddRowCol")}};propTagTableAddRowCol.prototype.initPropTagTableAddRowCol=function(){try{duzon_dialog.modifySpinnerValue("txtAddRowCount",10,1,"",""),duzon_dialog.modifySpinnerValue("txtAddColCount",10,1,"",
""),this.objRadioRow=g_objLayerKit.getElementById("rdoAddRow"),this.objRadioRowTop=g_objLayerKit.getElementById("rdoAddRowTop"),this.objRadioRowBottom=g_objLayerKit.getElementById("rdoAddRowBottom"),this.objTxtRowCount=g_objLayerKit.getElementById("txtAddRowCount"),this.objRadioRow.checked=!0,this.objRadioRowTop.checked=!0,this.objTxtRowCount.value=1,this.objRadioCol=g_objLayerKit.getElementById("rdoAddCol"),this.objRadioColLeft=g_objLayerKit.getElementById("rdoAddColLeft"),this.objRadioColRight=
g_objLayerKit.getElementById("rdoAddColRight"),this.objTxtColCount=g_objLayerKit.getElementById("txtAddColCount"),this.objRadioColLeft.checked=!0,this.objTxtColCount.value=1,this.objRadioRow.onclick=function(a){c.switchAddRowCol(!0)},this.objRadioCol.onclick=function(a){c.switchAddRowCol(!1)},this.switchAddRowCol(!0)}catch(a){g_objCommonUtil.displayErrorAlert(a,"initPropTagTableAddRowCol")}};propTagTableAddRowCol.prototype.switchAddRowCol=function(a){try{a?(this.objRadioRowTop.disabled=!1,this.objRadioRowBottom.disabled=
!1,duzon_dialog.setEnableSpinner("txtAddRowCount",!0),this.objRadioColLeft.disabled=!0,this.objRadioColRight.disabled=!0,duzon_dialog.setEnableSpinner("txtAddColCount",!1)):(this.objRadioRowTop.disabled=!0,this.objRadioRowBottom.disabled=!0,duzon_dialog.setEnableSpinner("txtAddRowCount",!1),this.objRadioColLeft.disabled=!1,this.objRadioColRight.disabled=!1,duzon_dialog.setEnableSpinner("txtAddColCount",!0))}catch(b){g_objCommonUtil.displayErrorAlert(b,"switchAddRowCol")}};propTagTableAddRowCol.prototype.getPropSettingData=
function(){try{this.objRadioRow.checked?(this.bAddRow=!0,this.nAddDirection=this.objRadioRowTop.checked?0:1,this.nAddCount=parseInt(this.objTxtRowCount.value)):(this.bAddRow=!1,this.nAddDirection=this.objRadioColLeft.checked?0:1,this.nAddCount=parseInt(this.objTxtColCount.value))}catch(a){g_objCommonUtil.displayErrorAlert(a,"getPropSettingData")}}},g_objPropTagTableAddRowCol=new propTagTableAddRowCol;

var propTagTableSelectFormula=function(){var n=this;this.objTableNode=this.objOutlineUtil=this.objTableCopyView=null;this.nSelectedCol=this.nSelectedRow=-1;this.arrRowCol=[];this.objFormulaResult=this.objFormulaData=this.objRadioMutiply=this.objRadioAverage=this.objRadioSum=null;this.strInfoString="\uc801\uc6a9\ud560 \uc140\uc744 \ud3b8\uc9d1\ucc3d\uc5d0\uc11c \uc120\ud0dd\ud558\uc138\uc694";this.strNaNString="\uacc4\uc0b0 \ubd88\uac00\ud55c \ud56d\ubaa9\uc774 \uc120\ud0dd\ub418\uc5c8\uc2b5\ub2c8\ub2e4";
this.bShowTagTableSelectFormula=!1;propTagTableSelectFormula.prototype.buildTagTableSelectFormula=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SELECT_CELL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="formulaData" style="height:80px;text-align:center;" class="mappingCode_preview propSection_td">';
a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_TYPE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td><input type="radio" id="rdoFormulaSum" name="rdoFormula" value="0" /> '+ID_RES_PROP_TAG_STRING_CALC_SUM+"</td>";a+='<td><input type="radio" id="rdoFormulaAverage" name="rdoFormula" value="1" /> '+
ID_RES_PROP_TAG_STRING_CALC_AVG+"</td>";a+='<td><input type="radio" id="rdoFormulaMutiply" name="rdoFormula" value="2" /> '+ID_RES_PROP_TAG_STRING_CALC_MUL+"</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_RESULT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="formulaResult" style="height:40px;text-align:center;" class="mappingCode_preview propSection_td">';
a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){g_objCommonUtil.displayErrorAlert(b,"buildTagTableSelectFormula")}};propTagTableSelectFormula.prototype.initPropTagTableSelectFormula=function(a,b,d,e){try{this.objRadioSum=g_objLayerKit.getElementById("rdoFormulaSum"),this.objRadioAverage=g_objLayerKit.getElementById("rdoFormulaAverage"),this.objRadioMutiply=g_objLayerKit.getElementById("rdoFormulaMutiply"),this.objRadioSum.checked=
!0,this.objRadioSum.onclick=function(a){n.displayData()},this.objRadioAverage.onclick=function(a){n.displayData()},this.objRadioMutiply.onclick=function(a){n.displayData()},this.objFormulaData=g_objLayerKit.getElementById("formulaData"),this.objFormulaResult=g_objLayerKit.getElementById("formulaResult"),this.objTableNode=a,this.nSelectedRow=b,this.nSelectedCol=d,this.arrRowCol=[],this.showTableCopyView(!0,a,b,d,e)}catch(c){g_objCommonUtil.displayErrorAlert(c,"initPropTagTableSelectFormula")}};propTagTableSelectFormula.prototype.initTableCopyView=
function(){try{if(null==this.objTableCopyView){if(!g_objLayerKit.getElementById("tableCopyView")&&!g_objInsertUtil.insertLayerHTML('<div id="tableCopyView" style="display:none;position:absolute;z-index:20028;border:0px;background-color:;filter:alpha(opacity=60);opacity:0.6;"></div>',!0))return;this.objTableCopyView=g_objLayerKit.getElementById("tableCopyView")}null==this.objOutlineUtil&&(this.objOutlineUtil=new outlineUtil,this.objOutlineUtil.initializeExtOutline(!1),this.objOutlineUtil.setZIndexExtOutline(20029))}catch(a){g_objCommonUtil.displayErrorAlert(a,
"initTableCopyView")}};propTagTableSelectFormula.prototype.showTableCopyView=function(a,b,d,e,c){try{if(a){this.bShowTagTableSelectFormula=!0;null==this.objTableCopyView&&this.initTableCopyView();var g=g_objPositionUtil.getOuterRect(b),k=g_objPositionUtil.getOuterRect(g_objEditObject[c]),m=g_objPositionUtil.getOuterRect(window.frameElement),p=m.left+k.left+g.left,q=m.top+k.top+g.top,n=p+g.width,A=q+g.height;this.objTableCopyView.style.left=p+"px";this.objTableCopyView.style.top=q+"px";this.objTableCopyView.style.width=
n-p+"px";this.objTableCopyView.style.height=A-q+"px";a=this.objTableCopyView.style.display="";for(var f=0;f<b.rows.length;f++)for(var t=g_objTableUtil.getTableCellsLength(b,f),h=0;h<t;h++)if(f!=d||h!=e)a+='<input type="checkbox" id="chkFormula_'+f+"_"+h+'" style="position:absolute;" />';this.objTableCopyView.innerHTML=a;g=a=!1;var x=g_objLayerKit.getElementById("chkFormula_0_0").offsetWidth,y=isShowScrollBar(c);for(f=0;f<b.rows.length;f++){var z=g_objPositionUtil.getElementPosClientRect(b.rows[f]);
a=0>z.top||z.top+x+2+(y.horizontal?20:0)>=k.height?!0:!1;t=g_objTableUtil.getTableCellsLength(b,f);for(h=0;h<t;h++)if(f!=d||h!=e){var u=g_objTableUtil.getTableCellElement(b,f,h),l=g_objPositionUtil.getElementPosClientRect(u);objCheckBox=g_objLayerKit.getElementById("chkFormula_"+f+"_"+h);g=l.left<k.left||l.left+x+2+(y.vertical?20:0)>=k.width?!0:!1;if(!0===a||!0===g)objCheckBox.style.display="none";else{objCheckBox.style.display="";var v=m.left+k.left+l.left,w=m.top+k.top+l.top;objCheckBox.style.left=
v-p+1+"px";objCheckBox.style.top=w-q+1+"px";(function(){var a=f,b=h;objCheckBox.onclick=function(c){g_objPropTagTableSelectFormula.clickCheckBox(this,a,b)}})()}}}u=g_objTableUtil.getTableCellElement(b,d,e);l=g_objPositionUtil.getElementPosClientRect(u);var r=g_objPositionUtil.getElementPosition(g_objEditObject[c],!1);v=r.left+l.left;w=r.top+l.top;this.objOutlineUtil.showExtOutline(!0,!1,!1,v,w,r.left+l.right,r.top+l.bottom,!1,!1)}else this.bShowTagTableSelectFormula=!1,this.objTableCopyView.style.display=
"none",this.objOutlineUtil.showExtOutline(!1,!1,!1,0,0,0,0,!1,!1)}catch(B){g_objCommonUtil.displayErrorAlert(B,"showTableCopyView")}};propTagTableSelectFormula.prototype.clickCheckBox=function(a,b,d){try{for(var e=!1,c=0;c<this.arrRowCol.length;c++)if(b==this.arrRowCol[c][0]&&d==this.arrRowCol[c][1]){e=!0;break}a.checked?e||(this.arrRowCol[this.arrRowCol.length]=[b,d]):e&&(this.arrRowCol=this.removeKeyValueInArray(this.arrRowCol,b,d));this.displayData()}catch(g){g_objCommonUtil.displayErrorAlert(g,
"clickCheckBox")}};propTagTableSelectFormula.prototype.removeKeyValueInArray=function(a,b,d){try{for(var e=[];0<a.length;){var c=a.shift();if(b!=c[0]||d!=c[1])e[e.length]=c}return e}catch(g){g_objCommonUtil.displayErrorAlert(g,"removeKeyValueInArray")}};propTagTableSelectFormula.prototype.displayData=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;for(var a="",b=[],d=0;d<this.arrRowCol.length;d++){var e=g_objTableUtil.getTableCellElement(this.objTableNode,
this.arrRowCol[d][0],this.arrRowCol[d][1]),c=g_objPropertyUtil.getTextContent(e);c=c.trim().replace(/[\u200B-\u200D\uFEFF]|(\\n|\\r)+/g,"");c=c.removeComma();if(0!=c.localeCompare("")){if(isNaN(c)){this.objFormulaData.innerHTML=this.strNaNString;this.objFormulaResult.innerHTML=this.strNaNString;return}a=""==a?c:a+(" : "+c);b[d]=parseFloat(c)}}if(""==a)this.objFormulaData.innerHTML=this.strInfoString,this.objFormulaResult.innerHTML=this.strInfoString;else{this.objFormulaData.innerHTML=a;var g=this.getFormulaCode(),
k=g_objTableFunction.doFormulaData(b,g);null!=k&&(this.objFormulaResult.innerHTML=k)}}catch(m){g_objCommonUtil.displayErrorAlert(m,"displayData")}};propTagTableSelectFormula.prototype.getFormulaCode=function(){try{return this.objRadioSum.checked?0:this.objRadioAverage.checked?1:this.objRadioMutiply.checked?2:-1}catch(a){g_objCommonUtil.displayErrorAlert(a,"getFormulaCode")}};propTagTableSelectFormula.prototype.setFormulaResultValue=function(){try{if(this.strInfoString!=this.objFormulaResult.innerHTML&&
""!=this.objFormulaResult.innerHTML){var a=g_objTableUtil.getTableCellElement(this.objTableNode,this.nSelectedRow,this.nSelectedCol);g_objTableUtil.setCellInnerText(this.objFormulaResult.innerHTML,a)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"setFormulaResultValue")}}},g_objPropTagTableSelectFormula=new propTagTableSelectFormula;

var propContentLink=function(){propContentLink.prototype.getPropContentParam=function(b){try{var a={arrValue:[]};a.arrValue[0]="";a.arrValue[1]="";a.arrValue[2]="";a.arrValue[3]="";a.arrValue[4]="";var d=this.setLinkSelection(b);fnObjectCheckNull(d)?a.arrValue[0]="http://":(a.arrValue[0]=""==d[0]?"http://":d[0],a.arrValue[1]=d[1],a.arrValue[2]=d[2],a.arrValue[3]=d[3],a.arrValue[4]=d[4]);return a}catch(e){g_objCommonUtil.displayErrorAlert(e,"getPropContentParam")}return null};propContentLink.prototype.setLinkHTML=
function(b,a,d){try{var e=b[0],f="",h="",c="";f=b[1];h=b[2];"undefined"!=typeof b[3]&&(c=b[3]);if(!fnObjectCheckNull(g_objEditorDocument[a])){if(window.attachEvent){var k=g_objEditorDocument[a].selection;if(fnObjectCheckNull(k))return;var g=k.type;g=g.toLowerCase();if(ID_STRING_NAME_NONE==g||ID_STRING_NAME_TEXT==g){var q=k.createRange();if(fnObjectCheckNull(q))return 0;var n=new Date,r=n.getTime(),p="#"+r;g_objEditorDocument[a].execCommand("CreateLink",!1,p);for(var m=g_objEditorDocument[a].getElementsByTagName("A"),
l=0;l<m.length;l++){var v=m[l].href,w=v.indexOf(p,0);-1!=w&&(m[l].href=e,this.setLinkHTMLDetail(m[l],h,f,c))}}else if(ID_STRING_NAME_CONTROL==g){var u=k.createRange();if(fnObjectCheckNull(u)||1!=u.length)return;var x=u.item(0);g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_UNLINK,!1,null);var z=x.parentElement;if(fnObjectCheckNull(z))return;var t=g_objEditorDocument[a].createElement("a");t.href=e;z.insertBefore(t,x);t.appendChild(x);this.setLinkHTMLDetail(t,h,f,c);u.select()}}else{g=getSelectionTypeForUpdateUI();
if((ID_STRING_NAME_NONE==g||ID_STRING_NAME_TEXT==g)&&g_bBrowserType_WK&&"a"!==getSelectionType().nodeName.toLowerCase()&&""==getSelectionTextValue(a))return;(t=g_objNodeUtil.getSelectionElement_Anchor("A",!0,a))&&g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_UNLINK,!1,null);n=new Date;r=n.getTime();p="#"+r;b=!1;g=null;if(g_bBrowserType_IE&&g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase()){b=
!0;var y=g_objObjectSelectionInfo.objSelectionObject,A=g_objNodeUtil.getParentElement(y);g=g_objEditorDocument[a].createElement("a");g.href=p;A.insertBefore(g,y);g.appendChild(y)}b||g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_CREATELINK,!1,p);m=g_objEditorDocument[a].getElementsByTagName("A");for(l=0;l<m.length;l++)v=m[l].href,w=v.indexOf(p,0),-1!=w&&(m[l].href=e,this.setLinkHTMLDetail(m[l],h,f,c));b&&(k=g_objEditWindow[a].getSelection(),k.selectAllChildren(g))}!1===d&&g_objUndoRedo.registerUndoRedoStack(0,
a)}}catch(B){g_objCommonUtil.displayErrorAlert(B,"setLinkHTML")}};propContentLink.prototype.setLinkHTMLDetail=function(b,a,d,e){try{if(!fnObjectCheckNull(b)&&("undefined"==typeof e&&(e=""),"A"==b.tagName.toUpperCase())){if(""!=a)b.title=a;else try{b.removeAttribute("title")}catch(f){}if(""!=d)b.target=d;else try{b.removeAttribute("target")}catch(f){}""!=e&&b.innerHTML!=e&&(b.innerHTML=e)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"setLinkHTMLDetail")}};propContentLink.prototype.setLinkSelection=
function(b){try{if(fnObjectCheckNull(g_objEditorDocument[b]))return null;if(window.attachEvent){var a=g_objEditorDocument[b].selection;if(fnObjectCheckNull(a))return null;var d=a.type;d=d.toLowerCase();var e=null;if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var f=a.createRange();if(fnObjectCheckNull(f))return null;var h=a.createRange();if(fnObjectCheckNull(h))return null;h.setEndPoint("EndToStart",f);a=b=!0;for(d=!1;b;){a?(h.moveEnd("character",1),a=!1):(h.moveStart("character",1),h.moveEnd("character",
1));if(""==h.htmlText)break;var c=null;if(f.inRange(h))for(c=h.parentElement();!fnObjectCheckNull(c);){var k=c.tagName;if("A"==k.toUpperCase()){d=!0;b=!1;break}c=c.parentElement}else break;if(d&&(f.moveToElementText(c),f.select(),e=this.getLinkInfo(c),null==e))return null}if(!d)for(c=f.parentElement();!fnObjectCheckNull(c);){k=c.tagName;if("A"==k.toUpperCase()){f.moveToElementText(c);f.select();e=this.getLinkInfo(c);if(null==e)return null;break}c=c.parentElement}return e}if(ID_STRING_NAME_CONTROL==
d){var g=a.createRange();if(fnObjectCheckNull(g)||1!=g.length)return null;var q=g.item(0);k=q.tagName;if("A"==k.toUpperCase()){if(e=this.getLinkInfo(q),null==e)return null}else for(c=q.parentElement;!fnObjectCheckNull(c);){if("A"==c.tagName.toUpperCase()){e=this.getLinkInfo(c);if(null==e)return null;break}c=c.parentElement}return e}}else{var n=g_objNodeUtil.getSelectionElement_Anchor("A",!0,b);if(!n)return null;e=this.getLinkInfo(n);return null==e?null:e}}catch(r){g_objCommonUtil.displayErrorAlert(r,
"setLinkSelection")}return null};propContentLink.prototype.getLinkInfo=function(b){try{if(fnObjectCheckNull(b))return null;var a=b.href;"http:///"==a.toLowerCase()?a="http://":"http:"==a.toLowerCase()&&(a="http://");var d=checkAnchorHrefSharp(a);null!=d&&(a=d);var e=b.target,f=b.title;d="";b.getAttribute("type")&&(d=b.getAttribute("type"));var h=b.innerHTML,c=Array(4);c[0]=a;c[1]=e;c[2]=f;c[3]=d;c[4]=h;return c}catch(k){g_objCommonUtil.displayErrorAlert(k,"getLinkInfo")}return null}},g_objPropContentLink=
new propContentLink;

var layerKit=function(){layerKit.prototype.getLayerDocument=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.document:document}catch(b){g_objCommonUtil.displayErrorAlert(b,"getLayerDocument")}return null};layerKit.prototype.getElementById=function(a){try{return this.getLayerDocument().getElementById(a)}catch(b){g_objCommonUtil.displayErrorAlert(b,"getElementById")}return null};layerKit.prototype.getLayerWindow=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.window:
window}catch(b){g_objCommonUtil.displayErrorAlert(b,"getLayerWindow")}return null}},g_objLayerKit=new layerKit;

var dze_menu_control={nEditNumber:0,setEditNumber:function(a){try{"undefined"!=typeof a&&(this.nEditNumber=a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setEditNumber")}},tb_menu_list:[],setTbMenuList:function(){try{this.tb_menu_list=[ID_RES_TOOL_STRING_MENU_FILE,ID_RES_TOOL_STRING_MENU_EDIT,ID_RES_TOOL_STRING_MENU_INSERT,ID_RES_TOOL_STRING_MENU_BASIC,ID_RES_TOOL_STRING_MENU_VIEW,ID_RES_TOOL_STRING_MENU_TABLE,ID_RES_CONST_STRING_INSERT_IMAGE]}catch(a){g_objCommonUtil.displayErrorAlert(a,"setTbMenuList")}},
idxDynamicMenuStart:5,idxTableMenu:5,idxImagePropertyMenu:6,tb_menu_content_left_list:[],setTbMenuContentLeftList:function(){try{this.tb_menu_content_left_list=[[-4],[ID_CUSTOM_UNDO,ID_CUSTOM_REDO,4],[-4]]}catch(a){g_objCommonUtil.displayErrorAlert(a,"setTbMenuContentLeftList")}},tb_menu_content_list:[],setTbMenuContentList:function(){try{this.tb_menu_content_list=[[[-4],[ID_CUSTOM_FILE_NEW,1],[ID_CUSTOM_FILE_OPEN,1],[-4],[1],[-4],[ID_CUSTOM_FILE_LAYOUT,1],[-4],[1],[-4],[ID_CUSTOM_SAVEAS,1],[ID_CUSTOM_PRINT,
1]],[[-4],[ID_CUSTOM_PASTE_EXT,1],[-4],[1],[-4],[ID_CUSTOM_CUT,1],[ID_CUSTOM_COPY_EXT,1],[-4],[1],[-4],[ID_CUSTOM_DELETE,1],[ID_CUSTOM_SELECT_ALL,1],[-4],[1],[-4],[ID_CUSTOM_EDIT_PRIINT_PAGE_BREAK,1],[-4],[1],[-4],[ID_CUSTOM_EDIT_SEARCH,1],[ID_CUSTOM_EDIT_REPLACE,1],[ID_CUSTOM_EDIT_REPLACE_CASE,1]],[[-4],[ID_CUSTOM_TABLE_CREATE,1],[ID_CUSTOM_DRAW_TABLE,1],[-4],[1],[-4],[ID_CUSTOM_INSERT_IMAGE,1],[ID_CUSTOM_INSERT_OBJECT_MOVIE,1],[ID_CUSTOM_INSERT_EMOTICONS,1],[ID_CUSTOM_INSERT_OBJECT_FILE,1],[-4],
[1],[-4],[ID_CUSTOM_HYPERLINK_INSERT,1],[-4],[1],[-4],[ID_CUSTOM_INSERT_BOOKMARK,1],[ID_CUSTOM_INSERT_OBJECT_HR,1],[ID_CUSTOM_INSERT_SPECIALCHARS,1],[-4],[1],[-4],[ID_CUSTOM_SELECT_PARAGRAPH,1]],[[-4],[ID_CUSTOM_STYLE_FONT,1],[-4],[1],[-4],[ID_CUSTOM_STYLE_PARAGRAPH,1],[-4],[1],[-4],[ID_CUSTOM_SUPERSCRIPT,ID_CUSTOM_SUBSCRIPT,4],[ID_CUSTOM_INDENT,ID_CUSTOM_OUTDENT,4],[-4],[1],[-4],[ID_CUSTOM_INSERT_UNORDERED_LIST,1],[ID_CUSTOM_INSERT_ORDERED_LIST,1],[ID_CUSTOM_STYLE_CASCADE_ORDERLIST,1],[ID_CUSTOM_STYLE_INCREASEORDER,
ID_CUSTOM_STYLE_DECREASEORDER,4],[-4],[1],[-4],[ID_CUSTOM_JUSTIFY_LEFT,1],[ID_CUSTOM_JUSTIFY_CENTER,1],[ID_CUSTOM_JUSTIFY_RIGHT,1],[ID_CUSTOM_JUSTIFY_JUSTIFY,1]],[[-4],[ID_CUSTOM_VIEW_EDIT,1],[-4],[1],[-4],[ID_CUSTOM_VIEW_HTML,1],[-4],[1],[-4],[ID_CUSTOM_FULLSCREEN,1],[-4],[1],[-4],[ID_CUSTOM_PREVIEW,1]],[[-4],[ID_CUSTOM_TABLE_PROPERTY,1],[ID_CUSTOM_TABLE_CELL_PROPERTY,1],[ID_CUSTOM_TABLE_CELL_STYLE,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_BACKCOLOR,ID_CUSTOM_TABLE_BORDER_THICKNESS,4],[ID_CUSTOM_TABLE_BORDER_TYPE,
ID_CUSTOM_TABLE_BORDER_COLOR,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_ADD_ROW,ID_CUSTOM_TABLE_ADD_COL,4],[ID_CUSTOM_TABLE_ADD_ROW_DOWN,ID_CUSTOM_TABLE_ADD_COL_RIGHT,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_DELETE_EXT,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_MERGE_CELL,ID_CUSTOM_TABLE_SPLIT_CELL,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_SAME_HEIGHT,ID_CUSTOM_TABLE_CELL_SAME_WIDTH,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_ALIGN,1],[ID_CUSTOM_TABLE_STYLE,1],[ID_CUSTOM_TABLE_SELECT,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_FORMULA_EXT,
ID_CUSTOM_TABLE_SELECT_FORMULA,4],[ID_CUSTOM_TABLE_NUMBER_FORMAT,ID_CUSTOM_TABLE_CONVERT_TEXT,4]],[[-4],[ID_CUSTOM_IMAGE_PROPERTY,1],[-4],[1],[-4],[ID_CUSTOM_IMAGE_BORDER_TYPE,1],[ID_CUSTOM_IMAGE_BORDER_THICKNESS,1],[ID_CUSTOM_IMAGE_BORDER_COLOR,1],[-4],[1],[-4],[ID_CUSTOM_IMAGE_HEIGHT,ID_CUSTOM_IMAGE_WIDTH,2],[-4],[1],[-4],[ID_CUSTOM_IMAGE_RESET_PICTURE,1]]]}catch(a){g_objCommonUtil.displayErrorAlert(a,"setTbMenuContentList")}},tb_menu_content_bottom_list:[],setTbMenuContentBottomList:function(){try{this.tb_menu_content_bottom_list=
[[-4],[ID_CUSTOM_HEADING_SIZE,5],[-4],[ID_CUSTOM_FONT_NAME,5],[-4],[ID_CUSTOM_FONT_SIZE,5],[-4],[ID_CUSTOM_STYLE_INCREASE_FONTSIZE,5],[ID_CUSTOM_STYLE_DECREASE_FONTSIZE,5],[-4],[ID_CUSTOM_LINE_HEIGHT,5],[-4],[ID_CUSTOM_LETTER_SPACING,5],[-4],[ID_CUSTOM_BOLD,5],[ID_CUSTOM_ITALIC,5],[ID_CUSTOM_UNDERLINE,5],[ID_CUSTOM_STRIKE,5],[ID_CUSTOM_FORE_COLOR,5],[ID_CUSTOM_BACK_COLOR,5]]}catch(a){g_objCommonUtil.displayErrorAlert(a,"setTbMenuContentBottomList")}},tb_menu_content_help_list:[],setTbMenuContentHelpList:function(){try{this.tb_menu_content_help_list=
[ID_CUSTOM_HELP_SHORTCUTS,ID_CUSTOM_HELP_INFO]}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:setTbMenuContentHelpList")}},allTbCommandIdList:[],setAllTbCommandIdList:function(){try{this.allTbCommandIdList=[];var a=this.tb_menu_content_list;a.push(this.tb_menu_content_left_list);a.push(this.tb_menu_content_bottom_list);for(var c=0;c<a.length;c++)for(var b=a[c],d=0;d<b.length;d++)if(!(2>b[d].length))for(var e=0;e<b[d].length-1;e++)this.allTbCommandIdList.push(b[d][e])}catch(f){g_objCommonUtil.displayErrorAlert(f,
"error:setAllTbCommandIdList")}},curr_checked_menu:[],prev_checked_menu:[],initialize:function(a){try{!0===dzeUiConfig.bUseUiMode&&(this.setEditNumber(a),this.setTbMenuList(),this.setTbMenuContentLeftList(),this.setTbMenuContentList(),this.setTbMenuContentBottomList(),this.setTbMenuContentHelpList(),this.setAllTbCommandIdList(),this.getUiMode(),g_objCommonUtil.log("dze_menu_control.initialize, UI MODE:"+this.ui_mode),this.addRibbonUiContainer(a),this.addUiToggleBtnInBasicUi(a),this.addRulerbarContainer(a),
this.curr_checked_menu[a]=-1,this.prev_checked_menu[a]=-1,this.showMenuUi(a),this.addEventMenuControl(a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_menu_control.initialize")}},addUiToggleBtnInBasicUi:function(a){try{if(this.setEditNumber(a),!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&1<dzeUiConfig.arrCustomMenuUiType.length&&null!=document.getElementById("TB_CONTAINER_MENU_"+a)){var c=document.getElementById("TB_CONTAINER_MENU_"+a).childNodes[0];if(null!=
c){var b=c.rows[0],d=b.insertCell();d.width=20;d.align="center";d.valign="top";d.style.position="relative";d.id="TB_MENU_HELP_BTN_"+a;d.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"/toolbar/toolbar_btn_help.png'>";d=b.insertCell();d.width=20;d.align="center";d.style.position="relative";d.id="TB_MENU_UI_SWITCH_BTN_"+a;d.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"/toolbar/toolbar_btn_adjust_doc_basic.gif'>";this.addEventMenuUiToggleBtnInBasicUi(a)}}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"addUiToggleBtnInBasicUi")}},addEventMenuUiToggleBtnInBasicUi:function(a){try{this.setEditNumber(a),document.getElementById("TB_MENU_UI_SWITCH_BTN_"+a).onclick=function(c){c=c?c:window.event;dze_menu_control.showUiToggleBtnLayer(a,this);TBCancelBubbleEvent(c)},document.getElementById("TB_MENU_HELP_BTN_"+a).onclick=function(c){c=c?c:window.event;dze_menu_control.showHelpBtnLayer(a,this);TBCancelBubbleEvent(c)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"addEventMenuUiToggleBtnInBasicUi")}},ui_toggle_btn_layer:null,
showUiToggleBtnLayer:function(a,c){try{if("undefined"==typeof a&&(a=dze_menu_control.nEditNumber),this.removeHelpBtnLayer(),this.setEditNumber(a),null==this.ui_toggle_btn_layer){this.ui_toggle_btn_layer=document.createElement("div");this.ui_toggle_btn_layer.className="dze_ui_toggle_btn_container";var b="";b+="<table border='0' cellspacing='0' cellpadding='0' width='100%'>";b+="\t<tr><td colspan='6' height='5'></td></tr>";for(var d=ID_RES_UI_TOGGLE_STRING_RIBBON,e=0;e<dzeUiConfig.arrCustomMenuUiType.length;e++){var f=
"";"basic"==dzeUiConfig.arrCustomMenuUiType[e]?(d=ID_RES_UI_TOGGLE_STRING_TOOLBAR,f="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/ico_selectbox.png'>"):"ribbon"==dzeUiConfig.arrCustomMenuUiType[e]&&(d=ID_RES_UI_TOGGLE_STRING_RIBBON,f="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_doc_templete_black.gif'>");0<e&&(b+="\t<tr><td colspan='6' height='1'></td></tr>",b+="\t<tr><td class='dze_ui_toggle_btn_underline' colspan='6'></td></tr>",b+="\t<tr><td colspan='6' height='1'></td></tr>");
b+="\t<tr class='dze_ui_toggle_btn_unit' uiType='"+dzeUiConfig.arrCustomMenuUiType[e]+"'><td width='8'></td><td width='16'>"+f+"</td><td width='6'></td><td align='left'>"+d+"</td><td width='10'></td><td width='3'></td></tr>"}this.ui_toggle_btn_layer.innerHTML=b+"\t<tr><td colspan='6' height='5'></td></tr></table>";this.addEventUiToggleBtnLayer(a);this.setUiToggleContainerPosition(this.ui_toggle_btn_layer);c.appendChild(this.ui_toggle_btn_layer);this.ui_toggle_btn_layer.style.display="block";duzon_dialog.animateDlg(this.ui_toggle_btn_layer,
"down");g_bDynamicLayer=!0}else this.removeUiToggleBtnLayer()}catch(g){g_objCommonUtil.displayErrorAlert(g,"showUiToggleBtnLayer")}},removeUiToggleBtnLayer:function(){try{null!=dze_menu_control.ui_toggle_btn_layer&&(dze_menu_control.ui_toggle_btn_layer.style.display="none",dze_menu_control.ui_toggle_btn_layer.parentNode.removeChild(dze_menu_control.ui_toggle_btn_layer),dze_menu_control.ui_toggle_btn_layer=null,g_bDynamicLayer=!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"removeUiToggleBtnLayer")}},
addEventUiToggleBtnLayer:function(a){try{if(null!=this.ui_toggle_btn_layer){"undefined"==typeof a&&(a=dze_menu_control.nEditNumber);for(var c=this.ui_toggle_btn_layer.getElementsByTagName("tr"),b=0;b<c.length;b++)c[b].getAttribute("uiType")&&(this.ui_mode==c[b].getAttribute("uiType")?c[b].childNodes[4].innerHTML="v":(c[b].onclick=function(b){b=b?b:window.event;dze_menu_control.setUiMode(this.getAttribute("uiType"));dze_menu_control.showMenuUi(a);dze_menu_control.removeUiToggleBtnLayer();TBCancelBubbleEvent(b)},
c[b].childNodes[4].innerHTML=""),c[b].onmouseover=function(){this.className="dze_ui_toggle_btn_over"},c[b].onmouseout=function(){this.className="dze_ui_toggle_btn_unit"},c[b].onmousedown=function(){this.className="dze_ui_toggle_btn_down"})}}catch(d){g_objCommonUtil.displayErrorAlert(d,"addEventUiToggleBtnLayer")}},help_btn_layer:null,showHelpBtnLayer:function(a,c){try{if("undefined"==typeof a&&(a=dze_menu_control.nEditNumber),this.removeUiToggleBtnLayer(),this.setEditNumber(a),null==this.help_btn_layer){this.help_btn_layer=
document.createElement("div");this.help_btn_layer.className="dze_ui_toggle_btn_container";var b="";b+="<table border='0' cellspacing='0' cellpadding='0' width='100%'>";b+="\t<tr><td colspan='6' height='5'></td></tr>";for(var d=0;d<this.tb_menu_content_help_list.length;d++){0<d&&(b+="\t<tr><td colspan='6' height='1'></td></tr>",b+="\t<tr><td class='dze_ui_toggle_btn_underline' colspan='6'></td></tr>",b+="\t<tr><td colspan='6' height='1'></td></tr>");var e=this.tb_menu_content_help_list[d];b+="\t<tr class='dze_ui_toggle_btn_unit' commandId='"+
e+"'><td width='8'></td><td width='16'>"+("<img src='"+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[e]+"'>")+"</td><td width='6'></td><td align='left'>"+g_arrConst[e][1]+"</td><td width='10'></td><td width='3'></td></tr>"}this.help_btn_layer.innerHTML=b+"\t<tr><td colspan='6' height='5'></td></tr></table>";this.addEventHelpBtnLayer(a);this.setUiToggleContainerPosition(this.help_btn_layer);c.appendChild(this.help_btn_layer);this.help_btn_layer.style.display="block";duzon_dialog.animateDlg(this.help_btn_layer,
"down");g_bDynamicLayer=!0}else this.removeHelpBtnLayer()}catch(f){g_objCommonUtil.displayErrorAlert(f,"showUiToggleBtnLayer")}},removeHelpBtnLayer:function(){try{null!=dze_menu_control.help_btn_layer&&(dze_menu_control.help_btn_layer.style.display="none",dze_menu_control.help_btn_layer.parentNode.removeChild(dze_menu_control.help_btn_layer),dze_menu_control.help_btn_layer=null,g_bDynamicLayer=!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"removeUiToggleBtnLayer")}},addEventHelpBtnLayer:function(a){try{if(null!=
this.help_btn_layer)for(var c=this.help_btn_layer.getElementsByTagName("tr"),b=0;b<c.length;b++)if(c[b].getAttribute("commandId")){var d=c[b].getAttribute("commandId"),e=eval(g_arrConst[d][3]);(function(){var d=e;c[b].onclick=function(b){b=b?b:window.event;d(b,this,a);dze_menu_control.removeHelpBtnLayer();TBCancelBubbleEvent(b)}})();c[b].onmouseover=function(){this.className="dze_ui_toggle_btn_over"};c[b].onmouseout=function(){this.className="dze_ui_toggle_btn_unit"};c[b].onmousedown=function(){this.className=
"dze_ui_toggle_btn_down"}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"addEventHelpBtnLayer")}},setUiToggleContainerPosition:function(a){try{a.style.top="ribbon"==this.ui_mode?"17px":"23px",a.style.left="-144px"}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setUiToggleContainerPosition")}},addRulerbarContainer:function(a){try{if(g_objCommonUtil.log("addRulerbarContainer ===================================="),g_bRulerbar_Display){this.setEditNumber(a);var c=document.getElementById("TB_CONTAINER_"+
a);if(null!=c){var b=c.insertRow();b.style.display="none";var d=b.insertCell();d.id="TB_CONTAINER_RULERBAR_"+a;d.style.borderWidth="0px";d.style.height="24px"}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"addRulerbarContainer")}},addRibbonUiContainer:function(a){try{if(this.setEditNumber(a),!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&0<dzeUiConfig.arrCustomMenuUiType.length&&inArray("ribbon",dzeUiConfig.arrCustomMenuUiType)){var c=document.getElementById("TB_CONTAINER_"+
a);if(null!=c&&!0===dzeUiConfig.bCustomize_MenuBar_Display&&0!=c.rows.length){var b=c.insertRow(1),d=b.insertCell();d.id="TB_CONTAINER_MENU_RIBBON_"+a;d.className="dze_ribbon_menu_tb_container";b.style.display="none"}}}catch(e){g_objCommonUtil.displayErrorAlert(e,"addRibbonUiContainer")}},ui_mode:"basic",getUiMode:function(){try{this.ui_mode="basic";if("undefined"==typeof dzeUiConfig.arrCustomMenuUiType||0==dzeUiConfig.arrCustomMenuUiType.length||!inArray("ribbon",dzeUiConfig.arrCustomMenuUiType))return this.setUiMode(this.ui_mode),
this.ui_mode;if(1==dzeUiConfig.arrCustomMenuUiType.length)return this.setUiMode(dzeUiConfig.arrCustomMenuUiType[0]),this.ui_mode;this.ui_mode=dzeUiConfig.arrCustomMenuUiType[0];if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeUiMode")&&(this.ui_mode=localStorage.getItem("dzeUiMode"))}catch(a){g_objCommonUtil.displayErrorAlert(a,"getUiMode error")}inArray(this.ui_mode,dzeUiConfig.arrCustomMenuUiType)||(this.ui_mode="basic");this.setUiMode(this.ui_mode);return this.ui_mode}catch(a){g_objCommonUtil.displayErrorAlert(a,
"getUiMode")}},setUiMode:function(a){try{if(this.ui_mode=a,"undefined"!=typeof localStorage)try{localStorage.setItem("dzeUiMode",a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setUiMode error")}}catch(c){g_objCommonUtil.displayErrorAlert(c,"setUiMode")}},showMenuUi:function(a){try{!0!==dzeUiConfig.bCustomize_MenuBar_Display&&this.setUiMode("basic"),"ribbon"==this.getUiMode()?dze_menu_control.showRibbonUi(a):dze_menu_control.showBasicUi(a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"showMenuUi")}},
keep_check_ribbon_menu:!0,showRibbonUi:function(a){try{this.initEditorUi(),g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display="none"),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display="none"),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+a).parentNode.style.display="none"),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+a).parentNode.style.display="none"),this.createRibbonMenu(a),
document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).parentNode.style.display="",this.moveTBIcon_BasicUi_To_TbContainer(a),this.moveTBIcon_TbContainer_To_Left_RibbonUi(a),this.moveTBIcon_TbContainer_To_Bottom_RibbonUi(a),!0!==this.keep_check_ribbon_menu&&(this.curr_checked_menu[a]=0),this.activateMenu(this.curr_checked_menu[a],a),this.setUiMode("ribbon"),g_bEditorHeightIFrameYN?this.resizeEditorHeight(a):this.resizeEditorHeight(a,g_arrEditorHeight[a]),this.addRibbonUiEvent(a),editor_onselectionchange(a)}catch(c){g_objCommonUtil.displayErrorAlert(c,
"showRibbonUi")}},showBasicUi:function(a){try{if(g_objCommonUtil.log("showBasicUi"),!0===this.ribbon_menu_created[a]||"basic"!=this.ui_mode)this.initEditorUi(),g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display=""),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display=""),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+a).parentNode.style.display=""),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+
a).parentNode.style.display=""),document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).parentNode.style.display="none",this.moveTBIcon_TbContainer_To_BasicUi(a),this.setUiMode("basic"),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,g_arrEditorHeight[a]),this.removeRibbonUiMouseEvent(a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"showBasicUi")}},resizeEditorHeight:function(a,c){try{if("undefined"==typeof a&&(a=this.nEditNumber),-1==a&&(a=this.nEditNumber),"ribbon"==this.ui_mode){200>
c&&(c=200);"undefined"==typeof c?c=document.documentElement.clientHeight:dzeEnvConfig.iFrameLayer&&g_bEditorHeightIFrameYN&&("100%"!=window.frameElement.getAttribute("height")&&(window.frameElement.style.height=c+"px"),window.frameElement.parentNode.style.height=c+"px",c=document.documentElement.clientHeight);g_nTabBarSetHeight=0;if(g_bTabBar_Display){var b=document.getElementById("TB_TABMODE_TR_CONTAINER_"+a);null!=b&&(g_nTabBarSetHeight=b.offsetHeight)}g_nToolbarSetHeight=0;var d=document.getElementById("TB_CONTAINER_"+
a);null!=d&&(g_nToolbarSetHeight=d.offsetHeight);g_arrEditorHeight[a]=c;g_nEditAreaSetHeight=c-g_nToolbarSetHeight-g_nTabBarSetHeight;if(!g_bTabBar_Display){var e=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a),f=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=f}isShowedRulerBar()&&dze_rulerbar_mgr.updateGuideLineHeight(g_nEditAreaSetHeight);g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px";g_objEditSetContainer[a].setAttribute("height",
g_arrEditorHeight[a]);document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).style.height=g_nEditAreaSetHeight+"px";document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).setAttribute("height",g_nEditAreaSetHeight);document.getElementById("dzeditor_Parent_"+a).style.height=g_nEditAreaSetHeight-1+"px";document.getElementById("dzeditor_"+a).style.height=g_nEditAreaSetHeight-2+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+
"px";document.getElementById("TB_CONTAINER_"+a).parentNode.setAttribute("height",document.getElementById("TB_CONTAINER_"+a).offsetHeight);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_nEditAreaSetHeight-22+"px")}}catch(g){g_objCommonUtil.displayErrorAlert(g,"resizeEditorHeight")}},initEditorUi:function(){try{g_objLayerEventUtil.initHideDynamicLayer(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),duzon_menubar.closeHiddenTbContainerTool(),duzon_dialog.closeExtendsDlg(),duzon_dialog.closeDialog()}catch(a){g_objCommonUtil.displayErrorAlert(a,
"initEditorUi")}},ribbon_menu_created:[],createRibbonMenu:function(a){try{if(!0!==this.ribbon_menu_created[a]){var c=document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a),b=document.getElementById("TB_CONTAINER_MENU_"+a),d=g_objPropertyUtil.getElementStyleAttributeValue(b,"background-color",a);b='<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0" border="0">';b+='\t<tr valign="center" height="5">';b+='\t\t<td valign="center" align="center" style="background-color:'+d+'"></td>';
b+="\t</tr>";b+='\t<tr valign="center">';b+='\t\t<td valign="center" align="center" style="background-color:'+d+'">';b+='\t\t\t<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0" border="0">';b+='\t\t\t\t<tr valign="center" height="24" id="TB_MENUBAR_RIBBON_'+a+'">';b+='\t\t\t\t\t<td class="dze_ribbon_menu_left"></td>';for(d=0;d<dze_menu_control.tb_menu_list.length;d++)b=d<this.idxDynamicMenuStart?b+('\t\t\t\t\t<td id="TB_MENU_RIBBON_'+d+"_"+a+'" class="dze_ribbon_menu_off"><span>'+
dze_menu_control.tb_menu_list[d]+"</span></td>"):b+('\t\t\t\t\t<td id="TB_MENU_RIBBON_'+d+"_"+a+'" class="dze_ribbon_d_menu_hide"><span>'+dze_menu_control.tb_menu_list[d]+"</span></td>");b+='\t\t\t\t\t<td class="dze_ribbon_menu_right"></td>';"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&1<dzeUiConfig.arrCustomMenuUiType.length&&(b+='\t\t\t\t\t<td class="dze_ribbon_menu_right" width="20" valign="top" align="center" id="TB_MENU_HELP_BTN2_'+a+'"><img src="'+dzeEnvConfig.strPath_Image+'/toolbar/toolbar_btn_help.png"></td>',
b+='\t\t\t\t\t<td class="dze_ribbon_menu_right" width="20" valign="top" align="center" id="TB_MENU_UI_SWITCH_BTN2_'+a+'"><img src="'+dzeEnvConfig.strPath_Image+'/toolbar/toolbar_btn_adjust_doc_basic.gif"></td>');b+="\t\t\t\t</tr>";b+="\t\t\t</table>";b+="\t\t</td>";b+="\t</tr>";b+='\t<tr valign="center">';b+='\t\t<td id="TB_MENU_RIBBON_CONTENT_CONTAINER_'+a+'">';b+='\t\t<table border="0" width="100%" cellspacing="0" cellpadding="0">';b+="\t\t\t<tr>";b+='\t\t\t\t<td height="54" width="32" class="dze_ribbon_tb_content_left_td"><div class="dze_ribbon_tb_content_left" id="TB_MENU_RIBBON_CONTENT_LEFT_'+
a+'"></div></td>';b+='\t\t\t\t<td height="54">';b+='\t\t\t\t<table border="0" width="100%" height="50" cellspacing="0" cellpadding="0">';b+="\t\t\t\t\t<tr>";b+='\t\t\t\t\t\t<td style="overflow:hidden">';for(d=0;d<dze_menu_control.tb_menu_list.length;d++)b+='\t\t\t\t\t\t<div class="dze_ribbon_tb_content" id="TB_MENU_RIBBON_CONTENT_'+d+"_"+a+'"></div>';b+="\t\t\t\t\t\t</td>";b+="\t\t\t\t\t</tr>";b+="\t\t\t\t</table>";b+="\t\t\t\t</td>";b+="\t\t\t</tr>";b+="\t\t\t<tr>";b+='\t\t\t\t<td colspan="2" class="dze_ribbon_tb_content_bottom_td">';
b+='\t\t\t\t<table border="0" width="100%" height="28" cellspacing="0" cellpadding="0">';b+="\t\t\t\t\t<tr>";b+='\t\t\t\t\t\t<td style="overflow:hidden">';b+='\t\t\t\t\t\t\t<div class="dze_ribbon_tb_content_bottom" id="TB_MENU_RIBBON_CONTENT_BOTTOM_'+a+'"></div>';b+="\t\t\t\t\t\t</td>";b+="\t\t\t\t\t</tr>";b+="\t\t\t\t</table>";b+="\t\t\t\t</td>";b+="\t\t\t</tr>";b+="\t\t</table>";b+="\t\t</td>";c.innerHTML=b+"\t</tr></table>";dze_menu_control.addRibbonMenuEvent(a);dze_menu_control.ribbon_menu_created[a]=
!0}}catch(e){g_objCommonUtil.displayErrorAlert(e,"createRibbonMenu")}},addRibbonMenuEvent:function(a){try{"undefined"==typeof a&&(a=this.nEditNumber);this.setEditNumber(a);document.getElementById("TB_MENU_UI_SWITCH_BTN2_"+a).onclick=function(b){b=b?b:window.event;dze_menu_control.showUiToggleBtnLayer(a,this);TBCancelBubbleEvent(b)};document.getElementById("TB_MENU_HELP_BTN2_"+a).onclick=function(b){b=b?b:window.event;dze_menu_control.showHelpBtnLayer(a,this);TBCancelBubbleEvent(b)};for(var c=null,
b=0;b<this.tb_menu_list.length;b++)c=document.getElementById("TB_MENU_RIBBON_"+b+"_"+a),c.TBSTATE=b<this.idxDynamicMenuStart?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_HIDE,c.onclick=function(){if(this.TBSTATE!=ID_STRING_NAME_GRAY&&this.TBSTATE==ID_STRING_NAME_UNCHECKED){var b=this.id.replace("TB_MENU_RIBBON_","").split("_").shift();dze_menu_control.activateMenu(b,a)}},c.onmouseover=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off"==this.className&&(this.className="dze_ribbon_menu_off_over")},
c.onmouseout=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off_over"==this.className&&(this.className="dze_ribbon_menu_off")}}catch(d){g_objCommonUtil.displayErrorAlert(d,"addRibbonMenuEvent")}},setMenuItemProperty:function(a,c,b){try{if("undefined"==typeof b&&(b=this.nEditNumber),-1!=b){var d=document.getElementById("TB_MENU_RIBBON_"+c+"_"+b);a==ID_STRING_NAME_CHECKED?(d.className=c<this.idxDynamicMenuStart?"dze_ribbon_menu_on":"dze_ribbon_d_menu_on",d.TBSTATE=ID_STRING_NAME_CHECKED,
this.setTBItemTextGray(!1,c,b)):a==ID_STRING_NAME_UNCHECKED?(d.className=c<this.idxDynamicMenuStart?"dze_ribbon_menu_off":"dze_ribbon_d_menu_off",d.TBSTATE=ID_STRING_NAME_UNCHECKED,this.setTBItemTextGray(!1,c,b)):a==ID_STRING_NAME_GRAY?(d.TBSTATE=ID_STRING_NAME_GRAY,this.setTBItemTextGray(!0,c,b)):a==ID_STRING_NAME_HIDE&&(d.TBSTATE=ID_STRING_NAME_HIDE,d.className="dze_ribbon_d_menu_hide")}}catch(e){g_objCommonUtil.displayErrorAlert(e,"setMenuItemProperty")}},setTBItemTextGray:function(a,c,b){try{"undefined"==
typeof b&&(b=this.nEditNumber),document.getElementById("TB_MENU_RIBBON_"+c+"_"+b).childNodes[0].className=a?"dze_ribbon_menu_text_gray":"dze_ribbon_menu_text_normal",a||document.getElementById("TB_MENU_RIBBON_CONTENT_"+c+"_"+b).getElementsByTagName("div")}catch(d){g_objCommonUtil.displayErrorAlert(d,"setTBItemTextGray")}},activateMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){0>a&&(a=0);var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);this.curr_checked_menu[[c]]==
a&&b.childNodes.length||(0<=this.curr_checked_menu[c]&&this.deactivateMenu(this.curr_checked_menu[c],c),this.curr_checked_menu[c]<this.idxDynamicMenuStart&&(this.prev_checked_menu[c]=this.curr_checked_menu[c]),this.curr_checked_menu[c]=a,this.activateMenuDetail(a,c),this.setDynamicMenu(c),this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c),a==this.idxImagePropertyMenu&&this.setMenuItemProperty(ID_STRING_NAME_GRAY,this.prev_checked_menu[c],c),this.showAllTBState(c))}}catch(d){g_objCommonUtil.displayErrorAlert(d,
"activateMenu")}},deactivateMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);b.TBSTATE!=ID_STRING_NAME_GRAY&&(b.TBSTATE=ID_STRING_NAME_UNCHECKED);a<this.idxDynamicMenuStart?this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c):a==this.idxTableMenu?this.checkTableCaret(c)&&!this.checkImageCaret(c)?this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c):this.setMenuItemProperty(ID_STRING_NAME_HIDE,a,c):this.setMenuItemProperty(ID_STRING_NAME_HIDE,
a,c);this.deactivateMenuDetail(a,c)}}catch(d){g_objCommonUtil.displayErrorAlert(d,"deactivateMenu")}},activateMenuDetail:function(a,c){try{if(-1!=c){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);"block"!=b.style.display&&(this.moveTBIcon_TbContainer_To_Main_RibbonUi(a,c),a===dze_menu_control.idxImagePropertyMenu&&this.setTBImageSizeInfo(c),b.style.display="block",dze_menu_control.setShowHideRibbonMainToolbars(a,c))}}catch(d){g_objCommonUtil.displayErrorAlert(d,"activateMenuDetail")}},
deactivateMenuDetail:function(a,c){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(a,c),document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).style.display="none"}catch(b){g_objCommonUtil.displayErrorAlert(b,"deactivateMenuDetail")}},setShowHideRibbonMainToolbars:function(a,c){try{"undefined"==typeof a&&(a=dze_menu_control.curr_checked_menu[c]),"undefined"==typeof c&&(c=g_nActiveEditNumber),0>c||0>a||(dze_menu_control.resizeTbContentDiv(a,c),dze_menu_control.removeBtnMoreRibbonTb("main","left",
a,c),dze_menu_control.removeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.makeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.resizeTbContentDiv(a,c))}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:setShowHideRibbonMainToolbars")}},setShowHideRibbonBottomToolbars:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),0>a||(dze_menu_control.resizeTbContentDiv("",a),dze_menu_control.removeBtnMoreRibbonTb("bottom","left","",a),dze_menu_control.removeBtnMoreRibbonTb("bottom",
"right","",a),dze_menu_control.makeBtnMoreRibbonTb("bottom","right","",a),dze_menu_control.resizeTbContentDiv("",a))}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setShowHideRibbonBottomToolbars")}},makeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return null;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+
d);else return null;if(null==e)return null;var f=e.childNodes[0];if(null==f)return null;for(var g=0,k=f.rows[0].cells.length,l=0;l<k;l++)f.rows[0].cells[l].getAttribute("width")&&(g+=parseInt(f.rows[0].cells[l].getAttribute("width"),10));if(g<e.offsetWidth)return dze_menu_control.removeBtnMoreRibbonTb(a,"left",b,d),dze_menu_control.removeBtnMoreRibbonTb(a,"right",b,d),e.style.marginLeft="0px",null;var m=g_objNodeUtil.getLoopParentElement(e,"table");if("right"==c){var n=m.rows[0].cells[m.rows[0].cells.length-
1];if("btnMore"!=n.getAttribute("type")){if("main"==a)var h="duzon_btn_view_hidden_ribbon_toolbar_next",r="duzon_btn_view_hidden_ribbon_toolbar_next_down",p="duzon_btn_view_hidden_ribbon_toolbar_next_over";else h="duzon_btn_view_hidden_ribbon_toolbar_next_bottom",r="duzon_btn_view_hidden_ribbon_toolbar_next_down_bottom",p="duzon_btn_view_hidden_ribbon_toolbar_next_over_bottom";n=m.rows[0].insertCell();n.setAttribute("type","btnMore");n.width=13;n.className=h;n.onmousedown=function(){this.className=
r};n.onmouseup=function(){this.className=p};n.onmouseover=function(){this.className=p};n.onmouseout=function(){this.className=h}}n.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return n}if("left"==c){var q=m.rows[0].cells[0];if("btnMore"!=q.getAttribute("type")){if("main"==a)var t="duzon_btn_view_hidden_ribbon_toolbar_prev",v="duzon_btn_view_hidden_ribbon_toolbar_prev_down",u="duzon_btn_view_hidden_ribbon_toolbar_prev_over";else t="duzon_btn_view_hidden_ribbon_toolbar_prev_bottom",
v="duzon_btn_view_hidden_ribbon_toolbar_prev_down_bottom",u="duzon_btn_view_hidden_ribbon_toolbar_prev_over_bottom";q=m.rows[0].insertCell(0);q.setAttribute("type","btnMore");q.width=13;q.className=t;q.onmousedown=function(){this.className=v};q.onmouseup=function(){this.className=u};q.onmouseover=function(){this.className=u};q.onmouseout=function(){this.className=t}}q.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return q}return null}catch(w){return g_objCommonUtil.displayErrorAlert(w,
"error:makeBtnMoreRibbonTb"),null}},removeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return 0;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return 0;var f=g_objNodeUtil.getLoopParentElement(e,"table");if(!f)return 0;a=0;if("right"==c){var g=f.rows[0].cells[f.rows[0].cells.length-
1];"btnMore"==g.getAttribute("type")&&(a=g.offsetWidth,g.parentNode.removeChild(g))}else if("left"==c){var k=f.rows[0].cells[0];"btnMore"==k.getAttribute("type")&&(a=k.offsetWidth,k.parentNode.removeChild(k));e.style.marginLeft="0px"}return a}catch(l){return g_objCommonUtil.displayErrorAlert(l,"error:removeBtnMoreRibbonTb"),0}},resizeTbContentDiv:function(a,c){try{if("undefined"==typeof a||""==a)a=dze_menu_control.curr_checked_menu[c];"undefined"==typeof c&&(c=g_nActiveEditNumber);if(!(0>c||0>a)){var b=
document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);if(null!=b){var d=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+c);null!=d&&(b.style.width="1px",d.style.width="1px",b.style.width=b.parentNode.offsetWidth-1+"px",d.style.width=d.parentNode.offsetWidth-1+"px")}}}catch(e){return g_objCommonUtil.displayErrorAlert(e,"error:resizeTbContentDiv"),null}},viewMoreRibbonTb:function(a,c,b,d){try{if(a&&("undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]),"undefined"==typeof d&&
(d=g_nActiveEditNumber),!(0>d||0>b))){if("main"==c)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==c)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return;var f=e.childNodes[0];if(null!=f){for(var g=0,k=f.rows[0].cells.length,l=0;l<k;l++)f.rows[0].cells[l].getAttribute("width")&&(g+=parseInt(f.rows[0].cells[l].getAttribute("width"),10));var m=g-e.offsetWidth;if(0<a.cellIndex){var n=dze_menu_control.makeBtnMoreRibbonTb(c,"left",b,d);dze_menu_control.removeBtnMoreRibbonTb(c,
"right",b,d);e.style.marginLeft=-n.offsetWidth+"px";dze_menu_control.slideMoveRibbonTb(e,"left",-m)}else{dze_menu_control.makeBtnMoreRibbonTb(c,"right",b,d);var h=dze_menu_control.removeBtnMoreRibbonTb(c,"left",b,d);e.style.marginLeft=-m+h+"px";dze_menu_control.slideMoveRibbonTb(e,"right",0)}}}}catch(r){g_objCommonUtil.displayErrorAlert(r,"error:viewMoreRibbonTb")}},slideMoveRibbonTb:function(a,c,b){try{var d=parseInt(a.style.marginLeft.replace(/px/,""),10),e=0,f="left"==c?-5:5,g=setInterval(function(){e++;
1E3<e?(a.style.marginLeft=b+"px",clearInterval(g)):(d+=f,"left"==c?d<=b&&(d=b):d>=b&&(d=b),d==b?(a.style.marginLeft=d+"px",clearInterval(g)):a.style.marginLeft=d+"px")},7)}catch(k){g_objCommonUtil.displayErrorAlert(k,"error:slideMoveRibbonTb")}},makeTB:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_BUTTON)return this.makeTB_Button(a,c);if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_COMBOBOX){var b=0,d=0;if(ID_COMMAND_FONT_NAME==a)b=102,d=2;else if(ID_COMMAND_FONT_SIZE==a||ID_COMMAND_HEADING_SIZE==a)b=
72,d=1;else if(ID_COMMAND_LETTER_SPACING==a||ID_COMMAND_LINE_HEIGHT==a)b=52,d=1;return this.makeTB_ComboBox(a,b,d,c)}return g_arrConst[a][6]==ID_TYPE_TOOLBAR_DROPDOWN?this.makeTB_DropDown(a,c):g_arrConst[a][6]==ID_TYPE_TOOLBAR_SPINNER?this.makeTB_Spinner(a,c):""}catch(e){g_objCommonUtil.displayErrorAlert(e,"makeTB")}},makeTB_Button:function(a,c){try{return'<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+
dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[a][1]+'"></div></div>'}catch(b){g_objCommonUtil.displayErrorAlert(b,"makeTB_Button")}return""},makeTB_ComboBox:function(a,c,b,d){try{var e="";e+='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+d+'" TBTYPE="toggle" style="line-height:0;width:'+c+'px;overflow:hidden;" title="'+g_arrConst[a][1]+'">';e+='<table style="width:'+c+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';
e+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+
dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+
g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+
g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+
g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');e+="</tr>";return e+"</table></div>"}catch(f){g_objCommonUtil.displayErrorAlert(f,"error:")}return""},makeTB_DropDown:function(a,c){try{var b="";b+='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';b+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="30">';
b+="<tr>";b+='<td width="18" style="line-height:0;height:20px;border:0px;padding:0px;">';b+='<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" alt="'+g_arrConst[a][1]+'" style="vertical-align:baseline;border:none;"></div></div>';a==ID_COMMAND_FORE_COLOR&&(b+='<div id="TB_SETFORECOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');a==ID_COMMAND_BACK_COLOR&&
(b+='<div id="TB_SETBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');a==ID_COMMAND_TABLE_CELL_BACKCOLOR&&(b+='<div id="TB_SETCELLBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');a==ID_COMMAND_IMAGE_BORDER_COLOR&&(b+='<div id="TB_SETIMAGEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');a==ID_COMMAND_TABLE_BORDER_COLOR&&
(b+='<div id="TB_SETTABLEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b+="</td>";b+='<td width="13" style="line-height:0;height:20px;border:0px;padding:0px;vertical-align:middle;">';b+='<div id="'+g_arrConst[a][2]+"_"+c+'_SUB" class="'+g_strSkin_DropDown_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>';b+="</td>";b+="</tr>";
return b+"</table></div>"}catch(d){g_objCommonUtil.displayErrorAlert(d,"error:")}return""},makeTB_Spinner:function(a,c){try{var b=g_arrConst[a][10],d=g_arrConst[a][11],e="dze_form_"+g_arrConst[a][2]+"_"+c,f='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';f+="<table align='' border='0' cellpadding='0' cellspacing='0'>";f+="<tr>";f+="<td width='30' class='dze_ribbon_tb_spinner_item_text'>"+g_arrConst[a][1]+": </td>";
f+="<td>";f+="\t<table align='' border='1' cellpadding='0' cellspacing='0' class='dze_ribbon_tb_spinner_input_form_container'>";f+="\t\t<tr>";f+="\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t<table align='' border='0' cellpadding='0' cellspacing='0'>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;' height='18'><input type='text' id='"+e+"' value='"+b+"' class='dze_ribbon_tb_spinner_input_form' size='5' /></td>";f+="\t\t\t\t\t\t<td style='line-height:0;' width='16' class='dze_ribbon_tb_spinner_unit_text'>"+
d+"</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t</table>";f+="\t\t\t</td>";f+="\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t<table align='' border='0' cellpadding='0' cellspacing='0' class='aaaaa'>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t\t\t\t<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\"><img src='"+
dzeEnvConfig.strPath_Image+"dialog/btn_arrow_up.png' alt='' width='5' height='3'></div>";f+="\t\t\t\t\t\t</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t\t\t\t<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\"><img src='"+dzeEnvConfig.strPath_Image+
"dialog/btn_arrow_down.png' alt='' width='5' height='3' border='0'></div>";f+="\t\t\t\t\t\t</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t</table>";f+="\t\t\t</td>";f+="\t\t</tr>";f+="\t</table>";f+="</td>";f+="</tr>";return f+"</table></div>"}catch(g){g_objCommonUtil.displayErrorAlert(g,"makeTB_Spinner")}},checkCommandIdInTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");c=!1;for(var d=0;d<b.length;d++)if(b[d].getAttribute("orgCommandId")==a){c=!0;break}return c}catch(e){g_objCommonUtil.displayErrorAlert(e,
"checkCommandIdInTbContainer")}},TB_CONTAINER:[],moveTBIcon_BasicUi_To_TbContainer:function(a){try{"undefined"==typeof this.TB_CONTAINER[a]&&(this.TB_CONTAINER[a]=document.createElement("div"),this.TB_CONTAINER[a].id="dze_idx_ribbon_tb_container_"+a,this.TB_CONTAINER[a].style.display="none",document.body.appendChild(this.TB_CONTAINER[a]));for(var c=-1,b=0;b<this.allTbCommandIdList.length;b++)if(c=this.allTbCommandIdList[b],!(0>c)&&1!=this.checkCommandIdInTbContainer(c,a)){for(var d=0,e=!1,f=[],g=
1;3>=g;g++)if(e=eval("dzeUiConfig.bCustomize_ToolBar"+g+"_Display"),f=eval("dzeUiConfig.arrCustomToolbar"+g),e){for(var k=0;k<f.length;k++)if(c==f[k][0]){d=g;break}if(0<d)break}if(0<d){var l=document.getElementById("TB_CONTAINER_TOOL_"+d+"_"+a).getElementsByTagName("div"),m=g_arrConst[c][2]+"_"+a;for(g=0;g<l.length;g++)if(l[g].getAttribute("id")&&l[g].id==m){if(!l[g].nextSibling||!l[g].nextSibling.getAttribute("orgCommandId")){var n=document.createElement("span");n.setAttribute("orgCommandId",c);
l[g].parentNode.insertBefore(n,l[g])}l[g].setAttribute("orgCommandId",c);this.TB_CONTAINER[a].appendChild(l[g]);break}}else{var h=this.makeTB(c,a);if(""!=h){var r=document.createElement("span");r.className="dze_ribbon_tb_item";r.title=g_arrConst[c][1];r.innerHTML=h;this.TB_CONTAINER[a].appendChild(r.childNodes[0]);var p=g_arrConst[c][6];p==ID_TYPE_TOOLBAR_SPINNER?this.addEventTBSpinner(c,a):(TBInitButton(c,p,a),ID_TB_QUERY_STATUS_BUTTON==p?handlerUI.setCommandUpdateIndex(a,c,g_TBButton[a].length-
1):ID_TB_QUERY_STATUS_COMBOBOX==p?handlerUI.setCommandUpdateIndex(a,c,g_TBComboBox[a].length-1):ID_TB_QUERY_STATUS_DROPDOWN==p&&handlerUI.setCommandUpdateIndex(a,c,g_TBDropDown[a].length-1))}}}}catch(q){g_objCommonUtil.displayErrorAlert(q,"moveTBIcon_BasicUi_To_TbContainer")}},spinnerBtnMDownTimer1:null,spinnerBtnMDownTimer2:null,currControlObject:null,addEventTBSpinner:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_SPINNER){for(var b=null,d=0;d<this.TB_CONTAINER[c].childNodes.length;d++)if(this.TB_CONTAINER[c].childNodes[d].getAttribute("orgCommandId")==
a){b=this.TB_CONTAINER[c].childNodes[d];break}if(null!=b){b.onmouseover=function(){return!0};b.onmouseout=function(){return!0};b.onmousedown=function(){return!0};b.onmouseup=function(){return!0};b.ondragstart=function(){return!0};b.onselectstart=function(){return!0};b.onselect=function(){return!0};b.onclick=function(){return!0};var e=g_arrConst[a][7],f=g_arrConst[a][8],g=g_arrConst[a][9],k=g_arrConst[a][3],l=b.getElementsByTagName("input")[0],m=b.getElementsByTagName("div");m[0].onmousedown=function(b){(b?
b:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(b=dze_menu_control.spinnUp(l,e,f,g,k,a,c),this.className="duzon_spinner_btn_arrow_down",b&&(dze_menu_control.spinnerBtnMDownTimer1=setTimeout(function(){dze_menu_control.spinnerBtnMDownTimer2=setInterval(function(){dze_menu_control.spinnUp(l,e,f,g,k,a,c)},70)},500)))};m[0].onmouseup=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};m[0].onmouseout=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();
this.className="duzon_spinner_btn_arrow_up"};m[0].onmouseover=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};m[1].onmousedown=function(b){(b?b:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(b=dze_menu_control.spinnDown(l,e,f,g,k,a,c),this.className="duzon_spinner_btn_arrow_down",b&&(dze_menu_control.spinnerBtnMDownTimer1=setTimeout(function(){dze_menu_control.spinnerBtnMDownTimer2=setInterval(function(){dze_menu_control.spinnDown(l,
e,f,g,k,a,c)},70)},500)))};m[1].onmouseup=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};m[1].onmouseout=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_up"};m[1].onmouseover=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};l.onmouseover=function(){return!0};l.onmouseout=function(){return!0};l.onmousedown=function(){return!0};l.onmouseup=
function(){return!0};l.ondragstart=function(){return!0};l.onselectstart=function(){return!0};l.onselect=function(){return!0};l.onclick=function(){return!0};l.onmousedown=function(){this.select()};l.onblur=function(){dze_menu_control.spinnValCheck(this,e,f)&&""!=k&&eval(k)(this.value,a,c)};l.onkeydown=function(b){try{var d=b?b:window.event;"undefined"==typeof d||null==d?g_objCommonUtil.log("IE8 -> Not Support"):(d.keyCode==ID_KEYCODE_ARROW_TOP&&dze_menu_control.spinnUp(l,e,f,g,k,a,c),d.keyCode==ID_KEYCODE_ARROW_BOTTOM&&
dze_menu_control.spinnDown(l,e,f,g,k,a,c),d.keyCode==ID_KEYCODE_ENTER&&dze_menu_control.spinnValCheck(this,e,f)&&""!=k&&eval(k)(this.value,a,c))}catch(r){}}}}}catch(n){g_objCommonUtil.displayErrorAlert(n,"error:dze_menu_control.addEventTBSpinner")}},spinnUp:function(a,c,b,d,e,f,g){try{if(null==a&&dze_menu_control.clearSpinnerBtnMDownTimer(),1!=a.disabled){""==a.value&&(a.value=b-1);c=parseInt(c,10);if(parseInt(a.value,10)+d<=parseInt(c,10))return a.value=parseInt(a.value,10)+d,""!=e&&eval(e)(a.value,
f,g),!0;dze_menu_control.clearSpinnerBtnMDownTimer();a.value=c;alert(ID_RES_DIALOG_ALERT_MAX_VALUE+c);return!1}}catch(k){g_objCommonUtil.displayErrorAlert(k,"dze_menu_control.spinnUp")}},spinnDown:function(a,c,b,d,e,f,g){try{if(null==a&&dze_menu_control.clearSpinnerBtnMDownTimer(),1!=a.disabled){""==a.value&&(a.value=b);b=parseInt(b,10);if(parseInt(a.value,10)-d>=b)return a.value=parseInt(a.value,10)-d,""!=e&&eval(e)(a.value,f,g),!0;dze_menu_control.clearSpinnerBtnMDownTimer();a.value=b;alert(ID_RES_DIALOG_ALERT_MIN_VALUE+
b);return!1}}catch(k){g_objCommonUtil.displayErrorAlert(k,"dze_menu_control.spinnDown")}},spinnValCheck:function(a,c,b){try{if(1!=checkNumber(a.value))return alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),a.value=a.value.replace(/[^0-9]/g,""),!1;c=parseInt(c,10);b=parseInt(b,10);val=parseInt(a.value,10);return val>c?(alert(ID_RES_DIALOG_ALERT_MAX_VALUE+c),a.value=c,!1):val<b?(alert(ID_RES_DIALOG_ALERT_MIN_VALUE+b),a.value=b,!1):!0}catch(d){return g_objCommonUtil.displayErrorAlert(d,"dze_menu_control.spinnValCheck"),
!1}},clearSpinnerBtnMDownTimer:function(){try{dze_menu_control.spinnerBtnMDownTimer1&&clearInterval(dze_menu_control.spinnerBtnMDownTimer1),dze_menu_control.spinnerBtnMDownTimer2&&clearInterval(dze_menu_control.spinnerBtnMDownTimer2),dze_menu_control.spinnerBtnMDownTimer1=null,dze_menu_control.spinnerBtnMDownTimer2=null}catch(a){g_objCommonUtil.displayErrorAlert(a,"error:dze_menu_control.clearSpinnerBtnMDownTimer")}},moveTBIcon_TbContainer_To_BasicUi:function(a){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(this.curr_checked_menu[a],
a);this.moveTBIcon_Left_RibbonUi_To_TbContainer(a);this.moveTBIcon_Bottom_RibbonUi_To_TbContainer(a);this.changeTbClass(this.TB_CONTAINER[a],"basic");for(var c=1;3>=c;c++)if(toolbarDisplay=eval("dzeUiConfig.bCustomize_ToolBar"+c+"_Display")){var b=document.getElementById("TB_CONTAINER_TOOL_"+c+"_"+a).getElementsByTagName("span");for(j=b.length-1;0<=j;j--)if(b[j].getAttribute("orgCommandId"))for(var d=this.TB_CONTAINER[a].getElementsByTagName("div"),e=0;e<d.length;e++)if(d[e].getAttribute("orgCommandId")&&
d[e].getAttribute("orgCommandId")==b[j].getAttribute("orgCommandId")){b[j].parentNode.insertBefore(d[e],b[j]);break}}}catch(f){g_objCommonUtil.displayErrorAlert(f,"moveTBIcon_TbContainer_To_BasicUi")}},setTBStyle_Basic_To_Ribbon:function(a){try{return"duzon_tb_button"==a.className&&(a.className="duzon_tb_button_ribbon",a.onmouseover=function(){this.className="duzon_tb_button_over_ribbon"},a.onmousedown=function(){this.className="duzon_tb_button_down_ribbon"},a.onmouseout=function(){this.className=
"duzon_tb_button_ribbon"}),a}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setTBStyle_Basic_To_Ribbon")}},setTBStyle_Ribbon_To_Basic:function(a){try{return"duzon_tb_button_ribbon"==a.className&&(a.className="duzon_tb_button",a.onmouseover=function(){this.className="duzon_tb_button_over"},a.onmousedown=function(){this.className="duzon_tb_button_down"},a.onmouseout=function(){this.className="duzon_tb_button"}),a}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:setTBStyle_Ribbon_To_Basic")}},
getTbObjFromTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");for(c=0;c<b.length;c++)if(a==b[c].getAttribute("orgCommandId"))return b[c];return null}catch(d){return null}},changeTbClass:function(a,c){try{if("ribbon"==c){(0==a.className.indexOf("duzon_tb_button")||0==a.className.indexOf("duzon_tb_dropdown"))&&0>a.className.indexOf("_ribbon")&&(a.className+="_ribbon");for(var b=a.getElementsByTagName("div"),d=0;d<b.length;d++){0>b[d].className.indexOf("_ribbon")&&
(0==b[d].className.indexOf("duzon_tb_button")&&(b[d].className+="_ribbon"),0==b[d].className.indexOf("duzon_tb_dropdown")&&(b[d].className+="_ribbon","table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",39),b[d].childNodes[0].setAttribute("height",30),b[d].childNodes[0].setAttribute("align","center"),b[d].childNodes[0].style.width="39px",b[d].childNodes[0].style.margin="auto",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",26),b[d].childNodes[0].rows[0].cells[0].style.textAlign=
"center",b[d].childNodes[0].rows[0].cells[0].style.height="30px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",13),b[d].childNodes[0].rows[0].cells[1].style.height="30px")),0==b[d].className.indexOf("tb_DropDown_Button_Image")&&(b[d].className+="_ribbon"),0==b[d].className.indexOf("tbDropDown_AreaButton")&&(b[d].className+="_ribbon"));var e=b[d].getElementsByTagName("img");e.length&&(e[0].src=e[0].src.replace(/\/toolbar\//,"/ribbon/"))}}else if("basic"==c)for(a.className=a.className.replace(/_ribbon$/,
""),b=a.getElementsByTagName("div"),d=0;d<b.length;d++)b[d].className=b[d].className.replace(/_ribbon$/,""),0==b[d].className.indexOf("duzon_tb_dropdown")&&"table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",30),b[d].childNodes[0].removeAttribute("height"),b[d].childNodes[0].removeAttribute("align"),b[d].childNodes[0].style.width="100%",b[d].childNodes[0].style.margin="",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",18),b[d].childNodes[0].rows[0].cells[0].style.textAlign=
"",b[d].childNodes[0].rows[0].cells[0].style.height="20px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",13),b[d].childNodes[0].rows[0].cells[1].style.height="20px"),e=b[d].getElementsByTagName("img"),e.length&&(e[0].src=e[0].src.replace(/\/ribbon\//,"/toolbar/"))}catch(f){g_objCommonUtil.displayErrorAlert(f,"error:changeTbClass")}},makeRibbonTbUnit:function(a,c){try{var b=null;if("undefined"==typeof a||null==a||!a.length)return b;if(2>a.length){var d=Math.abs(a[0]);if(0<=a[0]){b=document.createElement("table");
b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height="";var e=b.insertRow();h=e.insertCell();h.width=d;h.height="";h.innerHTML='<div class="dze_ribbon_tb_left_separator">'}else b=document.createElement("table"),b.cellSpacing="0",b.cellPadding="0",b.border="0",b.width=d,b.height="",e=b.insertRow(),h=e.insertCell(),h.width=d,h.height=""}else{var f=a[a.length-1];if(1==f){var g=d=50,k=a[0],l=g_arrConst[k][1].replace(/(\s|\/)/g,"");b=document.createElement("table");b.cellSpacing="0";b.cellPadding=
"0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.setAttribute("orgCommandId",k);h.width=d;h.height=50;h.align="center";h.className="dze_ribbon_tb_item_box";h.title=l;var m=this.getTbObjFromTbContainer(k,c);if(null==m)return m;m.style.margin="auto";h.appendChild(m);this.changeTbClass(h,"ribbon");var n=document.createElement("div");n.className="dze_ribbon_tb_item_text";n.id=m.id+"_RIBBON_TEXT";n.innerHTML=l;ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[k][6]&&(n.className="dze_ribbon_tb_item_text_dropbox");
m.appendChild(n)}else if(2==f){var h=e=null;d=95;g=40;var r=a[0],p=this.getTbObjFromTbContainer(r,c);if(null==p)return p;p.style.marginTop="0";p.style.marginBottom="0";var q=a[1],t=this.getTbObjFromTbContainer(q,c);if(null==t)return t;t.style.marginTop="0";t.style.marginBottom="0";b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.width=d;h.height=3;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";
h.setAttribute("orgCommandId",r);h.appendChild(p);e=b.insertRow();h=e.insertCell();h.width=d;h.height=4;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",q);h.appendChild(t);e=b.insertRow();h=e.insertCell();h.width=d;h.height=3}else if(3!=f)if(4==f){h=e=null;d=24;g=40;if(g_arrConst[a[0]][6]==ID_TYPE_TOOLBAR_DROPDOWN||g_arrConst[a[1]][6]==ID_TYPE_TOOLBAR_DROPDOWN)d=35;r=a[0];p=this.getTbObjFromTbContainer(r,c);if(null==p)return p;p.style.marginTop=
"0";p.style.marginBottom="0";q=a[1];t=this.getTbObjFromTbContainer(q,c);if(null==t)return t;t.style.marginTop="0";t.style.marginBottom="0";b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.width=d;h.height=3;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",r);h.appendChild(p);e=b.insertRow();h=e.insertCell();h.width=d;h.height=4;e=b.insertRow();
h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",q);h.appendChild(t);e=b.insertRow();h=e.insertCell();h.width=d;h.height=3}else if(5==f){d=24;g=28;k=a[0];if(k==ID_COMMAND_HEADING_SIZE||k==ID_COMMAND_FONT_SIZE)d="74";else if(k==ID_COMMAND_FONT_NAME)d="104";else if(k==ID_COMMAND_LINE_HEIGHT||k==ID_COMMAND_LETTER_SPACING)d="54";ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[k][6]&&(d="35");var v=this.getTbObjFromTbContainer(k,c);b=document.createElement("table");
b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.className="dze_ribbon_tb_item_box_bottom";h.width=d;h.height=g;h.setAttribute("orgCommandId",k);h.appendChild(v)}}return b}catch(u){return g_objCommonUtil.displayErrorAlert(u,arguments.callee.name),null}},moveTBIcon_TbContainer_To_Main_RibbonUi:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c),d=document.createElement("table");d.cellSpacing="0";d.cellPadding="0";
d.border="0";d.width="100%";for(var e=d.insertRow(),f=null,g=0;g<this.tb_menu_content_list[a].length;g++){var k=this.makeRibbonTbUnit(this.tb_menu_content_list[a][g],c);null!=k&&(f=e.insertCell(),f.width=k.width,f.height=k.height,f.appendChild(k))}e.insertCell();b.appendChild(d);duzon_dialog.animateDlg(d,"right")}catch(l){g_objCommonUtil.displayErrorAlert(l,"moveTBIcon_TbContainer_To_Main_RibbonUi")}},moveTBIcon_TbContainer_To_Left_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+
a),b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0;f<this.tb_menu_content_left_list.length;f++){var g=this.makeRibbonTbUnit(this.tb_menu_content_left_list[f],a);null!=g&&(e=d.insertCell(),e.width=g.width,e.height=g.height,e.appendChild(g))}c.appendChild(b)}catch(k){g_objCommonUtil.displayErrorAlert(k,"moveTBIcon_TbContainer_To_Left_RibbonUi")}},moveTBIcon_TbContainer_To_Bottom_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+
a),b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0;f<this.tb_menu_content_bottom_list.length;f++){var g=this.makeRibbonTbUnit(this.tb_menu_content_bottom_list[f],a);null!=g&&(e=d.insertCell(),e.width=g.width,e.height=g.height,e.appendChild(g))}d.insertCell();c.appendChild(b);this.setShowHideRibbonBottomToolbars()}catch(k){g_objCommonUtil.displayErrorAlert(k,"moveTBIcon_TbContainer_To_Bottom_RibbonUi")}},moveTBIcon_Main_RibbonUi_To_TbContainer:function(a,
c){try{for(var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).getElementsByTagName("td"),d=b.length-1;0<=d;d--)b[d].getAttribute("orgCommandId")&&(1<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[1].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[1]),2<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[2].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[2]),
this.TB_CONTAINER[c].appendChild(b[d].childNodes[0]),b[d].parentNode.removeChild(b[d]));document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).innerHTML=""}catch(e){g_objCommonUtil.displayErrorAlert(e,"moveTBIcon_Main_RibbonUi_To_TbContainer")}},moveTBIcon_Left_RibbonUi_To_TbContainer:function(a){try{for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),
c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).innerHTML=""}catch(d){g_objCommonUtil.displayErrorAlert(d,"moveTBIcon_Left_RibbonUi_To_TbContainer")}},moveTBIcon_Bottom_RibbonUi_To_TbContainer:function(a){try{for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+
a).innerHTML=""}catch(d){g_objCommonUtil.displayErrorAlert(d,"moveTBIcon_Bottom_RibbonUi_To_TbContainer")}},RibbonMenuSetStateAllEnable:function(a,c){try{for(var b=0;b<this.tb_menu_list.length;b++)document.getElementById("TB_MENU_RIBBON_"+b+"_"+c),a?this.setEnableRibbonMenu(b,c):this.setDisableRibbonMenu(b,c);this.showAllTBState()}catch(d){g_objCommonUtil.displayErrorAlert(d,"RibbonMenuSetStateAllEnable")}},setDisableRibbonMenu:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+
c);this.setTBItemTextGray(!0,a,c);b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_GRAY,a,c)}catch(d){g_objCommonUtil.displayErrorAlert(d,"setDisableRibbonMenu")}},setEnableRibbonMenu:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);this.setTBItemTextGray(!1,a,c);a==this.curr_checked_menu[c]?this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c):b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c)}catch(d){g_objCommonUtil.displayErrorAlert(d,
"setEnableRibbonMenu")}},addRibbonUiEvent:function(a){try{window.attachEvent?(g_objEditorDocument[a].attachEvent("onmouseup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].attachEvent("onkeyup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditWindow[a].attachEvent("onresize",dze_menu_control.evtResizeShowHideTb),window.attachEvent("onresize",dze_menu_control.evtResizeShowHideTb)):(g_objEditorDocument[a].addEventListener("mouseup",dze_menu_control.evtMouseUpShowDynamicMenu,
!1),g_objEditorDocument[a].addEventListener("keyup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditWindow[a].addEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1),window.addEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1))}catch(c){g_objCommonUtil.displayErrorAlert(c,"addRibbonUiEvent")}},removeRibbonUiMouseEvent:function(a){try{window.attachEvent?(g_objEditorDocument[a].detachEvent("onmouseup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].detachEvent("onkeyup",
dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].detachEvent("onreize",dze_menu_control.evtResizeShowHideTb),window.detachEvent("onreize",dze_menu_control.evtResizeShowHideTb)):(g_objEditorDocument[a].removeEventListener("mouseup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditorDocument[a].removeEventListener("keyup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditorDocument[a].removeEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1),window.removeEventListener("resize",
dze_menu_control.evtResizeShowHideTb,!1))}catch(c){g_objCommonUtil.displayErrorAlert(c,"removeRibbonUiMouseEvent")}},evtMouseUpShowDynamicMenu:function(a){try{var c=g_nActiveEditNumber;-1!=c&&setTimeout(function(){if(!0===dze_menu_control.checkTableCaret()){if(!0===dze_menu_control.checkImageCaret()){if(!GetMultiCellSelection()){dze_menu_control.activateMenu(dze_menu_control.idxImagePropertyMenu);return}}else{var a=document.getElementById("TB_MENU_RIBBON_"+dze_menu_control.idxTableMenu+"_"+c);if((a.TBSTATE==
ID_STRING_NAME_UNCHECKED||a.TBSTATE==ID_STRING_NAME_CHECKED)&&document.getElementById("TB_MENU_RIBBON_"+dze_menu_control.idxImagePropertyMenu+"_"+c).TBSTATE!=ID_STRING_NAME_CHECKED)return}dze_menu_control.activateMenu(dze_menu_control.idxTableMenu)}else!0===dze_menu_control.checkImageCaret()?dze_menu_control.activateMenu(dze_menu_control.idxImagePropertyMenu):dze_menu_control.curr_checked_menu[c]>=dze_menu_control.idxDynamicMenuStart&&dze_menu_control.activateMenu(dze_menu_control.prev_checked_menu[c]),
dze_menu_control.setDynamicMenu()},0)}catch(b){g_objCommonUtil.displayErrorAlert(b,"evtMouseUpShowDynamicMenu")}},setDynamicMenu:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),this.curr_checked_menu[a]<this.idxDynamicMenuStart&&!this.checkTableCaret(a)&&this.deactivateMenu(this.idxTableMenu,a),this.curr_checked_menu[a]<this.idxDynamicMenuStart&&!this.checkTableCaret(a)&&this.deactivateMenu(this.idxImagePropertyMenu,a)}catch(c){g_objCommonUtil.displayErrorAlert(c,"setDynamicMenu")}},
checkTableCaret:function(a){try{return"undefined"==typeof a&&(a=g_nActiveEditNumber),g_objTable||g_objTableSelection.setTableObjectOnCaret(a),g_objTable?!0:!1}catch(c){g_objCommonUtil.displayErrorAlert(c,"checkTableCaret")}},checkImageCaret:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var c=getSelectionControl(a);return"undefined"!=typeof c.controlObject&&null!=c.controlObject&&"img"==c.controlObject.nodeName.toLowerCase()?!0:!1}catch(b){g_objCommonUtil.displayErrorAlert(b,"checkImageCaret")}},
evtResizeShowHideTb:function(){try{for(var a in g_arrEditorAreaContainer){var c=a;dze_menu_control.setShowHideRibbonMainToolbars(dze_menu_control.curr_checked_menu[c],c);dze_menu_control.setShowHideRibbonBottomToolbars(c)}}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:evtResizeShowHideTb")}},addEventMenuControl:function(a){try{window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",dze_menu_control.evtEditorMouseDown):g_objEditorDocument[a].addEventListener("mousedown",dze_menu_control.evtEditorMouseDown,
!1)}catch(c){g_objCommonUtil.displayErrorAlert(c,"addEventMenuControl")}},evtEditorMouseDown:function(a){try{dze_menu_control.removeUiToggleBtnLayer(),dze_menu_control.removeHelpBtnLayer()}catch(c){g_objCommonUtil.displayErrorAlert(c,"error:evtEditorMouseDown")}},setTBImageSizeInfo:function(a){try{if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&(dze_menu_control.currControlObject=null,this.curr_checked_menu[a]==dze_menu_control.idxImagePropertyMenu)){var c=getSelectionControl(a);
if("undefined"!=typeof c.controlObject&&null!=c.controlObject&&"img"==c.controlObject.nodeName.toLowerCase()){dze_menu_control.currControlObject=c.controlObject;var b=document.getElementById("dze_form_"+g_arrConst[ID_CUSTOM_IMAGE_HEIGHT][2]+"_"+a);b&&(b.value=dze_menu_control.currControlObject.offsetHeight);var d=document.getElementById("dze_form_"+g_arrConst[ID_CUSTOM_IMAGE_WIDTH][2]+"_"+a);d&&(d.value=dze_menu_control.currControlObject.offsetWidth)}}}catch(e){g_objCommonUtil.displayErrorAlert(e,
"error:setTBImageSizeInfo")}},showAllTBState:function(a){},destruct:function(){}};

var RULERBAR_NONE_BTN=0,RULERBAR_L_TOP_BTN=1,RULERBAR_L_MID_BTN=2,RULERBAR_L_BOTTOM_BTN=3,RULERBAR_R_BOTTOM_BTN=4,RULERBAR_UNIT=15,dze_rulerbar_mgr={m_nEditNum:0,m_nEditorWidth:698,m_nMaxEditorWidthForFullScreen:0,m_nScrollBarClntWidth:0,m_nDefaultBodyMargin:3,m_nBtnHalfWidth:0,m_nObjType:DZE_TAG_NONE,m_nPressedKeyType:ID_KEYCODE_NONE,m_nPressedBtnType:RULERBAR_NONE_BTN,m_bCreated:!1,m_bShow:!1,m_bMove:!1,m_nPosLTB:0,m_nPosLMB:0,m_nPosRBB:0,m_nLeftMargin:0,m_nRightMargin:0,m_nIndent:0,m_curLineEle:null,
m_RulerbarEle:null,m_objFocusNode:null,m_drawVGuideLineDiv:null,m_pressLTBtnDiv:null,m_pressLMBtnDiv:null,m_pressLBBtnDiv:null,m_pressRBBtnDiv:null,m_CurDetailLineEle:null,m_DetailTxtBoxEle1:null,m_DetailUnitLineEle1:null,m_DetailTxtBoxEle2:null,m_DetailUnitLineEle2:null,m_DetailTxtBoxEle3:null,m_DetailUnitLineEle3:null,m_DetailTxtBoxEle4:null,m_DetailUnitLineEle4:null,m_DetailTxtBoxEle5:null,m_DetailUnitLineEle5:null,m_DetailTxtBoxEle6:null,m_posMoveX:0,debugBtnPos:function(){},debugParaAtt:function(){},
createRulerbar:function(a,b,c){try{this.initialize(a,b,c,ID_KEYCODE_NONE);b=null;b=this.m_bCreated?this.m_RulerbarEle.parentNode:document.getElementById("TB_CONTAINER_RULERBAR_"+a);if(g_bFullScreenMode&&this.m_bCreated){var d=g_objLayerKit.getLayerDocument().createElement("div");d.className="duzon_rulerbar_container";d.id="TB_CONTAINER_V_RULERBAR";d.innerHTML=this.createRulerbarBgTable();var f=b.childNodes[0];f.replaceChild(d.childNodes[0],f.childNodes[0]);f.childNodes[5].style.width=this.m_nEditorWidth+
"px"}else b.innerHTML=this.createRulerbarHTML(a);this.m_bCreated&&this.m_drawVGuideLineDiv&&(this.m_drawVGuideLineDiv.style.height=g_nEditAreaSetHeight-1-(g_bTabBar_Display?24:0)+"px");this.m_RulerbarEle=b.childNodes[0];this.initContainerRulerbarCtrl(this.m_nEditNum);this.m_bCreated=!0}catch(g){g_objCommonUtil.displayErrorAlert(g,"dze_rulerbar_mgr.createRulerbar")}},createRulerbarHTML:function(a){a="";try{a+='<div class="duzon_rulerbar_container" id = "TB_CONTAINER_V_RULERBAR">';a+=this.createRulerbarBgTable();
a+="<div class='dz_rulerbar_btn' style='top:-2px;' id='dz_rulerbar_top_btn'><img src='"+dzeEnvConfig.strPath_Image+"dialog/rulerbar_l_top_btn.png' alt='' width='7' height='9' border='0' ></div>";a+="<div class='dz_rulerbar_btn' style='top:9px;' id='dz_rulerbar_mid_btn'><img src='"+dzeEnvConfig.strPath_Image+"dialog/rulerbar_l_mid_btn.png' alt='' width='7' height='9' border='0'></div>";a+="<div class='dz_rulerbar_btn' style='top:16px;' id='dz_rulerbar_bottom_btn'><img src='"+dzeEnvConfig.strPath_Image+
"dialog/rulerbar_l_bottom_btn.png' alt='' width='7' height='4' border='0'></div>";a+="<div class='dz_rulerbar_btn' style='top:9px;' id='dz_rulerbar_r_bottom_btn'><img src='"+dzeEnvConfig.strPath_Image+"dialog/rulerbar_r_bottom_btn.png' alt='' width='7' height='9' border='0'></div>";a+="<div class='dz_rulerbar_detail_line' id='dz_rulerbar_detail_line' style='display:none;width: "+this.m_nEditorWidth+"px'></div>";var b=1;a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox1'  style='display:none;'>"+
b++ +"</div>";a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox2'  style='display:none;'>"+b++ +"</div>";a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox3'  style='display:none;'>"+b++ +"</div>";a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox4'  style='display:none;'>"+b++ +"</div>";a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox5'  style='display:none;'>"+b++ +"</div>";a+="<div class='dz_rulerbar_detail_txtbox' id='dz_rulerbar_detail_txtbox6'  style='display:none;'>"+
b++ +"</div>";a+="<div class='dz_rulerbar_detail_unit_line' id='dz_rulerbar_detail_unit_line1' style='display:none;'></div>";a+="<div class='dz_rulerbar_detail_unit_line' id='dz_rulerbar_detail_unit_line2' style='display:none;'></div>";a+="<div class='dz_rulerbar_detail_unit_line' id='dz_rulerbar_detail_unit_line3' style='display:none;'></div>";a+="<div class='dz_rulerbar_detail_unit_line' id='dz_rulerbar_detail_unit_line4' style='display:none;'></div>";a+="<div class='dz_rulerbar_detail_unit_line' id='dz_rulerbar_detail_unit_line5' style='display:none;'></div>";
return a+="</div>"}catch(c){return g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.createRulerbarHTML"),a}},createRulerbarBgTable:function(){var a="";try{a+='<table class = "dz_rulerbar_table" width ='+this.m_nEditorWidth+'"px" cellSpacing="0" cellPadding="0" >';a+='<tr height="16px" valign="center">';a+='<td class ="dz_rulerbar_bg_unit_gap" ></td>';for(var b=RULERBAR_UNIT,c=Math.floor((this.m_nEditorWidth-2*this.m_nDefaultBodyMargin)/RULERBAR_UNIT),d=0;d<c;d++)a=0==d%2?a+'<td class ="dz_rulerbar_bg_unit_line" >|':
a+('<td class ="dz_rulerbar_bg_unit_num" >'+b),a+="</td>",b+=RULERBAR_UNIT;a+='<td class ="dz_rulerbar_bg_unit_gap" ></td>';a+="</tr>";return a+="</table>"}catch(f){return g_objCommonUtil.displayErrorAlert(f,"toolbuilder.createRulerbarBgTable"),a}},createDrawVGuideLineDiv:function(){try{if(null==this.m_drawVGuideLineDiv){var a=g_bTabBar_Display?24:0;this.m_drawVGuideLineDiv=document.createElement("div");this.m_drawVGuideLineDiv.className="dze_v_rulerbar_guideline";this.m_drawVGuideLineDiv.style.height=
g_nEditAreaSetHeight-1-a+"px";document.body.appendChild(this.m_drawVGuideLineDiv)}this.m_drawVGuideLineDiv.setAttribute("id","dze_rulerbar_v_guideline"+this.m_nEditNum)}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.createDrawVGuideLineDiv")}},reset:function(){try{var a=this.getPressedBtnDiv();null!=a&&(a.className="dz_rulerbar_btn",this.m_bMove=!1,this.m_nObjType==DZE_TAG_NONE,this.m_nPressedBtnType=RULERBAR_NONE_BTN,this.m_nPressedKeyType=ID_KEYCODE_NONE,this.m_objFocusNode=null,
this.m_nScrollBarClntWidth=this.m_posMoveX=0)}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.reset")}},initialize:function(a,b,c,d){try{this.m_nEditNum=a,this.m_nEditorWidth=b,this.m_nDefaultBodyMargin=c,this.m_nPressedBtnType=RULERBAR_NONE_BTN,this.m_objFocusNode=null,this.m_nScrollBarClntWidth=this.m_posMoveX=0,this.m_nPressedKeyType=d}catch(f){g_objCommonUtil.displayErrorAlert(f,"dze_rulerbar_mgr.initialize")}},initContainerRulerbarCtrl:function(a){try{g_bRulerbar_Display&&this.m_RulerbarEle&&
(this.createDrawVGuideLineDiv(),this.setRulerbarCtrl(),this.updateCtrlPos())}catch(b){g_objCommonUtil.displayErrorAlert(b,"error:initContainerRulerbarCtrl")}},setRulerbarCtrl:function(){for(var a=1;5>a;a++){var b=this.m_RulerbarEle.childNodes[a];switch(a){case 1:this.m_pressLTBtnDiv=b;break;case 2:this.m_pressLMBtnDiv=b;break;case 3:this.m_pressLBBtnDiv=b;break;case 4:this.m_pressRBBtnDiv=b}this.m_nBtnHalfWidth||(this.m_nBtnHalfWidth=b.clientWidth?b.clientWidth:b.childNodes[0].width/2);this.evtProcessRulerbar(this.m_RulerbarEle,
b)}this.m_CurDetailLineEle=this.m_RulerbarEle.childNodes[5];this.m_DetailTxtBoxEle1=this.m_RulerbarEle.childNodes[6];this.m_DetailTxtBoxEle2=this.m_RulerbarEle.childNodes[7];this.m_DetailTxtBoxEle3=this.m_RulerbarEle.childNodes[8];this.m_DetailTxtBoxEle4=this.m_RulerbarEle.childNodes[9];this.m_DetailTxtBoxEle5=this.m_RulerbarEle.childNodes[10];this.m_DetailTxtBoxEle6=this.m_RulerbarEle.childNodes[11];this.m_DetailUnitLineEle1=this.m_RulerbarEle.childNodes[12];this.m_DetailUnitLineEle2=this.m_RulerbarEle.childNodes[13];
this.m_DetailUnitLineEle3=this.m_RulerbarEle.childNodes[14];this.m_DetailUnitLineEle4=this.m_RulerbarEle.childNodes[15];this.m_DetailUnitLineEle5=this.m_RulerbarEle.childNodes[16]},evtProcessRulerbar:function(a,b){try{a.onmousemove=function(a){dze_rulerbar_mgr.onMouseMoveProcess(a?a:window.event)},a.onmouseup=function(a){dze_rulerbar_mgr.onMouseUpProcess(a?a:window.event)},b.onmousedown=function(a){var b=dze_rulerbar_mgr.m_nPressedBtnType;"dz_rulerbar_top_btn"==this.id?dze_rulerbar_mgr.m_nPressedBtnType=
RULERBAR_L_TOP_BTN:"dz_rulerbar_mid_btn"==this.id?dze_rulerbar_mgr.m_nPressedBtnType=RULERBAR_L_MID_BTN:"dz_rulerbar_bottom_btn"==this.id?dze_rulerbar_mgr.m_nPressedBtnType=RULERBAR_L_BOTTOM_BTN:"dz_rulerbar_r_bottom_btn"==this.id&&(dze_rulerbar_mgr.m_nPressedBtnType=RULERBAR_R_BOTTOM_BTN);dze_rulerbar_mgr.onMouseDownProcess(a,b==RULERBAR_NONE_BTN)},b.onmouseup=function(a){dze_rulerbar_mgr.onMouseUpProcess(a)}}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.evtProcessRulerbar")}},showRulerbarVGuideLine:function(){try{if(this.m_nPressedBtnType){this.m_drawVGuideLineDiv.style.top=
g_nToolbarSetHeight+"px";var a=this.getPosCurPressedBtnDiv()+this.m_nBtnHalfWidth;0<=a&&(this.m_drawVGuideLineDiv.style.left=parseFloat(a,10)+"px")}}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.showRulerbarVGuideLine")}},showDetailBg:function(){try{this.m_nPressedKeyType==ID_KEYCODE_ALT?this.changeDetailRulerCtrl(!0):this.changeDetailRulerCtrl(!1)}catch(a){g_objCommonUtil.displayErrorAlert(a,"dze_rulerbar_mgr.showDetailBg")}},hideRulerbarVGuideLine:function(a){this.m_drawVGuideLineDiv.style.left=
"-500px";this.m_drawVGuideLineDiv.style.top="-500px";a&&this.reset()},changeDetailRulerCtrl:function(a){try{if(a){a=10;this.m_CurDetailLineEle.style.display="";if(""!=this.m_DetailTxtBoxEle1.innerText){var b=parseFloat(this.m_DetailTxtBoxEle1.style.width,10);a=isNaN(b)?10:b;a<=this.m_nDefaultBodyMargin&&(this.m_DetailTxtBoxEle1.style.display="");this.m_DetailUnitLineEle1.style.display=""}""!=this.m_DetailTxtBoxEle2.innerText&&(b=parseFloat(this.m_DetailTxtBoxEle2.style.width,10),a=isNaN(b)?10:b,a<=
parseFloat(this.m_DetailTxtBoxEle2.innerText,10)&&(this.m_DetailTxtBoxEle2.style.display="",this.m_DetailUnitLineEle2.style.display=""));""!=this.m_DetailTxtBoxEle3.innerText&&(b=parseFloat(this.m_DetailTxtBoxEle3.style.width,10),a=isNaN(b)?10:b,a<=parseFloat(this.m_DetailTxtBoxEle3.innerText,10)&&(this.m_DetailTxtBoxEle3.style.display="",this.m_DetailUnitLineEle3.style.display=""));""!=this.m_DetailTxtBoxEle4.innerText&&(b=parseFloat(this.m_DetailTxtBoxEle4.style.width,10),a=isNaN(b)?10:b,a<=parseFloat(this.m_DetailTxtBoxEle4.innerText,
10)&&(this.m_DetailTxtBoxEle4.style.display="",this.m_DetailUnitLineEle4.style.display=""));""!=this.m_DetailTxtBoxEle5.innerText&&(b=parseFloat(this.m_DetailTxtBoxEle5.style.width,10),a=isNaN(b)?10:b,a<=parseFloat(this.m_DetailTxtBoxEle5.innerText,10)&&(this.m_DetailTxtBoxEle5.style.display="",this.m_DetailUnitLineEle5.style.display=""));""!=this.m_DetailTxtBoxEle6.innerText&&(b=parseFloat(this.m_DetailTxtBoxEle6.style.width,10),a=isNaN(b)?10:b,a<=this.m_nDefaultBodyMargin&&(this.m_DetailTxtBoxEle6.style.display=
""));this.m_RulerbarEle.childNodes[0].style.color="white"}else this.m_CurDetailLineEle.style.display="none",""!=this.m_DetailTxtBoxEle1.innerText&&(this.m_DetailUnitLineEle1.style.display="none",this.m_DetailTxtBoxEle1.style.display="none"),""!=this.m_DetailTxtBoxEle2.innerText&&(this.m_DetailUnitLineEle2.style.display="none",this.m_DetailTxtBoxEle2.style.display="none"),""!=this.m_DetailTxtBoxEle3.innerText&&(this.m_DetailUnitLineEle3.style.display="none",this.m_DetailTxtBoxEle3.style.display="none"),
""!=this.m_DetailTxtBoxEle4.innerText&&(this.m_DetailUnitLineEle4.style.display="none",this.m_DetailTxtBoxEle4.style.display="none"),""!=this.m_DetailTxtBoxEle5.innerText&&(this.m_DetailUnitLineEle5.style.display="none",this.m_DetailTxtBoxEle5.style.display="none"),""!=this.m_DetailTxtBoxEle6.innerText&&(this.m_DetailTxtBoxEle6.style.display="none"),this.m_RulerbarEle.childNodes[0].style.color="black"}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.changeDetailRulerCtrl")}},changeRulerbarDisplay:function(a,
b){try{this.m_bShow!=b&&this.m_RulerbarEle&&(b?(this.m_RulerbarEle.parentNode.parentNode.style.display="",this.m_RulerbarEle.parentNode.style.display="",this.m_RulerbarEle.style.display="",this.m_bShow=!0):(this.m_RulerbarEle.parentNode.parentNode.style.display="none",this.m_RulerbarEle.parentNode.style.display="none",this.m_RulerbarEle.style.display="none",this.m_curLineEle=null,this.m_bShow=!1))}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.changeRulerbarDisplay")}},resizeEditorHeight:function(){try{var a=
this.m_nEditNum;"ribbon"==dze_menu_control.getUiMode()?g_bEditorHeightIFrameYN?dze_menu_control.resizeEditorHeight(a):dze_menu_control.resizeEditorHeight(a,g_arrEditorHeight[a]):g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,g_arrEditorHeight[a])}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.resizeEditorHeight")}},setCurStLineEle:function(a,b){try{if(a){if(a&&1==a.rangeCount){var c=null,d=a.getRangeAt(0);return(c=a.isCollapsed?d.startContainer:null==b?d.startContainer:
b)?this.searchParagraphEle(c,b,!0):this.getBodyFirstChildEle(g_objEditorDocument[this.m_nEditNum].body)}return this.getBodyFirstChildEle(g_objEditorDocument[this.m_nEditNum].body)}}catch(f){g_objCommonUtil.displayErrorAlert(f,"dze_rulerbar_mgr.setCurStLineEle")}},isParagraphEle:function(a){switch(a){case DZE_HTMLOBJ_P:return!0;case DZE_HTMLOBJ_OL:return!0;case DZE_HTMLOBJ_UL:return!0}return!1},checkSelectionRangeNode:function(a,b,c,d){try{var f=null;(f=d?this.m_curLineEle.nextSibling:this.m_curLineEle.previousSibling)&&
f.nodeType==ID_SELECTION_TEXT_NODE&&checkTextNodeAllWhiteCode_Plus_Space(f.nodeValue)&&(f=this.skipTextNode(f,!0));if(!f)return this.getBodyFirstChildEle(g_objEditorDocument[this.m_nEditNum].body);c.selectNodeContents(f);switch(b.compareBoundaryPoints(Range.END_TO_START,c)){case 1:d=!1;this.checkSelectionRangeNode(b,c,d);break;case 0:g_objCommonUtil.displayErrorAlert(e,"dze_rulerbar_mgr.position same!");break;case -1:d=!0,this.m_curLineEle=this.setCurStLineEle(a,f)}return d}catch(g){g_objCommonUtil.displayErrorAlert(g,
"dze_rulerbar_mgr.checkSelectionRangeNode")}},searchParagraphEle:function(a,b,c){try{var d=a.nodeName.toLowerCase();g_objCommonUtil.log("searchParagraphEle :: "+d);switch(d){case DZE_HTMLOBJ_OL:case DZE_HTMLOBJ_UL:break;default:for(;!this.isParagraphEle(d);){if(d==DZE_HTMLOBJ_BODY)return this.getBodyFirstChildEle(a);a=this.checkNodeType(a,b,c,!1);d=a.nodeName.toLowerCase()}}return a}catch(f){g_objCommonUtil.displayErrorAlert(f,"dze_rulerbar_mgr.searchParagraphEle")}},checkNodeType:function(a,b,c,
d){try{if(!a)return null;switch(a.nodeType){case ID_SELECTION_TEXT_NODE:if(checkTextNodeAllWhiteCode_Plus_Space(a.nodeValue)){if(a=this.skipTextNode(a,c),!a)return this.getBodyFirstChildEle(g_objEditorDocument[this.m_nEditNum].body)}else a=a.parentNode;break;case ID_SELECTION_ELEMENT_NODE:case ID_SELECTION_COMMENT_NODE:var f=a.nodeName.toLowerCase();!d&&null==b||f==DZE_HTMLOBJ_SPAN||f==DZE_HTMLOBJ_LI?a=a.parentNode:d&&(a=a.previousSibling)}return a}catch(g){g_objCommonUtil.displayErrorAlert(g,"dze_rulerbar_mgr.checkNodeType")}},
skipTextNode:function(a,b){try{var c=a.parentNode;if(c)switch(c.nodeName.toLowerCase()){case DZE_HTMLOBJ_BODY:c=null;if(c=b?a.nextSibling:a.previousSibling)a=c;else for(var d=a.previousSibling;d;){var f=d.nodeName.toLowerCase();if(f==DZE_HTMLOBJ_BODY)d=d.previousSibling;else if(this.isParagraphEle(f))return d;d=this.checkNodeType(d,null,!1,!0)}return a}return null}catch(g){g_objCommonUtil.displayErrorAlert(g,"dze_rulerbar_mgr.skipTextNode")}},skipCommentNode:function(a){try{return a&&a.nodeType==
ID_SELECTION_COMMENT_NODE?a.previousSibling:null}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.skipCommentNode")}},setCurLineEle:function(){try{var a=g_objEditWindow[this.m_nEditNum].getSelection();(this.m_curLineEle=this.setCurStLineEle(a,null))?this.setParaAttCtrl():g_objCommonUtil.displayErrorAlert(e,"Ele null")}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.setCurLineEle")}},updateGuideLineHeight:function(a){this.m_drawVGuideLineDiv&&(this.m_drawVGuideLineDiv.style.height=
a+"px")},getMaxEditorWidth:function(){var a=Math.max(this.m_nPosLTB,this.m_nPosLMB)+38+this.m_nBtnHalfWidth,b=this.getRightMargin();return this.m_nMaxEditorWidthForFullScreen=a+this.m_nDefaultBodyMargin+b},updateCtrlPos:function(){try{if(this.m_curLineEle||this.setCurLineEle(),this.m_curLineEle){var a=g_objEditorDocument[this.m_nEditNum].body.clientWidth;this.m_nEditorWidth!=a&&(this.m_nScrollBarClntWidth=this.m_nEditorWidth-a,this.m_nEditorWidth=a);var b=g_objEditWindow[this.m_nEditNum].getSelection();
if(b&&1==b.rangeCount){var c=b.getRangeAt(0).commonAncestorContainer;a=[{check:DZE_HTMLOBJ_TD},{check:DZE_HTMLOBJ_TR},{check:DZE_HTMLOBJ_BODY}];this.m_objFocusNode=g_objNodeUtil.getParentElementForTargetTags(c,a,a.length)}a=c=0;this.m_nObjType=getObjNodeType(this.m_objFocusNode,this.m_nEditNum);switch(this.m_nObjType){case DZE_TAG_TD:var d=this.m_objFocusNode;c=d.offsetLeft-d.clientLeft;a=d.offsetLeft+d.clientWidth-parseFloat(d.style.borderWidth,10);break;default:a=this.m_nEditorWidth-this.m_nDefaultBodyMargin}var f=
this.m_nLeftMargin+c,g=a-this.m_nRightMargin,h=f+this.m_nIndent;this.m_nPosLTB=h?h:0;this.m_nPosLMB=f?f:0;var k=Math.floor(this.m_nBtnHalfWidth);this.m_nPosRBB=g>k?g-k:0;this.setRulerbarBtnCtrl(this.m_nPosLTB,this.m_nPosLMB,this.m_nPosRBB);this.m_nPressedKeyType==ID_KEYCODE_ALT&&this.updateDetailCtrl(this.m_nPosLTB,this.m_nPosLMB,this.m_nPosRBB,k);g_bFullScreenMode&&(this.m_nMaxEditorWidthForFullScreen=this.m_nPosRBB+this.m_nRightMargin+this.m_nDefaultBodyMargin)}}catch(l){g_objCommonUtil.displayErrorAlert(l,
"dze_rulerbar_mgr.updateCtrlPos")}},setRulerbarBtnCtrl:function(a,b,c){try{this.m_pressLTBtnDiv.style.left=a+"px",this.m_pressLMBtnDiv.style.left=b+"px",this.m_pressLBBtnDiv.style.left=b+"px",this.m_pressRBBtnDiv.style.left=c+"px"}catch(d){g_objCommonUtil.displayErrorAlert(d,"dze_rulerbar_mgr.setRulerbarBtnCtrl")}},updateDetailCtrl:function(a,b,c,d){try{this.getPressedBtnDiv()&&(a=this.m_nPosLTB,b=this.m_nPosLMB,c=this.m_nPosRBB,d=this.m_nBtnHalfWidth);var f=Math.max(a,b),g=Math.min(a,b),h=this.m_nDefaultBodyMargin,
k=g?g-this.m_nDefaultBodyMargin:0;a=f-g;b=c-f;var l=this.m_nEditorWidth-this.m_nDefaultBodyMargin-c,m=this.m_nDefaultBodyMargin;this.m_DetailTxtBoxEle1.innerText=h;this.m_DetailTxtBoxEle1.style.left=h/2+"px";this.m_DetailUnitLineEle1.style.left=h+"px";this.m_DetailTxtBoxEle2.innerText=Math.abs(k);this.m_DetailTxtBoxEle2.style.left=this.m_nDefaultBodyMargin+k/2+"px";this.m_DetailUnitLineEle2.style.left=g+d+"px";this.m_DetailTxtBoxEle3.innerText=a;this.m_DetailTxtBoxEle3.style.left=g+a/2+"px";this.m_DetailUnitLineEle3.style.left=
f+d+"px";this.m_DetailTxtBoxEle4.innerText=b;this.m_DetailTxtBoxEle4.style.left=f+b/2+"px";this.m_DetailUnitLineEle4.style.left=c+d+"px";this.m_DetailTxtBoxEle5.innerText=l;this.m_DetailTxtBoxEle5.style.left=c+l/2+"px";this.m_DetailUnitLineEle5.style.left=this.m_nEditorWidth-this.m_nDefaultBodyMargin+"px";this.m_DetailTxtBoxEle6.innerText=m;this.m_DetailTxtBoxEle6.style.left=this.m_nEditorWidth-this.m_nDefaultBodyMargin+m/2+"px"}catch(n){g_objCommonUtil.displayErrorAlert(n,"dze_rulerbar_mgr.updateDetailCtrl")}},
getPressedBtnDiv:function(){try{switch(this.m_nPressedBtnType){case RULERBAR_L_TOP_BTN:return this.m_pressLTBtnDiv;case RULERBAR_L_MID_BTN:return this.m_pressLMBtnDiv;case RULERBAR_L_BOTTOM_BTN:return this.m_pressLBBtnDiv;case RULERBAR_R_BOTTOM_BTN:return this.m_pressRBBtnDiv}return null}catch(a){g_objCommonUtil.displayErrorAlert(a,"dze_rulerbar_mgr.getPressedBtnDiv")}},getPosCurPressedBtnDiv:function(){try{switch(this.m_nPressedBtnType){case RULERBAR_L_TOP_BTN:return this.m_nPosLTB;case RULERBAR_L_MID_BTN:return this.m_nPosLMB;
case RULERBAR_L_BOTTOM_BTN:return this.m_nPosLMB;case RULERBAR_R_BOTTOM_BTN:return this.m_nPosRBB}return null}catch(a){g_objCommonUtil.displayErrorAlert(a,"dze_rulerbar_mgr.getPressedBtnDiv")}},onmousemoveFromParent:function(a,b,c){if(this.m_nPressedBtnType)this.onMouseMoveProcess(b)},onMouseMoveProcess:function(a){try{if(this.m_nPressedBtnType){var b=g_objPositionUtil.getDocumentClientSize(self).nClientWidth;Math.max(a.clientX>b)!=a.clientX&&("-500px"==this.m_drawVGuideLineDiv.style.top&&(this.m_drawVGuideLineDiv.style.top=
g_nToolbarSetHeight+"px"),this.m_bMove=!0,this.m_posMoveX=a.clientX,this.moveBtnDiv())}}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.onMouseMoveProcess")}},setPressedKeyType:function(a){try{var b=ID_KEYCODE_NONE;a&&(b=a.altKey?ID_KEYCODE_ALT:a.ctrlKey?ID_KEYCODE_CTRL:ID_KEYCODE_NONE);this.m_nPressedKeyType!=b&&(this.m_nPressedKeyType=b,this.m_nPressedBtnType==RULERBAR_NONE_BTN?this.updateCtrlPos():this.updateDetailCtrl(0,0,0,0),this.showDetailBg())}catch(c){g_objCommonUtil.displayErrorAlert(c,
"dze_rulerbar_mgr.setPressedKeyType")}},getLeftMargin:function(){if(!this.m_curLineEle)return 0;var a=parseFloat(this.m_curLineEle.style.marginLeft,10);return this.m_nLeftMargin=a=isNaN(a)?0:a},getRightMargin:function(){if(!this.m_curLineEle)return 0;var a=parseFloat(this.m_curLineEle.style.marginRight,10);return this.m_nRightMargin=a=isNaN(a)?0:a},getIndent:function(){if(!this.m_curLineEle)return 0;var a=parseFloat(this.m_curLineEle.style.textIndent,10);return this.m_nIndent=a=isNaN(a)?0:a},checkDownPos:function(a,
b){try{if(!b||this.m_nPressedBtnType==RULERBAR_NONE_BTN)return!0;var c=this.m_nDefaultBodyMargin;this.m_objFocusNode&&this.m_nObjType==DZE_TAG_TD&&(c=this.m_objFocusNode.offsetLeft+this.m_nLeftMargin);if(this.m_nPosLTB<c&&!(0<this.m_nIndent)&&0!=this.m_nIndent){var d=this.m_nPressedBtnType;switch(d){case RULERBAR_L_TOP_BTN:this.m_nPressedBtnType=RULERBAR_L_TOP_BTN;this.m_posMoveX=0;this.moveBtnDiv();break;case RULERBAR_L_MID_BTN:this.m_nPressedBtnType=RULERBAR_L_MID_BTN;this.m_posMoveX=Math.abs(this.m_nIndent);
this.moveBtnDiv();break;case RULERBAR_L_BOTTOM_BTN:this.m_nPressedBtnType=RULERBAR_L_TOP_BTN,this.m_posMoveX=0,this.moveBtnDiv(),this.m_nPressedBtnType=RULERBAR_L_MID_BTN,this.m_posMoveX=Math.abs(this.m_nIndent),this.moveBtnDiv()}this.m_nPressedBtnType=d;this.m_bMove=!0}}catch(f){g_objCommonUtil.displayErrorAlert(f,"dze_rulerbar_mgr.checkDownPos")}return!1},onMouseDownProcess:function(a,b){try{this.setCurLineEle(),this.checkDownPos(a,b),this.showDetailBg(),this.showRulerbarVGuideLine()}catch(c){g_objCommonUtil.displayErrorAlert(c,
"dze_rulerbar_mgr.onMouseDownProcess")}},onMouseUpProcess:function(a){this.m_nPressedBtnType&&this.m_bMove&&(this.applyParagraph(a.clientX),this.hideRulerbarVGuideLine(!0))},moveBtnDiv:function(){try{if(this.m_nPressedBtnType!=RULERBAR_NONE_BTN&&null!=this.m_drawVGuideLineDiv){var a=this.m_posMoveX-this.m_nBtnHalfWidth;this.m_nPressedKeyType==ID_KEYCODE_NONE&&a&&(a-=a%RULERBAR_UNIT);var b=0;if(this.m_nPressedBtnType!=RULERBAR_R_BOTTOM_BTN&&(b=this.m_nPosRBB-this.m_nBtnHalfWidth-38,Math.max(a,b)==
a))return;a=Math.max(parseFloat(a,10),0);switch(this.m_nPressedBtnType){case RULERBAR_L_TOP_BTN:case RULERBAR_R_BOTTOM_BTN:this.m_nPressedBtnType==RULERBAR_R_BOTTOM_BTN?(a=Math.max(a,Math.max(this.m_nPosLTB,this.m_nPosLMB)+38+this.m_nBtnHalfWidth),this.m_nPosRBB=a=Math.min(a,this.m_nEditorWidth-this.m_nDefaultBodyMargin)):this.m_nPosLTB=a;break;case RULERBAR_L_MID_BTN:this.m_nPosLMB=a;break;case RULERBAR_L_BOTTOM_BTN:this.moveBtnDivLBottom(b,a)}this.setRulerbarBtnCtrl(this.m_nPosLTB,this.m_nPosLMB,
this.m_nPosRBB);this.m_nPressedKeyType==ID_KEYCODE_ALT&&this.updateDetailCtrl(0,0,0,0);this.showDetailBg();this.showRulerbarVGuideLine()}}catch(c){g_objCommonUtil.displayErrorAlert(c,"dze_rulerbar_mgr.moveBtnDiv")}},moveBtnDivLBottom:function(a,b){try{var c=b+this.m_nIndent;if(0<this.m_nIndent){if(Math.max(c,a)==c)return}else if(0!=this.m_nIndent&&0>c&&Math.min(c,0)==c)return;if(0==c||0!=c&&c!=a)this.m_nPosLMB=b,this.m_nPosLTB=0==this.m_nIndent?b:c}catch(d){g_objCommonUtil.displayErrorAlert(d,"dze_rulerbar_mgr.moveBtnDivLBottom")}},
applyParagraph:function(a){try{if(a=this.getPosCurPressedBtnDiv(),!(0>a)&&this.m_curLineEle){var b=0,c=0;if(this.m_objFocusNode)switch(this.m_nObjType){case DZE_TAG_TABLE:case DZE_TAG_TR:case DZE_TAG_TD:b=this.m_objFocusNode.offsetLeft;c=this.m_objFocusNode.offsetLeft+this.m_objFocusNode.offsetWidth;break;case DZE_TAG_NONE:c=b=0}var d=g_objEditWindow[this.m_nEditNum].getSelection(),f=d.getRangeAt(0),g=document.createRange();if(d&&f&&g)if(d.isCollapsed)this.setParaAtt(a,b,c);else{for(var h=!0,k=this.m_curLineEle,
l=this.setCurStLineEle(d,f.endContainer);this.m_curLineEle;){this.setParaAtt(a,b,c);if(this.m_curLineEle==l)break;h=this.checkSelectionRangeNode(d,f,g,h)}this.m_curLineEle=k}this.setParaAttCtrl()}}catch(m){g_objCommonUtil.displayErrorAlert(m,"dze_rulerbar_mgr.applyParagraph")}},setParaAtt:function(a,b,c){try{switch(this.m_nPressedBtnType){case RULERBAR_L_TOP_BTN:this.m_curLineEle.style.marginLeft;this.m_curLineEle.style.textIndent=-this.m_nLeftMargin+(a-b)+"px";break;case RULERBAR_L_MID_BTN:this.m_curLineEle.style.marginLeft=
a+"px";var d=this.m_nLeftMargin+this.m_nIndent;this.m_curLineEle.style.textIndent=a==d?"0px":d-(a-b)+"px";break;case RULERBAR_L_BOTTOM_BTN:this.m_curLineEle.style.marginLeft=a-b+"px";break;case RULERBAR_R_BOTTOM_BTN:this.m_curLineEle.style.marginRight=this.m_nEditorWidth-this.m_nDefaultBodyMargin-a+"px",this.m_nObjType==DZE_TAG_TD&&0!=c&&(this.m_curLineEle.style.marginRight=c-a+"px")}}catch(f){g_objCommonUtil.displayErrorAlert(f,"dze_rulerbar_mgr.setParaAtt")}},getBodyFirstChildEle:function(a){try{if(null!=
a.firstElementChild)return a.firstElementChild;g_objCommonUtil.log("dze_rulerbar_mgr.setCurStLineEle getBodyFirstChildEle null")}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.setCurStLineEle getBodyFirstChildEle null")}},setParaAttCtrl:function(){try{this.getLeftMargin(),this.getRightMargin(),this.getIndent()}catch(a){g_objCommonUtil.displayErrorAlert(a,"dze_rulerbar_mgr.setParaAttCtrl")}},onResize:function(a){if(!(dze_rulerbar_mgr.m_nMaxEditorWidthForFullScreen>=duzon_menubar.availToolbarWidth))try{dze_rulerbar_mgr.hideRulerbarVGuideLine(!1),
dze_rulerbar_mgr.m_bCreated||dze_rulerbar_mgr.createRulerbar(dze_rulerbar_mgr.m_nEditNum,a,dze_rulerbar_mgr.m_nDefaultBodyMargin),dze_rulerbar_mgr.setCurLineEle(),dze_rulerbar_mgr.updateCtrlPos()}catch(b){g_objCommonUtil.displayErrorAlert(b,"dze_rulerbar_mgr.onResize")}},destruct:function(){}};
function isPressedRulerBarBtn(){try{return g_bRulerbar_Display&&dze_rulerbar_mgr&&dze_rulerbar_mgr.m_bShow&&dze_rulerbar_mgr.m_nPressedBtnType?!0:!1}catch(a){g_objCommonUtil.displayErrorAlert(a,"[dze_rulerbar_mgr.js]::isPressedRulerBarBtn")}}function isShowedRulerBar(){try{return g_bRulerbar_Display&&dze_rulerbar_mgr&&dze_rulerbar_mgr.m_bShow?!0:!1}catch(a){g_objCommonUtil.displayErrorAlert(a,"[dze_rulerbar_mgr.js]::isShowedRulerBar")}}
function isCreatedRulerBar(){try{return g_bRulerbar_Display&&dze_rulerbar_mgr&&dze_rulerbar_mgr.m_bCreated?!0:!1}catch(a){g_objCommonUtil.displayErrorAlert(a,"[dze_rulerbar_mgr.js]::isCreatedRulerBar")}};

var g_objCopyPaste=new function(){this.objPasteDiv=null;this.arrPasteJob=[];this.curTimeoutId=null;this.bPasting=!1;this.isPasting=function(){return this.bPasting};this.bPaused=this.bProcessingJob=!1;this.nEditNumber=0;this.evnt=null;this.curCaretID="";this.timerID=null;this.DZE_PASTE_CAPTURE="dze_paste_capture";this.DZE_PASTE_HERE_MY_BROWSER="dze_paste_here_my_browser";this.PASTE_EMPTY=0;this.PASTE_TEXT=1;this.PASTE_TABLE=2;this.PASTE_HTML=3;this.PASTE_IMAGE=4;this.PASTE_LIST=5;this.nPasteType=0;
this.setPasteType=function(a){this.nPasteType=a};this.ID_PASTE_CARET="dze_paste_caret";this.ID_PASTE_POS_CARET="dze_paste_pos_caret";this.init=function(){try{this.objPasteDiv&&this.objPasteDiv.parentNode&&this.objPasteDiv.parentNode.removeChild(this.objPasteDiv),this.objPasteDiv=null,this.arrPasteJob=[],this.curTimeoutId=null,this.bPaused=this.bPasting=!1,this.nEditNumber=0,this.evnt=null,this.curCaretID="",this.nPasteType=0,this.bProcessingJob=!1,clearTimeout(this.timerID),this.timerID=null}catch(a){dalert(a)}};
this.pasteKeyDown=function(a,b){try{dzeUiConfig.bUsePasteCapture&&a&&!a.cancelBubble&&(a.keyCode==ID_KEYCODE_V&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||a.keyCode==ID_KEYCODE_INSERT&&a.shiftKey)&&(this.bPasting?TBCancelBubbleEvent(a):(g_objUndoRedo.registerUndoRedoStack(0,b),this.init(),this.nEditNumber=b,this.moveCaretToPasteDiv()))}catch(c){dalert(c)}};this.pasteClick=function(a){try{dzeUiConfig.bUsePasteCapture&&!this.bPasting&&(g_objUndoRedo.registerUndoRedoStack(0,a),this.init(),
this.nEditNumber=a,this.moveCaretToPasteDiv())}catch(b){dalert(b)}};this.moveCaretToPasteDiv=function(){try{if(dzeUiConfig.bUsePasteCapture){var a=g_objEditorDocument[this.nEditNumber],b=g_objEditWindow[this.nEditNumber];if(a&&b){this.curCaretID=this.ID_PASTE_CARET+"_"+g_objCommonUtil.getUniqueID();g_objCaretUtil.saveCaret(this.nEditNumber,this.curCaretID);this.objPasteDiv=this.createPasteDiv(this.nEditNumber);var c=b.getSelection(),d=a.createRange();d.selectNode(this.objPasteDiv.firstChild.firstChild);
c.removeAllRanges();c.addRange(d)}}}catch(e){dalert(e)}};this.pasteBefore=function(a,b){try{if(!dzeUiConfig.bUsePasteCapture)return!1;for(var c=g_objNodeUtil,d=c.getAncestorNodeOnCaret(b);d&&!c.isLoopBreakNode(d)&&d.id!=this.DZE_PASTE_CAPTURE;)d=d.parentNode;if(d.id!=this.DZE_PASTE_CAPTURE)return this.init(),!1;this.evnt=a;this.nEditNumber=b;this.bPasting=!0;this.resume();return!0}catch(e){dalert(e)}};this.pasteAfter=function(a,b){try{if(!dzeUiConfig.bUsePasteCapture)return!1;g_objCaretUtil.restoreCaret(b,
this.curCaretID);this.deleteCurrentContents();var c=this.objPasteDiv;this.adjustPasteContents(c);var d=this.guessPasteType(c);if(d==this.PASTE_EMPTY)return!1;var e=this.extractPasteContents(c,d),f=g_objNodeUtil;a=g_objCaretUtil;var l=g_objEditWindow[b],g=l?l.getSelection():null,k=g&&0<g.rangeCount?g.getRangeAt(0):null;if(!k)return!1;var h=a.insertCaretMarker(k,this.ID_PASTE_POS_CARET,!1).end;if(!h)return!1;this.splitParent(e,h,d);k.selectNode(h);k.collapse(!0);k.insertNode(e);a.removeMarkerAttribute(h);
if(d==this.PASTE_TEXT||d==this.PASTE_IMAGE)g_objLetterFn.copySpanStyle(h,h.previousSibling);else{var m=null;f.traverseNodesInRange(k,function(a){a&&(a.nodeType==ID_SELECTION_TEXT_NODE||f.checkTagName(a,"br"))&&(m=a)});m?(g_objLetterFn.copySpanStyle(h,m.parentNode),f.checkTagName(m,"br")?m.parentNode.insertBefore(h,m):insertAfter(m,h)):g_objLetterFn.copySpanStyle(h,h.previousSibling)}a.moveCaret(h,!0,!1)}catch(n){dalert(n)}};this.setPasteDiv=function(a){try{return this.objPasteDiv=a,this}catch(b){dalert(b)}};
this.getPasteDiv=function(){try{var a=g_objEditorDocument[this.nEditNumber];if(!dzeUiConfig.bUsePasteCapture||!this.bPasting)return a.body;var b=this.objPasteDiv;b&&b.parentNode||(this.objPasteDiv=b=a.getElementById(this.DZE_PASTE_CAPTURE));return b}catch(c){dalert(c)}};this.createPasteDiv=function(a){try{if(dzeUiConfig.bUsePasteCapture){"undefined"==typeof a&&(a=g_nActiveEditNumber);var b=g_objEditorDocument[a],c=b.createElement("div");c.id=this.DZE_PASTE_CAPTURE;c.contentEditable=!0;c.style.width=
"100%";c.style.height="100%";c.style.left=screen.width;c.style.position="fixed";c.style.background=b.body.style.background;c.innerHTML="<p>"+duzon_dialog.dze_bookmark_last_tag+"</p>";b.body.appendChild(c);return c}}catch(d){dalert(d)}};this.runPaste=function(){try{dzeUiConfig.bUsePasteCapture&&!this.bPaused&&(this.arrPasteJob.length&&(this.bProcessingJob=!0,this.arrPasteJob.shift().func(),this.bProcessingJob=!1),!this.bPaused&&0<this.arrPasteJob.length?this.resume():this.bPaused||0!=this.arrPasteJob.length||
(this.pasteAfter(this.evnt,this.nEditNumber),this.init(),editor_onpaste_complete(this.evnt,this.nEditNumber)))}catch(a){dalert(a)}};this.resume=function(){try{if(dzeUiConfig.bUsePasteCapture)if(this.bProcessingJob)this.bPaused=!1;else{this.bPaused=!1;for(var a=0;a<this.arrPasteJob.length;a++)this.arrPasteJob[a].delay=0;clearTimeout(this.timerID);this.timerID=setTimeout(function(){g_objCopyPaste.runPaste()},1)}}catch(b){dalert(b)}};this.pause=function(){try{dzeUiConfig.bUsePasteCapture&&(this.bPaused=
!0)}catch(a){dalert(a)}};this.setTimeoutForPaste=function(a,b){try{if(dzeUiConfig.bUsePasteCapture&&this.bPasting){a={func:a,delay:b};for(var c=0;c<this.arrPasteJob.length;c++)if(b<this.arrPasteJob[c].delay){this.arrPasteJob.splice(c,0,a);break}c>=this.arrPasteJob.length&&this.arrPasteJob.push(a)}else setTimeout(a,b)}catch(d){dalert(d)}};this.splitParent=function(a,b,c){try{if(!b)return!1;var d=g_objNodeUtil;if(c==this.PASTE_TEXT||c==this.PASTE_IMAGE)this.splitParentForPasteText(a,b,c);else{var e=
this.getClosetNoSplitNode(b),f=g_objSplitUtil.findSplitPosition(b,e);f.parentNode.insertBefore(b,f);d.splitOn(e,b)}}catch(l){dalert(l)}};this.splitParentForPasteText=function(a,b,c){try{if(c=g_objNodeUtil,c.checkTagName(b.parentNode,"span")&&!g_objPropertyUtil.element_hasClass(b.parentNode,"dze_shape_text_span")){var d=b.parentNode,e=a.firstChild;for(a=null;e;){a=e.nextSibling;if(c.checkTagName(e,"span")){var f=parseStyle(d.getAttribute("style")),l=parseStyle(e.getAttribute("style"));if(f&&l)for(var g in f)l[g]||
!f[g]||"fontFamily"!=g&&"fontSize"!=g&&"color"!=g&&"backgroundColor"!=g&&"fontWeight"!=g&&"lineHeight"!=g&&"letterSpacing"!=g||(e.style[g]=f[g])}else{var k=d.cloneNode(!1);e.parentNode.replaceChild(k,e);k.appendChild(e)}e=a}c.clean(d);d.firstChild==b?d.parentNode.insertBefore(b,d):d.lastChild==b?insertAfter(d,b):c.splitOn(d.parentNode,b)}}catch(h){dalert(h)}};this.getClosetNoSplitNode=function(a){try{if(!a)return null;for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a)&&!b.checkTagName(a,
"td","th")&&!b.checkTagName(a,"div");){var d=a.style.position.toLowerCase();if("absolute"==d||"fixed"==d)break;if(c.element_hasClass(a,"dze_shape_text_span"))break;a=a.parentElement}return a}catch(e){dalert(e)}};this.deleteCurrentContents=function(){try{var a=g_objEditWindow[this.nEditNumber].getSelection(),b=0<a.rangeCount?a.getRangeAt(0):null;b&&b.deleteContents();return!0}catch(c){dalert(c)}};this.guessPasteType=function(a){try{var b=this.PASTE_HTML;this.isPasteTypeEmpty(a)?b=this.PASTE_EMPTY:
this.isPasteTypeImage(a)?b=this.PASTE_IMAGE:this.isPasteTypeText(a)?b=this.PASTE_TEXT:this.isPasteTypeTable(a)?b=this.PASTE_TABLE:this.isPasteTypeList(a)&&(b=this.PASTE_LIST);return b}catch(c){dalert(c)}};this.isPasteTypeEmpty=function(a){try{if(!a||!a.firstChild)return!0;var b=a.firstChild;return 1==a.childNodes.length&&g_objNodeUtil.checkTagName(b,"p")&&b.firstChild.nodeType==ID_SELECTION_TEXT_NODE&&0==removeZeroWidthSpaceFromString(b.firstChild.nodeValue).length&&!b.firstChild.nextSibling?!0:!1}catch(c){dalert(c)}};
this.isPasteTypeText=function(a){try{if(!a||!a.firstChild)return!1;var b=g_objNodeUtil;return b.checkTagName(a.firstChild,"p")&&!a.firstChild.nextSibling||b.isAllTextInlineChildNode(a)?!0:!1}catch(c){dalert(c)}};this.isPasteTypeTable=function(a){try{return 1==a.childNodes.length&&g_objNodeUtil.checkTagName(a.firstChild,"table")?!0:!1}catch(b){dalert(b)}};this.isPasteTypeList=function(a){try{return a&&a.firstChild?"ol"==a.firstChild.nodeName.toLowerCase()||"ul"==a.firstChild.nodeName.toLowerCase()||
"div"==a.firstChild.nodeName.toLowerCase()&&1==a.firstChild.childNodes.length&&("ol"==a.firstChild.firstChild.nodeName.toLowerCase()||"ul"==a.firstChild.firstChild.nodeName.toLowerCase())?!0:!1:!1}catch(b){dalert(b)}};this.isPasteTypeImage=function(a){try{if(!a||!a.firstChild)return!1;var b=g_objNodeUtil;return b.checkTagName(a.firstChild,"img")&&!a.firstChild.nextSibling||b.checkTagName(a.firstChild,"p")&&!a.firstChild.nextSibling&&b.checkTagName(a.firstChild.firstChild,"img")&&!a.firstChild.firstChild.nextSibling?
!0:!1}catch(c){dalert(c)}};this.extractPasteContents=function(a,b){try{var c=g_objEditorDocument[this.nEditNumber].createRange();b!=this.PASTE_TEXT&&b!=this.PASTE_IMAGE||!g_objNodeUtil.checkTagName(a.firstChild,"p")?c.selectNodeContents(a):c.selectNodeContents(a.firstChild);return c.extractContents()}catch(d){dalert(d)}};this.insertSpanElementAfterLastTextNode=function(a){try{if(!a)return null;var b=g_objNodeUtil,c=a.ownerDocument,d=c.createRange();d.selectNode(a);var e=null;b.traverseNodesInRange(d,
function(a){a&&(a.nodeType==ID_SELECTION_TEXT_NODE||b.checkTagName(a,"br"))&&(e=a)});if(!e)return null;var f=c.createElement("span");g_objLetterFn.copySpanStyle(f,e.parentNode);b.checkTagName(e,"br")?e.parentNode.insertBefore(f,e):insertAfter(e,f);return f}catch(l){dalert(l)}};this.adjustPasteContents=function(a){try{var b=g_objNodeUtil;b.clean(a);!1===g_bBrowserType_IE&&setHyperlinkAuto(this.nEditNumber,!0);a&&2==a.childNodes.length&&b.checkTagName(a.firstChild,"table")&&b.checkTagName(a.childNodes[1],
"p")&&""==a.childNodes[1].innerHTML&&a.removeChild(a.childNodes[1]);this.removeFirstLastBlankPara(a);this.removeUselessDiv(a)}catch(c){dalert(c)}};this.removeFirstLastBlankPara=function(a){try{if(!a||!a.firstChild)return!1;var b=function(a){var b=g_objNodeUtil;a=b.checkTagName(a,"p");if(!a||a.style.whiteSpace)return!1;for(var c=a.childNodes,d=0;d<c.length;d++)if(!b.isIgnorable(c[d]))return!1;a.parentNode.removeChild(a);return!0},c=!1;c|=b(a.firstChild);return c|=b(a.lastChild)}catch(d){dalert(d)}};
this.removeUselessDiv=function(a){try{if(!a||!a.firstChild)return!1;var b=a.ownerDocument,c=g_objNodeUtil,d=g_objVideoControl,e=a.querySelectorAll("div");e=[].slice.call(e);e.forEach(function(e){if(e.ownerDocument==b){for(var f=e;f&&c.checkTagName(f,"div")&&f!=a;)f=f.parentNode;if(f==a){if(d.isInVideoContainer(e))return}else if(0<e.attributes.length||e.className||e.id)return;f=e.parentNode;var g=b.createDocumentFragment();c.moveNodesTo(g,e.firstChild);if(f==a&&c.isAllTextInlineChildNode(g)){var k=
b.createElement("p");k.appendChild(g);f.replaceChild(k,e)}else f.replaceChild(g,e)}});return!0}catch(f){dalert(f)}}},g_objVideoControl=new function(){this.isInVideoContainer=function(a){try{if(!a)return!1;var b=g_objNodeUtil;if(b.checkTagName(a.firstChild,"iframe"))return!0;for(;a&&!b.isLoopBreakNode(a);){var c=a.id,d=a.className;if(0<c.indexOf("video")||0<d.indexOf("video")||0<c.indexOf("player")||0<d.indexOf("player"))return!0;a=a.parentNode}return!1}catch(e){dalert(e)}}},g_objSplitUtil=new function(){this.findSplitPosition=
function(a,b){try{if(!a)return null;for(var c=g_objNodeUtil,d=a.parentNode;d&&d!=b&&!c.isLoopBreakNode(d);){for(;a;){var e=a.previousSibling;if(!e||!this.isZeroWidthNode(e))break;a=e}if(d.firstChild!=a)break;a=d;d=a.parentNode}return a}catch(f){dalert(f)}};this.isZeroWidthNode=function(a){try{var b=g_objNodeUtil,c=g_objPropertyUtil;if(b.checkTagName(a,"colgroup")||b.checkTagName(a,"span")&&(c.element_hasClass(a,"dze_page_break")||c.element_hasClass(a,"dze_shape_main")))return!0;if(a.nodeType==ID_SELECTION_ELEMENT_NODE){if(b.isInlineNode(a)&&
0==a.offsetWidth)return!0}else if(a.nodeType==ID_SELECTION_TEXT_NODE&&(0==a.nodeValue.length||!b.checkTagName(a.parentNode,"p","span","li")&&b.isIgnorable(a)))return!0;return!1}catch(d){dalert(d)}}};

